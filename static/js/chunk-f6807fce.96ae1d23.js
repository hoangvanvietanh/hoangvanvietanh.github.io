(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f6807fce"],{"049b":function(t,e,n){"use strict";e.default=void 0;var o=c(n("14a3")),i=n("4ff6"),r=c(n("8a64")),a=c(n("1908")),s=n("706b");function c(t){return t&&t.__esModule?t:{default:t}}var u={getConfigurations:function(){var t=(0,i.getDiagram)(),e=t.DiagramCommand;return this.dialogList||(this.dialogList=[{command:e.InsertShapeImage,title:r.default.format("dxDiagram-dialogInsertShapeImageTitle"),onGetContent:this.getChangeImageDialogContent},{command:e.EditShapeImage,title:r.default.format("dxDiagram-dialogEditShapeImageTitle"),onGetContent:this.getChangeImageDialogContent}])},getChangeImageDialogContent:function(t){var e=(0,o.default)("<div>");return t.component._createComponent(e,a.default,{selectButtonText:r.default.format("dxDiagram-dialogEditShapeImageSelectButton"),accept:"image/*",uploadMode:"useForm",onValueChanged:function(e){var n=(0,s.getWindow)(),o=new n.FileReader;o.onload=function(e){t.component._commandParameter=e.target.result},o.readAsDataURL(e.value[0])}}),e},getDialogParameters:function(t){var e=this.getConfigurations().map((function(t){return t.command})).indexOf(t);return e>=0?this.getConfigurations()[e]:null}},l=u;e.default=l,t.exports=e.default},"05bb":function(t,e,n){"use strict";e.default=void 0;var o=l(n("14a3")),i=l(n("8de2")),r=l(n("c0bf")),a=l(n("fe7a")),s=n("d4b2"),c=l(n("0fa5")),u=l(n("f4b7"));function l(t){return t&&t.__esModule?t:{default:t}}var p="dx-colorbox",h=p+"-input",d=h+"-container",f=p+"-color-result-preview",m=p+"-color-is-not-defined",g=p+"-overlay",y="dx-colorview-container-cell",v="dx-colorview-button-cell",C="dx-colorview-buttons-container",_="dx-colorview-apply-button",P="dx-colorview-cancel-button",S=a.default.prototype,b={makeTransparentBackground:S._makeTransparentBackground.bind(S),makeRgba:S._makeRgba.bind(S)},x=u.default.inherit({_supportedKeys:function(){var t=function(t){if(t.stopPropagation(),this.option("opened"))return t.preventDefault(),!0},e=function(t){return this.option("opened")?!t.altKey||(this.close(),!1):(t.preventDefault(),!1)},n=function(t){return this.option("opened")||t.altKey?!(!this.option("opened")&&t.altKey)||(this._validatedOpening(),!1):(t.preventDefault(),!1)};return(0,s.extend)(this.callBase(),{tab:function(t){this.option("opened")&&(t.preventDefault(),this._colorView._rgbInputs[0].focus())},enter:this._enterKeyHandler,leftArrow:t,rightArrow:t,upArrow:e,downArrow:n})},_getDefaultOptions:function(){return(0,s.extend)(this.callBase(),{editAlphaChannel:!1,applyValueMode:"useButtons",keyStep:1,fieldTemplate:null,buttonsLocation:"bottom after"})},_popupHidingHandler:function(){this.callBase(),"useButtons"===this.option("applyValueMode")&&this._updateColorViewValue(this.option("value"))},_popupConfig:function(){return(0,s.extend)(this.callBase(),{width:""})},_contentReadyHandler:function(){this._createColorView(),this._addPopupBottomClasses()},_addPopupBottomClasses:function(){var t=this._popup.bottomToolbar();t&&(t.addClass(y).addClass(v).find(".dx-toolbar-items-container").addClass(C),t.find(".dx-popup-done").addClass(_),t.find(".dx-popup-cancel").addClass(P))},_createColorView:function(){this._popup.overlayContent().addClass(g);var t=(0,o.default)("<div>").appendTo(this._popup.$content());this._colorView=this._createComponent(t,a.default,this._colorViewConfig()),this._colorView.registerKeyHandler("escape",this._escapeHandler.bind(this)),i.default.on(t,"focus",function(){this.focus()}.bind(this))},_escapeHandler:function(){this.close(),this.focus()},_applyNewColor:function(t){this.option("value",t),t&&b.makeTransparentBackground(this._$colorResultPreview,t),this._colorViewEnterKeyPressed&&(this.close(),this._colorViewEnterKeyPressed=!1)},_colorViewConfig:function(){var t=this;return{value:t.option("value"),matchValue:t.option("value"),editAlphaChannel:t.option("editAlphaChannel"),applyValueMode:t.option("applyValueMode"),focusStateEnabled:t.option("focusStateEnabled"),stylingMode:this.option("stylingMode"),onEnterKeyPressed:function(){t._colorViewEnterKeyPressed=!0,t._colorView.option("value")!==t.option("value")&&(t._applyNewColor(t._colorView.option("value")),t.close())},onValueChanged:function(e){if(b.makeRgba(e.value)!==e.previousValue){var n="instantly"===t.option("applyValueMode");(n||t._colorViewEnterKeyPressed)&&t._applyNewColor(e.value)}}}},_enterKeyHandler:function(){var t=this._input().val(),e=this.option("value"),n=this.option("editAlphaChannel")?b.makeRgba(e):e;if(!t)return!1;var o=new r.default(t);if(!o.colorIsInvalid){if(t!==n&&(this._applyColorFromInput(t),this.option("value",this.option("editAlphaChannel")?b.makeRgba(t):t)),this._colorView){var i=this._colorView.option("value");e!==i&&this.option("value",i)}return this.close(),!1}this._input().val(n)},_applyButtonHandler:function(){this._applyNewColor(this._colorView.option("value")),this.callBase()},_cancelButtonHandler:function(){this._resetInputValue(),this.callBase()},_getKeyboardListeners:function(){return this.callBase().concat([this._colorView])},_init:function(){this.callBase()},_initMarkup:function(){this.$element().addClass(p),this.callBase()},_renderInput:function(){this.callBase(),this._input().addClass(h),this._renderColorPreview()},_renderColorPreview:function(){this.$element().wrapInner((0,o.default)("<div>").addClass(d)),this._$colorBoxInputContainer=this.$element().children().eq(0),this._$colorResultPreview=(0,o.default)("<div>").addClass(f).appendTo(this._$textEditorInputContainer),this.option("value")?b.makeTransparentBackground(this._$colorResultPreview,this.option("value")):this._$colorBoxInputContainer.addClass(m)},_renderValue:function(){var t=this.option("value");return this.option("text",this.option("editAlphaChannel")?b.makeRgba(t):t),this.callBase()},_resetInputValue:function(){var t=this._input(),e=this.option("value");t.val(e),this._updateColorViewValue(e)},_updateColorViewValue:function(t){this._colorView&&this._colorView.option({value:t,matchValue:t})},_valueChangeEventHandler:function(t){var e=this._input().val();e&&(e=this._applyColorFromInput(e),this._updateColorViewValue(e)),this.callBase(t,e)},_applyColorFromInput:function(t){var e=new r.default(t);return e.colorIsInvalid&&(this._resetInputValue(),t=this.option("value")),t},_optionChanged:function(t){var e=t.value,n=t.name;switch(n){case"value":this._$colorBoxInputContainer.toggleClass(m,!e),e?b.makeTransparentBackground(this._$colorResultPreview,e):this._$colorResultPreview.removeAttr("style"),this._updateColorViewValue(e),this.callBase(t);break;case"applyButtonText":case"cancelButtonText":this.callBase(t),this._popup&&this._addPopupBottomClasses();break;case"editAlphaChannel":case"keyStep":this._colorView&&this._colorView.option(n,e);break;default:this.callBase(t)}}});(0,c.default)("dxColorBox",x);var w=x;e.default=w,t.exports=e.default},"05dd":function(t,e,n){"use strict";e.default=void 0;var o=r(n("3afe")),i=n("4ff6");function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function l(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t){var e=m();return function(){var n,o=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==a(e)&&"function"!==typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var y=function(t){l(n,t);var e=h(n);function n(t){var o;s(this,n),o=e.call(this,t);var r=(0,i.getDiagram)(),c=r.DiagramCommand;return o.commandOptions={},o.commandOptions[c.Fullscreen]="fullScreen",o.commandOptions[c.ZoomLevel]=function(t){"object"===a(this._getOption("zoomLevel"))?this._setOption("zoomLevel.value",t):this._setOption("zoomLevel",t)},o.commandOptions[c.SwitchAutoZoom]=function(t){var e=(0,i.getDiagram)(),n=e.AutoZoomMode;switch(t){case n.FitContent:this._setOption("autoZoomMode","fitContent");break;case n.FitToWidth:this._setOption("autoZoomMode","fitWidth");break;case n.Disabled:this._setOption("autoZoomMode","disabled")}},o.commandOptions[c.ToggleSimpleView]="simpleView",o.commandOptions[c.ShowGrid]="showGrid",o.commandOptions[c.SnapToGrid]="snapToGrid",o.commandOptions[c.GridSize]=function(t){"object"===a(this._getOption("gridSize"))?this._setOption("gridSize.value",t):this._setOption("gridSize",t)},o.commandOptions[c.ViewUnits]="viewUnits",o.commandOptions[c.PageSize]=function(t){var e=this._getOption("pageSize");void 0!==e&&e.width===t.width&&e.height===t.height||this._setOption("pageSize",t)},o.commandOptions[c.PageLandscape]=function(t){this._setOption("pageOrientation",t?"landscape":"portrait")},o.commandOptions[c.ViewUnits]=function(t){var e=(0,i.getDiagram)(),n=e.DiagramUnit;switch(t){case n.In:this._setOption("viewUnits","in");break;case n.Cm:this._setOption("viewUnits","cm");break;case n.Px:this._setOption("viewUnits","px")}},o.commandOptions[c.PageColor]="pageColor",o._updateLock=0,o}return u(n,[{key:"getCommandKeys",value:function(){return Object.keys(this.commandOptions).map((function(t){return parseInt(t)}))}},{key:"setItemValue",value:function(t,e){if(!this.isUpdateLocked()){this.beginUpdate();try{"function"===typeof this.commandOptions[t]?this.commandOptions[t].call(this,e):this._setOption(this.commandOptions[t],e)}finally{this.endUpdate()}}}},{key:"beginUpdate",value:function(){this._updateLock++}},{key:"endUpdate",value:function(){this._updateLock--}},{key:"isUpdateLocked",value:function(){return this._updateLock>0}},{key:"_getOption",value:function(t){return this._owner.option(t)}},{key:"_setOption",value:function(t,e){this._owner.option(t,e)}}]),n}(o.default),v=y;e.default=v,t.exports=e.default},"0770":function(t,e,n){"use strict";
/*!
 * devextreme-vue
 * Version: 20.2.4
 * Build date: Tue Dec 01 2020
 *
 * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-vue
 */Object.defineProperty(e,"__esModule",{value:!0}),e.DxZoomLevel=e.DxViewToolbar=e.DxToolboxGroup=e.DxToolbox=e.DxTabGroup=e.DxTab=e.DxPropertiesPanel=e.DxPageSizeItem=e.DxPageSize=e.DxNodes=e.DxMainToolbar=e.DxItem=e.DxHistoryToolbar=e.DxGroup=e.DxGridSize=e.DxExport=e.DxEditing=e.DxEdges=e.DxDefaultItemProperties=e.DxCustomShape=e.DxContextToolbox=e.DxContextMenu=e.DxConnectionPoint=e.DxCommandItem=e.DxCommand=e.DxAutoLayout=e.DxDiagram=void 0;var o=n("2eae"),i=n("27da"),r=n("27da"),a=i.createComponent({props:{autoZoomMode:String,contextMenu:Object,contextToolbox:Object,customShapes:Array,customShapeTemplate:{},customShapeToolboxTemplate:{},defaultItemProperties:Object,disabled:Boolean,edges:Object,editing:Object,elementAttr:Object,export:Object,fullScreen:Boolean,gridSize:[Number,Object],hasChanges:Boolean,height:[Function,Number,String],historyToolbar:Object,mainToolbar:Object,nodes:Object,onContentReady:Function,onCustomCommand:Function,onDisposing:Function,onInitialized:Function,onItemClick:Function,onItemDblClick:Function,onOptionChanged:Function,onRequestEditOperation:Function,onRequestLayoutUpdate:Function,onSelectionChanged:Function,pageColor:String,pageOrientation:String,pageSize:Object,propertiesPanel:Object,readOnly:Boolean,rtlEnabled:Boolean,showGrid:Boolean,simpleView:Boolean,snapToGrid:Boolean,toolbox:Object,units:String,viewToolbar:Object,viewUnits:String,visible:Boolean,width:[Function,Number,String],zoomLevel:[Number,Object]},emits:{"update:isActive":null,"update:hoveredElement":null,"update:autoZoomMode":null,"update:contextMenu":null,"update:contextToolbox":null,"update:customShapes":null,"update:customShapeTemplate":null,"update:customShapeToolboxTemplate":null,"update:defaultItemProperties":null,"update:disabled":null,"update:edges":null,"update:editing":null,"update:elementAttr":null,"update:export":null,"update:fullScreen":null,"update:gridSize":null,"update:hasChanges":null,"update:height":null,"update:historyToolbar":null,"update:mainToolbar":null,"update:nodes":null,"update:onContentReady":null,"update:onCustomCommand":null,"update:onDisposing":null,"update:onInitialized":null,"update:onItemClick":null,"update:onItemDblClick":null,"update:onOptionChanged":null,"update:onRequestEditOperation":null,"update:onRequestLayoutUpdate":null,"update:onSelectionChanged":null,"update:pageColor":null,"update:pageOrientation":null,"update:pageSize":null,"update:propertiesPanel":null,"update:readOnly":null,"update:rtlEnabled":null,"update:showGrid":null,"update:simpleView":null,"update:snapToGrid":null,"update:toolbox":null,"update:units":null,"update:viewToolbar":null,"update:viewUnits":null,"update:visible":null,"update:width":null,"update:zoomLevel":null},computed:{instance:function(){return this.$_instance}},beforeCreate:function(){this.$_WidgetClass=o.default,this.$_expectedChildren={contextMenu:{isCollectionItem:!1,optionName:"contextMenu"},contextToolbox:{isCollectionItem:!1,optionName:"contextToolbox"},customShape:{isCollectionItem:!0,optionName:"customShapes"},defaultItemProperties:{isCollectionItem:!1,optionName:"defaultItemProperties"},edges:{isCollectionItem:!1,optionName:"edges"},editing:{isCollectionItem:!1,optionName:"editing"},export:{isCollectionItem:!1,optionName:"export"},gridSize:{isCollectionItem:!1,optionName:"gridSize"},historyToolbar:{isCollectionItem:!1,optionName:"historyToolbar"},mainToolbar:{isCollectionItem:!1,optionName:"mainToolbar"},nodes:{isCollectionItem:!1,optionName:"nodes"},pageSize:{isCollectionItem:!1,optionName:"pageSize"},propertiesPanel:{isCollectionItem:!1,optionName:"propertiesPanel"},toolbox:{isCollectionItem:!1,optionName:"toolbox"},viewToolbar:{isCollectionItem:!1,optionName:"viewToolbar"},zoomLevel:{isCollectionItem:!1,optionName:"zoomLevel"}}}});e.DxDiagram=a;var s=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:orientation":null,"update:type":null},props:{orientation:String,type:String}});e.DxAutoLayout=s,s.$_optionName="autoLayout";var c=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:icon":null,"update:items":null,"update:name":null,"update:text":null},props:{icon:String,items:Array,name:String,text:String}});e.DxCommand=c,c.$_optionName="commands",c.$_isCollectionItem=!0;var u=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:icon":null,"update:items":null,"update:name":null,"update:text":null},props:{icon:String,items:Array,name:String,text:String}});e.DxCommandItem=u,u.$_optionName="items",u.$_isCollectionItem=!0;var l=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:x":null,"update:y":null},props:{x:Number,y:Number}});e.DxConnectionPoint=l,l.$_optionName="connectionPoints",l.$_isCollectionItem=!0;var p=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:commands":null,"update:enabled":null},props:{commands:Array,enabled:Boolean}});e.DxContextMenu=p,p.$_optionName="contextMenu",p.$_expectedChildren={command:{isCollectionItem:!0,optionName:"commands"}};var h=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:category":null,"update:displayMode":null,"update:enabled":null,"update:shapeIconsPerRow":null,"update:shapes":null,"update:width":null},props:{category:String,displayMode:String,enabled:Boolean,shapeIconsPerRow:Number,shapes:Array,width:Number}});e.DxContextToolbox=h,h.$_optionName="contextToolbox";var d=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowEditImage":null,"update:allowEditText":null,"update:allowResize":null,"update:backgroundImageHeight":null,"update:backgroundImageLeft":null,"update:backgroundImageToolboxUrl":null,"update:backgroundImageTop":null,"update:backgroundImageUrl":null,"update:backgroundImageWidth":null,"update:baseType":null,"update:category":null,"update:connectionPoints":null,"update:defaultHeight":null,"update:defaultImageUrl":null,"update:defaultText":null,"update:defaultWidth":null,"update:imageHeight":null,"update:imageLeft":null,"update:imageTop":null,"update:imageWidth":null,"update:keepRatioOnAutoSize":null,"update:maxHeight":null,"update:maxWidth":null,"update:minHeight":null,"update:minWidth":null,"update:template":null,"update:templateHeight":null,"update:templateLeft":null,"update:templateTop":null,"update:templateWidth":null,"update:textHeight":null,"update:textLeft":null,"update:textTop":null,"update:textWidth":null,"update:title":null,"update:toolboxTemplate":null,"update:toolboxWidthToHeightRatio":null,"update:type":null},props:{allowEditImage:Boolean,allowEditText:Boolean,allowResize:Boolean,backgroundImageHeight:Number,backgroundImageLeft:Number,backgroundImageToolboxUrl:String,backgroundImageTop:Number,backgroundImageUrl:String,backgroundImageWidth:Number,baseType:String,category:String,connectionPoints:Array,defaultHeight:Number,defaultImageUrl:String,defaultText:String,defaultWidth:Number,imageHeight:Number,imageLeft:Number,imageTop:Number,imageWidth:Number,keepRatioOnAutoSize:Boolean,maxHeight:Number,maxWidth:Number,minHeight:Number,minWidth:Number,template:{},templateHeight:Number,templateLeft:Number,templateTop:Number,templateWidth:Number,textHeight:Number,textLeft:Number,textTop:Number,textWidth:Number,title:String,toolboxTemplate:{},toolboxWidthToHeightRatio:Number,type:String}});e.DxCustomShape=d,d.$_optionName="customShapes",d.$_isCollectionItem=!0,d.$_expectedChildren={connectionPoint:{isCollectionItem:!0,optionName:"connectionPoints"}};var f=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:connectorLineEnd":null,"update:connectorLineStart":null,"update:connectorLineType":null,"update:shapeMaxHeight":null,"update:shapeMaxWidth":null,"update:shapeMinHeight":null,"update:shapeMinWidth":null,"update:style":null,"update:textStyle":null},props:{connectorLineEnd:String,connectorLineStart:String,connectorLineType:String,shapeMaxHeight:Number,shapeMaxWidth:Number,shapeMinHeight:Number,shapeMinWidth:Number,style:Object,textStyle:Object}});e.DxDefaultItemProperties=f,f.$_optionName="defaultItemProperties";var m=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:customDataExpr":null,"update:dataSource":null,"update:fromExpr":null,"update:fromLineEndExpr":null,"update:fromPointIndexExpr":null,"update:keyExpr":null,"update:lineTypeExpr":null,"update:lockedExpr":null,"update:pointsExpr":null,"update:styleExpr":null,"update:textExpr":null,"update:textStyleExpr":null,"update:toExpr":null,"update:toLineEndExpr":null,"update:toPointIndexExpr":null,"update:zIndexExpr":null},props:{customDataExpr:[Function,String],dataSource:[Array,Object],fromExpr:[Function,String],fromLineEndExpr:[Function,String],fromPointIndexExpr:[Function,String],keyExpr:[Function,String],lineTypeExpr:[Function,String],lockedExpr:[Function,String],pointsExpr:[Function,String],styleExpr:[Function,String],textExpr:[Function,String],textStyleExpr:[Function,String],toExpr:[Function,String],toLineEndExpr:[Function,String],toPointIndexExpr:[Function,String],zIndexExpr:[Function,String]}});e.DxEdges=m,m.$_optionName="edges";var g=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:allowAddShape":null,"update:allowChangeConnection":null,"update:allowChangeConnectorPoints":null,"update:allowChangeConnectorText":null,"update:allowChangeShapeText":null,"update:allowDeleteConnector":null,"update:allowDeleteShape":null,"update:allowMoveShape":null,"update:allowResizeShape":null},props:{allowAddShape:Boolean,allowChangeConnection:Boolean,allowChangeConnectorPoints:Boolean,allowChangeConnectorText:Boolean,allowChangeShapeText:Boolean,allowDeleteConnector:Boolean,allowDeleteShape:Boolean,allowMoveShape:Boolean,allowResizeShape:Boolean}});e.DxEditing=g,g.$_optionName="editing";var y=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:fileName":null,"update:proxyUrl":null},props:{fileName:String,proxyUrl:String}});e.DxExport=y,y.$_optionName="export";var v=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:items":null,"update:value":null},props:{items:Array,value:Number}});e.DxGridSize=v,v.$_optionName="gridSize";var C=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:category":null,"update:commands":null,"update:displayMode":null,"update:expanded":null,"update:shapes":null,"update:title":null},props:{category:String,commands:Array,displayMode:String,expanded:Boolean,shapes:Array,title:String}});e.DxGroup=C,C.$_optionName="groups",C.$_isCollectionItem=!0;var _=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:commands":null,"update:visible":null},props:{commands:Array,visible:Boolean}});e.DxHistoryToolbar=_,_.$_optionName="historyToolbar",_.$_expectedChildren={command:{isCollectionItem:!0,optionName:"commands"}};var P=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:height":null,"update:icon":null,"update:items":null,"update:name":null,"update:text":null,"update:width":null},props:{height:Number,icon:String,items:Array,name:String,text:String,width:Number}});e.DxItem=P,P.$_optionName="items",P.$_isCollectionItem=!0;var S=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:commands":null,"update:visible":null},props:{commands:Array,visible:Boolean}});e.DxMainToolbar=S,S.$_optionName="mainToolbar",S.$_expectedChildren={command:{isCollectionItem:!0,optionName:"commands"}};var b=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:autoLayout":null,"update:autoSizeEnabled":null,"update:containerChildrenExpr":null,"update:containerKeyExpr":null,"update:customDataExpr":null,"update:dataSource":null,"update:heightExpr":null,"update:imageUrlExpr":null,"update:itemsExpr":null,"update:keyExpr":null,"update:leftExpr":null,"update:lockedExpr":null,"update:parentKeyExpr":null,"update:styleExpr":null,"update:textExpr":null,"update:textStyleExpr":null,"update:topExpr":null,"update:typeExpr":null,"update:widthExpr":null,"update:zIndexExpr":null},props:{autoLayout:[Object,String],autoSizeEnabled:Boolean,containerChildrenExpr:[Function,String],containerKeyExpr:[Function,String],customDataExpr:[Function,String],dataSource:[Array,Object],heightExpr:[Function,String],imageUrlExpr:[Function,String],itemsExpr:[Function,String],keyExpr:[Function,String],leftExpr:[Function,String],lockedExpr:[Function,String],parentKeyExpr:[Function,String],styleExpr:[Function,String],textExpr:[Function,String],textStyleExpr:[Function,String],topExpr:[Function,String],typeExpr:[Function,String],widthExpr:[Function,String],zIndexExpr:[Function,String]}});e.DxNodes=b,b.$_optionName="nodes",b.$_expectedChildren={autoLayout:{isCollectionItem:!1,optionName:"autoLayout"}};var x=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:height":null,"update:items":null,"update:width":null},props:{height:Number,items:Array,width:Number}});e.DxPageSize=x,x.$_optionName="pageSize",x.$_expectedChildren={item:{isCollectionItem:!0,optionName:"items"},pageSizeItem:{isCollectionItem:!0,optionName:"items"}};var w=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:height":null,"update:text":null,"update:width":null},props:{height:Number,text:String,width:Number}});e.DxPageSizeItem=w,w.$_optionName="items",w.$_isCollectionItem=!0;var I=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:tabs":null,"update:visibility":null},props:{tabs:Array,visibility:String}});e.DxPropertiesPanel=I,I.$_optionName="propertiesPanel",I.$_expectedChildren={tab:{isCollectionItem:!0,optionName:"tabs"}};var T=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:commands":null,"update:groups":null,"update:title":null},props:{commands:Array,groups:Array,title:String}});e.DxTab=T,T.$_optionName="tabs",T.$_isCollectionItem=!0,T.$_expectedChildren={command:{isCollectionItem:!0,optionName:"commands"},group:{isCollectionItem:!0,optionName:"groups"},tabGroup:{isCollectionItem:!0,optionName:"groups"}};var O=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:commands":null,"update:title":null},props:{commands:Array,title:String}});e.DxTabGroup=O,O.$_optionName="groups",O.$_isCollectionItem=!0,O.$_expectedChildren={command:{isCollectionItem:!0,optionName:"commands"}};var E=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:groups":null,"update:shapeIconsPerRow":null,"update:showSearch":null,"update:visibility":null,"update:width":null},props:{groups:Array,shapeIconsPerRow:Number,showSearch:Boolean,visibility:String,width:Number}});e.DxToolbox=E,E.$_optionName="toolbox",E.$_expectedChildren={group:{isCollectionItem:!0,optionName:"groups"},toolboxGroup:{isCollectionItem:!0,optionName:"groups"}};var M=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:category":null,"update:displayMode":null,"update:expanded":null,"update:shapes":null,"update:title":null},props:{category:String,displayMode:String,expanded:Boolean,shapes:Array,title:String}});e.DxToolboxGroup=M,M.$_optionName="groups",M.$_isCollectionItem=!0;var D=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:commands":null,"update:visible":null},props:{commands:Array,visible:Boolean}});e.DxViewToolbar=D,D.$_optionName="viewToolbar",D.$_expectedChildren={command:{isCollectionItem:!0,optionName:"commands"}};var A=r.createConfigurationComponent({emits:{"update:isActive":null,"update:hoveredElement":null,"update:items":null,"update:value":null},props:{items:Array,value:Number}});e.DxZoomLevel=A,A.$_optionName="zoomLevel",e.default=a},"0b34":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=l(n("14a3")),r=n("d4b2"),a=l(n("367c")),s=l(n("a34f")),c=l(n("8c78")),u=l(n("6571"));function l(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function d(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}function f(t,e,n){return f="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=m(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},f(t,e,n||t)}function m(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=S(t),null===t)break;return t}function g(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function v(t){var e=P();return function(){var n,o=S(t);if(e){var i=S(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return C(this,n)}}function C(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?_(t):e}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}var b=420,x=340,w="dx-diagram-properties-popup",I="dx-diagram-properties-popup-notabs",T="dx-diagram-properties-panel",O="dx-diagram-properties-panel-group-title",E="dx-diagram-properties-panel-group-toolbar",M=function(t){g(n,t);var e=v(n);function n(){return p(this,n),e.apply(this,arguments)}return d(n,[{key:"_init",value:function(){f(S(n.prototype),"_init",this).call(this),this._commandTabs=u.default.getPropertyPanelCommandTabs(this.option("propertyTabs")),this._createOnCreateToolbar(),this._createOnSelectedGroupChanged()}},{key:"_initMarkup",value:function(){this._toolbars=[],this._selectedToolbar=void 0,f(S(n.prototype),"_initMarkup",this).call(this)}},{key:"_getPopupClass",value:function(){var t=w;return this._hasTabPanel()||(t+=" "+I),t}},{key:"_getPopupWidth",value:function(){return this.isMobileView()?"100%":b}},{key:"_getPopupHeight",value:function(){return x}},{key:"_getPopupPosition",value:function(){var t=this.option("offsetParent");return this.isMobileView()?{my:"left bottom",at:"left bottom",of:t}:{my:"right bottom",at:"right bottom",of:t,offset:"-"+this.option("offsetX")+" -"+this.option("offsetY")}}},{key:"_getPopupAnimation",value:function(){var t=this.option("offsetParent");return this.isMobileView()?{hide:this._getPopupSlideAnimationObject({direction:"bottom",from:{position:{my:"left bottom",at:"left bottom",of:t}},to:{position:{my:"left top",at:"left bottom",of:t}}}),show:this._getPopupSlideAnimationObject({direction:"top",from:{position:{my:"left top",at:"left bottom",of:t}},to:{position:{my:"left bottom",at:"left bottom",of:t}}})}:f(S(n.prototype),"_getPopupAnimation",this).call(this)}},{key:"_getPopupOptions",value:function(){return(0,r.extend)(f(S(n.prototype),"_getPopupOptions",this).call(this),{showTitle:this.isMobileView(),showCloseButton:this.isMobileView()})}},{key:"_renderPopupContent",value:function(t){if(this._commandTabs.length){var e=(0,i.default)("<div>").addClass(T).appendTo(t);this._hasTabPanel()?this._renderTabPanel(e):this._renderTabContent(e,this._commandTabs[0],0,!0)}}},{key:"_hasTabPanel",value:function(){return this._commandTabs.length>1}},{key:"_renderTabPanel",value:function(t){var e=this,n=(0,i.default)("<div>").appendTo(t);this._tabPanel=this._createComponent(n,s.default,{focusStateEnabled:!1,dataSource:this._commandTabs,itemTemplate:function(t,n,o){e._renderTabContent(o,t,n)},onSelectionChanged:function(t){e._onSelectedGroupChangedAction(),e._onPointerUpAction()},onContentReady:function(t){e._popup.option("height",t.component.$element().height()+e._getVerticalPaddingsAndBorders()),e._firstScrollView&&(e._scrollViewHeight=e._firstScrollView.$element().outerHeight(),e._firstScrollView.option("height",e._scrollViewHeight))}})}},{key:"_renderTabContent",value:function(t,e,n,o){var r=(0,i.default)("<div>").appendTo(t),s=this._createComponent(r,a.default,{height:this._scrollViewHeight});this._renderTabInnerContent(s.content(),e,n),o?this._popup.option("height",s.$element().height()+this._getVerticalPaddingsAndBorders()):this._firstScrollView=this._firstScrollView||s}},{key:"_renderTabInnerContent",value:function(t,e,n){var o=this;e.groups?e.groups.forEach((function(e,i){o._renderTabGroupContent(t,n,e.title,e.commands)})):e.commands&&this._renderTabGroupContent(t,n,void 0,e.commands)}},{key:"_renderTabGroupContent",value:function(t,e,n,o){n&&(0,i.default)("<div>").addClass(O).appendTo(t).text(n);var r=(0,i.default)("<div>").addClass(E).appendTo(t),a={$parent:r,commands:o};this._onCreateToolbarAction(a),this._toolbars[e]||(this._toolbars[e]=[]),this._toolbars[e].push(a.toolbar),this._selectedToolbar=a.toolbar}},{key:"getActiveToolbars",value:function(){var t=this._tabPanel?this._tabPanel.option("selectedIndex"):0;return this._toolbars[t]}},{key:"_createOnCreateToolbar",value:function(){this._onCreateToolbarAction=this._createActionByOption("onCreateToolbar")}},{key:"_createOnSelectedGroupChanged",value:function(){this._onSelectedGroupChangedAction=this._createActionByOption("onSelectedGroupChanged")}},{key:"_optionChanged",value:function(t){switch(t.name){case"onCreateToolbar":this._createOnCreateToolbar();break;case"onSelectedGroupChanged":this._createOnSelectedGroupChanged();break;case"propertyTabs":this._invalidate();break;default:f(S(n.prototype),"_optionChanged",this).call(this,t)}}}]),n}(c.default),D=M;e.default=D,t.exports=e.default},"0c7d":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=a(n("cc6a")),r=a(n("6571"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function l(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t){var e=m();return function(){var n,o=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var y=function(t){l(n,t);var e=h(n);function n(){return s(this,n),e.apply(this,arguments)}return u(n,[{key:"_getCommands",value:function(){return r.default.getHistoryToolbarCommands(this.option("commands"),this._getExcludeCommands())}},{key:"_getExcludeCommands",value:function(){var t=[].concat(this.option("excludeCommands"));return this.option("isMobileView")||t.push(r.default.SHOW_TOOLBOX_COMMAND_NAME),t}}]),n}(i.default),v=y;e.default=v,t.exports=e.default},1301:function(t,e,n){"use strict";e.default=void 0;var o=c(n("14a3")),i=c(n("90d1")),r=n("d4b2"),a=n("b62d"),s=c(n("0fa5"));function c(t){return t&&t.__esModule?t:{default:t}}var u="dx-progressbar",l="dx-progressbar-container",p="dx-progressbar-range-container",h="dx-progressbar-range",d="dx-progressbar-wrapper",f="dx-progressbar-status",m="dx-progressbar-animating-container",g="dx-progressbar-animating-segment",y=i.default.inherit({_getDefaultOptions:function(){return(0,r.extend)(this.callBase(),{value:0,statusFormat:function(t){return"Progress: "+Math.round(100*t)+"%"},showStatus:!0,onComplete:null,activeStateEnabled:!1,statusPosition:"bottom left",_animatingSegmentCount:0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(t){return"android"===t.platform},options:{_animatingSegmentCount:2}}])},_initMarkup:function(){this._renderStatus(),this._createCompleteAction(),this.callBase(),this.$element().addClass(u),this._$wrapper.addClass(d),this._$bar.addClass(l),this.setAria("role","progressbar"),(0,o.default)("<div>").addClass(p).appendTo(this._$wrapper).append(this._$bar),this._$range.addClass(h),this._toggleStatus(this.option("showStatus"))},_createCompleteAction:function(){this._completeAction=this._createActionByOption("onComplete")},_renderStatus:function(){this._$status=(0,o.default)("<div>").addClass(f)},_renderIndeterminateState:function(){this._$segmentContainer=(0,o.default)("<div>").addClass(m);for(var t=this.option("_animatingSegmentCount"),e=0;e<t;e++)(0,o.default)("<div>").addClass(g).addClass(g+"-"+(e+1)).appendTo(this._$segmentContainer);this._$segmentContainer.appendTo(this._$wrapper)},_toggleStatus:function(t){var e=this.option("statusPosition").split(" ");t?"top"===e[0]||"left"===e[0]?this._$status.prependTo(this._$wrapper):this._$status.appendTo(this._$wrapper):this._$status.detach(),this._togglePositionClass()},_togglePositionClass:function(){var t=this.option("statusPosition"),e=t.split(" ");this._$wrapper.removeClass("dx-position-top-left dx-position-top-right dx-position-bottom-left dx-position-bottom-right dx-position-left dx-position-right");var n="dx-position-"+e[0];e[1]&&(n+="-"+e[1]),this._$wrapper.addClass(n)},_toggleIndeterminateState:function(t){t?(this._renderIndeterminateState(),this._$bar.toggle(!1)):(this._$bar.toggle(!0),this._$segmentContainer.remove(),delete this._$segmentContainer)},_renderValue:function(){var t=this.option("value"),e=this.option("max");t||0===t?(this._$segmentContainer&&this._toggleIndeterminateState(!1),t===e&&this._completeAction(),this.callBase(),this._setStatus()):this._toggleIndeterminateState(!0)},_setStatus:function(){var t=this.option("statusFormat");t=(0,a.isFunction)(t)?t.bind(this):function(t){return t};var e=t(this._currentRatio,this.option("value"));this._$status.text(e)},_dispose:function(){this._$status.remove(),this.callBase()},_optionChanged:function(t){switch(t.name){case"statusFormat":this._setStatus();break;case"showStatus":this._toggleStatus(t.value);break;case"statusPosition":this._toggleStatus(this.option("showStatus"));break;case"onComplete":this._createCompleteAction();break;case"_animatingSegmentCount":break;default:this.callBase(t)}}});(0,s.default)("dxProgressBar",y);var v=y;e.default=v,t.exports=e.default,t.exports.default=t.exports},1908:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=w(n("14a3")),r=w(n("d28b0")),a=n("706b"),s=w(n("8de2")),c=w(n("0fa5")),u=w(n("718c")),l=n("b62d"),p=n("ce5d"),h=n("d4b2"),d=n("5e98"),f=n("b49b"),m=w(n("06a3")),g=w(n("2dc8")),y=w(n("5cf5")),v=w(n("1301")),C=w(n("b876")),_=w(n("2dd1")),P=n("1820"),S=n("5c27"),b=w(n("8a64")),x=n("fbaa");function w(t){return t&&t.__esModule?t:{default:t}}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function O(t,e,n){return e&&T(t.prototype,e),n&&T(t,n),t}function E(t,e,n){return E="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=M(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},E(t,e,n||t)}function M(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=N(t),null===t)break;return t}function D(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}function A(t,e){return A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},A(t,e)}function k(t){var e=z();return function(){var n,o=N(t);if(e){var i=N(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return L(this,n)}}function L(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?R(t):e}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function N(t){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},N(t)}var j=(0,a.getWindow)(),U="dx-fileuploader",B="dx-fileuploader-empty",H="dx-fileuploader-show-file-list",V="dx-fileuploader-dragover",F="dx-fileuploader-wrapper",K="dx-fileuploader-container",W="dx-fileuploader-content",G="dx-fileuploader-input-wrapper",Z="dx-fileuploader-input-container",q="dx-fileuploader-input-label",$="dx-fileuploader-input",X="dx-fileuploader-files-container",Y="dx-fileuploader-file-container",J="dx-fileuploader-file-info",Q="dx-fileuploader-file-status-message",tt="dx-fileuploader-file",et="dx-fileuploader-file-name",nt="dx-fileuploader-file-size",ot="dx-fileuploader-button",it="dx-fileuploader-button-container",rt="dx-fileuploader-cancel-button",at="dx-fileuploader-upload-button",st="dx-fileuploader-invalid",ct=400,ut="chunkMetadata",lt=function(){return(0,i.default)("<input>").attr("type","file")},pt=function(){return!!j.FormData},ht=function(t){D(n,t);var e=k(n);function n(){return I(this,n),e.apply(this,arguments)}return O(n,[{key:"_supportedKeys",value:function(){var t=this,e=function(e){e.preventDefault();var n=t._selectButton.$element();s.default.trigger(n,S.name)};return(0,h.extend)(E(N(n.prototype),"_supportedKeys",this).call(this),{space:e,enter:e})}},{key:"_setOptionsByReference",value:function(){E(N(n.prototype),"_setOptionsByReference",this).call(this),(0,h.extend)(this._optionsByReference,{value:!0})}},{key:"_getDefaultOptions",value:function(){return(0,h.extend)(E(N(n.prototype),"_getDefaultOptions",this).call(this),{chunkSize:0,value:[],selectButtonText:b.default.format("dxFileUploader-selectFile"),uploadButtonText:b.default.format("dxFileUploader-upload"),labelText:b.default.format("dxFileUploader-dropFile"),name:"files[]",multiple:!1,accept:"",uploadUrl:"/",allowCanceling:!0,showFileList:!0,progress:0,dialogTrigger:void 0,dropZone:void 0,readyToUploadMessage:b.default.format("dxFileUploader-readyToUpload"),uploadedMessage:b.default.format("dxFileUploader-uploaded"),uploadFailedMessage:b.default.format("dxFileUploader-uploadFailedMessage"),uploadAbortedMessage:b.default.format("dxFileUploader-uploadAbortedMessage"),uploadMode:"instantly",uploadMethod:"POST",uploadHeaders:{},uploadCustomData:{},onBeforeSend:null,onUploadStarted:null,onUploaded:null,onFilesUploaded:null,onProgress:null,onUploadError:null,onUploadAborted:null,onDropZoneEnter:null,onDropZoneLeave:null,allowedFileExtensions:[],maxFileSize:0,minFileSize:0,inputAttr:{},invalidFileExtensionMessage:b.default.format("dxFileUploader-invalidFileExtension"),invalidMaxFileSizeMessage:b.default.format("dxFileUploader-invalidMaxFileSize"),invalidMinFileSizeMessage:b.default.format("dxFileUploader-invalidMinFileSize"),extendSelection:!0,validationMessageMode:"always",uploadFile:null,uploadChunk:null,abortUpload:null,validationMessageOffset:{h:0,v:0},useNativeInputClick:!1,useDragOver:!0,nativeDropSupported:!0,_uploadButtonType:"normal"})}},{key:"_defaultOptionsRules",value:function(){return E(N(n.prototype),"_defaultOptionsRules",this).call(this).concat([{device:function(){return"desktop"===_.default.real().deviceType&&!_.default.isSimulator()},options:{focusStateEnabled:!0}},{device:[{platform:"android"}],options:{validationMessageOffset:{v:0}}},{device:function(){return"desktop"!==_.default.real().deviceType},options:{useDragOver:!1}},{device:function(){return!pt()},options:{uploadMode:"useForm"}},{device:function(){return C.default.msie||"desktop"!==_.default.real().deviceType},options:{nativeDropSupported:!1}},{device:function(){return(0,x.isMaterial)()},options:{_uploadButtonType:"default"}}])}},{key:"_initOptions",value:function(t){var e="labelText"in t;E(N(n.prototype),"_initOptions",this).call(this,t),e||this._shouldDragOverBeRendered()||this.option("labelText","")}},{key:"_init",value:function(){E(N(n.prototype),"_init",this).call(this),this._initFileInput(),this._initLabel(),this._setUploadStrategy(),this._createFiles(),this._createBeforeSendAction(),this._createUploadStartedAction(),this._createUploadedAction(),this._createFilesUploadedAction(),this._createProgressAction(),this._createUploadErrorAction(),this._createUploadAbortedAction(),this._createDropZoneEnterAction(),this._createDropZoneLeaveAction()}},{key:"_setUploadStrategy",value:function(){var t=null;if(this.option("chunkSize")>0){var e=this.option("uploadChunk");t=e&&(0,l.isFunction)(e)?new yt(this):new gt(this)}else{var n=this.option("uploadFile");t=n&&(0,l.isFunction)(n)?new _t(this):new Ct(this)}this._uploadStrategy=t}},{key:"_initFileInput",value:function(){var t=this;this._isCustomClickEvent=!1,this._$fileInput||(this._$fileInput=lt(),s.default.on(this._$fileInput,"change",this._inputChangeHandler.bind(this)),s.default.on(this._$fileInput,"click",(function(e){return e.stopPropagation(),t.option("useNativeInputClick")||t._isCustomClickEvent}))),this._$fileInput.prop({multiple:this.option("multiple"),accept:this.option("accept"),tabIndex:-1})}},{key:"_inputChangeHandler",value:function(){if(!this._doPreventInputChange){var t=this._$fileInput.val().replace(/^.*\\/,""),e=this._$fileInput.prop("files");if(!e||e.length||"useForm"===this.option("uploadMode")){var n=e?this._getFiles(e):[{name:t}];this._changeValue(n),"instantly"===this.option("uploadMode")&&this._uploadFiles()}}}},{key:"_shouldFileListBeExtended",value:function(){return"useForm"!==this.option("uploadMode")&&this.option("extendSelection")&&this.option("multiple")}},{key:"_removeDuplicates",value:function(t,e){for(var n=[],o=0;o<e.length;o++)this._isFileInArray(t,e[o])||n.push(e[o]);return n}},{key:"_isFileInArray",value:function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.size===e.size&&o.name===e.name)return!0}return!1}},{key:"_changeValue",value:function(t){var e=this._shouldFileListBeExtended()?this.option("value").slice():[];"instantly"!==this.option("uploadMode")&&(t=this._removeDuplicates(e,t)),this.option("value",e.concat(t))}},{key:"_getFiles",value:function(t){var e=[];return(0,p.each)(t,(function(t,n){return e.push(n)})),e}},{key:"_getFile",value:function(t){var e=(0,l.isNumeric)(t)?this.option("value")[t]:t;return this._files.filter((function(t){return t.value===e}))[0]}},{key:"_initLabel",value:function(){this._$inputLabel||(this._$inputLabel=(0,i.default)("<div>")),this._updateInputLabelText()}},{key:"_updateInputLabelText",value:function(){var t=this._isInteractionDisabled()?"":this.option("labelText");this._$inputLabel.text(t)}},{key:"_focusTarget",value:function(){return this.$element().find("."+ot)}},{key:"_getSubmitElement",value:function(){return this._$fileInput}},{key:"_initMarkup",value:function(){E(N(n.prototype),"_initMarkup",this).call(this),this.$element().addClass(U),this._renderWrapper(),this._renderInputWrapper(),this._renderSelectButton(),this._renderInputContainer(),this._renderUploadButton(),this._preventRecreatingFiles=!0}},{key:"_render",value:function(){this._preventRecreatingFiles=!1,this._attachDragEventHandlers(this._$inputWrapper),this._attachDragEventHandlers(this.option("dropZone")),this._renderFiles(),E(N(n.prototype),"_render",this).call(this)}},{key:"_createFileProgressBar",value:function(t){t.progressBar=this._createProgressBar(t.value.size),t.progressBar.$element().appendTo(t.$file),this._initStatusMessage(t),this._ensureCancelButtonInitialized(t)}},{key:"_setStatusMessage",value:function(t,e){var n=this;setTimeout((function(){n.option("showFileList")&&t.$statusMessage&&(t.$statusMessage.text(e),t.$statusMessage.css("display",""),t.progressBar.$element().remove())}),ct)}},{key:"_getUploadAbortedStatusMessage",value:function(){return"instantly"===this.option("uploadMode")?this.option("uploadAbortedMessage"):this.option("readyToUploadMessage")}},{key:"_createFiles",value:function(){var t=this,e=this.option("value");!this._files||0!==e.length&&this._shouldFileListBeExtended()||(this._preventFilesUploading(this._files),this._files=null),this._files||(this._files=[]),(0,p.each)(e.slice(this._files.length),(function(e,n){var o=t._createFile(n);t._validateFile(o),t._files.push(o)}))}},{key:"_preventFilesUploading",value:function(t){var e=this;t.forEach((function(t){return e._uploadStrategy.abortUpload(t)}))}},{key:"_validateFile",value:function(t){t.isValidFileExtension=this._validateFileExtension(t),t.isValidMinSize=this._validateMinFileSize(t),t.isValidMaxSize=this._validateMaxFileSize(t)}},{key:"_validateFileExtension",value:function(t){var e=this.option("allowedFileExtensions"),n=t.value.name.substring(t.value.name.lastIndexOf(".")).toLowerCase();if(0===e.length)return!0;for(var o=0;o<e.length;o++)if(n===e[o].toLowerCase())return!0;return!1}},{key:"_validateMaxFileSize",value:function(t){var e=t.value.size,n=this.option("maxFileSize");return!(n>0)||e<=n}},{key:"_validateMinFileSize",value:function(t){var e=t.value.size,n=this.option("minFileSize");return!(n>0)||e>=n}},{key:"_createBeforeSendAction",value:function(){this._beforeSendAction=this._createActionByOption("onBeforeSend",{excludeValidators:["readOnly"]})}},{key:"_createUploadStartedAction",value:function(){this._uploadStartedAction=this._createActionByOption("onUploadStarted",{excludeValidators:["readOnly"]})}},{key:"_createUploadedAction",value:function(){this._uploadedAction=this._createActionByOption("onUploaded",{excludeValidators:["readOnly"]})}},{key:"_createFilesUploadedAction",value:function(){this._filesUploadedAction=this._createActionByOption("onFilesUploaded",{excludeValidators:["readOnly"]})}},{key:"_createProgressAction",value:function(){this._progressAction=this._createActionByOption("onProgress",{excludeValidators:["readOnly"]})}},{key:"_createUploadAbortedAction",value:function(){this._uploadAbortedAction=this._createActionByOption("onUploadAborted",{excludeValidators:["readOnly"]})}},{key:"_createUploadErrorAction",value:function(){this._uploadErrorAction=this._createActionByOption("onUploadError",{excludeValidators:["readOnly"]})}},{key:"_createDropZoneEnterAction",value:function(){this._dropZoneEnterAction=this._createActionByOption("onDropZoneEnter")}},{key:"_createDropZoneLeaveAction",value:function(){this._dropZoneLeaveAction=this._createActionByOption("onDropZoneLeave")}},{key:"_createFile",value:function(t){return{value:t,loadedSize:0,onProgress:(0,u.default)(),onAbort:(0,u.default)(),onLoad:(0,u.default)(),onError:(0,u.default)(),onLoadStart:(0,u.default)(),isValidFileExtension:!0,isValidMaxSize:!0,isValidMinSize:!0,isValid:function(){return this.isValidFileExtension&&this.isValidMaxSize&&this.isValidMinSize},isInitialized:!1}}},{key:"_resetFileState",value:function(t){t.isAborted=!1,t.uploadStarted=!1,t.isStartLoad=!1,t.loadedSize=0,t.chunksData=void 0,t.request=void 0}},{key:"_renderFiles",value:function(){var t,e=this,n=this.option("value");this._$filesContainer?this._shouldFileListBeExtended()&&0!==n.length||this._$filesContainer.empty():this._$filesContainer=(0,i.default)("<div>").addClass(X).appendTo(this._$content);var o=this.option("showFileList");o&&(0,p.each)(this._files,(function(t,n){n.$file||e._renderFile(n)})),this.$element().toggleClass(H,o),this._toggleFileUploaderEmptyClassName(),this._updateFileNameMaxWidth(),null===(t=this._validationMessage)||void 0===t||t.repaint()}},{key:"_renderFile",value:function(t){var e=t.value,n=(0,i.default)("<div>").addClass(Y).appendTo(this._$filesContainer);this._renderFileButtons(t,n),t.$file=(0,i.default)("<div>").addClass(tt).appendTo(n);var o=(0,i.default)("<div>").addClass(J).appendTo(t.$file);t.$statusMessage=(0,i.default)("<div>").addClass(Q).appendTo(t.$file),(0,i.default)("<div>").addClass(et).text(e.name).appendTo(o),(0,l.isDefined)(e.size)&&(0,i.default)("<div>").addClass(nt).text(this._getFileSize(e.size)).appendTo(o),t.isValid()?t.$statusMessage.text(this.option("readyToUploadMessage")):(t.isValidFileExtension||t.$statusMessage.append(this._createValidationElement("invalidFileExtensionMessage")),t.isValidMaxSize||t.$statusMessage.append(this._createValidationElement("invalidMaxFileSizeMessage")),t.isValidMinSize||t.$statusMessage.append(this._createValidationElement("invalidMinFileSizeMessage")),n.addClass(st))}},{key:"_createValidationElement",value:function(t){return(0,i.default)("<span>").text(this.option(t))}},{key:"_updateFileNameMaxWidth",value:function(){var t=this.option("allowCanceling")&&"useForm"!==this.option("uploadMode")?1:0,e="useButtons"===this.option("uploadMode")?1:0,n=this._$filesContainer.find("."+Y).first().width()||this._$filesContainer.width(),o=this._$filesContainer.find("."+it).eq(0),i=o.width()*(t+e),r=this._$filesContainer.find("."+nt).eq(0),a=r.text();r.text("1000 Mb");var s=r.width();r.text(a),this._$filesContainer.find("."+et).css("maxWidth",n-i-s)}},{key:"_renderFileButtons",value:function(t,e){var n=this._getCancelButton(t);n&&e.append(n);var o=this._getUploadButton(t);o&&e.append(o)}},{key:"_getCancelButton",value:function(t){var e=this;return"useForm"===this.option("uploadMode")?null:(t.cancelButton=this._createComponent((0,i.default)("<div>").addClass(ot+" "+rt),y.default,{onClick:function(){return e._removeFile(t)},icon:"close",visible:this.option("allowCanceling"),disabled:this.option("readOnly"),integrationOptions:{}}),(0,i.default)("<div>").addClass(it).append(t.cancelButton.$element()))}},{key:"_getUploadButton",value:function(t){var e=this;return t.isValid()&&"useButtons"===this.option("uploadMode")?(t.uploadButton=this._createComponent((0,i.default)("<div>").addClass(ot+" "+at),y.default,{onClick:function(){return e._uploadFile(t)},icon:"upload"}),t.onLoadStart.add((function(){return t.uploadButton.option({visible:!1,disabled:!0})})),t.onAbort.add((function(){return t.uploadButton.option({visible:!0,disabled:!1})})),(0,i.default)("<div>").addClass(it).append(t.uploadButton.$element())):null}},{key:"_removeFile",value:function(t){var e;null===(e=t.$file)||void 0===e||e.parent().remove(),this._files.splice((0,d.inArray)(t,this._files),1);var n=this.option("value").slice();n.splice((0,d.inArray)(t.value,n),1),this._preventRecreatingFiles=!0,this.option("value",n),this._preventRecreatingFiles=!1,this._toggleFileUploaderEmptyClassName(),this._doPreventInputChange=!0,this._$fileInput.val(""),this._doPreventInputChange=!1}},{key:"removeFile",value:function(t){if("useForm"!==this.option("uploadMode")&&(0,l.isDefined)(t)){var e=this._getFile(t);e&&(e.uploadStarted&&this._preventFilesUploading([e]),this._removeFile(e))}}},{key:"_toggleFileUploaderEmptyClassName",value:function(){this.$element().toggleClass(B,!this._files.length||this._hasInvalidFile(this._files))}},{key:"_hasInvalidFile",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isValid())return!0;return!1}},{key:"_getFileSize",value:function(t){var e=0,n=[b.default.format("dxFileUploader-bytes"),b.default.format("dxFileUploader-kb"),b.default.format("dxFileUploader-Mb"),b.default.format("dxFileUploader-Gb")],o=n.length-1;while(e<o&&t>=1024)t/=1024,e++;return Math.round(t)+" "+n[e]}},{key:"_renderSelectButton",value:function(){var t=(0,i.default)("<div>").addClass(ot).appendTo(this._$inputWrapper);this._selectButton=this._createComponent(t,y.default,{text:this.option("selectButtonText"),focusStateEnabled:!1,integrationOptions:{},disabled:this.option("readOnly")}),this._selectFileDialogHandler=this._selectButtonClickHandler.bind(this),"desktop"===_.default.real().deviceType?this._selectButton.option("onClick",this._selectFileDialogHandler):this._attachSelectFileDialogHandler(this._selectButton.$element()),this._attachSelectFileDialogHandler(this.option("dialogTrigger"))}},{key:"_selectButtonClickHandler",value:function(){if(!this.option("useNativeInputClick")){if(this._isInteractionDisabled())return!1;this._isCustomClickEvent=!0,s.default.trigger(this._$fileInput,"click"),this._isCustomClickEvent=!1}}},{key:"_attachSelectFileDialogHandler",value:function(t){(0,l.isDefined)(t)&&(this._detachSelectFileDialogHandler(t),s.default.on((0,i.default)(t),"click",this._selectFileDialogHandler))}},{key:"_detachSelectFileDialogHandler",value:function(t){(0,l.isDefined)(t)&&s.default.off((0,i.default)(t),"click",this._selectFileDialogHandler)}},{key:"_renderUploadButton",value:function(){if("useButtons"===this.option("uploadMode")){var t=(0,i.default)("<div>").addClass(ot).addClass(at).appendTo(this._$content);this._uploadButton=this._createComponent(t,y.default,{text:this.option("uploadButtonText"),onClick:this._uploadButtonClickHandler.bind(this),type:this.option("_uploadButtonType"),integrationOptions:{}})}}},{key:"_uploadButtonClickHandler",value:function(){this._uploadFiles()}},{key:"_shouldDragOverBeRendered",value:function(){return!this.option("readOnly")&&("useForm"!==this.option("uploadMode")||this.option("nativeDropSupported"))}},{key:"_isInteractionDisabled",value:function(){return this.option("readOnly")||this.option("disabled")}},{key:"_renderInputContainer",value:function(){this._$inputContainer=(0,i.default)("<div>").addClass(Z).appendTo(this._$inputWrapper),this._$fileInput.addClass($),this._renderInput();var t="dx-fileuploader-input-label-".concat(new r.default);this._$inputLabel.attr("id",t).addClass(q).appendTo(this._$inputContainer),this.setAria("labelledby",t,this._$fileInput)}},{key:"_renderInput",value:function(){this.option("useNativeInputClick")?this._selectButton.option("template",this._selectButtonInputTemplate.bind(this)):(this._$fileInput.appendTo(this._$inputContainer),this._selectButton.option("template","content")),this._applyInputAttributes(this.option("inputAttr"))}},{key:"_selectButtonInputTemplate",value:function(t,e){var n=(0,i.default)(e),o=(0,i.default)("<span>").addClass("dx-button-text").text(t.text);return n.append(o).append(this._$fileInput),n}},{key:"_renderInputWrapper",value:function(){this._$inputWrapper=(0,i.default)("<div>").addClass(G).appendTo(this._$content)}},{key:"_detachDragEventHandlers",value:function(t){(0,l.isDefined)(t)&&s.default.off((0,i.default)(t),(0,P.addNamespace)("",this.NAME))}},{key:"_attachDragEventHandlers",value:function(t){var e=t!==this._$inputWrapper;(0,l.isDefined)(t)&&this._shouldDragOverBeRendered()&&(this._detachDragEventHandlers(t),t=(0,i.default)(t),this._dragEventsTargets=[],s.default.on(t,(0,P.addNamespace)("dragenter",this.NAME),this._dragEnterHandler.bind(this,e)),s.default.on(t,(0,P.addNamespace)("dragover",this.NAME),this._dragOverHandler.bind(this)),s.default.on(t,(0,P.addNamespace)("dragleave",this.NAME),this._dragLeaveHandler.bind(this,e)),s.default.on(t,(0,P.addNamespace)("drop",this.NAME),this._dropHandler.bind(this,e)))}},{key:"_applyInputAttributes",value:function(t){this._$fileInput.attr(t)}},{key:"_useInputForDrop",value:function(){return this.option("nativeDropSupported")&&"useForm"===this.option("uploadMode")}},{key:"_dragEnterHandler",value:function(t,e){if(this.option("disabled"))return!1;this._useInputForDrop()||e.preventDefault(),this._tryToggleDropZoneActive(!0,t,e),this._updateEventTargets(e)}},{key:"_dragOverHandler",value:function(t){this._useInputForDrop()||t.preventDefault(),t.originalEvent.dataTransfer.dropEffect="copy"}},{key:"_dragLeaveHandler",value:function(t,e){this._useInputForDrop()||e.preventDefault(),this._updateEventTargets(e),this._tryToggleDropZoneActive(!1,t,e)}},{key:"_updateEventTargets",value:function(t){var e=this._dragEventsTargets.indexOf(t.target),n=-1!==e;"dragenter"===t.type?!n&&this._dragEventsTargets.push(t.target):n&&this._dragEventsTargets.splice(e,1)}},{key:"_tryToggleDropZoneActive",value:function(t,e,n){var o=t?"addClass":"removeClass",i=t?"_dropZoneEnterAction":"_dropZoneLeaveAction";this._dragEventsTargets.length||(this[i]({event:n,dropZoneElement:n.currentTarget}),e||this.$element()[o](V))}},{key:"_dropHandler",value:function(t,e){if(this._dragEventsTargets=[],t||this.$element().removeClass(V),!(this._useInputForDrop()||t&&this._isInteractionDisabled())){e.preventDefault();var n=e.originalEvent.dataTransfer.files,o=this._getFiles(n);!this.option("multiple")&&o.length>1||(this._changeValue(this._filterFiles(o)),"instantly"===this.option("uploadMode")&&this._uploadFiles())}}},{key:"_handleAllFilesUploaded",value:function(){var t=this._files.every((function(t){return!t.isValid()||t._isError||t._isLoaded||t.isAborted}));t&&this._filesUploadedAction()}},{key:"_filterFiles",value:function(t){if(!t.length)return t;var e=this.option("accept");if(!e.length)return t;for(var n=[],o=this._getAllowedFileTypes(e),i=0,r=t.length;i<r;i++)this._isFileTypeAllowed(t[i],o)&&n.push(t[i]);return n}},{key:"_getAllowedFileTypes",value:function(t){return t.length?t.split(",").map((function(t){return t.trim()})):[]}},{key:"_isFileTypeAllowed",value:function(t,e){for(var n=0,o=e.length;n<o;n++){var i=e[n];if("."===i[0]){if(i=i.replace(".","\\."),t.name.match(new RegExp(i+"$","i")))return!0}else if(i=i.replace("*",""),t.type.match(new RegExp(i,"i")))return!0}return!1}},{key:"_renderWrapper",value:function(){var t=(0,i.default)("<div>").addClass(F).appendTo(this.$element()),e=(0,i.default)("<div>").addClass(K).appendTo(t);this._$content=(0,i.default)("<div>").addClass(W).appendTo(e)}},{key:"_clean",value:function(){this._$fileInput.detach(),delete this._$filesContainer,this._files&&this._files.forEach((function(t){t.$file=null,t.$statusMessage=null})),E(N(n.prototype),"_clean",this).call(this)}},{key:"abortUpload",value:function(t){if("useForm"!==this.option("uploadMode"))if((0,l.isDefined)(t)){var e=this._getFile(t);e&&this._preventFilesUploading([e])}else this._preventFilesUploading(this._files)}},{key:"upload",value:function(t){if("useForm"!==this.option("uploadMode"))if((0,l.isDefined)(t)){var e=this._getFile(t);e&&pt()&&this._uploadFile(e)}else this._uploadFiles()}},{key:"_uploadFiles",value:function(){var t=this;pt()&&(0,p.each)(this._files,(function(e,n){return t._uploadFile(n)}))}},{key:"_uploadFile",value:function(t){this._uploadStrategy.upload(t)}},{key:"_updateProgressBar",value:function(t,e){t.progressBar&&t.progressBar.option({value:e.loaded,showStatus:!0}),this._progressAction({file:t.value,segmentSize:e.currentSegmentSize,bytesLoaded:e.loaded,bytesTotal:e.total,event:e.event,request:t.request})}},{key:"_updateTotalProgress",value:function(t,e){var n=t?this._getProgressValue(e/t):0;this.option("progress",n),this._setLoadedSize(e)}},{key:"_getProgressValue",value:function(t){return Math.floor(100*t)}},{key:"_initStatusMessage",value:function(t){t.$statusMessage.css("display","none")}},{key:"_ensureCancelButtonInitialized",value:function(t){var e=this;if(!t.isInitialized){t.cancelButton.option("onClick",(function(){e._preventFilesUploading([t]),e._removeFile(t)}));var n=function(){setTimeout((function(){t.cancelButton.option({visible:!1})}),ct)};t.onLoad.add(n),t.onError.add(n)}}},{key:"_createProgressBar",value:function(t){var e=this;return this._createComponent((0,i.default)("<div>"),v.default,{value:void 0,min:0,max:t,statusFormat:function(t){return e._getProgressValue(t)+"%"},showStatus:!1,statusPosition:"right"})}},{key:"_getTotalFilesSize",value:function(){var t=this;return this._totalFilesSize||(this._totalFilesSize=0,(0,p.each)(this._files,(function(e,n){t._totalFilesSize+=n.value.size}))),this._totalFilesSize}},{key:"_getTotalLoadedFilesSize",value:function(){var t=this;return this._totalLoadedFilesSize||(this._totalLoadedFilesSize=0,(0,p.each)(this._files,(function(e,n){t._totalLoadedFilesSize+=n.loadedSize}))),this._totalLoadedFilesSize}},{key:"_setLoadedSize",value:function(t){this._totalLoadedFilesSize=t}},{key:"_recalculateProgress",value:function(){this._totalFilesSize=0,this._totalLoadedFilesSize=0,this._updateTotalProgress(this._getTotalFilesSize(),this._getTotalLoadedFilesSize())}},{key:"_updateReadOnlyState",value:function(){var t=this.option("readOnly");this._selectButton.option("disabled",t),this._files.forEach((function(e){var n;return null===(n=e.cancelButton)||void 0===n?void 0:n.option("disabled",t)})),this._updateInputLabelText(),this._attachDragEventHandlers(this._$inputWrapper)}},{key:"_optionChanged",value:function(t){var e=t.name,o=t.value,i=t.previousValue;switch(e){case"height":case"width":this._updateFileNameMaxWidth(),E(N(n.prototype),"_optionChanged",this).call(this,t);break;case"value":!o.length&&this._$fileInput.val(""),this._preventRecreatingFiles||(this._createFiles(),this._renderFiles()),this._recalculateProgress(),E(N(n.prototype),"_optionChanged",this).call(this,t);break;case"name":this._initFileInput(),E(N(n.prototype),"_optionChanged",this).call(this,t);break;case"accept":this._initFileInput();break;case"multiple":this._initFileInput(),t.value||this.reset();break;case"readOnly":this._updateReadOnlyState(),E(N(n.prototype),"_optionChanged",this).call(this,t);break;case"selectButtonText":this._selectButton.option("text",o);break;case"uploadButtonText":this._uploadButton&&this._uploadButton.option("text",o);break;case"_uploadButtonType":this._uploadButton&&this._uploadButton.option("type",o);break;case"dialogTrigger":this._detachSelectFileDialogHandler(i),this._attachSelectFileDialogHandler(o);break;case"dropZone":this._detachDragEventHandlers(i),this._attachDragEventHandlers(o);break;case"maxFileSize":case"minFileSize":case"allowedFileExtensions":case"invalidFileExtensionMessage":case"invalidMaxFileSizeMessage":case"invalidMinFileSizeMessage":case"readyToUploadMessage":case"uploadedMessage":case"uploadFailedMessage":case"uploadAbortedMessage":this._invalidate();break;case"labelText":this._updateInputLabelText();break;case"showFileList":this._preventRecreatingFiles||this._renderFiles();break;case"uploadFile":case"uploadChunk":case"chunkSize":this._setUploadStrategy();break;case"abortUpload":case"uploadUrl":case"progress":case"uploadMethod":case"uploadHeaders":case"uploadCustomData":case"extendSelection":break;case"allowCanceling":case"uploadMode":this.reset(),this._invalidate();break;case"onBeforeSend":this._createBeforeSendAction();break;case"onUploadStarted":this._createUploadStartedAction();break;case"onUploaded":this._createUploadedAction();break;case"onFilesUploaded":this._createFilesUploadedAction();break;case"onProgress":this._createProgressAction();break;case"onUploadError":this._createUploadErrorAction();break;case"onUploadAborted":this._createUploadAbortedAction();break;case"onDropZoneEnter":this._createDropZoneEnterAction();break;case"onDropZoneLeave":this._createDropZoneLeaveAction();break;case"useNativeInputClick":this._renderInput();break;case"useDragOver":this._attachDragEventHandlers(this._$inputWrapper);break;case"nativeDropSupported":this._invalidate();break;case"inputAttr":this._applyInputAttributes(this.option(e));break;default:E(N(n.prototype),"_optionChanged",this).call(this,t)}}},{key:"reset",value:function(){this.option("value",[])}}]),n}(g.default),dt=function(){function t(e,n){I(this,t),this.file=e,this.chunkSize=n,this.index=0}return O(t,[{key:"read",value:function(){if(!this.file)return null;var t=this.createBlobResult(this.file,this.index,this.chunkSize);return t.isCompleted&&(this.file=null),this.index++,t}},{key:"createBlobResult",value:function(t,e,n){var o=e*n;return{blob:this.sliceFile(t,o,n),index:e,isCompleted:o+n>=t.size}}},{key:"sliceFile",value:function(t,e,n){return t.slice?t.slice(e,e+n):t.webkitSlice?t.webkitSlice(e,e+n):null}}]),t}(),ft=function(){function t(e){I(this,t),this.fileUploader=e}return O(t,[{key:"upload",value:function(t){t.isInitialized&&t.isAborted&&this.fileUploader._resetFileState(t),t.isValid()&&!t.uploadStarted&&(this._prepareFileBeforeUpload(t),this._uploadCore(t))}},{key:"abortUpload",value:function(t){var e=this;if(!(t._isError||t._isLoaded||t.isAborted)&&(t.isAborted=!0,t.request&&t.request.abort(),this._isCustomCallback("abortUpload"))){var n=this.fileUploader.option("abortUpload"),o=this._createUploadArgument(t),i=null;try{var r=n(t.value,o);i=(0,f.fromPromise)(r)}catch(a){i=(new f.Deferred).reject(a).promise()}i.done((function(){return t.onAbort.fire()})).fail((function(n){return e._handleFileError(t,n)}))}}},{key:"_beforeSend",value:function(t,e){var n=this._createUploadArgument(e);this.fileUploader._beforeSendAction({request:t,file:e.value,uploadInfo:n}),e.request=t}},{key:"_createUploadArgument",value:function(t){}},{key:"_uploadCore",value:function(t){}},{key:"_isCustomCallback",value:function(t){var e=this.fileUploader.option(t);return e&&(0,l.isFunction)(e)}},{key:"_handleFileError",value:function(t,e){t._isError=!0,t.onError.fire(e)}},{key:"_prepareFileBeforeUpload",value:function(t){var e;t.$file&&(null===(e=t.progressBar)||void 0===e||e.dispose(),this.fileUploader._createFileProgressBar(t));t.isInitialized||(t.onLoadStart.add(this._onUploadStarted.bind(this,t)),t.onLoad.add(this._onLoadedHandler.bind(this,t)),t.onError.add(this._onErrorHandler.bind(this,t)),t.onAbort.add(this._onAbortHandler.bind(this,t)),t.onProgress.add(this._onProgressHandler.bind(this,t)),t.isInitialized=!0)}},{key:"_isStatusError",value:function(t){return 400<=t&&t<500||500<=t&&t<600}},{key:"_onUploadStarted",value:function(t,e){t.uploadStarted=!0,this.fileUploader._uploadStartedAction({file:t.value,event:e,request:t.request})}},{key:"_onAbortHandler",value:function(t,e){var n={file:t.value,event:e,request:t.request,message:this.fileUploader._getUploadAbortedStatusMessage()};this.fileUploader._uploadAbortedAction(n),this.fileUploader._setStatusMessage(t,n.message),this.fileUploader._handleAllFilesUploaded()}},{key:"_onErrorHandler",value:function(t,e){var n={file:t.value,event:void 0,request:t.request,error:e,message:this.fileUploader.option("uploadFailedMessage")};this.fileUploader._uploadErrorAction(n),this.fileUploader._setStatusMessage(t,n.message),this.fileUploader._handleAllFilesUploaded()}},{key:"_onLoadedHandler",value:function(t,e){var n={file:t.value,event:e,request:t.request,message:this.fileUploader.option("uploadedMessage")};t._isLoaded=!0,this.fileUploader._uploadedAction(n),this.fileUploader._setStatusMessage(t,n.message),this.fileUploader._handleAllFilesUploaded()}},{key:"_onProgressHandler",value:function(t,e){if(t){var n=this.fileUploader._getTotalFilesSize(),o=this.fileUploader._getTotalLoadedFilesSize(),i=Math.min(e.loaded,t.value.size),r=i-t.loadedSize;t.loadedSize=i,this.fileUploader._updateTotalProgress(n,o+r),this.fileUploader._updateProgressBar(t,this._getLoadedData(i,e.total,r,e))}}},{key:"_getLoadedData",value:function(t,e,n,o){return{loaded:t,total:e,currentSegmentSize:n}}},{key:"_extendFormData",value:function(t){var e=this.fileUploader.option("uploadCustomData");for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(0,l.isDefined)(e[n])&&t.append(n,e[n])}}]),t}(),mt=function(t){D(n,t);var e=k(n);function n(t){var o;return I(this,n),o=e.call(this,t),o.chunkSize=o.fileUploader.option("chunkSize"),o}return O(n,[{key:"_uploadCore",value:function(t){var e=t.value,n={name:e.name,loadedBytes:0,type:e.type,blobReader:new dt(e,this.chunkSize),guid:new r.default,fileSize:e.size,count:Math.ceil(e.size/this.chunkSize),customData:{}};t.chunksData=n,this._sendChunk(t,n)}},{key:"_sendChunk",value:function(t,e){var n=this,o=e.blobReader.read();e.currentChunk=o,o&&this._sendChunkCore(t,e,o).done((function(){t.isAborted||(e.loadedBytes+=o.blob.size,t.onProgress.fire({loaded:e.loadedBytes,total:t.value.size}),o.isCompleted&&t.onLoad.fire(),setTimeout((function(){return n._sendChunk(t,e)})))})).fail((function(e){n._shouldHandleError(e)&&n._handleFileError(t,e)}))}},{key:"_sendChunkCore",value:function(t,e,n){}},{key:"_shouldHandleError",value:function(t){}},{key:"_tryRaiseStartLoad",value:function(t){t.isStartLoad||(t.isStartLoad=!0,t.onLoadStart.fire())}},{key:"_getEvent",value:function(t){return null}},{key:"_createUploadArgument",value:function(t){return this._createChunksInfo(t.chunksData)}},{key:"_createChunksInfo",value:function(t){return{bytesUploaded:t.loadedBytes,chunkCount:t.count,customData:t.customData,chunkBlob:t.currentChunk.blob,chunkIndex:t.currentChunk.index}}}]),n}(ft),gt=function(t){D(n,t);var e=k(n);function n(){return I(this,n),e.apply(this,arguments)}return O(n,[{key:"_sendChunkCore",value:function(t,e,n){var o=this;return m.default.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:function(e){return o._beforeSend(e,t)},upload:{onloadstart:function(){return o._tryRaiseStartLoad(t)},onabort:function(){return t.onAbort.fire()}},data:this._createFormData({fileName:e.name,blobName:this.fileUploader.option("name"),blob:n.blob,index:n.index,count:e.count,type:e.type,guid:e.guid,size:e.fileSize})})}},{key:"_shouldHandleError",value:function(t){return this._isStatusError(t.status)}},{key:"_createFormData",value:function(t){var e=new j.FormData;return e.append(t.blobName,t.blob),e.append(ut,JSON.stringify({FileName:t.fileName,Index:t.index,TotalCount:t.count,FileSize:t.size,FileType:t.type,FileGuid:t.guid})),this._extendFormData(e),e}}]),n}(mt),yt=function(t){D(n,t);var e=k(n);function n(){return I(this,n),e.apply(this,arguments)}return O(n,[{key:"_sendChunkCore",value:function(t,e){this._tryRaiseStartLoad(t);var n=this._createChunksInfo(e),o=this.fileUploader.option("uploadChunk");try{var i=o(t.value,n);return(0,f.fromPromise)(i)}catch(r){return(new f.Deferred).reject(r).promise()}}},{key:"_shouldHandleError",value:function(t){return!0}}]),n}(mt),vt=function(t){D(n,t);var e=k(n);function n(){return I(this,n),e.apply(this,arguments)}return O(n,[{key:"_uploadCore",value:function(t){var e=this;t.loadedSize=0,this._uploadFile(t).done((function(){t.isAborted||t.onLoad.fire()})).fail((function(n){e._shouldHandleError(t,n)&&e._handleFileError(t,n)}))}},{key:"_uploadFile",value:function(t){}},{key:"_shouldHandleError",value:function(t,e){}},{key:"_handleProgress",value:function(t,e){t._isError||(t._isProgressStarted=!0,t.onProgress.fire(e))}},{key:"_getLoadedData",value:function(t,e,o,i){var r=E(N(n.prototype),"_getLoadedData",this).call(this,t,e,o,i);return r.event=i,r}}]),n}(ft),Ct=function(t){D(n,t);var e=k(n);function n(){return I(this,n),e.apply(this,arguments)}return O(n,[{key:"_uploadFile",value:function(t){var e=this;return m.default.sendRequest({url:this.fileUploader.option("uploadUrl"),method:this.fileUploader.option("uploadMethod"),headers:this.fileUploader.option("uploadHeaders"),beforeSend:function(n){return e._beforeSend(n,t)},upload:{onprogress:function(n){return e._handleProgress(t,n)},onloadstart:function(){return t.onLoadStart.fire()},onabort:function(){return t.onAbort.fire()}},data:this._createFormData(this.fileUploader.option("name"),t.value)})}},{key:"_shouldHandleError",value:function(t,e){return this._isStatusError(e.status)||!t._isProgressStarted}},{key:"_createFormData",value:function(t,e){var n=new j.FormData;return n.append(t,e,e.name),this._extendFormData(n),n}}]),n}(vt),_t=function(t){D(n,t);var e=k(n);function n(){return I(this,n),e.apply(this,arguments)}return O(n,[{key:"_uploadFile",value:function(t){var e=this;t.onLoadStart.fire();var n=function(n){var o={loaded:n,total:t.size};e._handleProgress(t,o)},o=this.fileUploader.option("uploadFile");try{var i=o(t.value,n);return(0,f.fromPromise)(i)}catch(r){return(new f.Deferred).reject(r).promise()}}},{key:"_shouldHandleError",value:function(t,e){return!0}}]),n}(vt);(0,c.default)("dxFileUploader",ht);var Pt=ht;e.default=Pt,t.exports=e.default,t.exports.default=t.exports},"1be3":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=H(n("14a3")),r=H(n("cc156")),a=H(n("5d60")),s=H(n("0fa5")),c=n("d4b2"),u=n("b62d"),l=n("cb15"),p=H(n("be58")),h=H(n("fead")),d=n("4ff6"),f=n("706b"),m=n("9703"),g=H(n("8de2")),y=n("1820"),v=H(n("8a64")),C=H(n("061a")),_=B(n("ad64")),P=H(n("b370")),S=H(n("cc6a")),b=H(n("7009")),x=H(n("0c7d")),w=H(n("8177")),I=H(n("7e98")),T=H(n("d00a")),O=H(n("fea6")),E=H(n("6816")),M=H(n("48a3")),D=H(n("bc49")),A=H(n("ec06")),k=H(n("0b34")),L=H(n("05dd")),R=H(n("049b")),z=H(n("6571")),N=H(n("e315")),j=H(n("8b98"));function U(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return U=function(){return t},t}function B(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!==typeof t)return{default:t};var e=U();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=i?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function H(t){return t&&t.__esModule?t:{default:t}}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function K(t,e,n){return e&&F(t.prototype,e),n&&F(t,n),t}function W(t,e,n){return W="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=G(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},W(t,e,n||t)}function G(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Q(t),null===t)break;return t}function Z(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q(t,e)}function q(t,e){return q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},q(t,e)}function $(t){var e=J();return function(){var n,o=Q(t);if(e){var i=Q(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return X(this,n)}}function X(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?Y(t):e}function Y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function J(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}var tt="dx-diagram",et="dx-diagram-fullscreen",nt=tt+"-toolbar-wrapper",ot=tt+"-content-wrapper",it=tt+"-content",rt=tt+"-scroll-view",at=tt+"-floating-toolbar-container",st=tt+"-properties-panel-toolbar-container",ct=tt+"-loading-indicator",ut=12,lt="in",pt=1,ht="disabled",dt="portrait",ft="#ffffff",mt=576,gt=12,yt=3,vt=12,Ct=4,_t=152,Pt="dxDiagramEvent",St=(0,y.addNamespace)("fullscreenchange",Pt),bt=(0,y.addNamespace)("msfullscreenchange",Pt),xt=(0,y.addNamespace)("webkitfullscreenchange",Pt),wt=(0,y.addNamespace)("mozfullscreenchange",Pt),It=function(t){Z(n,t);var e=$(n);function n(){return V(this,n),e.apply(this,arguments)}return K(n,[{key:"_init",value:function(){this._updateDiagramLockCount=0,this.toggleFullscreenLock=0,this._browserResizeTimer=-1,this._toolbars=[],W(Q(n.prototype),"_init",this).call(this),this._initDiagram(),this._createCustomCommand()}},{key:"_initMarkup",value:function(){var t=this;W(Q(n.prototype),"_initMarkup",this).call(this),this._toolbars=[],delete this._isMobileScreenSize;var e=!(0,f.hasWindow)();this.$element().addClass(tt),delete this._mainToolbar,this.option("mainToolbar.visible")&&this._renderMainToolbar();var o=(0,i.default)("<div>").addClass(ot).appendTo(this.$element());if(delete this._historyToolbar,delete this._historyToolbarResizeCallback,this._isHistoryToolbarVisible()&&this._renderHistoryToolbar(o),delete this._propertiesToolbar,delete this._propertiesToolbarResizeCallback,this._isPropertiesPanelEnabled()&&this._renderPropertiesToolbar(o),delete this._viewToolbar,delete this._viewToolbarResizeCallback,this.option("viewToolbar.visible")&&this._renderViewToolbar(o),delete this._toolbox,delete this._toolboxResizeCallback,this._isToolboxEnabled()&&this._renderToolbox(o),delete this._propertiesPanel,delete this._propertiesPanelResizeCallback,this._isPropertiesPanelEnabled()&&this._renderPropertiesPanel(o),this._$content=(0,i.default)("<div>").addClass(it).appendTo(o),delete this._contextMenu,this.option("contextMenu.enabled")&&this._renderContextMenu(o),delete this._contextToolbox,this.option("contextToolbox.enabled")&&this._renderContextToolbox(o),this._renderDialog(o),!e){var r=(0,i.default)("<div>").addClass(rt).appendTo(this._$content);this._createComponent(r,M.default,{onCreateDiagram:function(e){t._diagramInstance.createDocument(e.$parent[0],e.scrollView)}})}(0,f.hasWindow)()&&h.default.add((function(){t._killBrowserResizeTimer(),t._browserResizeTimer=setTimeout((function(){return t._processBrowserResize()}),100)})),this._setCustomCommandChecked(z.default.SHOW_PROPERTIES_PANEL_COMMAND_NAME,this._isPropertiesPanelVisible()),this._setCustomCommandChecked(z.default.SHOW_TOOLBOX_COMMAND_NAME,this._isToolboxVisible())}},{key:"_processBrowserResize",value:function(){this._isMobileScreenSize=void 0,this._processDiagramResize(),this._killBrowserResizeTimer()}},{key:"_processDiagramResize",value:function(){this._historyToolbarResizeCallback&&this._historyToolbarResizeCallback.call(this),this._propertiesToolbarResizeCallback&&this._propertiesToolbarResizeCallback.call(this),this._propertiesPanelResizeCallback&&this._propertiesPanelResizeCallback.call(this),this._viewToolbarResizeCallback&&this._viewToolbarResizeCallback.call(this),this._toolboxResizeCallback&&this._toolboxResizeCallback.call(this)}},{key:"_killBrowserResizeTimer",value:function(){this._browserResizeTimer>-1&&clearTimeout(this._browserResizeTimer),this._browserResizeTimer=-1}},{key:"isMobileScreenSize",value:function(){return void 0===this._isMobileScreenSize&&(this._isMobileScreenSize=(0,f.hasWindow)()&&this.$element().outerWidth()<mt),this._isMobileScreenSize}},{key:"_captureFocus",value:function(){this._diagramInstance&&this._diagramInstance.captureFocus()}},{key:"_captureFocusOnTimeout",value:function(){var t=this;this._captureFocusTimeout=setTimeout((function(){t._captureFocus(),delete t._captureFocusTimeout}),100)}},{key:"_killCaptureFocusTimeout",value:function(){this._captureFocusTimeout&&(clearTimeout(this._captureFocusTimeout),delete this._captureFocusTimeout)}},{key:"notifyBarCommandExecuted",value:function(){this._captureFocusOnTimeout()}},{key:"_registerToolbar",value:function(t){this._registerBar(t),this._toolbars.push(t)}},{key:"_registerBar",value:function(t){t.bar.onChanged.add(this),this._diagramInstance.registerBar(t.bar)}},{key:"_getExcludeCommands",value:function(){var t=[];return this._isToolboxEnabled()||t.push(z.default.SHOW_TOOLBOX_COMMAND_NAME),this._isPropertiesPanelEnabled()||t.push(z.default.SHOW_PROPERTIES_PANEL_COMMAND_NAME),t}},{key:"_getToolbarBaseOptions",value:function(){var t=this;return{onContentReady:function(e){var n=e.component;return t._registerToolbar(n)},onSubMenuVisibilityChanging:function(e){var n=e.component;return t._diagramInstance.updateBarItemsState(n.bar)},onPointerUp:this._onPanelPointerUp.bind(this),export:this.option("export"),container:this.$element(),excludeCommands:this._getExcludeCommands(),onInternalCommand:this._onInternalCommand.bind(this),onCustomCommand:this._onCustomCommand.bind(this),isMobileView:this.isMobileScreenSize()}}},{key:"_onInternalCommand",value:function(t){switch(t.command){case z.default.SHOW_TOOLBOX_COMMAND_NAME:this._toolbox&&this._toolbox.toggle();break;case z.default.SHOW_PROPERTIES_PANEL_COMMAND_NAME:this._propertiesPanel&&this._propertiesPanel.toggle()}}},{key:"_onCustomCommand",value:function(t){this._customCommandAction({name:t.name})}},{key:"_renderMainToolbar",value:function(){var t=(0,i.default)("<div>").addClass(nt).appendTo(this.$element());this._mainToolbar=this._createComponent(t,b.default,(0,c.extend)(this._getToolbarBaseOptions(),{commands:this.option("mainToolbar.commands"),skipAdjustSize:!0}))}},{key:"_isHistoryToolbarVisible",value:function(){return this.option("historyToolbar.visible")&&!this.isReadOnlyMode()}},{key:"_renderHistoryToolbar",value:function(t){var e=this,n=!(0,f.hasWindow)(),o=(0,i.default)("<div>").addClass(at).appendTo(t);this._historyToolbar=this._createComponent(o,x.default,(0,c.extend)(this._getToolbarBaseOptions(),{commands:this.option("historyToolbar.commands"),locateInMenu:"never"})),this._updateHistoryToolbarPosition(o,t,n),this._historyToolbarResizeCallback=function(){e._historyToolbar.option("isMobileView",e.isMobileScreenSize())}}},{key:"_updateHistoryToolbarPosition",value:function(t,e,n){n||p.default.setup(t,{my:"left top",at:"left top",of:e,offset:ut+" "+ut})}},{key:"_isToolboxEnabled",value:function(){return"disabled"!==this.option("toolbox.visibility")&&!this.isReadOnlyMode()}},{key:"_isToolboxVisible",value:function(){return"visible"===this.option("toolbox.visibility")||"auto"===this.option("toolbox.visibility")&&!this.isMobileScreenSize()}},{key:"_renderToolbox",value:function(t){var e=this,n=!(0,f.hasWindow)(),o=(0,i.default)("<div>").appendTo(t),r=this._getToolboxBounds(t,n);this._toolbox=this._createComponent(o,A.default,{isMobileView:this.isMobileScreenSize(),isVisible:this._isToolboxVisible(),container:this.$element(),height:r.height,offsetParent:t,offsetX:r.offsetX,offsetY:r.offsetY,showSearch:this.option("toolbox.showSearch"),toolboxGroups:this._getToolboxGroups(),toolboxWidth:this.option("toolbox.width"),onShapeCategoryRendered:function(t){n||e._diagramInstance.createToolbox(t.$element[0],"texts"===t.displayMode,t.shapes||t.category,{shapeIconSpacing:gt,shapeIconCountInRow:e.option("toolbox.shapeIconsPerRow"),shapeIconAttributes:{"data-toggle":t.dataToggle}})},onFilterChanged:function(t){n||e._diagramInstance.applyToolboxFilter(t.text,t.filteringToolboxes)},onVisibilityChanging:function(t){n||(e._setCustomCommandChecked(z.default.SHOW_TOOLBOX_COMMAND_NAME,t.visible),e._propertiesPanel&&t.visible&&e.isMobileScreenSize()&&e._propertiesPanel.hide(),e._historyToolbar&&t.visible&&e.isMobileScreenSize()&&(e._historyToolbarZIndex=_.create(P.default.baseZIndex()),e._historyToolbar.$element().css("zIndex",e._historyToolbarZIndex),e._historyToolbar.$element().css("boxShadow","none")),e._viewToolbar&&(e._viewToolbar.$element().css("opacity",t.visible&&e.isMobileScreenSize()?"0":"1"),e._viewToolbar.$element().css("pointerEvents",t.visible&&e.isMobileScreenSize()?"none":"")))},onVisibilityChanged:function(t){t.visible||e._textInputStarted||e._captureFocus(),n||e._historyToolbar&&!t.visible&&e.isMobileScreenSize()&&e._historyToolbarZIndex&&(_.remove(e._historyToolbarZIndex),e._historyToolbar.$element().css("zIndex",""),e._historyToolbar.$element().css("boxShadow",""),e._historyToolbarZIndex=void 0)},onPointerUp:this._onPanelPointerUp.bind(this)}),this._toolboxResizeCallback=function(){var o=e._getToolboxBounds(t,n);e._toolbox.option("height",o.height);var i=e._toolbox.option("isMobileView");i!==e.isMobileScreenSize()&&(e._toolbox.option({isMobileView:e.isMobileScreenSize(),isVisible:e._isToolboxVisible()}),e._setCustomCommandChecked(z.default.SHOW_TOOLBOX_COMMAND_NAME,e._isToolboxVisible())),e._toolbox.updateMaxHeight()}}},{key:"_getToolboxBounds",value:function(t,e){var n={offsetX:ut,offsetY:ut,height:e?0:t.height()-2*ut};return this._historyToolbar&&!e&&(n.offsetY+=this._historyToolbar.$element().outerHeight()+ut,n.height-=this._historyToolbar.$element().outerHeight()+ut),this._viewToolbar&&!e&&(n.height-=this._viewToolbar.$element().outerHeight()+this._getViewToolbarYOffset(e)),n}},{key:"_renderViewToolbar",value:function(t){var e=this,n=!(0,f.hasWindow)(),o=(0,i.default)("<div>").addClass(at).appendTo(t);this._viewToolbar=this._createComponent(o,w.default,(0,c.extend)(this._getToolbarBaseOptions(),{commands:this.option("viewToolbar.commands"),locateInMenu:"never"})),this._updateViewToolbarPosition(o,t,n),this._viewToolbarResizeCallback=function(){e._updateViewToolbarPosition(o,t,n)}}},{key:"_getViewToolbarYOffset",value:function(t){if(!t){var e=ut;return this._viewToolbar&&this._propertiesToolbar&&(e+=(this._propertiesToolbar.$element().outerHeight()-this._viewToolbar.$element().outerHeight())/2),e}}},{key:"_updateViewToolbarPosition",value:function(t,e,n){n||p.default.setup(t,{my:"left bottom",at:"left bottom",of:e,offset:ut+" -"+this._getViewToolbarYOffset(n)})}},{key:"_isPropertiesPanelEnabled",value:function(){return"disabled"!==this.option("propertiesPanel.visibility")&&!this.isReadOnlyMode()}},{key:"_isPropertiesPanelVisible",value:function(){return"visible"===this.option("propertiesPanel.visibility")}},{key:"_renderPropertiesToolbar",value:function(t){var e=this,n=!(0,f.hasWindow)(),o=(0,i.default)("<div>").addClass(at).addClass(st).appendTo(t);this._propertiesToolbar=this._createComponent(o,I.default,(0,c.extend)(this._getToolbarBaseOptions(),{buttonStylingMode:"contained",buttonType:"default",locateInMenu:"never"})),this._updatePropertiesToolbarPosition(o,t,n),this._propertiesToolbarResizeCallback=function(){e._updatePropertiesToolbarPosition(o,t,n)}}},{key:"_updatePropertiesToolbarPosition",value:function(t,e,n){n||p.default.setup(t,{my:"right bottom",at:"right bottom",of:e,offset:"-"+ut+" -"+ut})}},{key:"_renderPropertiesPanel",value:function(t){var e=this,n=!(0,f.hasWindow)(),o=(0,i.default)("<div>").appendTo(t),r=ut,a=2*ut+(n?0:this._propertiesToolbar.$element().outerHeight());this._propertiesPanel=this._createComponent(o,k.default,{isMobileView:this.isMobileScreenSize(),isVisible:this._isPropertiesPanelVisible(),container:this.$element(),offsetParent:t,offsetX:r,offsetY:a,propertyTabs:this.option("propertiesPanel.tabs"),onCreateToolbar:function(t){t.toolbar=e._createComponent(t.$parent,S.default,(0,c.extend)(e._getToolbarBaseOptions(),{commands:t.commands,locateInMenu:"never",editorStylingMode:"outlined"}))},onVisibilityChanging:function(t){n||(e._updatePropertiesPanelGroupBars(t.component),e._setCustomCommandChecked(z.default.SHOW_PROPERTIES_PANEL_COMMAND_NAME,t.visible),e._toolbox&&t.visible&&e.isMobileScreenSize()&&e._toolbox.hide())},onVisibilityChanged:function(t){t.visible||e._textInputStarted||e._captureFocus()},onSelectedGroupChanged:function(t){var n=t.component;return e._updatePropertiesPanelGroupBars(n)},onPointerUp:this._onPanelPointerUp.bind(this)}),this._propertiesPanelResizeCallback=function(){var t=e._propertiesPanel.option("isMobileView");t!==e.isMobileScreenSize()&&(e._propertiesPanel.option({isMobileView:e.isMobileScreenSize(),isVisible:e._isPropertiesPanelVisible()}),e._setCustomCommandChecked(z.default.SHOW_PROPERTIES_PANEL_COMMAND_NAME,e._isPropertiesPanelVisible()))}}},{key:"_updatePropertiesPanelGroupBars",value:function(t){var e=this;t.getActiveToolbars().forEach((function(t){e._diagramInstance.updateBarItemsState(t.bar)}))}},{key:"_onPanelPointerUp",value:function(){this._captureFocusOnTimeout()}},{key:"_renderContextMenu",value:function(t){var e=this,n=(0,i.default)("<div>").appendTo(t);this._contextMenu=this._createComponent(n,T.default.DiagramContextMenuWrapper,{commands:this.option("contextMenu.commands"),onContentReady:function(t){var n=t.component;return e._registerBar(n)},onVisibilityChanging:function(t){var n=t.component;return e._diagramInstance.updateBarItemsState(n.bar)},onItemClick:function(t){return e._onBeforeCommandExecuted(t.command)},export:this.option("export"),excludeCommands:this._getExcludeCommands(),onInternalCommand:this._onInternalCommand.bind(this),onCustomCommand:this._onCustomCommand.bind(this)})}},{key:"_renderContextToolbox",value:function(t){var e=this,n=!(0,f.hasWindow)(),o=this.option("contextToolbox.category"),r=this.option("contextToolbox.displayMode"),a=this.option("contextToolbox.shapes"),s=(0,i.default)("<div>").appendTo(t);this._contextToolbox=this._createComponent(s,O.default,{toolboxWidth:this.option("contextToolbox.width"),onShown:function(t){if(!n){var s=(0,i.default)(t.$element),c="texts"===r;if(!a&&!o&&!c){var u=e._getToolboxGroups().filter((function(e){return e.category===t.category}))[0];u&&(c="texts"===u.displayMode)}e._diagramInstance.createContextToolbox(s[0],c,a||o||t.category,{shapeIconSpacing:vt,shapeIconCountInRow:e.option("contextToolbox.shapeIconsPerRow")},(function(n){t.callback(n),e._captureFocus(),t.hide()}))}}})}},{key:"_setCustomCommandChecked",value:function(t,e){this._toolbars.forEach((function(n){n.setCommandChecked(t,e)}))}},{key:"_onBeforeCommandExecuted",value:function(t){var e=R.default.getDialogParameters(t);return e&&this._showDialog(e),!!e}},{key:"_renderDialog",value:function(t){var e=(0,i.default)("<div>").appendTo(t);this._dialogInstance=this._createComponent(e,E.default,{})}},{key:"_showDialog",value:function(t){this._dialogInstance&&(this._dialogInstance.option("onGetContent",t.onGetContent),this._dialogInstance.option("onHidden",function(){this._captureFocus()}.bind(this)),this._dialogInstance.option("command",this._diagramInstance.getCommand(t.command)),this._dialogInstance.option("title",t.title),this._dialogInstance._show())}},{key:"_showLoadingIndicator",value:function(){this._loadingIndicator=(0,i.default)("<div>").addClass(ct),this._createComponent(this._loadingIndicator,a.default,{});var t=this._$content||this.$element();t.append(this._loadingIndicator)}},{key:"_hideLoadingIndicator",value:function(){this._loadingIndicator&&(this._loadingIndicator.remove(),this._loadingIndicator=null)}},{key:"_initDiagram",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramControl;if(this._diagramInstance=new e,this._diagramInstance.onChanged=this._raiseDataChangeAction.bind(this),this._diagramInstance.onEdgeInserted=this._raiseEdgeInsertedAction.bind(this),this._diagramInstance.onEdgeUpdated=this._raiseEdgeUpdatedAction.bind(this),this._diagramInstance.onEdgeRemoved=this._raiseEdgeRemovedAction.bind(this),this._diagramInstance.onNodeInserted=this._raiseNodeInsertedAction.bind(this),this._diagramInstance.onNodeUpdated=this._raiseNodeUpdatedAction.bind(this),this._diagramInstance.onNodeRemoved=this._raiseNodeRemovedAction.bind(this),this._diagramInstance.onToolboxDragStart=this._raiseToolboxDragStart.bind(this),this._diagramInstance.onToolboxDragEnd=this._raiseToolboxDragEnd.bind(this),this._diagramInstance.onTextInputStart=this._raiseTextInputStart.bind(this),this._diagramInstance.onTextInputEnd=this._raiseTextInputEnd.bind(this),this._diagramInstance.onToggleFullscreen=this._onToggleFullScreen.bind(this),this._diagramInstance.onShowContextMenu=this._onShowContextMenu.bind(this),this._diagramInstance.onHideContextMenu=this._onHideContextMenu.bind(this),this._diagramInstance.onShowContextToolbox=this._onShowContextToolbox.bind(this),this._diagramInstance.onHideContextToolbox=this._onHideContextToolbox.bind(this),this._diagramInstance.onNativeAction.add({notifyItemClick:this._raiseItemClickAction.bind(this),notifyItemDblClick:this._raiseItemDblClickAction.bind(this),notifySelectionChanged:this._raiseSelectionChanged.bind(this)}),this._diagramInstance.onRequestOperation=this._raiseRequestEditOperation.bind(this),this._updateEventSubscriptionMethods(),this._updateDefaultItemProperties(),this._updateEditingSettings(),this._updateShapeTexts(),this._updateUnitItems(),this._updateFormatUnitsMethod(),this.option("units")!==lt&&this._updateUnitsState(),this.isReadOnlyMode()&&this._updateReadOnlyState(),this.option("pageSize")&&(this.option("pageSize.items")&&this._updatePageSizeItemsState(),this.option("pageSize.width")&&this.option("pageSize.height")&&this._updatePageSizeState()),this.option("pageOrientation")!==dt&&this._updatePageOrientationState(),this.option("pageColor")!==ft&&this._updatePageColorState(),this.option("viewUnits")!==lt&&this._updateViewUnitsState(),this.option("showGrid")||this._updateShowGridState(),this.option("snapToGrid")||this._updateSnapToGridState(),this.option("gridSize")&&(this.option("gridSize.items")&&this._updateGridSizeItemsState(),this._updateGridSizeState()),this.option("zoomLevel.items")&&this._updateZoomLevelItemsState(),this.option("simpleView")&&this._updateSimpleViewState(),this.option("zoomLevel")!==pt&&this._updateZoomLevelState(),this.option("autoZoomMode")!==ht&&this._updateAutoZoomState(),this.option("fullScreen")){var n=(0,f.getWindow)();n&&n.self!==n.top?this.option("fullScreen",!1):this._updateFullscreenState()}this.optionsUpdateBar=new L.default(this),this._diagramInstance.registerBar(this.optionsUpdateBar),(0,f.hasWindow)()&&this._diagramInstance.initMeasurer(this.$element()[0]),this._updateCustomShapes(this._getCustomShapes()),this._refreshDataSources()}},{key:"_clean",value:function(){this._diagramInstance&&this._diagramInstance.cleanMarkup((function(t){(0,i.default)(t).empty()})),W(Q(n.prototype),"_clean",this).call(this)}},{key:"_dispose",value:function(){this._killCaptureFocusTimeout(),W(Q(n.prototype),"_dispose",this).call(this),this._diagramInstance=void 0}},{key:"_executeDiagramCommand",value:function(t,e){this._diagramInstance.getCommand(t).execute(e)}},{key:"getNodeDataSource",value:function(){return this._nodesOption&&this._nodesOption.getDataSource()}},{key:"getEdgeDataSource",value:function(){return this._edgesOption&&this._edgesOption.getDataSource()}},{key:"_refreshDataSources",value:function(){this._beginUpdateDiagram(),this._refreshNodesDataSource(),this._refreshEdgesDataSource(),this._endUpdateDiagram()}},{key:"_refreshNodesDataSource",value:function(){this._nodesOption&&(this._nodesOption._disposeDataSource(),delete this._nodesOption),this.option("nodes.dataSource")&&(this._nodesOption=new N.default(this),this._nodesOption.option("dataSource",this.option("nodes.dataSource")),this._nodesOption._refreshDataSource())}},{key:"_refreshEdgesDataSource",value:function(){this._edgesOption&&(this._edgesOption._disposeDataSource(),delete this._edgesOption),this.option("edges.dataSource")&&(this._edgesOption=new j.default(this),this._edgesOption.option("dataSource",this.option("edges.dataSource")),this._edgesOption._refreshDataSource())}},{key:"_getDiagramData",value:function(){var t,e=(0,d.getDiagram)(),n=e.DiagramCommand;return this._executeDiagramCommand(n.Export,(function(e){t=e})),t}},{key:"_setDiagramData",value:function(t,e){var n=(0,d.getDiagram)(),o=n.DiagramCommand;this._executeDiagramCommand(o.Import,{data:t,keepExistingItems:e})}},{key:"isReadOnlyMode",value:function(){return this.option("readOnly")||this.option("disabled")}},{key:"_onDataSourceChanged",value:function(){this._bindDiagramData()}},{key:"_getChangesKeys",value:function(t){return t.map((function(t){return t.internalKey||t.key})).filter((function(t){return!!t}))}},{key:"_createOptionGetter",value:function(t){var e=this.option(t);return e&&(0,l.compileGetter)(e)}},{key:"_onRequestUpdateLayout",value:function(t){this._requestLayoutUpdateAction||this._createRequestLayoutUpdateAction();var e={changes:t,allowed:!1};return this._requestLayoutUpdateAction(e),e.allowed}},{key:"_createOptionSetter",value:function(t){var e=this.option(t);return(0,u.isFunction)(e)?e:e&&(0,l.compileSetter)(e)}},{key:"_bindDiagramData",value:function(){if(!this._updateDiagramLockCount&&this._isBindingMode()){var t,e,n,o,i,r,a,s,c=(0,d.getDiagram)(),u=c.DiagramCommand,l=c.ConnectorLineOption,p=c.ConnectorLineEnding,h={nodeDataSource:this._nodesOption&&this._nodesOption.getItems(),edgeDataSource:this._edgesOption&&this._edgesOption.getItems(),nodeDataImporter:{getKey:this._createOptionGetter("nodes.keyExpr"),setKey:this._createOptionSetter("nodes.keyExpr"),getCustomData:this._createOptionGetter("nodes.customDataExpr"),setCustomData:this._createOptionSetter("nodes.customDataExpr"),getLocked:this._createOptionGetter("nodes.lockedExpr"),setLocked:this._createOptionSetter("nodes.lockedExpr"),getStyle:this._createOptionGetter("nodes.styleExpr"),setStyle:this._createOptionSetter("nodes.styleExpr"),getStyleText:this._createOptionGetter("nodes.textStyleExpr"),setStyleText:this._createOptionSetter("nodes.textStyleExpr"),getZIndex:this._createOptionGetter("nodes.zIndexExpr"),setZIndex:this._createOptionSetter("nodes.zIndexExpr"),getType:this._createOptionGetter("nodes.typeExpr"),setType:this._createOptionSetter("nodes.typeExpr"),getText:this._createOptionGetter("nodes.textExpr"),setText:this._createOptionSetter("nodes.textExpr"),getImage:this._createOptionGetter("nodes.imageUrlExpr"),setImage:this._createOptionSetter("nodes.imageUrlExpr"),getLeft:this._createOptionGetter("nodes.leftExpr"),setLeft:this._createOptionSetter("nodes.leftExpr"),getTop:this._createOptionGetter("nodes.topExpr"),setTop:this._createOptionSetter("nodes.topExpr"),getWidth:this._createOptionGetter("nodes.widthExpr"),setWidth:this._createOptionSetter("nodes.widthExpr"),getHeight:this._createOptionGetter("nodes.heightExpr"),setHeight:this._createOptionSetter("nodes.heightExpr"),getParentKey:this._createOptionGetter("nodes.parentKeyExpr"),setParentKey:this._createOptionSetter("nodes.parentKeyExpr"),getItems:this._createOptionGetter("nodes.itemsExpr"),setItems:this._createOptionSetter("nodes.itemsExpr"),getContainerKey:a=this._createOptionGetter("nodes.containerKeyExpr"),setContainerKey:s=this._createOptionSetter("nodes.containerKeyExpr"),getChildren:!a&&!s&&this._createOptionGetter("nodes.containerChildrenExpr"),setChildren:!a&&!s&&this._createOptionSetter("nodes.containerChildrenExpr")},edgeDataImporter:{getKey:this._createOptionGetter("edges.keyExpr"),setKey:this._createOptionSetter("edges.keyExpr"),getCustomData:this._createOptionGetter("edges.customDataExpr"),setCustomData:this._createOptionSetter("edges.customDataExpr"),getLocked:this._createOptionGetter("edges.lockedExpr"),setLocked:this._createOptionSetter("edges.lockedExpr"),getStyle:this._createOptionGetter("edges.styleExpr"),setStyle:this._createOptionSetter("edges.styleExpr"),getStyleText:this._createOptionGetter("edges.textStyleExpr"),setStyleText:this._createOptionSetter("edges.textStyleExpr"),getZIndex:this._createOptionGetter("edges.zIndexExpr"),setZIndex:this._createOptionSetter("edges.zIndexExpr"),getFrom:this._createOptionGetter("edges.fromExpr"),setFrom:this._createOptionSetter("edges.fromExpr"),getFromPointIndex:this._createOptionGetter("edges.fromPointIndexExpr"),setFromPointIndex:this._createOptionSetter("edges.fromPointIndexExpr"),getTo:this._createOptionGetter("edges.toExpr"),setTo:this._createOptionSetter("edges.toExpr"),getToPointIndex:this._createOptionGetter("edges.toPointIndexExpr"),setToPointIndex:this._createOptionSetter("edges.toPointIndexExpr"),getPoints:this._createOptionGetter("edges.pointsExpr"),setPoints:this._createOptionSetter("edges.pointsExpr"),getText:this._createOptionGetter("edges.textExpr"),setText:this._createOptionSetter("edges.textExpr"),getLineOption:(t=this._createOptionGetter("edges.lineTypeExpr"))&&function(e){var n=t(e);return this._getConnectorLineOption(n)}.bind(this),setLineOption:(e=this._createOptionSetter("edges.lineTypeExpr"))&&function(t,n){switch(n){case l.Straight:n="straight";break;case l.Orthogonal:n="orthogonal"}e(t,n)}.bind(this),getStartLineEnding:(n=this._createOptionGetter("edges.fromLineEndExpr"))&&function(t){var e=n(t);return this._getConnectorLineEnding(e)}.bind(this),setStartLineEnding:(o=this._createOptionSetter("edges.fromLineEndExpr"))&&function(t,e){switch(e){case p.Arrow:e="arrow";break;case p.OutlinedTriangle:e="outlinedTriangle";break;case p.FilledTriangle:e="filledTriangle";break;case p.None:e="none"}o(t,e)}.bind(this),getEndLineEnding:(i=this._createOptionGetter("edges.toLineEndExpr"))&&function(t){var e=i(t);return this._getConnectorLineEnding(e)}.bind(this),setEndLineEnding:(r=this._createOptionSetter("edges.toLineEndExpr"))&&function(t,e){switch(e){case p.Arrow:e="arrow";break;case p.OutlinedTriangle:e="outlinedTriangle";break;case p.FilledTriangle:e="filledTriangle";break;case p.None:e="none"}r(t,e)}.bind(this)},layoutParameters:this._getDataBindingLayoutParameters()};this._executeDiagramCommand(u.BindDocument,h)}}},{key:"_reloadContentByChanges",value:function(t,e){var n=this._getChangesKeys(t),o=this._onRequestUpdateLayout(t);this._reloadContent(n,o,e)}},{key:"_reloadContent",value:function(t,e,n){var o=this,i=function(){var t,e;return o._nodesOption&&n&&(t=o._nodesOption.getItems()),o._edgesOption&&n&&(e=o._edgesOption.getItems()),{nodeDataSource:t,edgeDataSource:e}};this._diagramInstance.reloadContent(t,i,e&&this._getDataBindingLayoutParameters(),n)}},{key:"_getConnectorLineOption",value:function(t){var e=(0,d.getDiagram)(),n=e.ConnectorLineOption;switch(t){case"straight":return n.Straight;default:return n.Orthogonal}}},{key:"_getConnectorLineEnding",value:function(t){var e=(0,d.getDiagram)(),n=e.ConnectorLineEnding;switch(t){case"arrow":return n.Arrow;case"outlinedTriangle":return n.OutlinedTriangle;case"filledTriangle":return n.FilledTriangle;default:return n.None}}},{key:"_getDataBindingLayoutParameters",value:function(){var t=(0,d.getDiagram)(),e=t.DataLayoutType,n=t.DataLayoutOrientation,o=this.option("nodes.autoLayout")||"off",i=o.type||o,r={};if("off"!==i&&("auto"!==i||!this._hasNodePositionExprs())){switch(i){case"tree":r.type=e.Tree;break;default:r.type=e.Sugiyama}switch(o.orientation){case"vertical":r.orientation=n.Vertical;break;case"horizontal":r.orientation=n.Horizontal}(this.option("edges.fromPointIndexExpr")||this.option("edges.toPointIndexExpr"))&&(r.skipPointIndices=!0)}return r.autoSizeEnabled=!!this.option("nodes.autoSizeEnabled"),r}},{key:"_hasNodePositionExprs",value:function(){return this.option("nodes.topExpr")&&this.option("nodes.leftExpr")}},{key:"_getAutoZoomValue",value:function(t){var e=(0,d.getDiagram)(),n=e.AutoZoomMode;switch(t){case"fitContent":return n.FitContent;case"fitWidth":return n.FitToWidth;default:return n.Disabled}}},{key:"_isBindingMode",value:function(){return this._nodesOption&&this._nodesOption.hasItems()||this._edgesOption&&this._nodesOption.hasItems()}},{key:"_beginUpdateDiagram",value:function(){this._updateDiagramLockCount++}},{key:"_endUpdateDiagram",value:function(){this._updateDiagramLockCount=Math.max(this._updateDiagramLockCount-1,0),this._updateDiagramLockCount||this._bindDiagramData()}},{key:"_getCustomShapes",value:function(){return this.option("customShapes")||[]}},{key:"_getToolboxGroups",value:function(){return D.default.getGroups(this.option("toolbox.groups"))}},{key:"_updateCustomShapes",value:function(t,e){var n=this;Array.isArray(e)&&this._diagramInstance.removeCustomShapes(e.map((function(t){return t.type}))),Array.isArray(t)&&this._diagramInstance.addCustomShapes(t.map((function(t){var e=t.template||n.option("customShapeTemplate"),o=e&&n._getTemplate(e),r=t.toolboxTemplate||n.option("customShapeToolboxTemplate"),a=r&&n._getTemplate(r);return{category:t.category,type:t.type,baseType:t.baseType,title:t.title,svgUrl:t.backgroundImageUrl,svgToolboxUrl:t.backgroundImageToolboxUrl,svgLeft:t.backgroundImageLeft,svgTop:t.backgroundImageTop,svgWidth:t.backgroundImageWidth,svgHeight:t.backgroundImageHeight,defaultWidth:t.defaultWidth,defaultHeight:t.defaultHeight,toolboxWidthToHeightRatio:t.toolboxWidthToHeightRatio,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,allowResize:t.allowResize,defaultText:t.defaultText,allowEditText:t.allowEditText,textLeft:t.textLeft,textTop:t.textTop,textWidth:t.textWidth,textHeight:t.textHeight,defaultImageUrl:t.defaultImageUrl,allowEditImage:t.allowEditImage,imageLeft:t.imageLeft,imageTop:t.imageTop,imageWidth:t.imageWidth,imageHeight:t.imageHeight,connectionPoints:t.connectionPoints&&t.connectionPoints.map((function(t){return{x:t.x,y:t.y}})),createTemplate:o&&function(t,e){o.render({model:n._nativeItemToDiagramItem(e),container:(0,m.getPublicElement)((0,i.default)(t))})},createToolboxTemplate:a&&function(t,e){a.render({model:n._nativeItemToDiagramItem(e),container:(0,m.getPublicElement)((0,i.default)(t))})},destroyTemplate:o&&function(t){(0,i.default)(t).empty()},templateLeft:t.templateLeft,templateTop:t.templateTop,templateWidth:t.templateWidth,templateHeight:t.templateHeight,keepRatioOnAutoSize:t.keepRatioOnAutoSize}})))}},{key:"_onToggleFullScreen",value:function(t){this.toggleFullscreenLock>0||(this._changeNativeFullscreen(t),this.$element().toggleClass(et,t),this._diagramInstance.updateLayout(!0),this._processDiagramResize(),this._toolbox&&this._toolbox.repaint(),this._propertiesPanel&&this._propertiesPanel.repaint())}},{key:"_changeNativeFullscreen",value:function(t){var e=(0,f.getWindow)();e.self!==e.top&&t!==this._inNativeFullscreen()&&(t?this._subscribeFullscreenNativeChanged():this._unsubscribeFullscreenNativeChanged(),this._setNativeFullscreen(t))}},{key:"_setNativeFullscreen",value:function(t){var e=(0,f.getWindow)(),n=e.self.document,o=e.self.document.body;t?o.requestFullscreen?o.requestFullscreen():o.mozRequestFullscreen?o.mozRequestFullscreen():o.webkitRequestFullscreen?o.webkitRequestFullscreen():o.msRequestFullscreen&&o.msRequestFullscreen():n.exitFullscreen?n.exitFullscreen():n.mozCancelFullscreen?n.mozCancelFullscreen():n.webkitExitFullscreen?n.webkitExitFullscreen():n.msExitFullscreen&&n.msExitFullscreen()}},{key:"_inNativeFullscreen",value:function(){var t=(0,f.getWindow)().document,e=t.fullscreenElement||t.msFullscreenElement||t.webkitFullscreenElement,n=e===t.body||t.webkitIsFullscreen;return!!n}},{key:"_subscribeFullscreenNativeChanged",value:function(){var t=(0,f.getWindow)().document,e=this._onNativeFullscreenChangeHandler.bind(this);g.default.on(t,St,e),g.default.on(t,bt,e),g.default.on(t,xt,e),g.default.on(t,wt,e)}},{key:"_unsubscribeFullscreenNativeChanged",value:function(){var t=(0,f.getWindow)().document;g.default.off(t,St),g.default.off(t,bt),g.default.off(t,xt),g.default.off(t,wt)}},{key:"_onNativeFullscreenChangeHandler",value:function(){this._inNativeFullscreen()||(this._unsubscribeFullscreenNativeChanged(),this.option("fullScreen",!1))}},{key:"_executeDiagramFullscreenCommand",value:function(t){var e=(0,d.getDiagram)(),n=e.DiagramCommand;this.toggleFullscreenLock++,this._executeDiagramCommand(n.Fullscreen,t),this.toggleFullscreenLock--}},{key:"_onShowContextMenu",value:function(t,e,n){this._contextMenu&&this._contextMenu._show(t,e,n)}},{key:"_onHideContextMenu",value:function(){this._contextMenu&&this._contextMenu._hide()}},{key:"_onShowContextToolbox",value:function(t,e,n,o,i){this._contextToolbox&&this._contextToolbox._show(t,e,n,o,i)}},{key:"_onHideContextToolbox",value:function(){this._contextToolbox&&this._contextToolbox._hide()}},{key:"_getDiagramUnitValue",value:function(t){var e=(0,d.getDiagram)(),n=e.DiagramUnit;switch(t){case"in":return n.In;case"cm":return n.Cm;case"px":return n.Px;default:return n.In}}},{key:"_updateReadOnlyState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand,n=this.isReadOnlyMode();this._executeDiagramCommand(e.ToggleReadOnly,n)}},{key:"_updateZoomLevelState",value:function(){var t=this.option("zoomLevel.value");t||(t=this.option("zoomLevel"));var e=(0,d.getDiagram)(),n=e.DiagramCommand;this._executeDiagramCommand(n.ZoomLevel,t)}},{key:"_updateZoomLevelItemsState",value:function(){var t=this.option("zoomLevel.items");if(Array.isArray(t)){var e=(0,d.getDiagram)(),n=e.DiagramCommand;this._executeDiagramCommand(n.ZoomLevelItems,t)}}},{key:"_updateAutoZoomState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.SwitchAutoZoom,this._getAutoZoomValue(this.option("autoZoomMode")))}},{key:"_updateSimpleViewState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.ToggleSimpleView,this.option("simpleView"))}},{key:"_updateFullscreenState",value:function(){var t=this.option("fullScreen");this._executeDiagramFullscreenCommand(t),this._onToggleFullScreen(t)}},{key:"_updateShowGridState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.ShowGrid,this.option("showGrid"))}},{key:"_updateSnapToGridState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.SnapToGrid,this.option("snapToGrid"))}},{key:"_updateGridSizeState",value:function(){var t=this.option("gridSize.value");t||(t=this.option("gridSize"));var e=(0,d.getDiagram)(),n=e.DiagramCommand;this._executeDiagramCommand(n.GridSize,t)}},{key:"_updateGridSizeItemsState",value:function(){var t=this.option("gridSize.items");if(Array.isArray(t)){var e=(0,d.getDiagram)(),n=e.DiagramCommand;this._executeDiagramCommand(n.GridSizeItems,t)}}},{key:"_updateUnitItems",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramLocalizationService,n=this._getUnitItems();this._unitItems!==n&&(this._unitItems=n,e.unitItems=n)}},{key:"_getUnitItems",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramUnit,n={};return n[e.In]=v.default.format("dxDiagram-unitIn"),n[e.Cm]=v.default.format("dxDiagram-unitCm"),n[e.Px]=v.default.format("dxDiagram-unitPx"),n}},{key:"_updateFormatUnitsMethod",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramLocalizationService;e.formatUnit=function(t){return C.default.format(t)}}},{key:"_updateViewUnitsState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.ViewUnits,this._getDiagramUnitValue(this.option("viewUnits")))}},{key:"_updateUnitsState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.Units,this._getDiagramUnitValue(this.option("units")))}},{key:"_updatePageSizeState",value:function(){var t=this.option("pageSize");if(t&&t.width&&t.height){var e=(0,d.getDiagram)(),n=e.DiagramCommand;this._executeDiagramCommand(n.PageSize,t)}}},{key:"_updatePageSizeItemsState",value:function(){var t=this.option("pageSize.items");if(Array.isArray(t)){var e=(0,d.getDiagram)(),n=e.DiagramCommand;this._executeDiagramCommand(n.PageSizeItems,t)}}},{key:"_updatePageOrientationState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.PageLandscape,"landscape"===this.option("pageOrientation"))}},{key:"_updatePageColorState",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramCommand;this._executeDiagramCommand(e.PageColor,this.option("pageColor"))}},{key:"_updateShapeTexts",value:function(){var t=(0,d.getDiagram)(),e=t.DiagramLocalizationService,n=this._getShapeTexts();this._shapeTexts!==n&&(this._shapeTexts=n,e.shapeTexts=n)}},{key:"_getShapeTexts",value:function(){var t=(0,d.getDiagram)(),e=t.ShapeTypes,n={};return n[e.Text]=v.default.format("dxDiagram-shapeText"),n[e.Rectangle]=v.default.format("dxDiagram-shapeRectangle"),n[e.Ellipse]=v.default.format("dxDiagram-shapeEllipse"),n[e.Cross]=v.default.format("dxDiagram-shapeCross"),n[e.Triangle]=v.default.format("dxDiagram-shapeTriangle"),n[e.Diamond]=v.default.format("dxDiagram-shapeDiamond"),n[e.Heart]=v.default.format("dxDiagram-shapeHeart"),n[e.Pentagon]=v.default.format("dxDiagram-shapePentagon"),n[e.Hexagon]=v.default.format("dxDiagram-shapeHexagon"),n[e.Octagon]=v.default.format("dxDiagram-shapeOctagon"),n[e.Star]=v.default.format("dxDiagram-shapeStar"),n[e.ArrowLeft]=v.default.format("dxDiagram-shapeArrowLeft"),n[e.ArrowUp]=v.default.format("dxDiagram-shapeArrowUp"),n[e.ArrowRight]=v.default.format("dxDiagram-shapeArrowRight"),n[e.ArrowDown]=v.default.format("dxDiagram-shapeArrowDown"),n[e.ArrowUpDown]=v.default.format("dxDiagram-shapeArrowUpDown"),n[e.ArrowLeftRight]=v.default.format("dxDiagram-shapeArrowLeftRight"),n[e.Process]=v.default.format("dxDiagram-shapeProcess"),n[e.Decision]=v.default.format("dxDiagram-shapeDecision"),n[e.Terminator]=v.default.format("dxDiagram-shapeTerminator"),n[e.PredefinedProcess]=v.default.format("dxDiagram-shapePredefinedProcess"),n[e.Document]=v.default.format("dxDiagram-shapeDocument"),n[e.MultipleDocuments]=v.default.format("dxDiagram-shapeMultipleDocuments"),n[e.ManualInput]=v.default.format("dxDiagram-shapeManualInput"),n[e.Preparation]=v.default.format("dxDiagram-shapePreparation"),n[e.Data]=v.default.format("dxDiagram-shapeData"),n[e.Database]=v.default.format("dxDiagram-shapeDatabase"),n[e.HardDisk]=v.default.format("dxDiagram-shapeHardDisk"),n[e.InternalStorage]=v.default.format("dxDiagram-shapeInternalStorage"),n[e.PaperTape]=v.default.format("dxDiagram-shapePaperTape"),n[e.ManualOperation]=v.default.format("dxDiagram-shapeManualOperation"),n[e.Delay]=v.default.format("dxDiagram-shapeDelay"),n[e.StoredData]=v.default.format("dxDiagram-shapeStoredData"),n[e.Display]=v.default.format("dxDiagram-shapeDisplay"),n[e.Merge]=v.default.format("dxDiagram-shapeMerge"),n[e.Connector]=v.default.format("dxDiagram-shapeConnector"),n[e.Or]=v.default.format("dxDiagram-shapeOr"),n[e.SummingJunction]=v.default.format("dxDiagram-shapeSummingJunction"),n[e.Container]=v.default.format("dxDiagram-shapeContainerDefaultText"),n[e.VerticalContainer]=v.default.format("dxDiagram-shapeVerticalContainer"),n[e.HorizontalContainer]=v.default.format("dxDiagram-shapeHorizontalContainer"),n[e.Card]=v.default.format("dxDiagram-shapeCardDefaultText"),n[e.CardWithImageOnLeft]=v.default.format("dxDiagram-shapeCardWithImageOnLeft"),n[e.CardWithImageOnTop]=v.default.format("dxDiagram-shapeCardWithImageOnTop"),n[e.CardWithImageOnRight]=v.default.format("dxDiagram-shapeCardWithImageOnRight"),n}},{key:"_updateEventSubscriptionMethods",value:function(){var t=(0,d.getDiagram)(),e=t.RenderHelper;e.addEventListener=function(t,e,n){g.default.on(t,e,n)},e.removeEventListener=function(t,e,n){g.default.off(t,e,n)}}},{key:"_updateDefaultItemProperties",value:function(){this.option("defaultItemProperties.style")&&this._diagramInstance.setInitialStyleProperties(this.option("defaultItemProperties.style")),this.option("defaultItemProperties.textStyle")&&this._diagramInstance.setInitialTextStyleProperties(this.option("defaultItemProperties.textStyle")),this._diagramInstance.setInitialConnectorProperties({lineOption:this._getConnectorLineOption(this.option("defaultItemProperties.connectorLineType")),startLineEnding:this._getConnectorLineEnding(this.option("defaultItemProperties.connectorLineStart")),endLineEnding:this._getConnectorLineEnding(this.option("defaultItemProperties.connectorLineEnd"))}),this._diagramInstance.applyShapeSizeSettings({shapeMinWidth:this.option("defaultItemProperties.shapeMinWidth"),shapeMaxWidth:this.option("defaultItemProperties.shapeMaxWidth"),shapeMinHeight:this.option("defaultItemProperties.shapeMinHeight"),shapeMaxHeight:this.option("defaultItemProperties.shapeMaxHeight")})}},{key:"_updateEditingSettings",value:function(){this._diagramInstance.applyOperationSettings({addShape:this.option("editing.allowAddShape"),addShapeFromToolbox:this.option("editing.allowAddShape"),deleteShape:this.option("editing.allowDeleteShape"),deleteConnector:this.option("editing.allowDeleteConnector"),changeConnection:this.option("editing.allowChangeConnection"),changeConnectorPoints:this.option("editing.allowChangeConnectorPoints"),changeShapeText:this.option("editing.allowChangeShapeText"),changeConnectorText:this.option("editing.allowChangeConnectorText"),resizeShape:this.option("editing.allowResizeShape"),moveShape:this.option("editing.allowMoveShape")})}},{key:"focus",value:function(){this._captureFocus()}},{key:"export",value:function(){return this._getDiagramData()}},{key:"exportTo",value:function(t,e){var n=this._getDiagramExportToCommand(t);this._executeDiagramCommand(n,e)}},{key:"_getDiagramExportToCommand",value:function(t){var e=(0,d.getDiagram)(),n=e.DiagramCommand;switch(t){case"png":return n.ExportPng;case"jpg":return n.ExportJpg;default:return n.ExportSvg}}},{key:"import",value:function(t,e){this._setDiagramData(t,e),this._raiseDataChangeAction()}},{key:"updateToolbox",value:function(){this._diagramInstance&&this._diagramInstance.refreshToolbox(),this._toolbox&&this._toolbox.updateMaxHeight()}},{key:"_getDefaultOptions",value:function(){return(0,c.extend)(W(Q(n.prototype),"_getDefaultOptions",this).call(this),{readOnly:!1,zoomLevel:pt,simpleView:!1,autoZoomMode:ht,fullScreen:!1,showGrid:!0,snapToGrid:!0,units:lt,viewUnits:lt,pageOrientation:dt,pageColor:ft,hasChanges:!1,nodes:{dataSource:null,keyExpr:"id",customDataExpr:void 0,lockedExpr:void 0,styleExpr:void 0,textStyleExpr:void 0,zIndexExpr:void 0,typeExpr:"type",textExpr:"text",imageUrlExpr:void 0,parentKeyExpr:void 0,itemsExpr:void 0,leftExpr:void 0,topExpr:void 0,widthExpr:void 0,heightExpr:void 0,containerKeyExpr:void 0,containerChildrenExpr:"children",autoLayout:"auto",autoSizeEnabled:!0},edges:{dataSource:null,keyExpr:"id",customDataExpr:void 0,lockedExpr:void 0,styleExpr:void 0,textStyleExpr:void 0,zIndexExpr:void 0,fromExpr:"from",fromPointIndexExpr:void 0,toExpr:"to",toPointIndexExpr:void 0,pointsExpr:void 0,textExpr:void 0,lineTypeExpr:void 0,fromLineEndExpr:void 0,toLineEndExpr:void 0},customShapes:[],toolbox:{visibility:"auto",shapeIconsPerRow:yt,showSearch:!0},mainToolbar:{visible:!1},historyToolbar:{visible:!0},viewToolbar:{visible:!0},contextMenu:{enabled:!0},contextToolbox:{enabled:!0,shapeIconsPerRow:Ct,width:_t},propertiesPanel:{visibility:"auto"},defaultItemProperties:{connectorLineType:"orthogonal",connectorLineStart:"none",connectorLineEnd:"arrow"},editing:{allowAddShape:!0,allowDeleteShape:!0,allowDeleteConnector:!0,allowChangeConnection:!0,allowChangeConnectorPoints:!0,allowChangeShapeText:!0,allowChangeConnectorText:!0,allowResizeShape:!0,allowMoveShape:!0},export:{fileName:"Diagram",proxyUrl:void 0},onItemClick:null,onItemDblClick:null,onSelectionChanged:null,onRequestEditOperation:null,onRequestLayoutUpdate:null})}},{key:"_raiseDataChangeAction",value:function(){this._initialized&&this.option("hasChanges",!0)}},{key:"_raiseEdgeInsertedAction",value:function(t,e,n){this._edgesOption&&this._edgesOption.insert(t,e,n)}},{key:"_raiseEdgeUpdatedAction",value:function(t,e,n,o){this._edgesOption&&this._edgesOption.update(t,e,n,o)}},{key:"_raiseEdgeRemovedAction",value:function(t,e,n,o){this._edgesOption&&this._edgesOption.remove(t,e,n,o)}},{key:"_raiseNodeInsertedAction",value:function(t,e,n){this._nodesOption&&this._nodesOption.insert(t,e,n)}},{key:"_raiseNodeUpdatedAction",value:function(t,e,n,o){this._nodesOption&&this._nodesOption.update(t,e,n,o)}},{key:"_raiseNodeRemovedAction",value:function(t,e,n,o){this._nodesOption&&this._nodesOption.remove(t,e,n,o)}},{key:"_raiseToolboxDragStart",value:function(){this._toolbox&&(this._toolbox._raiseToolboxDragStart(),this.isMobileScreenSize()&&(this._toolbox.hide(),this._toolboxDragHidden=!0))}},{key:"_raiseToolboxDragEnd",value:function(){this._toolbox&&(this._toolbox._raiseToolboxDragEnd(),this._toolboxDragHidden&&(this._toolbox.show(),delete this._toolboxDragHidden))}},{key:"_raiseTextInputStart",value:function(){this._textInputStarted=!0,this._propertiesPanel&&this.isMobileScreenSize()&&this._propertiesPanel.isVisible()&&(this._propertiesPanel.hide(),this._propertiesPanelTextInputHidden=!0),this._toolbox&&this.isMobileScreenSize()&&this._toolbox.isVisible()&&(this._toolbox.hide(),this._toolboxTextInputHidden=!0)}},{key:"_raiseTextInputEnd",value:function(){this._propertiesPanel&&this._propertiesPanelTextInputHidden&&(this._propertiesPanel.show(),delete this._propertiesPanelTextInputHidden),this._toolbox&&this._toolboxTextInputHidden&&(this._toolbox.show(),delete this._toolboxTextInputHidden),this._textInputStarted=!1}},{key:"_createItemClickAction",value:function(){this._itemClickAction=this._createActionByOption("onItemClick")}},{key:"_createItemDblClickAction",value:function(){this._itemDblClickAction=this._createActionByOption("onItemDblClick")}},{key:"_createSelectionChangedAction",value:function(){this._selectionChangedAction=this._createActionByOption("onSelectionChanged")}},{key:"_createRequestEditOperationAction",value:function(){this._requestEditOperationAction=this._createActionByOption("onRequestEditOperation")}},{key:"_createRequestLayoutUpdateAction",value:function(){this._requestLayoutUpdateAction=this._createActionByOption("onRequestLayoutUpdate")}},{key:"_createCustomCommand",value:function(){this._customCommandAction=this._createActionByOption("onCustomCommand")}},{key:"_raiseItemClickAction",value:function(t){this._itemClickAction||this._createItemClickAction(),this._itemClickAction({item:this._nativeItemToDiagramItem(t)})}},{key:"_raiseItemDblClickAction",value:function(t){this._itemDblClickAction||this._createItemDblClickAction(),this._itemDblClickAction({item:this._nativeItemToDiagramItem(t)})}},{key:"_raiseSelectionChanged",value:function(t){this._selectionChangedAction||this._createSelectionChangedAction(),this._selectionChangedAction({items:t.map(this._nativeItemToDiagramItem.bind(this))})}},{key:"_raiseRequestEditOperation",value:function(t,e){this._requestEditOperationAction||this._createRequestEditOperationAction();var n=this._getRequestEditOperationEventArgs(t,e);this._requestEditOperationAction(n),e.allowed=n.allowed}},{key:"_getModelOperation",value:function(t){var e=(0,d.getDiagram)(),n=e.DiagramModelOperation;switch(t){case n.AddShape:return"addShape";case n.AddShapeFromToolbox:return"addShapeFromToolbox";case n.DeleteShape:return"deleteShape";case n.DeleteConnector:return"deleteConnector";case n.ChangeConnection:return"changeConnection";case n.ChangeConnectorPoints:return"changeConnectorPoints";case n.BeforeChangeShapeText:return"beforeChangeShapeText";case n.ChangeShapeText:return"changeShapeText";case n.BeforeChangeConnectorText:return"beforeChangeConnectorText";case n.ChangeConnectorText:return"changeConnectorText";case n.ResizeShape:return"resizeShape";case n.MoveShape:return"moveShape"}}},{key:"_getRequestEditOperationEventArgs",value:function(t,e){var n=(0,d.getDiagram)(),o=n.DiagramModelOperation,i=n.ConnectorPosition,r={operation:this._getModelOperation(t),allowed:e.allowed,updateUI:e.updateUI};switch(t){case o.AddShape:r.args={shape:e.shape&&this._nativeItemToDiagramItem(e.shape),position:e.position&&{x:e.position.x,y:e.position.y}};break;case o.AddShapeFromToolbox:r.args={shapeType:e.shapeType};break;case o.DeleteShape:r.args={shape:e.shape&&this._nativeItemToDiagramItem(e.shape)};break;case o.DeleteConnector:r.args={connector:e.connector&&this._nativeItemToDiagramItem(e.connector)};break;case o.ChangeConnection:r.args={newShape:e.shape&&this._nativeItemToDiagramItem(e.shape),oldShape:e.oldShape&&this._nativeItemToDiagramItem(e.oldShape),connector:e.connector&&this._nativeItemToDiagramItem(e.connector),connectionPointIndex:e.connectionPointIndex,connectorPosition:e.position===i.Begin?"start":"end"};break;case o.ChangeConnectorPoints:r.args={connector:e.connector&&this._nativeItemToDiagramItem(e.connector),newPoints:e.points&&e.points.map((function(t){return{x:t.x,y:t.y}})),oldPoints:e.oldPoints&&e.oldPoints.map((function(t){return{x:t.x,y:t.y}}))};break;case o.BeforeChangeShapeText:r.args={shape:e.shape&&this._nativeItemToDiagramItem(e.shape)};break;case o.ChangeShapeText:r.args={shape:e.shape&&this._nativeItemToDiagramItem(e.shape),text:e.text};break;case o.BeforeChangeConnectorText:r.args={connector:e.connector&&this._nativeItemToDiagramItem(e.connector),index:e.index};break;case o.ChangeConnectorText:r.args={connector:e.connector&&this._nativeItemToDiagramItem(e.connector),index:e.index,text:e.text};break;case o.ResizeShape:r.args={shape:e.shape&&this._nativeItemToDiagramItem(e.shape),newSize:e.size&&{width:e.size.width,height:e.size.height},oldSize:e.oldSize&&{width:e.oldSize.width,height:e.oldSize.height}};break;case o.MoveShape:r.args={shape:e.shape&&this._nativeItemToDiagramItem(e.shape),newPosition:e.position&&{x:e.position.x,y:e.position.y},oldPosition:e.oldPosition&&{x:e.oldPosition.x,y:e.oldPosition.y}}}return r}},{key:"_nativeItemToDiagramItem",value:function(t){var e=(0,d.getDiagram)(),n=e.NativeShape,o=t instanceof n?this._nativeShapeToDiagramShape.bind(this):this._nativeConnectorToDiagramConnector.bind(this);return(0,c.extend)({id:t.id,key:t.key,dataItem:void 0},o(t))}},{key:"_nativeShapeToDiagramShape",value:function(t){return{dataItem:this._nodesOption&&this._nodesOption.findItem(t.key),itemType:"shape",text:t.text,type:t.type,position:{x:t.position.x,y:t.position.y},size:{width:t.size.width,height:t.size.height},attachedConnectorIds:t.attachedConnectorIds}}},{key:"_nativeConnectorToDiagramConnector",value:function(t){return{dataItem:this._edgesOption&&this._edgesOption.findItem(t.key),itemType:"connector",texts:t.texts,fromKey:t.fromKey,toKey:t.toKey,fromId:t.fromId,fromPointIndex:t.fromPointIndex,toId:t.toId,toPointIndex:t.toPointIndex,points:t.points.map((function(t){return{x:t.x,y:t.y}}))}}},{key:"getItemByKey",value:function(t){var e=this._diagramInstance&&this._diagramInstance.getNativeItemByDataKey(t);return e&&this._nativeItemToDiagramItem(e)}},{key:"getItemById",value:function(t){var e=this._diagramInstance&&this._diagramInstance.getNativeItemByKey(t);return e&&this._nativeItemToDiagramItem(e)}},{key:"_invalidateContextMenuCommands",value:function(){this._contextMenu&&this._contextMenu.option({commands:this.option("contextMenu.commands")})}},{key:"_invalidatePropertiesPanelTabs",value:function(){this._propertiesPanel&&this._propertiesPanel.option({propertyTabs:this.option("propertiesPanel.tabs")})}},{key:"_invalidateMainToolbarCommands",value:function(){this._mainToolbar&&this._mainToolbar.option({commands:this.option("mainToolbar.commands")})}},{key:"_invalidateHistoryToolbarCommands",value:function(){this._historyToolbar&&this._historyToolbar.option({commands:this.option("historyToolbar.commands")})}},{key:"_invalidateViewToolbarCommands",value:function(){this._viewToolbar&&this._viewToolbar.option({commands:this.option("viewToolbar.commands")})}},{key:"_invalidateToolboxGroups",value:function(){this._toolbox&&this._toolbox.option({toolboxGroups:this._getToolboxGroups()})}},{key:"_optionChanged",value:function(t){if(!this.optionsUpdateBar.isUpdateLocked()){this.optionsUpdateBar.beginUpdate();try{this._optionChangedCore(t)}finally{this.optionsUpdateBar.endUpdate()}}}},{key:"_optionChangedCore",value:function(t){var e=this;switch(t.name){case"readOnly":case"disabled":this._updateReadOnlyState(),this._invalidate();break;case"zoomLevel":"zoomLevel"!==t.fullName&&"zoomLevel.items"!==t.fullName||this._updateZoomLevelItemsState(),"zoomLevel"!==t.fullName&&"zoomLevel.value"!==t.fullName||this._updateZoomLevelState();break;case"autoZoomMode":this._updateAutoZoomState();break;case"simpleView":this._updateSimpleViewState();break;case"fullScreen":this._updateFullscreenState();break;case"showGrid":this._updateShowGridState();break;case"snapToGrid":this._updateSnapToGridState();break;case"gridSize":"gridSize"!==t.fullName&&"gridSize.items"!==t.fullName||this._updateGridSizeItemsState(),"gridSize"!==t.fullName&&"gridSize.value"!==t.fullName||this._updateGridSizeState();break;case"viewUnits":this._updateViewUnitsState();break;case"units":this._updateUnitsState();break;case"pageSize":"pageSize"!==t.fullName&&"pageSize.items"!==t.fullName||this._updatePageSizeItemsState(),"pageSize"!==t.fullName&&"pageSize.width"!==t.fullName&&"pageSize.height"!==t.fullName||this._updatePageSizeState();break;case"pageOrientation":this._updatePageOrientationState();break;case"pageColor":this._updatePageColorState();break;case"nodes":"nodes.autoLayout"===t.fullName?this._refreshDataSources():this._refreshNodesDataSource();break;case"edges":this._refreshEdgesDataSource();break;case"customShapes":this._updateCustomShapes(t.value,t.previousValue),this._invalidate();break;case"contextMenu":"contextMenu.commands"===t.fullName?this._invalidateContextMenuCommands():this._invalidate();break;case"contextToolbox":this._invalidate();break;case"propertiesPanel":"propertiesPanel.tabs"===t.name?this._invalidatePropertiesPanelTabs():this._invalidate();break;case"toolbox":"toolbox.groups"===t.fullName?this._invalidateToolboxGroups():this._invalidate();break;case"mainToolbar":"mainToolbar.commands"===t.fullName?this._invalidateMainToolbarCommands():this._invalidate();break;case"historyToolbar":"historyToolbar.commands"===t.fullName?this._invalidateHistoryToolbarCommands():this._invalidate();break;case"viewToolbar":"viewToolbar.commands"===t.fullName?this._invalidateViewToolbarCommands():this._invalidate();break;case"onItemClick":this._createItemClickAction();break;case"onItemDblClick":this._createItemDblClickAction();break;case"onSelectionChanged":this._createSelectionChangedAction();break;case"onRequestEditOperation":this._createRequestEditOperationAction();break;case"onRequestLayoutUpdate":this._createRequestLayoutUpdateAction();break;case"onCustomCommand":this._createCustomCommand();break;case"defaultItemProperties":this._updateDefaultItemProperties();break;case"editing":this._updateEditingSettings();break;case"export":this._toolbars.forEach((function(t){t.option("export",e.option("export"))})),this._contextMenu&&this._contextMenu.option("export",this.option("export"));break;case"hasChanges":break;default:W(Q(n.prototype),"_optionChanged",this).call(this,t)}}}]),n}(r.default);(0,s.default)("dxDiagram",It);var Tt=It;e.default=Tt,t.exports=e.default},"2eae":function(t,e,n){"use strict";e.default=void 0;var o=i(n("1be3"));function i(t){return t&&t.__esModule?t:{default:t}}var r=o.default;e.default=r,t.exports=e.default,t.exports.default=t.exports},"3afe":function(t,e,n){"use strict";e.default=void 0;var o=n("4ff6");function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function a(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var s=function(){function t(e){i(this,t);var n=(0,o.getDiagram)(),r=n.EventDispatcher;this.onChanged=new r,this._owner=e}return a(t,[{key:"raiseBarCommandExecuted",value:function(t,e){this.onChanged.raise("notifyBarCommandExecuted",parseInt(t),e)}},{key:"getCommandKeys",value:function(){throw"Not Implemented"}},{key:"setItemValue",value:function(t,e){}},{key:"setItemEnabled",value:function(t,e){}},{key:"setItemVisible",value:function(t,e){}},{key:"setEnabled",value:function(t){}},{key:"setItemSubItems",value:function(t,e){}},{key:"isVisible",value:function(){return!0}},{key:"_getKeys",value:function(t){var e=this,n=t.reduce((function(t,n){return void 0!==n.command&&t.push(n.command),n.items&&(t=t.concat(e._getKeys(n.items))),t}),[]);return n}}]),t}(),c=s;e.default=c,t.exports=e.default},"48a3":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=c(n("14a3")),r=c(n("cc156")),a=c(n("367c")),s=n("4ff6");function c(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function p(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function h(t,e,n){return h="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=d(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function d(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=_(t),null===t)break;return t}function f(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function g(t){var e=C();return function(){var n,o=_(t);if(e){var i=_(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?v(t):e}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var P=function(t){f(n,t);var e=g(n);function n(){return u(this,n),e.apply(this,arguments)}return p(n,[{key:"_init",value:function(){h(_(n.prototype),"_init",this).call(this);var t=(0,s.getDiagram)(),e=t.EventDispatcher;this.onScroll=new e,this._createOnCreateDiagramAction()}},{key:"_initMarkup",value:function(){var t=this;h(_(n.prototype),"_initMarkup",this).call(this);var e=(0,i.default)("<div>").appendTo(this.$element());this._scrollView=this._createComponent(e,a.default,{direction:"both",bounceEnabled:!1,onScroll:function(e){var n=e.scrollOffset;t._raiseOnScroll(n.left,n.top)}}),this._onCreateDiagramAction({$parent:(0,i.default)(this._scrollView.content()),scrollView:this})}},{key:"setScroll",value:function(t,e){this._scrollView.scrollTo({left:t,top:e}),this._raiseOnScrollWithoutPoint()}},{key:"offsetScroll",value:function(t,e){this._scrollView.scrollBy({left:t,top:e}),this._raiseOnScrollWithoutPoint()}},{key:"getSize",value:function(){var t=(0,s.getDiagram)(),e=t.Size,n=this._scrollView.$element();return new e(Math.floor(n.width()),Math.floor(n.height()))}},{key:"getScrollContainer",value:function(){return this._scrollView.$element()[0]}},{key:"getScrollBarWidth",value:function(){return 0}},{key:"detachEvents",value:function(){}},{key:"_raiseOnScroll",value:function(t,e){var n=(0,s.getDiagram)(),o=n.Point;this.onScroll.raise("notifyScrollChanged",(function(){return new o(t,e)}))}},{key:"_raiseOnScrollWithoutPoint",value:function(){var t=this,e=(0,s.getDiagram)(),n=e.Point;this.onScroll.raise("notifyScrollChanged",(function(){return new n(t._scrollView.scrollLeft(),t._scrollView.scrollTop())}))}},{key:"_createOnCreateDiagramAction",value:function(){this._onCreateDiagramAction=this._createActionByOption("onCreateDiagram")}},{key:"_optionChanged",value:function(t){switch(t.name){case"onCreateDiagram":this._createOnCreateDiagramAction();break;default:h(_(n.prototype),"_optionChanged",this).call(this,t)}}}]),n}(r.default),S=P;e.default=S,t.exports=e.default},"4ff6":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.getDiagram=u;var i=c(n("0fc0")),r=s(n("e0d5"));function a(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!==typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var s=i?Object.getOwnPropertyDescriptor(t,r):null;s&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function c(t){return t&&t.__esModule?t:{default:t}}function u(){if(!r.default)throw i.default.Error("E1041","devexpress-diagram");return r}},"5ef7":function(t,e,n){"use strict";e.default=void 0;var o=r(n("14a3")),i=n("0814");function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}var s="dx-diagram-contextmenu",c={getContextMenuItemTemplate:function(t,e,n,r){var a=(0,o.default)(r);a.empty();var s=void 0!==e.rootCommand?e.rootCommand:-1;if(e.icon&&!e.checked){var c=(0,i.getImageContainer)(e.icon);a.append(c)}else if(t._menuHasCheckedItems&&!0===t._menuHasCheckedItems[s]){var u=(0,i.getImageContainer)("check");u.css("visibility",e.checked?"visible":"hidden"),a.append(u)}a.append('<span class="dx-menu-item-text">'+e.text+"</span>"),Array.isArray(e.items)&&e.items.length>0&&a.append('<span class="dx-menu-item-popout-container"><div class="dx-menu-item-popout"></div></span>')},getContextMenuCssClass:function(){return s},onContextMenuItemClick:function(t,e,n){if(void 0===e.command&&void 0===e.name||Array.isArray(e.items)&&e.items.length){if(void 0!==e.rootCommand&&void 0!==e.value){var o=c.getItemCommandParameter(t,e,e.value);n.call(this,e.rootCommand,void 0,o)}}else{var i=c.getItemCommandParameter(t,e);n.call(this,e.command,e.name,i)}},getItemValue:function(t){return"object"===a(t.value)?JSON.stringify(t.value):t.value},getItemOptionText:function(t,e){if(t){e=e.slice();var n=this._getParentItemOptionText(e);t&&t._originalItemsInfo&&t._originalItemsInfo[n]&&(e[e.length-1]+=t._originalItemsInfo[n].indexPathCorrection)}return this._getItemOptionTextCore(e)},_getParentItemOptionText:function(t){var e=t.slice(0,t.length-1);return this._getItemOptionTextCore(e)},_getItemOptionTextCore:function(t){return t.reduce((function(t,e){return t+"items[".concat(e,"].")}),"")},getItemCommandParameter:function(t,e,n){return e.getParameter?e.getParameter(t):n},updateContextMenuItems:function(t,e,n,o){var i=this;t._originalItemsInfo||(t._originalItemsInfo={}),t._originalItemsInfo[e]||(t._originalItemsInfo[e]={items:t.option(e+"items")||[]}),o=o.map((function(e){return{value:i.getItemValue(e),text:e.text,checked:e.checked,widget:t,rootCommand:n}}));var r=t._originalItemsInfo[e].items;t.option(e+"items",o.concat(r)),t._originalItemsInfo[e]&&r.length&&(t._originalItemsInfo[e].indexPathCorrection=o.length)},updateContextMenuItemVisible:function(t,e,n){t.option(e+"visible",n)},updateContextMenuItemValue:function(t,e,n,o){var i=t.option(e+"items");"boolean"!==typeof o||i&&i.length?void 0!==o&&(this._setContextMenuHasCheckedItems(t,n),Array.isArray(i)&&i.forEach((function(t,e){t.checked=t.value===o}))):(this._setContextMenuHasCheckedItems(t,-1),t.option(e+"checked",o))},_setContextMenuHasCheckedItems:function(t,e){t._menuHasCheckedItems||(t._menuHasCheckedItems={}),t._menuHasCheckedItems[e]=!0}},u=c;e.default=u,t.exports=e.default},6571:function(t,e,n){"use strict";e.default=void 0;var o=n("4ff6"),i=n("c6e7"),r=n("b62d"),a=n("706b"),s=n("d4b2"),c=u(n("8a64"));function u(t){return t&&t.__esModule?t:{default:t}}var l="separator",p={widget:l},h={SMALL_EDITOR_ITEM:"dx-diagram-sm-edit-item",MEDIUM_EDITOR_ITEM:"dx-diagram-md-edit-item",LARGE_EDITOR_ITEM:"dx-diagram-lg-edit-item",IMAGE_DROPDOWN_ITEM:"dx-diagram-image-dropdown-item",COLOR_EDITOR_ITEM:"dx-diagram-color-edit-item",LARGE_ICON_ITEM:"dx-diagram-lg-icon-item"},d={SHOW_TOOLBOX_COMMAND_NAME:"toolbox",SHOW_PROPERTIES_PANEL_COMMAND_NAME:"propertiesPanel",getAllCommands:function(){var t=this,e=(0,o.getDiagram)(),n=e.DiagramCommand;return this._allCommands||(this._allCommands={separator:p,exportSvg:{command:n.ExportSvg,text:c.default.format("dxDiagram-commandExportToSvg"),getParameter:function(e){return function(n){return t._exportTo(e,n,"SVG","image/svg+xml")}}},exportPng:{command:n.ExportPng,text:c.default.format("dxDiagram-commandExportToPng"),getParameter:function(e){return function(n){return t._exportTo(e,n,"PNG","image/png")}}},exportJpg:{command:n.ExportJpg,text:c.default.format("dxDiagram-commandExportToJpg"),getParameter:function(e){return function(n){return t._exportTo(e,n,"JPEG","image/jpeg")}}},undo:{command:n.Undo,hint:c.default.format("dxDiagram-commandUndo"),text:c.default.format("dxDiagram-commandUndo"),icon:"undo",menuIcon:"undo"},redo:{command:n.Redo,hint:c.default.format("dxDiagram-commandRedo"),text:c.default.format("dxDiagram-commandRedo"),icon:"redo",menuIcon:"redo"},cut:{command:n.Cut,hint:c.default.format("dxDiagram-commandCut"),text:c.default.format("dxDiagram-commandCut"),icon:"cut",menuIcon:"cut"},copy:{command:n.Copy,hint:c.default.format("dxDiagram-commandCopy"),text:c.default.format("dxDiagram-commandCopy"),icon:"copy",menuIcon:"copy"},paste:{command:n.PasteInPosition,hint:c.default.format("dxDiagram-commandPaste"),text:c.default.format("dxDiagram-commandPaste"),icon:"paste",menuIcon:"paste"},selectAll:{command:n.SelectAll,hint:c.default.format("dxDiagram-commandSelectAll"),text:c.default.format("dxDiagram-commandSelectAll"),icon:"dx-diagram-i-button-select-all dx-diagram-i",menuIcon:"dx-diagram-i-menu-select-all dx-diagram-i"},delete:{command:n.Delete,hint:c.default.format("dxDiagram-commandDelete"),text:c.default.format("dxDiagram-commandDelete"),icon:"remove",menuIcon:"remove"},fontName:{command:n.FontName,hint:c.default.format("dxDiagram-commandFontName"),text:c.default.format("dxDiagram-commandFontName"),widget:"dxSelectBox",items:["Arial","Arial Black","Helvetica","Times New Roman","Courier New","Courier","Verdana","Georgia","Comic Sans MS","Trebuchet MS"].map((function(t){return{text:t,value:t}})),cssClass:h.MEDIUM_EDITOR_ITEM},fontSize:{command:n.FontSize,hint:c.default.format("dxDiagram-commandFontSize"),text:c.default.format("dxDiagram-commandFontSize"),widget:"dxSelectBox",items:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72].map((function(t){return{text:t+"pt",value:t+"pt"}})),cssClass:h.SMALL_EDITOR_ITEM},bold:{command:n.Bold,hint:c.default.format("dxDiagram-commandBold"),text:c.default.format("dxDiagram-commandBold"),icon:"bold",menuIcon:"bold"},italic:{command:n.Italic,hint:c.default.format("dxDiagram-commandItalic"),text:c.default.format("dxDiagram-commandItalic"),icon:"italic",menuIcon:"italic"},underline:{command:n.Underline,hint:c.default.format("dxDiagram-commandUnderline"),text:c.default.format("dxDiagram-commandUnderline"),icon:"underline",menuIcon:"underline"},fontColor:{command:n.FontColor,text:c.default.format("dxDiagram-commandTextColor"),hint:c.default.format("dxDiagram-commandTextColor"),widget:"dxColorBox",icon:"dx-icon dx-icon-color",menuIcon:"dx-icon dx-icon-color",cssClass:h.COLOR_EDITOR_ITEM},lineColor:{command:n.StrokeColor,text:c.default.format("dxDiagram-commandLineColor"),hint:c.default.format("dxDiagram-commandLineColor"),widget:"dxColorBox",icon:"dx-icon dx-icon-background",menuIcon:"dx-icon dx-icon-background",cssClass:h.COLOR_EDITOR_ITEM},lineWidth:{command:n.StrokeWidth,text:c.default.format("dxDiagram-commandLineWidth"),hint:c.default.format("dxDiagram-commandLineWidth"),widget:"dxSelectBox",items:[1,2,3,4,5,6,7,8].map((function(t){return{text:t+"px",value:t.toString()}})),cssClass:h.SMALL_EDITOR_ITEM},lineStyle:{command:n.StrokeStyle,text:c.default.format("dxDiagram-commandLineStyle"),hint:c.default.format("dxDiagram-commandLineStyle"),widget:"dxSelectBox",items:[{value:"",menuIcon:"dx-diagram-i-line-solid dx-diagram-i",hint:c.default.format("dxDiagram-commandLineStyleSolid")},{value:"2,2",menuIcon:"dx-diagram-i-line-dotted dx-diagram-i",hint:c.default.format("dxDiagram-commandLineStyleDotted")},{value:"6,2",menuIcon:"dx-diagram-i-line-dashed dx-diagram-i",hint:c.default.format("dxDiagram-commandLineStyleDashed")}],cssClass:h.IMAGE_DROPDOWN_ITEM},fillColor:{command:n.FillColor,text:c.default.format("dxDiagram-commandFillColor"),hint:c.default.format("dxDiagram-commandFillColor"),widget:"dxColorBox",icon:"dx-diagram-i dx-diagram-i-button-fill",menuIcon:"dx-diagram-i dx-diagram-i-menu-fill",cssClass:h.COLOR_EDITOR_ITEM},textAlignLeft:{command:n.TextLeftAlign,hint:c.default.format("dxDiagram-commandAlignLeft"),text:c.default.format("dxDiagram-commandAlignLeft"),icon:"alignleft",menuIcon:"alignleft"},textAlignCenter:{command:n.TextCenterAlign,hint:c.default.format("dxDiagram-commandAlignCenter"),text:c.default.format("dxDiagram-commandAlignCenter"),icon:"aligncenter",menuIcon:"aligncenter"},textAlignRight:{command:n.TextRightAlign,hint:c.default.format("dxDiagram-commandAlignRight"),text:c.default.format("dxDiagram-commandAlignRight"),icon:"alignright",menu:"alignright"},lock:{command:n.Lock,hint:c.default.format("dxDiagram-commandLock"),text:c.default.format("dxDiagram-commandLock"),icon:"dx-diagram-i-button-lock dx-diagram-i",menuIcon:"dx-diagram-i-menu-lock dx-diagram-i"},unlock:{command:n.Unlock,hint:c.default.format("dxDiagram-commandUnlock"),text:c.default.format("dxDiagram-commandUnlock"),icon:"dx-diagram-i-button-unlock dx-diagram-i",menuIcon:"dx-diagram-i-menu-unlock dx-diagram-i"},bringToFront:{command:n.BringToFront,hint:c.default.format("dxDiagram-commandBringToFront"),text:c.default.format("dxDiagram-commandBringToFront"),icon:"dx-diagram-i-button-bring-to-front dx-diagram-i",menuIcon:"dx-diagram-i-menu-bring-to-front dx-diagram-i"},sendToBack:{command:n.SendToBack,hint:c.default.format("dxDiagram-commandSendToBack"),text:c.default.format("dxDiagram-commandSendToBack"),icon:"dx-diagram-i-button-send-to-back dx-diagram-i",menuIcon:"dx-diagram-i-menu-send-to-back dx-diagram-i"},insertShapeImage:{command:n.InsertShapeImage,text:c.default.format("dxDiagram-commandInsertShapeImage"),icon:"dx-diagram-i-button-image-insert dx-diagram-i",menuIcon:"dx-diagram-i-menu-image-insert dx-diagram-i"},editShapeImage:{command:n.EditShapeImage,text:c.default.format("dxDiagram-commandEditShapeImage"),icon:"dx-diagram-i-button-image-edit dx-diagram-i",menuIcon:"dx-diagram-i-menu-image-edit dx-diagram-i"},deleteShapeImage:{command:n.DeleteShapeImage,text:c.default.format("dxDiagram-commandDeleteShapeImage"),icon:"dx-diagram-i-button-image-delete dx-diagram-i",menuIcon:"dx-diagram-i-menu-image-delete dx-diagram-i"},connectorLineType:{command:n.ConnectorLineOption,widget:"dxSelectBox",hint:c.default.format("dxDiagram-commandConnectorLineType"),items:[{value:0,menuIcon:"dx-diagram-i-connector-straight dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineStraight")},{value:1,menuIcon:"dx-diagram-i-connector-orthogonal dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineOrthogonal")}],cssClass:h.IMAGE_DROPDOWN_ITEM},connectorLineStart:{command:n.ConnectorStartLineEnding,widget:"dxSelectBox",items:[{value:0,menuIcon:"dx-diagram-i-connector-begin-none dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineNone")},{value:1,menuIcon:"dx-diagram-i-connector-begin-arrow dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineArrow")},{value:2,menuIcon:"dx-diagram-i-connector-begin-outlined-triangle dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineArrow")},{value:3,menuIcon:"dx-diagram-i-connector-begin-filled-triangle dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineArrow")}],hint:c.default.format("dxDiagram-commandConnectorLineStart"),cssClass:h.IMAGE_DROPDOWN_ITEM},connectorLineEnd:{command:n.ConnectorEndLineEnding,widget:"dxSelectBox",items:[{value:0,menuIcon:"dx-diagram-i-connector-end-none dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineNone")},{value:1,menuIcon:"dx-diagram-i-connector-end-arrow dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineArrow")},{value:2,menuIcon:"dx-diagram-i-connector-end-outlined-triangle dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineArrow")},{value:3,menuIcon:"dx-diagram-i-connector-end-filled-triangle dx-diagram-i",hint:c.default.format("dxDiagram-commandConnectorLineArrow")}],hint:c.default.format("dxDiagram-commandConnectorLineEnd"),cssClass:h.IMAGE_DROPDOWN_ITEM},layoutTreeTopToBottom:{command:n.AutoLayoutTreeVertical,text:c.default.format("dxDiagram-commandLayoutTopToBottom"),hint:c.default.format("dxDiagram-commandLayoutTopToBottom"),icon:"dx-diagram-i-button-layout-tree-tb dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutTreeBottomToTop:{command:n.AutoLayoutTreeVerticalBottomToTop,text:c.default.format("dxDiagram-commandLayoutBottomToTop"),hint:c.default.format("dxDiagram-commandLayoutBottomToTop"),icon:"dx-diagram-i-button-layout-tree-bt dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutTreeLeftToRight:{command:n.AutoLayoutTreeHorizontal,text:c.default.format("dxDiagram-commandLayoutLeftToRight"),hint:c.default.format("dxDiagram-commandLayoutLeftToRight"),icon:"dx-diagram-i-button-layout-tree-lr dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutTreeRightToLeft:{command:n.AutoLayoutTreeHorizontalRightToLeft,text:c.default.format("dxDiagram-commandLayoutRightToLeft"),hint:c.default.format("dxDiagram-commandLayoutRightToLeft"),icon:"dx-diagram-i-button-layout-tree-rl dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutLayeredTopToBottom:{command:n.AutoLayoutLayeredVertical,text:c.default.format("dxDiagram-commandLayoutTopToBottom"),hint:c.default.format("dxDiagram-commandLayoutTopToBottom"),icon:"dx-diagram-i-button-layout-layered-tb dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutLayeredBottomToTop:{command:n.AutoLayoutLayeredVerticalBottomToTop,text:c.default.format("dxDiagram-commandLayoutBottomToTop"),hint:c.default.format("dxDiagram-commandLayoutBottomToTop"),icon:"dx-diagram-i-button-layout-layered-bt dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutLayeredLeftToRight:{command:n.AutoLayoutLayeredHorizontal,text:c.default.format("dxDiagram-commandLayoutLeftToRight"),hint:c.default.format("dxDiagram-commandLayoutLeftToRight"),icon:"dx-diagram-i-button-layout-layered-lr dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},layoutLayeredRightToLeft:{command:n.AutoLayoutLayeredHorizontalRightToLeft,text:c.default.format("dxDiagram-commandLayoutRightToLeft"),hint:c.default.format("dxDiagram-commandLayoutRightToLeft"),icon:"dx-diagram-i-button-layout-layered-rl dx-diagram-i",cssClass:h.LARGE_ICON_ITEM},fullScreen:{command:n.Fullscreen,hint:c.default.format("dxDiagram-commandFullscreen"),text:c.default.format("dxDiagram-commandFullscreen"),icon:"dx-diagram-i dx-diagram-i-button-fullscreen",menuIcon:"dx-diagram-i dx-diagram-i-menu-fullscreen",cssClass:h.COLOR_EDITOR_ITEM},units:{command:n.ViewUnits,hint:c.default.format("dxDiagram-commandUnits"),text:c.default.format("dxDiagram-commandUnits"),widget:"dxSelectBox"},simpleView:{command:n.ToggleSimpleView,hint:c.default.format("dxDiagram-commandSimpleView"),text:c.default.format("dxDiagram-commandSimpleView"),widget:"dxCheckBox"},showGrid:{command:n.ShowGrid,hint:c.default.format("dxDiagram-commandShowGrid"),text:c.default.format("dxDiagram-commandShowGrid"),widget:"dxCheckBox"},snapToGrid:{command:n.SnapToGrid,hint:c.default.format("dxDiagram-commandSnapToGrid"),text:c.default.format("dxDiagram-commandSnapToGrid"),widget:"dxCheckBox"},gridSize:{command:n.GridSize,hint:c.default.format("dxDiagram-commandGridSize"),text:c.default.format("dxDiagram-commandGridSize"),widget:"dxSelectBox"},pageSize:{command:n.PageSize,hint:c.default.format("dxDiagram-commandPageSize"),text:c.default.format("dxDiagram-commandPageSize"),widget:"dxSelectBox",cssClass:h.LARGE_EDITOR_ITEM,getCommandValue:function(t){return JSON.parse(t)},getEditorValue:function(t){return JSON.stringify(t)}},pageOrientation:{command:n.PageLandscape,hint:c.default.format("dxDiagram-commandPageOrientation"),text:c.default.format("dxDiagram-commandPageOrientation"),widget:"dxSelectBox",items:[{value:!0,text:c.default.format("dxDiagram-commandPageOrientationLandscape")},{value:!1,text:c.default.format("dxDiagram-commandPageOrientationPortrait")}],cssClass:h.MEDIUM_EDITOR_ITEM},pageColor:{command:n.PageColor,hint:c.default.format("dxDiagram-commandPageColor"),text:c.default.format("dxDiagram-commandPageColor"),widget:"dxColorBox",icon:"dx-diagram-i dx-diagram-i-button-fill",menuIcon:"dx-diagram-i dx-diagram-i-menu-fill",cssClass:h.COLOR_EDITOR_ITEM},zoomLevel:{command:n.ZoomLevel,hint:c.default.format("dxDiagram-commandZoomLevel"),text:c.default.format("dxDiagram-commandZoomLevel"),widget:"dxTextBox",items:[p,{command:n.FitToScreen,hint:c.default.format("dxDiagram-commandFitToContent"),text:c.default.format("dxDiagram-commandFitToContent")},{command:n.FitToWidth,hint:c.default.format("dxDiagram-commandFitToWidth"),text:c.default.format("dxDiagram-commandFitToWidth")},p,{command:n.AutoZoomToContent,hint:c.default.format("dxDiagram-commandAutoZoomByContent"),text:c.default.format("dxDiagram-commandAutoZoomByContent")},{command:n.AutoZoomToWidth,hint:c.default.format("dxDiagram-commandAutoZoomByWidth"),text:c.default.format("dxDiagram-commandAutoZoomByWidth")}],getEditorDisplayValue:function(t){return Math.round(100*t)+"%"},cssClass:h.SMALL_EDITOR_ITEM},toolbox:{command:this.SHOW_TOOLBOX_COMMAND_NAME,iconChecked:"dx-diagram-i dx-diagram-i-button-toolbox-close",iconUnchecked:"dx-diagram-i dx-diagram-i-button-toolbox-open",hint:c.default.format("dxDiagram-uiShowToolbox"),text:c.default.format("dxDiagram-uiShowToolbox")},propertiesPanel:{command:this.SHOW_PROPERTIES_PANEL_COMMAND_NAME,iconChecked:"close",iconUnchecked:"dx-diagram-i dx-diagram-i-button-properties-panel-open",hint:c.default.format("dxDiagram-uiProperties"),text:c.default.format("dxDiagram-uiProperties")}})},getMainToolbarCommands:function(t,e){var n=this.getAllCommands(),o=t?this._getPreparedCommands(n,t):this._getDefaultMainToolbarCommands(n);return this._prepareToolbarCommands(o,e)},_getDefaultMainToolbarCommands:function(t){return this._defaultMainToolbarCommands||(this._defaultMainToolbarCommands=[t.undo,t.redo,t.separator,t.fontName,t.fontSize,t.bold,t.italic,t.underline,t.separator,t.lineWidth,t.lineStyle,t.separator,t.fontColor,t.lineColor,t.fillColor,t.separator,t.textAlignLeft,t.textAlignCenter,t.textAlignRight,t.separator,t.connectorLineType,t.connectorLineStart,t.connectorLineEnd,t.separator,{text:c.default.format("dxDiagram-uiLayout"),showText:"always",items:[{text:c.default.format("dxDiagram-uiLayoutTree"),items:[t.layoutTreeTopToBottom,t.layoutTreeBottomToTop,t.layoutTreeLeftToRight,t.layoutTreeRightToLeft]},{text:c.default.format("dxDiagram-uiLayoutLayered"),items:[t.layoutLayeredTopToBottom,t.layoutLayeredBottomToTop,t.layoutLayeredLeftToRight,t.layoutLayeredRightToLeft]}]}])},getHistoryToolbarCommands:function(t,e){var n=this.getAllCommands(),o=t?this._getPreparedCommands(n,t):this._getDefaultHistoryToolbarCommands(n);return this._prepareToolbarCommands(o,e)},_getDefaultHistoryToolbarCommands:function(t){return this._defaultHistoryToolbarCommands||(this._defaultHistoryToolbarCommands=[t.undo,t.redo,t.separator,t.toolbox])},getViewToolbarCommands:function(t,e){var n=this.getAllCommands(),o=t?this._getPreparedCommands(n,t):this._getDefaultViewToolbarCommands(n);return this._prepareToolbarCommands(o,e)},_getDefaultViewToolbarCommands:function(t){return this._defaultViewToolbarCommands||(this._defaultViewToolbarCommands=[t.zoomLevel,t.separator,t.fullScreen,t.separator,{widget:"dxButton",icon:"export",text:c.default.format("dxDiagram-uiExport"),hint:c.default.format("dxDiagram-uiExport"),items:[t.exportSvg,t.exportPng,t.exportJpg]},{icon:"preferences",hint:c.default.format("dxDiagram-uiSettings"),text:c.default.format("dxDiagram-uiSettings"),items:[t.units,t.separator,t.showGrid,t.snapToGrid,t.gridSize,t.separator,t.simpleView,t.toolbox]}])},getPropertiesToolbarCommands:function(t,e){var n=this.getAllCommands(),o=t?this._getPreparedCommands(n,t):this._getDefaultPropertiesToolbarCommands(n);return this._prepareToolbarCommands(o,e)},_getDefaultPropertiesToolbarCommands:function(t){return this._defaultPropertiesToolbarCommands||(this._defaultPropertiesToolbarCommands=[t.propertiesPanel])},_getDefaultPropertyPanelCommandGroups:function(){return this._defaultPropertyPanelCommandGroups||(this._defaultPropertyPanelCommandGroups=[{title:c.default.format("dxDiagram-uiStyle"),groups:[{title:c.default.format("dxDiagram-uiText"),commands:["fontName","fontSize","bold","italic","underline","textAlignLeft","textAlignCenter","textAlignRight","fontColor"]},{title:c.default.format("dxDiagram-uiObject"),commands:["lineStyle","lineWidth","lineColor","fillColor"]},{title:c.default.format("dxDiagram-uiConnector"),commands:["connectorLineType","connectorLineStart","connectorLineEnd"]}]},{title:c.default.format("dxDiagram-uiLayout"),groups:[{title:c.default.format("dxDiagram-uiLayoutLayered"),commands:["layoutLayeredTopToBottom","layoutLayeredBottomToTop","layoutLayeredLeftToRight","layoutLayeredRightToLeft"]},{title:c.default.format("dxDiagram-uiLayoutTree"),commands:["layoutTreeTopToBottom","layoutTreeBottomToTop","layoutTreeLeftToRight","layoutTreeRightToLeft"]}]},{title:c.default.format("dxDiagram-uiDiagram"),groups:[{title:c.default.format("dxDiagram-uiPage"),commands:["pageSize","pageOrientation","pageColor"]}]}])},_preparePropertyPanelGroups:function(t){var e=this,n=this.getAllCommands(),o=[];return t.forEach((function(t){var i,r=t.commands;r&&(r=e._getPreparedCommands(n,r),r=e._prepareToolbarCommands(r)),t.groups&&(i=[],t.groups.forEach((function(t){var o=t.commands;o&&(o=e._getPreparedCommands(n,o),o=e._prepareToolbarCommands(o)),i.push({title:t.title,commands:o})}))),o.push({title:t.title,commands:r,groups:i})})),o},getPropertyPanelCommandTabs:function(t){return t=t||this._getDefaultPropertyPanelCommandGroups(),this._preparePropertyPanelGroups(t)},getContextMenuCommands:function(t){var e=this.getAllCommands(),n=t?this._getPreparedCommands(e,t):this._getDefaultContextMenuCommands(e);return this._prepareContextMenuCommands(n)},_getDefaultContextMenuCommands:function(t){return this._defaultContextMenuCommands||(this._defaultContextMenuCommands=[t.cut,t.copy,t.paste,t.delete,t.separator,t.selectAll,t.separator,t.bringToFront,t.sendToBack,t.separator,t.lock,t.unlock,t.separator,t.insertShapeImage,t.editShapeImage,t.deleteShapeImage])},_getPreparedCommands:function(t,e){var n=this;return e.map((function(e){if(t[e])return t[e];if(e.text||e.icon||e.name){var o=e.name&&t[e.name],i={command:o&&o.command,name:e.name,text:e.text||o&&o.text,hint:e.text||o&&o.hint,icon:e.icon||o&&o.icon,menuIcon:e.icon||o&&o.menuIcon,widget:o&&o.widget,cssClass:o&&o.cssClass,getParameter:o&&o.getParameter,getCommandValue:o&&o.getCommandValue,getEditorValue:o&&o.getEditorValue,getEditorDisplayValue:o&&o.getEditorDisplayValue,iconChecked:o&&o.iconChecked,iconUnchecked:o&&o.iconUnchecked};return Array.isArray(e.items)?i.items=n._getPreparedCommands(t,e.items):i.items=o&&o.items,i}})).filter((function(t){return t}))},_prepareContextMenuCommands:function(t,e,n){var o=this,i=!1;return t.map((function(t){if(o._isValidCommand(t,e)){if(t!==p){var r=o._cloneCommand(t,e);return r.icon=r.menuIcon,r.beginGroup=i,r.rootCommand=r.command?void 0:n&&n.command,i=!1,r}i=!0}})).filter((function(t){return t}))},_prepareToolbarCommands:function(t,e){var n=this;return t.map((function(t){if(n._isValidCommand(t,e))return n._cloneCommand(t,e)})).filter((function(t){return t})).filter((function(t,e,n){return(t.widget!==l||e!==n.length-1)&&t}))},_cloneCommand:function(t,e){var n=(0,s.extend)({},t);return Array.isArray(t.items)&&(n.items=this._prepareContextMenuCommands(t.items,e,n)),n},_isValidCommand:function(t,e){return e=e||[],-1===e.indexOf(t.command)},_exportTo:function(t,e,n,o){var s=(0,a.getWindow)();if(s&&s.atob&&(0,r.isFunction)(s.Blob)){var c=this._getBlobByDataURI(s,e,o),u=t.option("export");i.fileSaver.saveAs(u.fileName||"foo",n,c,u.proxyURL)}},_getBlobByDataURI:function(t,e,n){for(var o=t.atob(e.split(",")[1]),i=new Uint8Array(o.length),r=0;r<o.length;r++)i[r]=o.charCodeAt(r);return new t.Blob([i.buffer],{type:n})}},f=d;e.default=f,t.exports=e.default},6816:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=u(n("14a3")),r=u(n("cc156")),a=u(n("8a64")),s=u(n("205e")),c=n("d4b2");function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function d(t,e,n){return d="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=f(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},d(t,e,n||t)}function f(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=P(t),null===t)break;return t}function m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function y(t){var e=_();return function(){var n,o=P(t);if(e){var i=P(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?C(t):e}function C(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var S=function(t){m(n,t);var e=y(n);function n(){return l(this,n),e.apply(this,arguments)}return h(n,[{key:"_init",value:function(){d(P(n.prototype),"_init",this).call(this),this._command=void 0,this._isShown=!1,this._createOnGetContentOption(),this._createOnHiddenOption()}},{key:"_initMarkup",value:function(){d(P(n.prototype),"_initMarkup",this).call(this),this._command=this.option("command"),this._$popupElement=(0,i.default)("<div>").appendTo(this.$element()),this._popup=this._createComponent(this._$popupElement,s.default,{title:this.option("title"),maxWidth:this.option("maxWidth"),height:this.option("height"),toolbarItems:this.option("toolbarItems"),onHidden:this._onHiddenAction})}},{key:"_clean",value:function(){delete this._popup,this._$popupElement&&this._$popupElement.remove()}},{key:"_getDefaultOptions",value:function(){return(0,c.extend)(d(P(n.prototype),"_getDefaultOptions",this).call(this),{title:"",maxWidth:500,height:"auto",toolbarItems:this._getToolbarItems()})}},{key:"_getToolbarItems",value:function(){return[this._getOkToolbarItem(),this._getCancelToolbarItem()]}},{key:"_getOkToolbarItem",value:function(){return{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:a.default.format("dxDiagram-dialogButtonOK"),onClick:function(){this._command.execute(this._commandParameter),this._hide()}.bind(this)}}}},{key:"_getCancelToolbarItem",value:function(){return{widget:"dxButton",location:"after",toolbar:"bottom",options:{text:a.default.format("dxDiagram-dialogButtonCancel"),onClick:this._hide.bind(this)}}}},{key:"_optionChanged",value:function(t){switch(t.name){case"title":case"maxWidth":case"height":case"toolbarItems":this._popup.option(t.name,t.value);break;case"command":this._command=t.value;break;case"onGetContent":this._createOnGetContentOption();break;case"onHidden":this._createOnHiddenOption();break;default:d(P(n.prototype),"_optionChanged",this).call(this,t)}}},{key:"_createOnGetContentOption",value:function(){this._onGetContentAction=this._createActionByOption("onGetContent")}},{key:"_createOnHiddenOption",value:function(){this._onHiddenAction=this._createActionByOption("onHidden")}},{key:"_hide",value:function(){this._popup.hide(),this._isShown=!1}},{key:"_show",value:function(){this._popup.$content().empty().append(this._onGetContentAction()),this._popup.show(),this._isShown=!0}},{key:"isVisible",value:function(){return this._isShown}}]),n}(r.default),b=S;e.default=b,t.exports=e.default},"6d93":function(t,e){(function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=function(t){return t&&DataView.prototype.isPrototypeOf(t)},i=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};l.prototype.append=function(t,e){t=s(t),e=c(e);var n=this.map[t];this.map[t]=n?n+","+e:e},l.prototype["delete"]=function(t){delete this.map[s(t)]},l.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},l.prototype.set=function(t,e){this.map[s(t)]=c(e)},l.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},l.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),u(t)},l.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),u(t)},l.prototype.entries=function(){var t=[];return this.forEach((function(e,n){t.push([n,e])})),u(t)},e.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var r=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];C.prototype.clone=function(){return new C(this,{body:this._bodyInit})},y.call(C.prototype),y.call(S.prototype),S.prototype.clone=function(){return new S(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},S.error=function(){var t=new S(null,{status:0,statusText:""});return t.type="error",t};var a=[301,302,303,307,308];S.redirect=function(t,e){if(-1===a.indexOf(e))throw new RangeError("Invalid status code");return new S(null,{status:e,headers:{location:t}})},t.Headers=l,t.Request=C,t.Response=S,t.fetch=function(t,n){return new Promise((function(o,i){var r=new C(t,n),a=new XMLHttpRequest;a.onload=function(){var t={status:a.status,statusText:a.statusText,headers:P(a.getAllResponseHeaders()||"")};t.url="responseURL"in a?a.responseURL:t.headers.get("X-Request-URL");var e="response"in a?a.response:a.responseText;o(new S(e,t))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(r.method,r.url,!0),"include"===r.credentials?a.withCredentials=!0:"omit"===r.credentials&&(a.withCredentials=!1),"responseType"in a&&e.blob&&(a.responseType="blob"),r.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),a.send("undefined"===typeof r._bodyInit?null:r._bodyInit)}))},t.fetch.polyfill=!0}function s(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function c(t){return"string"!==typeof t&&(t=String(t)),t}function u(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(n[Symbol.iterator]=function(){return n}),n}function l(t){this.map={},t instanceof l?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function h(t){return new Promise((function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function d(t){var e=new FileReader,n=h(e);return e.readAsArrayBuffer(t),n}function f(t){var e=new FileReader,n=h(e);return e.readAsText(t),n}function m(t){for(var e=new Uint8Array(t),n=new Array(e.length),o=0;o<e.length;o++)n[o]=String.fromCharCode(e[o]);return n.join("")}function g(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"===typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&o(t))this._bodyArrayBuffer=g(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!i(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(t)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(m(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function v(t){var e=t.toUpperCase();return r.indexOf(e)>-1?e:t}function C(t,e){e=e||{};var n=e.body;if(t instanceof C){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=v(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var n=t.split("="),o=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(i))}})),e}function P(t){var e=new l,n=t.replace(/\r?\n[\t ]+/g," ");return n.split(/\r?\n/).forEach((function(t){var n=t.split(":"),o=n.shift().trim();if(o){var i=n.join(":").trim();e.append(o,i)}})),e}function S(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}})("undefined"!==typeof self?self:this)},7009:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=a(n("cc6a")),r=a(n("6571"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function l(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t){var e=m();return function(){var n,o=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var y=function(t){l(n,t);var e=h(n);function n(){return s(this,n),e.apply(this,arguments)}return u(n,[{key:"_getCommands",value:function(){return r.default.getMainToolbarCommands(this.option("commands"),this.option("excludeCommands"))}}]),n}(i.default),v=y;e.default=v,t.exports=e.default},"79ab":function(t,e,n){"use strict";e.default=void 0;var o=i(n("05bb"));function i(t){return t&&t.__esModule?t:{default:t}}var r=o.default;e.default=r,t.exports=e.default,t.exports.default=t.exports},"7e98":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=a(n("cc6a")),r=a(n("6571"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function l(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t){var e=m();return function(){var n,o=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var y=function(t){l(n,t);var e=h(n);function n(){return s(this,n),e.apply(this,arguments)}return u(n,[{key:"_getCommands",value:function(){return r.default.getPropertiesToolbarCommands()}}]),n}(i.default),v=y;e.default=v,t.exports=e.default},8177:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=a(n("cc6a")),r=a(n("6571"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function l(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t){var e=m();return function(){var n,o=g(t);if(e){var i=g(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var y=function(t){l(n,t);var e=h(n);function n(){return s(this,n),e.apply(this,arguments)}return u(n,[{key:"_getCommands",value:function(){return r.default.getViewToolbarCommands(this.option("commands"),this.option("excludeCommands"))}}]),n}(i.default),v=y;e.default=v,t.exports=e.default},"8b98":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=r(n("be1c"));function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function p(t){var e=f();return function(){var n,o=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}var g=function(t){u(n,t);var e=p(n);function n(){return a(this,n),e.apply(this,arguments)}return c(n,[{key:"_getKeyExpr",value:function(){return this._diagramWidget._createOptionGetter("edges.keyExpr")}}]),n}(i.default),y=g;e.default=y,t.exports=e.default},"8c78":function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=u(n("14a3")),r=n("d4b2"),a=n("706b"),s=u(n("205e")),c=u(n("bd32"));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function d(t,e,n){return d="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=f(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},d(t,e,n||t)}function f(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=P(t),null===t)break;return t}function m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function y(t){var e=_();return function(){var n,o=P(t);if(e){var i=P(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?C(t):e}function C(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var S="dx-diagram-mobile-popup",b=function(t){m(n,t);var e=y(n);function n(){return l(this,n),e.apply(this,arguments)}return h(n,[{key:"_init",value:function(){d(P(n.prototype),"_init",this).call(this),this._createOnVisibilityChangingAction(),this._createOnVisibilityChangedAction()}},{key:"isVisible",value:function(){return this.option("isVisible")}},{key:"isMobileView",value:function(){return this.option("isMobileView")}},{key:"_initMarkup",value:function(){d(P(n.prototype),"_initMarkup",this).call(this);var t=this.$element(),e=(0,i.default)("<div>").addClass(this._getPopupClass()).addClass(this.isMobileView()&&S).appendTo(t);this._popup=this._createComponent(e,s.default,this._getPopupOptions()),this._updatePopupVisible()}},{key:"show",value:function(){this.option("isVisible",!0)}},{key:"hide",value:function(){this.option("isVisible",!1)}},{key:"toggle",value:function(){this.option("isVisible",!this.isVisible())}},{key:"repaint",value:function(){this._popup.repaint()}},{key:"_getPopupContent",value:function(){return this._popup.content()}},{key:"_getPopupTitle",value:function(){var t=(0,i.default)(this._getPopupContent());return t.parent().find(".dx-popup-title")}},{key:"_getPointerUpElements",value:function(){return[this._getPopupContent(),this._getPopupTitle()]}},{key:"_getVerticalPaddingsAndBorders",value:function(){var t=(0,i.default)(this._getPopupContent());return t.outerHeight()-t.height()}},{key:"_getHorizontalPaddingsAndBorders",value:function(){var t=(0,i.default)(this._getPopupContent());return t.outerWidth()-t.width()}},{key:"_getPopupClass",value:function(){return""}},{key:"_getPopupWidth",value:function(){return this.option("width")||"auto"}},{key:"_getPopupMaxWidth",value:function(){return this.option("maxWidth")}},{key:"_getPopupMinWidth",value:function(){return this.option("minWidth")}},{key:"_getPopupHeight",value:function(){return this.option("height")||"auto"}},{key:"_getPopupMaxHeight",value:function(){return this.option("maxHeight")}},{key:"_getPopupMinHeight",value:function(){return this.option("minHeight")}},{key:"_getPopupPosition",value:function(){return{}}},{key:"_getPopupContainer",value:function(){return this.option("container")}},{key:"_getPopupSlideAnimationObject",value:function(t){return(0,r.extend)({type:"slide",start:function(){(0,i.default)("body").css("overflow","hidden")},complete:function(){(0,i.default)("body").css("overflow","")}},t)}},{key:"_getPopupAnimation",value:function(){return{hide:{type:"fadeOut"},show:{type:"fadeIn"}}}},{key:"_getPopupOptions",value:function(){var t=this,e=this;return{animation:(0,a.hasWindow)()?this._getPopupAnimation():null,shading:!1,showTitle:!1,focusStateEnabled:!1,container:this._getPopupContainer(),width:this._getPopupWidth(),height:this._getPopupHeight(),maxWidth:this._getPopupMaxWidth(),maxHeight:this._getPopupMaxHeight(),minWidth:this._getPopupMinWidth(),minHeight:this._getPopupMinHeight(),position:this._getPopupPosition(),onContentReady:function(){e._renderPopupContent(e._popup.content())},onShowing:function(){t._onVisibilityChangingAction({visible:!0,component:t})},onShown:function(){t.option("isVisible",!0),t._onVisibilityChangedAction({visible:!0,component:t})},onHiding:function(){t._onVisibilityChangingAction({visible:!1,component:t})},onHidden:function(){t.option("isVisible",!1),t._onVisibilityChangedAction({visible:!1,component:t})}}}},{key:"_renderPopupContent",value:function(t){}},{key:"_updatePopupVisible",value:function(){this._popup.option("visible",this.isVisible())}},{key:"_createOnVisibilityChangingAction",value:function(){this._onVisibilityChangingAction=this._createActionByOption("onVisibilityChanging")}},{key:"_createOnVisibilityChangedAction",value:function(){this._onVisibilityChangedAction=this._createActionByOption("onVisibilityChanged")}},{key:"_optionChanged",value:function(t){switch(t.name){case"onVisibilityChanging":this._createOnVisibilityChangingAction();break;case"onVisibilityChanged":this._createOnVisibilityChangedAction();break;case"container":this._popup.option("container",this._getPopupContainer());break;case"width":this._popup.option("width",this._getPopupWidth());break;case"height":this._popup.option("height",this._getPopupHeight());break;case"maxWidth":this._popup.option("maxWidth",this._getPopupMaxWidth());break;case"maxHeight":this._popup.option("maxHeight",this._getPopupMaxHeight());break;case"minWidth":this._popup.option("minWidth",this._getPopupMinWidth());break;case"minHeight":this._popup.option("minHeight",this._getPopupMinHeight());break;case"isMobileView":this._invalidate();break;case"isVisible":this._updatePopupVisible();break;default:d(P(n.prototype),"_optionChanged",this).call(this,t)}}},{key:"_getDefaultOptions",value:function(){return(0,r.extend)(d(P(n.prototype),"_getDefaultOptions",this).call(this),{isVisible:!0,isMobileView:!1,offsetX:0,offsetY:0})}}]),n}(c.default),x=b;e.default=x,t.exports=e.default},"8da7":function(t,e,n){},"90d1":function(t,e,n){"use strict";e.default=void 0;var o=u(n("14a3")),i=u(n("2dc8")),r=u(n("0fa5")),a=n("d4b2"),s=n("706b"),c=u(n("84cc"));function u(t){return t&&t.__esModule?t:{default:t}}var l="dx-trackbar",p="dx-trackbar-container",h="dx-trackbar-range",d="dx-trackbar-wrapper",f=i.default.inherit({_getDefaultOptions:function(){return(0,a.extend)(this.callBase(),{min:0,max:100,value:0})},_initMarkup:function(){this.$element().addClass(l),this._renderWrapper(),this._renderContainer(),this._renderRange(),this._renderValue(),this._setRangeStyles(),this.callBase()},_render:function(){this.callBase(),this._setRangeStyles(this._rangeStylesConfig())},_renderWrapper:function(){this._$wrapper=(0,o.default)("<div>").addClass(d).appendTo(this.$element())},_renderContainer:function(){this._$bar=(0,o.default)("<div>").addClass(p).appendTo(this._$wrapper)},_renderRange:function(){this._$range=(0,o.default)("<div>").addClass(h).appendTo(this._$bar)},_renderValue:function(){var t=this.option("value"),e=this.option("min"),n=this.option("max");if(!(e>n)){if(t<e)return this.option("value",e),void(this._currentRatio=0);if(t>n)return this.option("value",n),void(this._currentRatio=1);var o=e===n?0:(t-e)/(n-e);!this._needPreventAnimation&&this._setRangeStyles({width:100*o+"%"}),this.setAria({valuemin:this.option("min"),valuemax:n,valuenow:t}),this._currentRatio=o}},_rangeStylesConfig:function(){return{width:100*this._currentRatio+"%"}},_setRangeStyles:function(t){c.default.stop(this._$range),t?!this._needPreventAnimation&&(0,s.hasWindow)()&&c.default.animate(this._$range,{type:"custom",duration:100,to:t}):this._$range.css({width:0})},_optionChanged:function(t){switch(t.name){case"value":this._renderValue(),this.callBase(t);break;case"max":case"min":this._renderValue();break;default:this.callBase(t)}},_dispose:function(){c.default.stop(this._$range),this.callBase()}});(0,r.default)("dxTrackBar",f);var m=f;e.default=m,t.exports=e.default},a9e6:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=x(n("14a3")),r=x(n("8de2")),a=x(n("84cc")),s=n("5c27"),c=x(n("2dd1")),u=x(n("b547")),l=n("d4b2"),p=n("2809"),h=n("9703"),d=b(n("ce5d")),f=n("b62d"),m=x(n("0fa5")),g=n("1820"),y=x(n("6bfd")),v=n("b49b"),C=n("6f5b"),_=n("0814"),P=n("fbaa");function S(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return S=function(){return t},t}function b(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!==typeof t)return{default:t};var e=S();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=i?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=t[r]}return n.default=t,e&&e.set(t,n),n}function x(t){return t&&t.__esModule?t:{default:t}}var w="dx-accordion",I="dx-accordion-wrapper",T="dx-accordion-item",O="dx-accordion-item-opened",E="dx-accordion-item-closed",M="dx-accordion-item-title",D="dx-accordion-item-body",A="dx-accordion-item-title-caption",k="dxAccordionItemData",L=y.default.inherit({_activeStateUnit:"."+T,_getDefaultOptions:function(){return(0,l.extend)(this.callBase(),{hoverStateEnabled:!0,height:void 0,itemTitleTemplate:"title",onItemTitleClick:null,selectedIndex:0,collapsible:!1,multiple:!1,animationDuration:300,deferRendering:!0,selectionByClick:!0,activeStateEnabled:!0,_itemAttributes:{role:"tab"},_animationEasing:"ease"})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return"desktop"===c.default.real().deviceType&&!c.default.isSimulator()},options:{focusStateEnabled:!0}},{device:function(){return(0,P.isMaterial)()},options:{animationDuration:200,_animationEasing:"cubic-bezier(0.4, 0, 0.2, 1)"}}])},_itemElements:function(){return this._itemContainer().children(this._itemSelector())},_init:function(){this.callBase(),this.option("selectionRequired",!this.option("collapsible")),this.option("selectionMode",this.option("multiple")?"multiple":"single");var t=this.$element();t.addClass(w),this._$container=(0,i.default)("<div>").addClass(I),t.append(this._$container)},_initTemplates:function(){this.callBase(),this._templateManager.addDefaultTemplates({title:new C.BindableTemplate((function(t,e){if((0,f.isPlainObject)(e)){var n=(0,_.getImageContainer)(e.icon);n&&t.append(n),(0,f.isDefined)(e.title)&&!(0,f.isPlainObject)(e.title)&&t.append(u.default.createTextNode(e.title))}else(0,f.isDefined)(e)&&t.text(String(e));t.wrapInner((0,i.default)("<div>").addClass(A))}),["title","icon"],this.option("integrationOptions.watchMethod"))})},_initMarkup:function(){var t=this;this._deferredItems=[],this.callBase(),this.setAria({role:"tablist",multiselectable:this.option("multiple")}),(0,p.deferRender)((function(){var e=t._getSelectedItemIndices();t._renderSelection(e,[])}))},_render:function(){this.callBase(),this._updateItemHeightsWrapper(!0)},_itemDataKey:function(){return k},_itemClass:function(){return T},_itemContainer:function(){return this._$container},_itemTitles:function(){return this._itemElements().find("."+M)},_itemContents:function(){return this._itemElements().find("."+D)},_getItemData:function(t){return(0,i.default)(t).parent().data(this._itemDataKey())||this.callBase.apply(this,arguments)},_executeItemRenderAction:function(t){t.type||this.callBase.apply(this,arguments)},_itemSelectHandler:function(t){(0,i.default)(t.target).closest(this._itemContents()).length||this.callBase.apply(this,arguments)},_afterItemElementDeleted:function(t,e){this._deferredItems.splice(e.itemIndex,1),this.callBase.apply(this,arguments)},_renderItemContent:function(t){var e=this.callBase((0,l.extend)({},t,{contentClass:M,templateProperty:"titleTemplate",defaultTemplateName:this.option("itemTitleTemplate")}));this._attachItemTitleClickAction(e);var n=new v.Deferred;(0,f.isDefined)(this._deferredItems[t.index])?this._deferredItems[t.index]=n:this._deferredItems.push(n),(!this.option("deferRendering")||this._getSelectedItemIndices().indexOf(t.index)>=0)&&n.resolve(),n.done(this.callBase.bind(this,(0,l.extend)({},t,{contentClass:D,container:(0,h.getPublicElement)((0,i.default)("<div>").appendTo((0,i.default)(e).parent()))})))},_attachItemTitleClickAction:function(t){var e=(0,g.addNamespace)(s.name,this.NAME);r.default.off(t,e),r.default.on(t,e,this._itemTitleClickHandler.bind(this))},_itemTitleClickHandler:function(t){this._itemDXEventHandler(t,"onItemTitleClick")},_renderSelection:function(t,e){this._itemElements().addClass(E),this.setAria("hidden",!0,this._itemContents()),this._updateItems(t,e)},_updateSelection:function(t,e){this._updateItems(t,e),this._updateItemHeightsWrapper(!1)},_updateItems:function(t,e){var n=this,o=this._itemElements();d.each(t,(function(t,e){n._deferredItems[e].resolve();var i=o.eq(e).addClass(O).removeClass(E);n.setAria("hidden",!1,i.find("."+D))})),d.each(e,(function(t,e){var i=o.eq(e).removeClass(O);n.setAria("hidden",!0,i.find("."+D))}))},_updateItemHeightsWrapper:function(t){this.option("templatesRenderAsynchronously")?this._animationTimer=setTimeout(function(){this._updateItemHeights(t)}.bind(this)):this._updateItemHeights(t)},_updateItemHeights:function(t){var e=this,n=e._deferredAnimate,o=this._splitFreeSpace(this._calculateFreeSpace());return clearTimeout(this._animationTimer),v.when.apply(i.default,[].slice.call(this._itemElements()).map((function(n){return e._updateItemHeight((0,i.default)(n),o,t)}))).done((function(){n&&n.resolveWith(e)}))},_updateItemHeight:function(t,e,n){var o=t.children("."+M);a.default.isAnimating(t)&&a.default.stop(t);var i=t.outerHeight(),r=t.hasClass(O)?e+o.outerHeight()||t.height("auto").outerHeight():o.outerHeight();return this._animateItem(t,i,r,n,!!e)},_animateItem:function(t,e,n,o,i){var r;return o||e===n?(t.css("height",n),r=(new v.Deferred).resolve()):r=a.default.animate(t,{type:"custom",from:{height:e},to:{height:n},duration:this.option("animationDuration"),easing:this.option("_animationEasing")}),r.done((function(){t.hasClass(O)&&!i&&t.css("height",""),t.not("."+O).addClass(E)}))},_splitFreeSpace:function(t){return t?t/this.option("selectedItems").length:t},_calculateFreeSpace:function(){var t=this.option("height");if(void 0!==t&&"auto"!==t){var e=this._itemTitles(),n=0;return d.each(e,(function(t,e){n+=(0,i.default)(e).outerHeight()})),this.$element().height()-n}},_visibilityChanged:function(t){t&&this._dimensionChanged()},_dimensionChanged:function(){this._updateItemHeights(!0)},_clean:function(){clearTimeout(this._animationTimer),this.callBase()},_itemOptionChanged:function(t,e,n,o){this.callBase(t,e,n,o),"visible"===e&&this._updateItemHeightsWrapper(!0)},_tryParseItemPropertyName:function(t){var e=t.match(/.*\.(.*)/);if((0,f.isDefined)(e)&&e.length>=1)return e[1]},_optionChanged:function(t){switch(t.name){case"items":this.callBase(t),"title"===this._tryParseItemPropertyName(t.fullName)&&this._renderSelection(this._getSelectedItemIndices(),[]);break;case"animationDuration":case"onItemTitleClick":case"_animationEasing":break;case"collapsible":this.option("selectionRequired",!this.option("collapsible"));break;case"itemTitleTemplate":case"height":case"deferRendering":this._invalidate();break;case"multiple":this.option("selectionMode",t.value?"multiple":"single");break;default:this.callBase(t)}},expandItem:function(t){return this._deferredAnimate=new v.Deferred,this.selectItem(t),this._deferredAnimate.promise()},collapseItem:function(t){return this._deferredAnimate=new v.Deferred,this.unselectItem(t),this._deferredAnimate.promise()},updateDimensions:function(){return this._updateItemHeights(!1)}});(0,m.default)("dxAccordion",L);var R=L;e.default=R,t.exports=e.default,t.exports.default=t.exports},bc49:function(t,e,n){"use strict";e.default=void 0;var o=i(n("8a64"));function i(t){return t&&t.__esModule?t:{default:t}}var r={getDefaultGroups:function(){return this._groups||(this._groups={general:{category:"general",title:o.default.format("dxDiagram-categoryGeneral")},flowchart:{category:"flowchart",title:o.default.format("dxDiagram-categoryFlowchart")},orgChart:{category:"orgChart",title:o.default.format("dxDiagram-categoryOrgChart")},containers:{category:"containers",title:o.default.format("dxDiagram-categoryContainers")},custom:{category:"custom",title:o.default.format("dxDiagram-categoryCustom")}})},getGroups:function(t){var e=this.getDefaultGroups();return t?t.map((function(t){return"string"===typeof t?{category:t,title:e[t]&&e[t].title||t}:t})).filter((function(t){return t})):[e.general,e.flowchart,e.orgChart,e.containers]}},a=r;e.default=a,t.exports=e.default},bd32:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=u(n("14a3")),r=u(n("cc156")),a=u(n("8de2")),s=n("1820"),c=u(n("4f86"));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function d(t,e,n){return d="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=f(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},d(t,e,n||t)}function f(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=P(t),null===t)break;return t}function m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function y(t){var e=_();return function(){var n,o=P(t);if(e){var i=P(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?C(t):e}function C(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var S=(0,s.addNamespace)(c.default.up,"dxDiagramPanel"),b=".dx-textbox",x=function(t){m(n,t);var e=y(n);function n(){return l(this,n),e.apply(this,arguments)}return h(n,[{key:"_init",value:function(){d(P(n.prototype),"_init",this).call(this),this._createOnPointerUpAction()}},{key:"_render",value:function(){d(P(n.prototype),"_render",this).call(this),this._attachPointerUpEvent()}},{key:"_getPointerUpElements",value:function(){return[this.$element()]}},{key:"_attachPointerUpEvent",value:function(){var t=this,e=this._getPointerUpElements();e.forEach((function(e){a.default.off(e,S),a.default.on(e,S,(function(e){(0,i.default)(e.target).closest(b).length||t._onPointerUpAction()}))}))}},{key:"_createOnPointerUpAction",value:function(){this._onPointerUpAction=this._createActionByOption("onPointerUp")}},{key:"_optionChanged",value:function(t){switch(t.name){case"onPointerUp":this._createOnPointerUpAction();break;default:d(P(n.prototype),"_optionChanged",this).call(this,t)}}}]),n}(r.default),w=x;e.default=w,t.exports=e.default},be1c:function(t,e,n){"use strict";e.default=void 0;var o=n("d4b2"),i=a(n("b9dd")),r=a(n("39d2"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function p(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){var e=g();return function(){var n,o=y(t);if(e){var i=y(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==s(e)&&"function"!==typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var v=function(t){p(n,t);var e=d(n);function n(t){var o;return c(this,n),o=e.call(this),o._diagramWidget=t,o._resetCache(),o}return l(n,[{key:"_dataSourceChangedHandler",value:function(t,e){if(this._resetCache(),this._items=t.map((function(t){return(0,o.extend)({},t)})),this._dataSourceItems=t.slice(),e&&e.changes){var n=e.changes.filter((function(t){return!t.internalChange}));n.length&&this._reloadContentByChanges(n,!0)}else this._diagramWidget._onDataSourceChanged()}},{key:"_dataSourceLoadingChangedHandler",value:function(t){t&&!this._dataSource.isLoaded()?this._diagramWidget._showLoadingIndicator():this._diagramWidget._hideLoadingIndicator()}},{key:"_prepareData",value:function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&void 0===t[e]&&(t[e]=null);return t}},{key:"insert",value:function(t,e,n){var o=this;this._resetCache();var i=this._getStore();i.insert(this._prepareData(t)).done((function(t,n){var r=[{type:"insert",key:n,data:t,internalChange:!0}];i.push(r),o._reloadContentByChanges(r,!1),e&&e(t),o._resetCache()})).fail((function(t){n&&n(t),o._resetCache()}))}},{key:"update",value:function(t,e,n,o){var i=this,r=this._getStore(),a=this._getStoreKey(r,t,e);r.update(a,this._prepareData(e)).done((function(t,e){var o=[{type:"update",key:e,data:t,internalChange:!0}];r.push(o),i._reloadContentByChanges(o,!1),n&&n(e,t)})).fail((function(t){o&&o(t)}))}},{key:"remove",value:function(t,e,n,o){var i=this;this._resetCache();var r=this._getStore(),a=this._getStoreKey(r,t,e);r.remove(a).done((function(t){var e=[{type:"remove",key:t,internalChange:!0}];r.push(e),i._reloadContentByChanges(e,!1),n&&n(t),i._resetCache()})).fail((function(t){o&&o(t),i._resetCache()}))}},{key:"findItem",value:function(t){return this._items?this._getItemByKey(t):null}},{key:"getItems",value:function(){return this._items}},{key:"hasItems",value:function(){return!!this._items}},{key:"_reloadContentByChanges",value:function(t,e){var n=this;t=t.map((function(t){return(0,o.extend)(t,{internalKey:n._getInternalKey(t.key)})})),this._diagramWidget._reloadContentByChanges(t,e)}},{key:"_getItemByKey",value:function(t){this._ensureCache();var e=this._cache,n=this._getIndexByKey(t);return e.items[n]}},{key:"_getIndexByKey",value:function(t){this._ensureCache();var e=this._cache;if("object"!==s(t)){var n=e.keySet||e.keys.reduce((function(t,e,n){return t[e]=n,t}),{});return e.keySet||(e.keySet=n),n[t]}for(var o=0,i=e.keys.length;o<i;o++)if(e.keys[o]===t)return o;return-1}},{key:"_ensureCache",value:function(){var t=this._cache;t.keys||(t.keys=[],t.items=[],this._fillCache(t,this._items))}},{key:"_fillCache",value:function(t,e){var n=this;if(e&&e.length){var o=this._getKeyExpr();o&&e.forEach((function(e){t.keys.push(o(e)),t.items.push(e)}));var i=this._getItemsExpr();i&&e.forEach((function(e){return n._fillCache(t,i(e))}));var r=this._getContainerChildrenExpr();r&&e.forEach((function(e){return n._fillCache(t,r(e))}))}}},{key:"_getKeyExpr",value:function(){throw"Not Implemented"}},{key:"_getItemsExpr",value:function(){}},{key:"_getContainerChildrenExpr",value:function(){}},{key:"_dataSourceOptions",value:function(){return{paginate:!1}}},{key:"_getStore",value:function(){return this._dataSource&&this._dataSource.store()}},{key:"_getStoreKey",value:function(t,e,n){var o=t.keyOf(n);if(o===n){var i=this._getKeyExpr();this._dataSourceItems.forEach((function(t){i(t)===e&&(o=t)}))}return o}},{key:"_getInternalKey",value:function(t){if("object"===s(t)){var e=this._getKeyExpr();return e(t)}return t}},{key:"_resetCache",value:function(){this._cache={}}}]),n}(i.default);v.include(r.default);var C=v;e.default=C,t.exports=e.default},c0bf:function(t,e,n){"use strict";e.default=void 0;var o={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d*\.*\d+)\)$/,process:function(t){return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4])]}},{re:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/,process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^#([a-f0-9]{1})([a-f0-9]{1})([a-f0-9]{1})$/,process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/^hsv\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e=parseInt(t[1],10),n=parseInt(t[2],10),o=parseInt(t[3],10),i=p(e,n,o);return[i[0],i[1],i[2],1,[e,n,o]]}},{re:/^hsl\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(t){var e=parseInt(t[1],10),n=parseInt(t[2],10),o=parseInt(t[3],10),i=y(e,n,o);return[i[0],i[1],i[2],1,null,[e,n,o]]}}],r=Math.round;function a(t){var e;this.baseColor=t,t&&(e=String(t).toLowerCase().replace(/ /g,""),e=o[e]?"#"+o[e]:e,e=s(e)),e||(this.colorIsInvalid=!0),e=e||{},this.r=c(e[0]),this.g=c(e[1]),this.b=c(e[2]),this.a=c(e[3],1,1),e[4]?this.hsv={h:e[4][0],s:e[4][1],v:e[4][2]}:this.hsv=l(this.r,this.g,this.b),e[5]?this.hsl={h:e[5][0],s:e[5][1],l:e[5][2]}:this.hsl=d(this.r,this.g,this.b)}function s(t){if("transparent"===t)return[0,0,0,0];for(var e,n=0,o=i.length;n<o;++n)if(e=i[n].re.exec(t),e)return i[n].process(e);return null}function c(t,e,n){return e=e||0,n=n||255,t<0||isNaN(t)?e:t>n?n:t}function u(t,e,n){return"#"+(16777216|t<<16|e<<8|n).toString(16).slice(1)}function l(t,e,n){var o,i,r=Math.max(t,e,n),a=Math.min(t,e,n),s=r-a,c=r;if(i=0===r?0:1-a/r,r===a)o=0;else switch(r){case t:o=(e-n)/s*60,e<n&&(o+=360);break;case e:o=(n-t)/s*60+120;break;case n:o=(t-e)/s*60+240}return i*=100,c*=100/255,{h:Math.round(o),s:Math.round(i),v:Math.round(c)}}function p(t,e,n){var o,i,r,a=Math.floor(t%360/60),s=(100-e)*n/100,c=t%60/60*(n-s),u=s+c,l=n-c;switch(a){case 0:o=n,i=u,r=s;break;case 1:o=l,i=n,r=s;break;case 2:o=s,i=n,r=u;break;case 3:o=s,i=l,r=n;break;case 4:o=u,i=s,r=n;break;case 5:o=n,i=s,r=l}return[Math.round(2.55*o),Math.round(2.55*i),Math.round(2.55*r)]}function h(t,e,n,o){var i=Math.max(t,e,n);switch(i){case t:return(e-n)/o+(e<n?6:0);case e:return(n-t)/o+2;case n:return(t-e)/o+4}}function d(t,e,n){t=v(t,255),e=v(e,255),n=v(n,255);var o,i,a=Math.max(t,e,n),s=Math.min(t,e,n),c=a+s,u=c/2;if(a===s)o=i=0;else{var l=a-s;i=u>.5?l/(2-c):l/c,o=h(t,e,n,l),o/=6}return{h:r(360*o),s:r(100*i),l:r(100*u)}}function f(t,e){var n=e;return"r"===t&&(n=e+1/3),"b"===t&&(n=e-1/3),n}function m(t){return t<0&&(t+=1),t>1&&(t-=1),t}function g(t,e,n){return n=m(n),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function y(t,e,n){var o,i,a;if(t=v(t,360),e=v(e,100),n=v(n,100),0===e)o=i=a=n;else{var s=n<.5?n*(1+e):n+e-n*e,c=2*n-s;o=g(c,s,f("r",t)),i=g(c,s,f("g",t)),a=g(c,s,f("b",t))}return[r(255*o),r(255*i),r(255*a)]}function v(t,e){return t=Math.min(e,Math.max(0,parseFloat(t))),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function C(t,e,n){return e=e||0,n=n||255,!(t%1!==0||t<e||t>n||"number"!==typeof t||isNaN(t))}a.prototype={constructor:a,highlight:function(t){return t=t||10,this.alter(t).toHex()},darken:function(t){return t=t||10,this.alter(-t).toHex()},alter:function(t){var e=new a;return e.r=c(this.r+t),e.g=c(this.g+t),e.b=c(this.b+t),e},blend:function(t,e){var n=t instanceof a?t:new a(t),o=new a;return o.r=c(r(this.r*(1-e)+n.r*e)),o.g=c(r(this.g*(1-e)+n.g*e)),o.b=c(r(this.b*(1-e)+n.b*e)),o},toHex:function(){return u(this.r,this.g,this.b)},getPureColor:function(){var t=p(this.hsv.h,100,100);return new a("rgb("+t.join(",")+")")},isValidHex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},isValidRGB:function(t,e,n){return!!(C(t)&&C(e)&&C(n))},isValidAlpha:function(t){return!(isNaN(t)||t<0||t>1||"number"!==typeof t)},colorIsInvalid:!1,fromHSL:function(t){var e=new a,n=y(t.h,t.s,t.l);return e.r=n[0],e.g=n[1],e.b=n[2],e}};var _=a;e.default=_,t.exports=e.default},c6e7:function(t,e,n){"use strict";e.fileSaver=e.MIME_TYPES=void 0;var o=l(n("14a3")),i=l(n("b547")),r=n("706b"),a=l(n("8de2")),s=l(n("0fc0")),c=n("b62d"),u=n("71c4");function l(t){return t&&t.__esModule?t:{default:t}}var p=(0,r.getWindow)(),h=(0,r.getNavigator)(),d={EXCEL:"xlsx",CSS:"css",PNG:"png",JPEG:"jpeg",GIF:"gif",SVG:"svg",PDF:"pdf"},f={CSS:"text/css",EXCEL:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",PNG:"image/png",JPEG:"image/jpeg",GIF:"image/gif",SVG:"image/svg+xml",PDF:"application/pdf"};e.MIME_TYPES=f;var m={_revokeObjectURLTimeout:3e4,_getDataUri:function(t,e){var n=this._getMimeType(t);return"data:".concat(n,";base64,").concat(e)},_getMimeType:function(t){return f[t]||"application/octet-stream"},_linkDownloader:function(t,e){var n=i.default.createElement("a");return n.download=t,n.href=e,n.target="_blank",n},_formDownloader:function(t,e,n,r){var s={method:"post",action:t,enctype:"multipart/form-data"},c=(0,o.default)("<form>").css({display:"none"}).attr(s);function u(t,e){for(var n in e)t.setAttribute(n,e[n]);return t}c.append(u(i.default.createElement("input"),{type:"hidden",name:"fileName",value:e})),c.append(u(i.default.createElement("input"),{type:"hidden",name:"contentType",value:n})),c.append(u(i.default.createElement("input"),{type:"hidden",name:"data",value:r})),c.appendTo("body"),a.default.trigger(c,"submit"),a.default.trigger(c,"submit")&&c.remove()},_saveByProxy:function(t,e,n,o){var i=this._getMimeType(n);return this._formDownloader(t,e,i,o)},_winJSBlobSave:function(t,e,n){var o=new Windows.Storage.Pickers.FileSavePicker;o.suggestedStartLocation=Windows.Storage.Pickers.PickerLocationId.documentsLibrary;var i=d[n];if(i){var r=this._getMimeType(n);o.fileTypeChoices.insert(r,["."+i])}o.suggestedFileName=e,o.pickSaveFileAsync().then((function(e){e&&e.openAsync(Windows.Storage.FileAccessMode.readWrite).then((function(e){var n=t.msDetachStream();Windows.Storage.Streams.RandomAccessStream.copyAsync(n,e).then((function(){e.flushAsync().done((function(){n.close(),e.close()}))}))}))}))},_click:function(t){try{t.dispatchEvent(new MouseEvent("click",{cancelable:!0}))}catch(n){var e=i.default.getDocument().createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,p,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}},_saveBlobAs:function(t,e,n){var o=this;if(this._blobSaved=!1,(0,c.isDefined)(h.msSaveOrOpenBlob))h.msSaveOrOpenBlob(n,t),this._blobSaved=!0;else if((0,c.isDefined)(p.WinJS))this._winJSBlobSave(n,t,e),this._blobSaved=!0;else{var i=p.URL||p.webkitURL||p.mozURL||p.msURL||p.oURL;if((0,c.isDefined)(i)){var r=i.createObjectURL(n),a=this._linkDownloader(t,r);setTimeout((function(){i.revokeObjectURL(r),o._objectUrlRevoked=!0}),this._revokeObjectURLTimeout),this._click(a)}else u.logger.warn("window.URL || window.webkitURL || window.mozURL || window.msURL || window.oURL is not defined")}},saveAs:function(t,e,n,o,i){var r=d[e];if(r&&(t+="."+r),(0,c.isDefined)(o)&&s.default.log("W0001","Export","proxyURL","19.2","This option is no longer required"),i)this._saveByProxy(o,t,e,n);else if((0,c.isFunction)(p.Blob))this._saveBlobAs(t,e,n);else if((0,c.isDefined)(o)&&!(0,c.isDefined)(h.userAgent.match(/iPad/i)))this._saveByProxy(o,t,e,n);else{(0,c.isDefined)(h.userAgent.match(/iPad/i))||s.default.log("E1034");var a=this._linkDownloader(t,this._getDataUri(e,n));this._click(a)}}};e.fileSaver=m},cc6a:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=d(n("14a3")),r=d(n("a522")),a=d(n("ceb6")),s=d(n("3afe")),c=n("d4b2"),u=n("706b"),l=d(n("bd32")),p=d(n("5ef7")),h=n("4ff6");function d(t){return t&&t.__esModule?t:{default:t}}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function g(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function y(t,e,n){return y="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=v(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},y(t,e,n||t)}function v(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=w(t),null===t)break;return t}function C(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}function _(t,e){return _=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_(t,e)}function P(t){var e=x();return function(){var n,o=w(t);if(e){var i=w(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return S(this,n)}}function S(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}n("3c1d"),n("79ab"),n("1efe");var I="dx-format-active",T="dx-diagram-toolbar",O="dx-diagram-toolbar-separator",E="dx-diagram-toolbar-menu-separator",M="dx-diagram-mobile-toolbar-color-box-opened",D=function(t){C(n,t);var e=P(n);function n(){return f(this,n),e.apply(this,arguments)}return g(n,[{key:"_init",value:function(){this._commands=[],this._itemHelpers={},this._commandContextMenus={},this._contextMenuList=[],this._valueConverters={},this.bar=new A(this),this._createOnInternalCommand(),this._createOnCustomCommand(),this._createOnSubMenuVisibilityChangingAction(),y(w(n.prototype),"_init",this).call(this)}},{key:"_initMarkup",value:function(){y(w(n.prototype),"_initMarkup",this).call(this);var t=!(0,u.hasWindow)();this.option("skipAdjustSize")||t||this.$element().width(""),this._commands=this._getCommands(),this._itemHelpers={},this._commandContextMenus={},this._contextMenuList=[];var e=this._createMainElement();if(this._renderToolbar(e),!this.option("skipAdjustSize")&&!t){var o=this.$element().find(".dx-toolbar-before");this.$element().width(o.width())}}},{key:"_createMainElement",value:function(){return(0,i.default)("<div>").addClass(T).appendTo(this._$element)}},{key:"_getCommands",value:function(){return this.option("commands")||[]}},{key:"_renderToolbar",value:function(t){var e=this._commands.filter((function(t){return-1===["after","center"].indexOf(t.position)})),n=this._commands.filter((function(t){return"center"===t.position})),o=this._commands.filter((function(t){return"after"===t.position})),i=[].concat(this._prepareToolbarItems(e,"before",this._executeCommand)).concat(this._prepareToolbarItems(n,"center",this._executeCommand)).concat(this._prepareToolbarItems(o,"after",this._executeCommand));this._toolbarInstance=this._createComponent(t,r.default,{dataSource:i})}},{key:"_prepareToolbarItems",value:function(t,e,n){var o=this;return t.map((function(t){return(0,c.extend)(!0,{location:e,locateInMenu:o.option("locateInMenu")},o._createItem(t,e,n),o._createItemOptions(t),o._createItemActionOptions(t,n))}))}},{key:"_createItem",value:function(t,e,n){var o=this;return(t.getCommandValue||t.getEditorValue||t.getEditorDisplayValue)&&(this._valueConverters[t.command]={getCommandValue:t.getCommandValue,getEditorValue:t.getEditorValue,getEditorDisplayValue:t.getEditorDisplayValue}),"separator"===t.widget?{template:function(t,e,n){(0,i.default)(n).addClass(O)},menuItemTemplate:function(t,e,n){(0,i.default)(n).addClass(E)}}:{widget:t.widget||"dxButton",cssClass:t.cssClass,options:{stylingMode:this.option("buttonStylingMode"),type:this.option("buttonType"),text:t.text,hint:t.hint,icon:t.icon||t.iconUnchecked||t.iconChecked,iconChecked:t.iconChecked,iconUnchecked:t.iconUnchecked,onInitialized:function(e){return o._onItemInitialized(e.component,t)},onContentReady:function(e){return o._onItemContentReady(e.component,t,n)}}}}},{key:"_createItemOptions",value:function(t){var e=t.widget,n=t.command,o=t.items,i=t.valueExpr,r=t.displayExpr,a=t.showText,s=t.hint,c=t.icon;return"dxSelectBox"===e?this._createSelectBoxItemOptions(n,s,o,i,r):"dxTextBox"===e?this._createTextBoxItemOptions(n,s):"dxColorBox"===e?this._createColorBoxItemOptions(n,s,c):e&&"dxButton"!==e?void 0:{showText:a||"inMenu"}}},{key:"_createSelectBoxItemOptions",value:function(t,e,n,o,r){var a=this._createTextEditorItemOptions(e);a=(0,c.extend)(!0,a,{options:{dataSource:n,displayExpr:r||"text",valueExpr:o||"value",dropDownOptions:{container:this.option("container")}}});var s=n&&n.every((function(t){return void 0!==t.icon}));return s&&(a=(0,c.extend)(!0,a,{options:{fieldTemplate:function(t,e){(0,i.default)("<i>").addClass(t&&t.icon).appendTo(e),(0,i.default)("<div>").dxTextBox({readOnly:!0,stylingMode:"outlined"}).appendTo(e)},itemTemplate:function(t,e,n){return(0,i.default)(n).attr("title",t.hint),'<i class="'.concat(t.icon,'"></i>')}}})),a}},{key:"_createTextBoxItemOptions",value:function(t,e){var n=this,o=this._createTextEditorItemOptions(e);return o=(0,c.extend)(!0,o,{options:{readOnly:!0,focusStateEnabled:!1,hoverStateEnabled:!1,buttons:[{name:"dropDown",location:"after",options:{icon:"spindown",disabled:!1,stylingMode:"text",onClick:function(e){var o=n._commandContextMenus[t];o&&n._toggleContextMenu(o)}}}]}}),o}},{key:"_createColorBoxItemOptions",value:function(t,e,n){var o=this,r=this._createTextEditorItemOptions(e);return n&&(r=(0,c.extend)(!0,r,{options:{openOnFieldClick:!0,fieldTemplate:function(t,e){(0,i.default)("<i>").addClass(n).css("borderBottomColor",t).appendTo(e),(0,i.default)("<div>").dxTextBox({readOnly:!0,stylingMode:"outlined"}).appendTo(e)}}})),r=(0,c.extend)(!0,r,{options:{dropDownOptions:{container:this.option("container")},onOpened:function(){o.option("isMobileView")&&(0,i.default)("body").addClass(M)},onClosed:function(){(0,i.default)("body").removeClass(M)}}}),r}},{key:"_createTextEditorItemOptions",value:function(t){return{options:{stylingMode:this.option("editorStylingMode"),hint:t}}}},{key:"_createItemActionOptions",value:function(t,e){var n=this;switch(t.widget){case"dxSelectBox":case"dxColorBox":case"dxCheckBox":return{options:{onValueChanged:function(o){var i=p.default.getItemCommandParameter(n,t,o.component.option("value"));e.call(n,t.command,t.name,i)}}};case"dxTextBox":return{};default:return{options:{onClick:function(o){if(t.items){var i=o.component._contextMenu;i&&n._toggleContextMenu(i)}else{var r=p.default.getItemCommandParameter(n,t);e.call(n,t.command,t.name,r)}}}}}}},{key:"_toggleContextMenu",value:function(t){this._contextMenuList.forEach((function(e){t!==e&&e.hide()})),t.toggle()}},{key:"_onItemInitialized",value:function(t,e){this._addItemHelper(e.command,new k(t))}},{key:"_onItemContentReady",value:function(t,e,n){var o=this,r=(0,h.getDiagram)(),s=r.Browser;if(("dxButton"===t.NAME||"dxTextBox"===t.NAME)&&e.items){var c=(0,i.default)("<div>").appendTo(this.$element());t._contextMenu=this._createComponent(c,a.default,{items:e.items,target:t.$element(),cssClass:p.default.getContextMenuCssClass(),showEvent:"",closeOnOutsideClick:!s.TouchUI,focusStateEnabled:!1,position:{at:"left bottom"},itemTemplate:function(t,e,n){p.default.getContextMenuItemTemplate(this,t,e,n)},onItemClick:function(t){var e=t.component,i=t.itemData;p.default.onContextMenuItemClick(o,i,n.bind(o)),i.items&&i.items.length||e.hide()},onShowing:function(t){o._showingSubMenu||(o._showingSubMenu=t.component,o._onSubMenuVisibilityChangingAction({visible:!0,component:o}),t.component.option("items",t.component.option("items")),delete o._showingSubMenu)},onInitialized:function(n){var i=n.component;return o._onContextMenuInitialized(i,e,t)},onDisposing:function(t){var n=t.component;return o._onContextMenuDisposing(n,e)}})}}},{key:"_onContextMenuInitialized",value:function(t,e,n){this._contextMenuList.push(t),e.command&&(this._commandContextMenus[e.command]=t),this._addContextMenuHelper(e,t,[],n)}},{key:"_addItemHelper",value:function(t,e){if(void 0!==t){if(this._itemHelpers[t])throw new Error("Toolbar cannot contain duplicated commands.");this._itemHelpers[t]=e}}},{key:"_addContextMenuHelper",value:function(t,e,n,o){var i=this;t.items&&t.items.forEach((function(t,r){var a=n.concat(r);i._addItemHelper(t.command,new L(e,a,t.command,o)),i._addContextMenuHelper(t,e,a,o)}))}},{key:"_onContextMenuDisposing",value:function(t,e){this._contextMenuList.splice(this._contextMenuList.indexOf(t),1),delete this._commandContextMenus[e.command]}},{key:"_executeCommand",value:function(t,e,n){if(!this._updateLocked){if("number"===typeof t){var o=this._valueConverters[t];o&&o.getCommandValue&&(n=o.getCommandValue(n)),this.bar.raiseBarCommandExecuted(t,n)}else"string"===typeof t&&this._onInternalCommandAction({command:t});void 0!==e&&this._onCustomCommandAction({name:e})}}},{key:"_createOnInternalCommand",value:function(){this._onInternalCommandAction=this._createActionByOption("onInternalCommand")}},{key:"_createOnCustomCommand",value:function(){this._onCustomCommandAction=this._createActionByOption("onCustomCommand")}},{key:"_setItemEnabled",value:function(t,e){if(t in this._itemHelpers){var n=this._itemHelpers[t];n.canUpdate(this._showingSubMenu)&&n.setEnabled(e)}}},{key:"_setEnabled",value:function(t){this._toolbarInstance.option("disabled",!t),this._contextMenuList.forEach((function(e){e.option("disabled",!t)}))}},{key:"_setItemValue",value:function(t,e){try{if(this._updateLocked=!0,t in this._itemHelpers){var n=this._itemHelpers[t];if(n.canUpdate(this._showingSubMenu)){var o,i=this._valueConverters[t];i&&i.getEditorValue&&(e=i.getEditorValue(e)),i&&i.getEditorDisplayValue&&(o=i.getEditorDisplayValue(e));var r=this._commandContextMenus[t];n.setValue(e,o,r,r&&t)}}}finally{this._updateLocked=!1}}},{key:"_setItemSubItems",value:function(t,e){if(this._updateLocked=!0,t in this._itemHelpers){var n=this._itemHelpers[t];if(n.canUpdate(this._showingSubMenu)){var o=this._commandContextMenus[t];n.setItems(e,o,o&&t)}}this._updateLocked=!1}},{key:"_createOnSubMenuVisibilityChangingAction",value:function(){this._onSubMenuVisibilityChangingAction=this._createActionByOption("onSubMenuVisibilityChanging")}},{key:"_optionChanged",value:function(t){switch(t.name){case"isMobileView":(0,i.default)("body").removeClass(M),this._invalidate();break;case"onSubMenuVisibilityChanging":this._createOnSubMenuVisibilityChangingAction();break;case"onInternalCommand":this._createOnInternalCommand();break;case"onCustomCommand":this._createOnCustomCommand();break;case"container":case"commands":this._invalidate();break;case"export":break;default:y(w(n.prototype),"_optionChanged",this).call(this,t)}}},{key:"_getDefaultOptions",value:function(){return(0,c.extend)(y(w(n.prototype),"_getDefaultOptions",this).call(this),{isMobileView:!1,export:{fileName:"Diagram",proxyUrl:void 0},locateInMenu:"auto",buttonStylingMode:"text",buttonType:"normal",editorStylingMode:"filled",skipAdjustSize:!1})}},{key:"setCommandChecked",value:function(t,e){this._setItemValue(t,e)}},{key:"setCommandEnabled",value:function(t,e){this._setItemEnabled(t,e)}}]),n}(l.default),A=function(t){C(n,t);var e=P(n);function n(){return f(this,n),e.apply(this,arguments)}return g(n,[{key:"getCommandKeys",value:function(){return this._getKeys(this._owner._commands)}},{key:"setItemValue",value:function(t,e){this._owner._setItemValue(t,e)}},{key:"setItemEnabled",value:function(t,e){this._owner._setItemEnabled(t,e)}},{key:"setEnabled",value:function(t){this._owner._setEnabled(t)}},{key:"setItemSubItems",value:function(t,e){this._owner._setItemSubItems(t,e)}}]),n}(s.default),k=function(){function t(e){f(this,t),this._widget=e}return g(t,[{key:"canUpdate",value:function(t){return void 0===t}},{key:"setEnabled",value:function(t){this._widget.option("disabled",!t)}},{key:"setValue",value:function(t,e,n,o){"value"in this._widget.option()?this._updateEditorValue(t,e):void 0!==t&&this._updateButtonValue(t),n&&this._updateContextMenuItemValue(n,"",o,t)}},{key:"setItems",value:function(t,e,n){e?this._updateContextMenuItems(e,"",n,t):this._updateEditorItems(t)}},{key:"_updateContextMenuItems",value:function(t,e,n,o){p.default.updateContextMenuItems(t,e,n,o)}},{key:"_updateEditorItems",value:function(t){"items"in this._widget.option()&&this._widget.option("items",t.map((function(t){return{value:p.default.getItemValue(t),text:t.text}})))}},{key:"_updateEditorValue",value:function(t,e){this._widget.option("value",t),!this._widget.option("selectedItem")&&e&&this._widget.option("value",e)}},{key:"_updateButtonValue",value:function(t){this._widget.option("iconChecked")&&this._widget.option("iconUnchecked")?this._widget.option("icon",t?this._widget.option("iconChecked"):this._widget.option("iconUnchecked")):this._widget.$element().toggleClass(I,t)}},{key:"_updateContextMenuItemValue",value:function(t,e,n,o){p.default.updateContextMenuItemValue(t,e,n,o)}}]),t}(),L=function(t){C(n,t);var e=P(n);function n(t,o,i,r){var a;return f(this,n),a=e.call(this,t),a._indexPath=o,a._rootCommandKey=i,a._rootWidget=r,a}return g(n,[{key:"canUpdate",value:function(t){return y(w(n.prototype),"canUpdate",this).call(this,t)||t===this._widget}},{key:"setEnabled",value:function(t){this._widget.option(this._getItemOptionText()+"disabled",!t);var e=this._hasEnabledCommandItems(this._widget.option("items"));this._rootWidget.option("disabled",!e)}},{key:"_hasEnabledCommandItems",value:function(t){var e=this;return!!t&&t.some((function(t){return void 0!==t.command&&!t.disabled||e._hasEnabledCommandItems(t.items)}))}},{key:"setValue",value:function(t){this._updateContextMenuItemValue(this._widget,this._getItemOptionText(),this._rootCommandKey,t)}},{key:"setItems",value:function(t){this._updateContextMenuItems(this._widget,this._getItemOptionText(),this._rootCommandKey,t)}},{key:"_getItemOptionText",value:function(){return p.default.getItemOptionText(this._widget,this._indexPath)}}]),n}(k),R=D;e.default=R,t.exports=e.default},d00a:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=p(n("14a3")),r=p(n("cc156")),a=p(n("ceb6")),s=p(n("6571")),c=p(n("5ef7")),u=p(n("3afe")),l=n("4ff6");function p(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function m(t,e,n){return m="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=g(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},m(t,e,n||t)}function g(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=b(t),null===t)break;return t}function y(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function C(t){var e=S();return function(){var n,o=b(t);if(e){var i=b(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return _(this,n)}}function _(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?P(t):e}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var x="dx-diagram-touchbar",w="dx-diagram-touchbar-overlay",I="dx-diagram-touchbar-target",T=800,O=32,E=function(t){y(n,t);var e=C(n);function n(){return h(this,n),e.apply(this,arguments)}return f(n,[{key:"_init",value:function(){m(b(n.prototype),"_init",this).call(this),this._createOnVisibilityChangingAction(),this._createOnInternalCommand(),this._createOnCustomCommand(),this._createOnItemClickAction(),this._tempState=void 0,this._commands=[],this._commandToIndexMap={},this.bar=new D(this)}},{key:"_initMarkup",value:function(){var t=this;m(b(n.prototype),"_initMarkup",this).call(this),this._commands=this._getCommands(),this._commandToIndexMap={},this._fillCommandToIndexMap(this._commands,[]),this._$contextMenuTargetElement=(0,i.default)("<div>").addClass(I).appendTo(this.$element());var e=(0,i.default)("<div>").appendTo(this.$element());this._contextMenuInstance=this._createComponent(e,M,{isTouchBarMode:this._isTouchBarMode(),cssClass:this._isTouchBarMode()?x:c.default.getContextMenuCssClass(),closeOnOutsideClick:!1,showEvent:"",focusStateEnabled:!1,items:this._commands,position:this._isTouchBarMode()?{my:{x:"center",y:"bottom"},at:{x:"center",y:"top"},of:this._$contextMenuTargetElement}:{},itemTemplate:function(t,e,n){c.default.getContextMenuItemTemplate(this,t,e,n)},onItemClick:function(e){var n=e.itemData;return t._onItemClick(n)},onShowing:function(e){!0!==t._inOnShowing&&(t._inOnShowing=!0,t._onVisibilityChangingAction({visible:!0,component:t}),e.component.option("items",e.component.option("items")),delete t._inOnShowing)}})}},{key:"_show",value:function(t,e,n){if(this._contextMenuInstance.hide(),this._isTouchBarMode()){this._$contextMenuTargetElement.show(),n||(n={x:t,y:e,width:0,height:0});var o=n.width>T?0:(T-n.width)/2;this._$contextMenuTargetElement.css({left:n.x-o,top:n.y-O,width:n.width+2*o,height:n.height+2*O}),this._contextMenuInstance.show()}else this._contextMenuInstance.option("position",{offset:t+" "+e}),this._contextMenuInstance.show()}},{key:"_hide",value:function(){this._$contextMenuTargetElement.hide(),this._contextMenuInstance.hide()}},{key:"_isTouchBarMode",value:function(){var t=(0,l.getDiagram)(),e=t.Browser;return e.TouchUI}},{key:"_onItemClick",value:function(t){var e=!1;this._onItemClickAction&&(e=this._onItemClickAction(t)),e||(c.default.onContextMenuItemClick(this,t,this._executeCommand.bind(this)),this._contextMenuInstance.hide())}},{key:"_executeCommand",value:function(t,e,n){"number"===typeof t?this.bar.raiseBarCommandExecuted(t,n):"string"===typeof t&&this._onInternalCommandAction({command:t}),void 0!==e&&this._onCustomCommandAction({name:e})}},{key:"_createOnInternalCommand",value:function(){this._onInternalCommandAction=this._createActionByOption("onInternalCommand")}},{key:"_createOnCustomCommand",value:function(){this._onCustomCommandAction=this._createActionByOption("onCustomCommand")}},{key:"_getCommands",value:function(){return s.default.getContextMenuCommands(this.option("commands"))}},{key:"_fillCommandToIndexMap",value:function(t,e){var n=this;t.forEach((function(t,o){var i=e.concat([o]);void 0!==t.command&&(n._commandToIndexMap[t.command]=i),Array.isArray(t.items)&&n._fillCommandToIndexMap(t.items,i)}))}},{key:"_setItemEnabled",value:function(t,e){this._setItemVisible(t,e)}},{key:"_setItemVisible",value:function(t,e){var n=c.default.getItemOptionText(this._contextMenuInstance,this._commandToIndexMap[t]);c.default.updateContextMenuItemVisible(this._contextMenuInstance,n,e)}},{key:"_setItemValue",value:function(t,e){var n=c.default.getItemOptionText(this._contextMenuInstance,this._commandToIndexMap[t]);c.default.updateContextMenuItemValue(this._contextMenuInstance,n,t,e)}},{key:"_setItemSubItems",value:function(t,e){var n=c.default.getItemOptionText(this._contextMenuInstance,this._commandToIndexMap[t]);c.default.updateContextMenuItems(this._contextMenuInstance,n,t,e)}},{key:"_setEnabled",value:function(t){this._contextMenuInstance.option("disabled",!t)}},{key:"isVisible",value:function(){return this._inOnShowing}},{key:"_createOnVisibilityChangingAction",value:function(){this._onVisibilityChangingAction=this._createActionByOption("onVisibilityChanging")}},{key:"_createOnItemClickAction",value:function(){this._onItemClickAction=this._createActionByOption("onItemClick")}},{key:"_optionChanged",value:function(t){switch(t.name){case"onVisibilityChanging":this._createOnVisibilityChangingAction();break;case"onInternalCommand":this._createOnInternalCommand();break;case"onCustomCommand":this._createOnCustomCommand();break;case"onItemClick":this._createOnItemClickAction();break;case"commands":this._invalidate();break;case"export":break;default:m(b(n.prototype),"_optionChanged",this).call(this,t)}}}]),n}(r.default),M=function(t){y(n,t);var e=C(n);function n(){return h(this,n),e.apply(this,arguments)}return f(n,[{key:"_renderContextMenuOverlay",value:function(){var t=this;m(b(n.prototype),"_renderContextMenuOverlay",this).call(this),this._overlay&&this.option("isTouchBarMode")&&this._overlay&&this._overlay.option("onShown",(function(){var e=(0,i.default)(t._overlay.$content());e.parent().addClass(w)}))}}]),n}(a.default),D=function(t){y(n,t);var e=C(n);function n(t){return h(this,n),e.call(this,t)}return f(n,[{key:"getCommandKeys",value:function(){return this._getKeys(this._owner._commands)}},{key:"setItemValue",value:function(t,e){this._owner._setItemValue(t,e)}},{key:"setItemEnabled",value:function(t,e){this._owner._setItemEnabled(t,e)}},{key:"setItemVisible",value:function(t,e){this._owner._setItemVisible(t,e)}},{key:"setItemSubItems",value:function(t,e){this._owner._setItemSubItems(t,e)}},{key:"setEnabled",value:function(t){this._owner._setEnabled(t)}},{key:"isVisible",value:function(){return this._owner.isVisible()}}]),n}(u.default),A={DiagramContextMenuWrapper:E,DiagramContextMenu:M};e.default=A,t.exports=e.default},e0d5:function(t,e,n){
/*!
 * DevExpress Diagram (dx-diagram)
 * Version: 2.0.5
 * Build date: Mon Nov 23 2020
 * 
 * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED
 * Read about DevExpress licensing here: https://www.devexpress.com/Support/EULAs
 */
(function(e,n){t.exports=n()})(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=105)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeType=e.ShapeTypes=e.ShapeCategories=void 0;var o=function(){function t(){}return t.General="general",t.Flowchart="flowchart",t.OrgChart="orgChart",t.Containers="containers",t.Custom="custom",t}();e.ShapeCategories=o;var i=function(){function t(){}return t.Text="text",t.Rectangle="rectangle",t.Ellipse="ellipse",t.Cross="cross",t.Triangle="triangle",t.Diamond="diamond",t.Heart="heart",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Octagon="octagon",t.Star="star",t.ArrowLeft="arrowLeft",t.ArrowUp="arrowTop",t.ArrowRight="arrowRight",t.ArrowDown="arrowBottom",t.ArrowUpDown="arrowNorthSouth",t.ArrowLeftRight="arrowEastWest",t.Process="process",t.Decision="decision",t.Terminator="terminator",t.PredefinedProcess="predefinedProcess",t.Document="document",t.MultipleDocuments="multipleDocuments",t.ManualInput="manualInput",t.Preparation="preparation",t.Data="data",t.Database="database",t.HardDisk="hardDisk",t.InternalStorage="internalStorage",t.PaperTape="paperTape",t.ManualOperation="manualOperation",t.Delay="delay",t.StoredData="storedData",t.Display="display",t.Merge="merge",t.Connector="connector",t.Or="or",t.SummingJunction="summingJunction",t.Container="container",t.VerticalContainer="verticalContainer",t.HorizontalContainer="horizontalContainer",t.Card="card",t.CardWithImageOnLeft="cardWithImageOnLeft",t.CardWithImageOnTop="cardWithImageOnTop",t.CardWithImageOnRight="cardWithImageOnRight",t}();e.ShapeTypes=i,function(t){t[t["text"]=0]="text",t[t["rectangle"]=1]="rectangle",t[t["ellipse"]=2]="ellipse",t[t["cross"]=3]="cross",t[t["triangle"]=4]="triangle",t[t["diamond"]=5]="diamond",t[t["heart"]=6]="heart",t[t["pentagon"]=7]="pentagon",t[t["hexagon"]=8]="hexagon",t[t["octagon"]=9]="octagon",t[t["star"]=10]="star",t[t["arrowLeft"]=11]="arrowLeft",t[t["arrowTop"]=12]="arrowTop",t[t["arrowRight"]=13]="arrowRight",t[t["arrowBottom"]=14]="arrowBottom",t[t["arrowNorthSouth"]=15]="arrowNorthSouth",t[t["arrowEastWest"]=16]="arrowEastWest",t[t["process"]=17]="process",t[t["decision"]=18]="decision",t[t["terminator"]=19]="terminator",t[t["predefinedProcess"]=20]="predefinedProcess",t[t["document"]=21]="document",t[t["multipleDocuments"]=22]="multipleDocuments",t[t["manualInput"]=23]="manualInput",t[t["preparation"]=24]="preparation",t[t["data"]=25]="data",t[t["database"]=26]="database",t[t["hardDisk"]=27]="hardDisk",t[t["internalStorage"]=28]="internalStorage",t[t["paperTape"]=29]="paperTape",t[t["manualOperation"]=30]="manualOperation",t[t["delay"]=31]="delay",t[t["storedData"]=32]="storedData",t[t["display"]=33]="display",t[t["merge"]=34]="merge",t[t["connector"]=35]="connector",t[t["or"]=36]="or",t[t["summingJunction"]=37]="summingJunction",t[t["verticalContainer"]=38]="verticalContainer",t[t["horizontalContainer"]=39]="horizontalContainer",t[t["cardWithImageOnLeft"]=40]="cardWithImageOnLeft",t[t["cardWithImageOnTop"]=41]="cardWithImageOnTop",t[t["cardWithImageOnRight"]=42]="cardWithImageOnRight"}(e.ShapeType||(e.ShapeType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;var o=function(){function t(t,e){this.x=t,this.y=e}return t.zero=function(){return new t(0,0)},t.fromNumber=function(e){return new t(e,e)},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.toString=function(){return JSON.stringify(this)},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.offset=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.offsetByPoint=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.multiply=function(t,e){return this.x*=t,this.y*=e,this},t.prototype.negative=function(){return this.x*=-1,this.y*=-1,this},t.prototype.applyConverter=function(t){return this.x=t(this.x),this.y=t(this.y),this},t.plus=function(e,n){return new t(e.x+n.x,e.y+n.y)},t.minus=function(e,n){return new t(e.x-n.x,e.y-n.y)},t.xComparer=function(t,e){return t.x-e.x},t.yComparer=function(t,e){return t.y-e.y},t.equals=function(t,e){return t.x===e.x&&t.y===e.y},t}();e.Point=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Size=void 0;var o=function(){function t(t,e){this.width=t,this.height=e}return t.empty=function(){return new t(0,0)},t.fromNumber=function(e){return new t(e,e)},t.initByCommonAction=function(e){var n=function(t){return t.width},o=function(t){return t.height};return new t(e(n,o),e(o,n))},t.prototype.isEmpty=function(){return 0===this.width&&0===this.height},t.prototype.toString=function(){return JSON.stringify(this)},t.prototype.nonNegativeSize=function(){return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this},t.prototype.offset=function(t,e){return this.width=this.width+t,this.height=this.height+e,this},t.prototype.multiply=function(t,e){return this.width*=t,this.height*=e,this},t.prototype.equals=function(t){return this.width===t.width&&this.height===t.height},t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.copyFrom=function(t){this.width=t.width,this.height=t.height},t.prototype.applyConverter=function(t){return this.width=t(this.width),this.height=t(this.height),this},t.equals=function(t,e){return t.width===e.width&&t.height===e.height},t}();e.Size=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectUtils=e.GeometryUtils=e.Utils=e.EventDispatcher=e.Range=void 0,n(175);var o=n(2),i=n(1),r=n(12),a=n(39),s=function(){function t(t,e){this.from=t,this.to=void 0!==e?e:t}return Object.defineProperty(t.prototype,"length",{get:function(){return Math.abs(this.to-this.from)},enumerable:!1,configurable:!0}),t.prototype.extend=function(t){this.from=Math.min(t.from,this.from),this.to=Math.max(t.to,this.to)},t.prototype.includes=function(t){return t>=this.from&&t<=this.to},t.fromLength=function(e,n){return new t(e,e+n)},t}();e.Range=s;var c=function(){function t(){this.listeners=[]}return t.prototype.add=function(t){if(!t)throw new Error("Not Implemented");this.hasEventListener(t)||this.listeners.push(t)},t.prototype.remove=function(t){for(var e=0,n=void 0;n=this.listeners[e];e++)if(n===t){this.listeners.splice(e,1);break}},t.prototype.raise=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var o=0,i=void 0;i=this.listeners[o];o++){var r=i[t];r&&r.apply(i,e)}},t.prototype.raise1=function(t){for(var e=0,n=void 0;n=this.listeners[e];e++)t(n)},t.prototype.hasEventListener=function(t){for(var e=0,n=this.listeners.length;e<n;e++)if(this.listeners[e]===t)return!0;return!1},t}();e.EventDispatcher=c;var u=function(){function t(){}return t.flatten=function(t){return[].concat.apply([],t)},t}();e.Utils=u;var l=function(){function t(){}return t.getCommonRectangle=function(t){if(!t.length)return new r.Rectangle(0,0,0,0);var e=Number.MAX_VALUE,n=-Number.MAX_VALUE,o=Number.MAX_VALUE,i=-Number.MAX_VALUE;return t.forEach((function(t){e=Math.min(e,t.x),n=Math.max(n,t.right),o=Math.min(o,t.y),i=Math.max(i,t.bottom)})),new r.Rectangle(e,o,n-e,i-o)},t.findFreeSpace=function(t,e,n,o){var r=[o?o.x:0],s=[o?o.y:0];t.forEach((function(t){r.push(t.x),r.push(t.right),s.push(t.y),s.push(t.bottom)})),r=r.sort((function(t,e){return t-e})).reduce((function(t,e,n){return r[n-1]!==e&&t.push(e)&&t||t}),[]),s=s.sort((function(t,e){return t-e})).reduce((function(t,e,n){return s[n-1]!==e&&t.push(e)&&t||t}),[]);for(var c=s.map((function(t){return r.map((function(t,e){return r[e+1]-t}))})),u=function(t,e){for(var n=a.SearchUtils.binaryIndexOf(r,(function(t){return t-e.x})),o=a.SearchUtils.binaryIndexOf(r,(function(t){return t-e.right})),i=a.SearchUtils.binaryIndexOf(s,(function(t){return t-e.y})),u=a.SearchUtils.binaryIndexOf(s,(function(t){return t-e.bottom})),l=i;l<u;l++)for(var p=n;p<o;p++)c[l][p]*=-1},l=0,p=void 0;p=t[l];l++)u(l,p);for(var h=0;h<s.length;h++)for(var d=0;d<r.length-1;d++){var f=this.checkRect(c,s,r,h,d,e,n);if(f>0)d=f;else if(0===f)return new i.Point(r[d],s[h])}return null},t.checkRect=function(t,e,n,o,i,r,a){for(var s=0,c=0,u=n.length-2,l=o;l<e.length;l++){s=e[l+1]-e[o];for(var p=i;p<=u;p++){if(t[l][p]<0)return 0===p?-1:p;if(c=n[p+1]-n[i],r.width<=c||!a&&p===n.length-2&&r.width/2<=c){if(r.height<=s||!a&&l===e.length-2&&r.height/2<=s)return 0;u=p}}}},t.getArrowPoints=function(t,e,n,o){if(t.x===e.x&&t.y===e.y)return{point1:t.clone(),point2:t.clone(),point3:t.clone()};var r=e.x-t.x,a=e.y-t.y,s=Math.sqrt(Math.pow(r,2)+Math.pow(a,2)),c=r/s,u=a/s,l=t.x+n*c+o*u,p=t.y+n*u-o*c,h=t.x+n*c-o*u,d=t.y+n*u+o*c,f=t.x+n*c,m=t.y+n*u;return{point1:new i.Point(l,p),point2:new i.Point(h,d),point3:new i.Point(f,m)}},t.removeUnnecessaryLinePoints=function(t,e,n){void 0===n&&(n=function(t){return void 0!==t}),this.removeDuplicatedPoints(t,e,n),this.removeOneLinePoints(t,e,n),this.removeBackwardPoints(t,e,n)},t.removeBackwardPoints=function(t,e,n){void 0===n&&(n=function(t){return void 0!==t});var o,i=0;while(o=t[i]){if(t.length<=2)break;var r=this.getNextPoint(t,i,!0,n),a=this.getNextPoint(t,i,!1,n);if(a&&r){if(o.x===a.x&&o.x===r.x&&(o.y>a.y&&o.y>r.y||o.y<a.y&&o.y<r.y)&&e(t[i],i))continue;if(o.y===a.y&&o.y===r.y&&(o.x>a.x&&o.x>r.x||o.x<a.x&&o.x<r.x)&&e(t[i],i))continue}i++}},t.removeOneLinePoints=function(t,e,n){void 0===n&&(n=function(t){return void 0!==t});var o,i=0;while(o=t[i]){if(t.length<=2)break;var r=this.getNextPoint(t,i,!0,n),a=this.getNextPoint(t,i,!1,n);if(a&&r){if((o.x===a.x&&o.x===r.x||o.y===a.y&&o.y===r.y)&&e(t[i],i))continue;var s=(r.y-a.y)/(r.x-a.x);if(r.y-t[i].y===(r.x-t[i].x)*s&&e(t[i],i))continue}i++}},t.removeDuplicatedPoints=function(t,e,n){void 0===n&&(n=function(t){return void 0!==t});var o,i=0;while(o=t[i]){if(t.length<=2)break;var r=this.getNextPoint(t,i,!0,n);if(r&&o.x===r.x&&o.y===r.y){var a=i+1;if(a===t.length-1&&a--,e(t[a],a))continue}i++}},t.getNextPoint=function(t,e,n,o){var i,r=e+(n?1:-1);while(i=t[r]){if(o(i))return i;r+=n?1:-1}},t.getDistance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.getPathLength=function(e){var n,o=0;return e.forEach((function(e){if(void 0!==n){var i=t.getDistance(e,n);o+=i}n=e})),o},t.getPathPointByPosition=function(e,n){if(!e.length)throw new Error("Invalid points");if(0>n||n>1)throw new Error("Invalid relative position");var o=this.getPathLength(e);if(e.length<=2&&0===o||0===n)return[e[0],0];for(var r=o*n,a=0,s=1;s<e.length;s++){var c=t.getDistance(e[s],e[s-1]);if(a+c>=r){var u=r-a,l=(e[s].x-e[s-1].x)/c,p=(e[s].y-e[s-1].y)/c;return[new i.Point(e[s-1].x+l*u,e[s-1].y+p*u),s]}a+=c}return[e[e.length-1],e.length-1]},t.getLineAngle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},t.getTriangleBeginAngle=function(t,e,n){var o=this.getLineAngle(t,e),i=this.getLineAngle(t,n);return Math.abs(i-o)},t.getTriangleEndAngle=function(t,e,n){var o=this.getLineAngle(t,e),i=this.getLineAngle(n,e);return Math.abs(o-i)},t.getPathPointByPoint=function(e,n){if(!e.length)throw new Error("Invalid points");if(1===e.length)return e[0];for(var o,i=Number.MAX_VALUE,r=1;r<e.length;r++){var a=e[r-1],s=e[r];if(n.equals(a)){o=a.clone();break}if(n.equals(s)){o=s.clone();break}var c=this.getTriangleBeginAngle(a,s,n),u=this.getTriangleEndAngle(a,s,n),l=t.getDistance(n,a),p=t.getDistance(n,s),h=l*Math.sin(c),d=void 0;if(d=Math.PI/2<=c&&c<=3*Math.PI/2?l:Math.PI/2<=u&&u<=3*Math.PI/2?p:Math.abs(h),d<i)if(i=d,Math.PI/2<=c&&c<=3*Math.PI/2)o=a.clone();else if(Math.PI/2<=u&&u<=3*Math.PI/2)o=s.clone();else{var f=Math.fround||Math.round,m=this.getLineAngle(a,s),g=f(Math.abs(h*Math.sin(m))),y=f(Math.abs(h*Math.cos(m))),v=n.y-a.y<f((n.x-a.x)*Math.tan(m));0<=m&&m<=Math.PI/2?(g*=v?-1:1,y*=v?1:-1):Math.PI/2<=m&&m<=Math.PI||0>=m&&m>=-Math.PI/2?(g*=v?1:-1,y*=v?1:-1):-Math.PI/2>=m&&m>=-Math.PI&&(g*=v?-1:1,y*=v?1:-1),o=n.clone().offset(g,y)}}return o},t.getPathPositionByPoint=function(e,n,o){void 0===o&&(o=100),n=this.getPathPointByPoint(e,n);for(var i=this.getPathLength(e),r=0,a=1;a<e.length;a++){var s=e[a-1],c=e[a],u=t.getDistance(c,s),l=Math.atan((c.y-s.y)/(c.x-s.x)),p=Math.fround||Math.round;if(n.x===c.x&&n.x===s.x||n.y===c.y&&n.y===s.y||p(n.y-s.y)===p((n.x-s.x)*Math.tan(l)))return 0!==Math.sin(l)?r+=Math.abs((n.y-s.y)/Math.sin(l)):r+=Math.abs(n.x-s.x),Math.round(r*o/i)/o;r+=u}return 1},t.arePointsEqual=function(t,e){var n=t.length,o=e.length;if(n!==o)return!1;for(var i=0;i<n;i++)if(!t[i].equals(e[i]))return!1;return!0},t.getMaxRectangleEnscribedInEllipse=function(t){var e=t.width*Math.sqrt(2)/2,n=t.height*Math.sqrt(2)/2;return new o.Size(e,n)},t.getEllipseByEnscribedRectangle=function(t){return new o.Size(2*t.width/Math.sqrt(2),2*t.height/Math.sqrt(2))},t}();e.GeometryUtils=l;var p=function(){function t(){}return t.cloneObject=function(t){return t&&Object.assign({},t)},t.compareObjects=function(t,e){return t===e||"object"===typeof t&&"object"===typeof e&&this.isDeepEqual(t,e)},t.isDeepEqual=function(t,e){var n=t?Object.getOwnPropertyNames(t):[],o=e?Object.getOwnPropertyNames(e):[];if(n.length!==o.length)return!1;for(var i=0;i<n.length;i++){var r=n[i];switch(typeof t[r]){case"object":if(!this.isDeepEqual(t[r],e[r]))return!1;break;case"number":if((!isNaN(t[r])||!isNaN(e[r]))&&t[r]!==e[r])return!1;break;default:if(t[r]!==e[r])return!1}}return!0},t}();e.ObjectUtils=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PathPrimitiveClosePathCommand=e.PathPrimitiveArcToCommand=e.PathPrimitiveQuadraticCurveToCommand=e.PathPrimitiveCubicCurveToCommand=e.PathPrimitiveLineToCommand=e.PathPrimitiveMoveToCommand=e.PathPrimitiveCommand=e.PathPrimitive=void 0;var i=n(15),r=n(25),a=n(110),s=function(t){function e(e,n,o,i,r){var a=t.call(this,n,o,i,r)||this;return a.commands=e.map((function(t){return t.style=n,t})),a}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"path")},e.prototype.applyElementProperties=function(e,n){e.setAttribute("d",this.commands.map((function(t){return t.toString()})).join(" ")),this.setPositionCorrectionAttribute(e),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.PathPrimitive=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a.PrimitiveObject);e.PathPrimitiveCommand=c;var u=function(t){function e(e,n){var o=t.call(this)||this;return o.x=e,o.y=n,o}return o(e,t),e.prototype.toString=function(){return"M "+this.getUnitVaue(this.x)+" "+this.getUnitVaue(this.y)},e.fromPoint=function(t){return new e(t.x,t.y)},e}(c);e.PathPrimitiveMoveToCommand=u;var l=function(t){function e(e,n){var o=t.call(this)||this;return o.x=e,o.y=n,o}return o(e,t),e.prototype.toString=function(){return"L "+this.getUnitVaue(this.x)+" "+this.getUnitVaue(this.y)},e.fromPoint=function(t){return new e(t.x,t.y)},e}(c);e.PathPrimitiveLineToCommand=l;var p=function(t){function e(e,n,o,i,r,a){var s=t.call(this)||this;return s.x1=e,s.y1=n,s.x2=o,s.y2=i,s.x3=r,s.y3=a,s}return o(e,t),e.prototype.toString=function(){return"C "+this.getUnitVaue(this.x1)+" "+this.getUnitVaue(this.y1)+","+this.getUnitVaue(this.x2)+" "+this.getUnitVaue(this.y2)+","+this.getUnitVaue(this.x3)+" "+this.getUnitVaue(this.y3)},e}(c);e.PathPrimitiveCubicCurveToCommand=p;var h=function(t){function e(e,n,o,i){var r=t.call(this)||this;return r.x1=e,r.y1=n,r.x2=o,r.y2=i,r}return o(e,t),e.prototype.toString=function(){return"Q "+this.getUnitVaue(this.x1)+" "+this.getUnitVaue(this.y1)+","+this.getUnitVaue(this.x2)+" "+this.getUnitVaue(this.y2)},e}(c);e.PathPrimitiveQuadraticCurveToCommand=h;var d=function(t){function e(e,n,o,i,r,a,s){var c=t.call(this)||this;return c.rx=e,c.ry=n,c.xAxisRotation=o,c.largeArcFlag=i,c.sweepFag=r,c.x=a,c.y=s,c}return o(e,t),e.prototype.toString=function(){return"A "+this.getUnitVaue(this.rx)+" "+this.getUnitVaue(this.ry)+" "+this.getUnitVaue(this.xAxisRotation)+" "+(this.largeArcFlag?"1":"0")+" "+(this.sweepFag?"1":"0")+this.getUnitVaue(this.x)+","+this.getUnitVaue(this.y)},e}(c);e.PathPrimitiveArcToCommand=d;var f=function(t){function e(){return t.call(this)||this}return o(e,t),e.prototype.toString=function(){return"z"},e}(c);e.PathPrimitiveClosePathCommand=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CompositionHistoryItem=e.HistoryItem=void 0;var i=function(){function t(){this.uniqueId=-1}return t.prototype.changeModified=function(){return!0},t.prototype.getName=function(){return this.constructor.name},t}();e.HistoryItem=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.historyItems=[],e.dataSyncItems=[],e}return o(e,t),e.prototype.changeModified=function(){for(var t,e=0;t=this.historyItems[e];e++)if(t.changeModified())return!0;return!1},e.prototype.redo=function(t){for(var e,n=0;e=this.historyItems[n];n++)e.redo(t)},e.prototype.undo=function(t){for(var e,n=this.dataSyncItems.length-1;e=this.dataSyncItems[n];n--)e.undo(t);this.dataSyncItems=[];for(n=this.historyItems.length-1;e=this.historyItems[n];n--)e.undo(t)},e.prototype.add=function(t){if(null==t)throw new Error("cannot be null");this.historyItems.push(t)},e}(i);e.CompositionHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Connector=e.CONNECTOR_DEFAULT_TEXT_POSITION=e.ConnectorPosition=void 0;var i,r=n(11),a=n(12),s=n(41),c=n(2),u=n(42),l=n(83),p=n(13),h=n(43),d=n(4),f=n(58),m=n(18),g=n(27),y=n(3),v=n(8),C=n(177),_=n(178),P=n(184),S=n(31),b=n(185),x=n(85);(function(t){t[t["Begin"]=0]="Begin",t[t["End"]=1]="End"})(i=e.ConnectorPosition||(e.ConnectorPosition={})),e.CONNECTOR_DEFAULT_TEXT_POSITION=.5;var w=function(t){function n(e){var n=t.call(this)||this;if(n.beginConnectionPointIndex=-1,n.endConnectionPointIndex=-1,n.properties=new S.ConnectorProperties,n.points=e.map((function(t){return t.clone()})),e.length<2)throw Error("Points count should be greater than 1");return n.texts=new b.ConnectorTexts,n}return o(n,t),Object.defineProperty(n.prototype,"rectangle",{get:function(){var t=this.getRenderPoints(),e=t.map((function(t){return t.x})),n=t.map((function(t){return t.y})),o=e.reduce((function(t,e){return Math.min(t,e)}),Number.MAX_VALUE),i=e.reduce((function(t,e){return Math.max(t,e)}),-Number.MAX_VALUE),r=n.reduce((function(t,e){return Math.min(t,e)}),Number.MAX_VALUE),s=n.reduce((function(t,e){return Math.max(t,e)}),-Number.MAX_VALUE);return new a.Rectangle(o,r,i-o,s-r)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldChangeRenderPoints",{get:function(){return void 0!==this.renderPoints&&void 0!==this.routingStrategy},enumerable:!1,configurable:!0}),n.prototype.assign=function(e){t.prototype.assign.call(this,e),e.beginItem=this.beginItem,e.beginConnectionPointIndex=this.beginConnectionPointIndex,e.endItem=this.endItem,e.endConnectionPointIndex=this.endConnectionPointIndex,e.properties=this.properties.clone(),e.texts=this.texts.clone(),void 0!==this.routingStrategy&&(e.routingStrategy=this.routingStrategy.clone()),void 0!==this.renderPoints&&(e.renderPoints=this.renderPoints.map((function(t){return t.clone()}))),void 0!==this.actualRoutingMode&&(e.actualRoutingMode=this.actualRoutingMode),this.lockCreateRenderPoints&&(e.lockCreateRenderPoints=this.lockCreateRenderPoints),this.shouldInvalidateRenderPoints&&(e.shouldInvalidateRenderPoints=this.shouldInvalidateRenderPoints)},n.prototype.clone=function(){var t=new n(this.points);return this.assign(t),t},n.prototype.getTextCount=function(){return this.texts.count()},n.prototype.getText=function(t){void 0===t&&(t=e.CONNECTOR_DEFAULT_TEXT_POSITION);var n=this.texts.get(t);return n?n.value:""},n.prototype.setText=function(t,n){void 0===n&&(n=e.CONNECTOR_DEFAULT_TEXT_POSITION),t&&""!==t?this.texts.set(n,new b.ConnectorText(n,t)):this.texts.remove(n)},n.prototype.getTextPoint=function(t){var e=this.getRenderPoints();return y.GeometryUtils.getPathPointByPosition(e,t)[0]},n.prototype.getTextPositionByPoint=function(t){var e=this.getRenderPoints(),n=y.GeometryUtils.getPathLength(e),o=y.GeometryUtils.getPathPositionByPoint(e,t),i=r.UnitConverter.pointsToTwips(parseInt(this.styleText["font-size"]));return i>o*n?i/n:i>n-o*n?(n-i)/n:o},n.prototype.getTextRectangle=function(t){return a.Rectangle.fromGeometry(this.getTextPoint(t),new c.Size(0,0))},n.prototype.getRenderPoints=function(t){if(void 0===t&&(t=!1),void 0===this.shouldInvalidateRenderPoints||this.shouldInvalidateRenderPoints)if(this.shouldInvalidateRenderPoints=!1,this.routingStrategy){if(!this.lockCreateRenderPoints){if(this.renderPoints=new _.ConnectorPointsOrthogonalCalculator(this).getPoints(),this.renderPoints&&!this.points[0].equals(this.points[this.points.length-1])&&this.actualRoutingMode!==g.ConnectorRoutingMode.None){this.actualRoutingMode=g.ConnectorRoutingMode.None;var e=this.routingStrategy.createRoutingSegments(this.renderPoints);this.routingStrategy.isValidRouting(e,this.beginItem,this.endItem)||(this.actualRoutingMode=g.ConnectorRoutingMode.AllShapesOnly,this.renderPoints=this.routingStrategy.createRoutedRenderPoints(this.points,e,this.beginItem,this.endItem,this.beginConnectionPointIndex,this.endConnectionPointIndex))}this.calculateRenderPointsWithoutSkipped()}}else this.renderPoints=this.getCalculator().getPoints(),this.calculateRenderPointsWithoutSkipped();return t?this.renderPoints:this.renderPointsWithoutSkipped},n.prototype.createRenderPointsContext=function(){return this.shouldChangeRenderPoints?new x.ConnectorRenderPointsContext(this.renderPoints.map((function(t){return t.clone()})),this.lockCreateRenderPoints,this.actualRoutingMode):void 0},n.prototype.updatePointsOnPageResize=function(t,e){this.points=this.points.map((function(n){return n.clone().offset(t,e)})),this.renderPoints&&(this.renderPoints=this.renderPoints.map((function(n){var o=n.clone().offset(t,e);return o.pointIndex=n.pointIndex,o.skipped=n.skipped,o})),this.calculateRenderPointsWithoutSkipped())},n.prototype.changePoints=function(t,e){this.points=t,this.replaceRenderPoints(e)},n.prototype.addPoint=function(t,e){this.points.splice(t,0,e)},n.prototype.deletePoint=function(t){this.points.splice(t,1)},n.prototype.movePoint=function(t,e){this.points[t]=e},n.prototype.onAddPoint=function(t,e,n){this.shouldChangeRenderPoints?this.replaceRenderPointsCore(this.routingStrategy.onAddPoint(this.points,t,e,this.renderPoints,n),n,g.ConnectorRoutingMode.AllShapesOnly):this.invalidateRenderPoints()},n.prototype.onDeletePoint=function(t,e,n){this.shouldChangeRenderPoints?this.replaceRenderPointsCore(this.routingStrategy.onDeletePoint(this.points,t,this.renderPoints,e),void 0===n?this.lockCreateRenderPoints:n,g.ConnectorRoutingMode.AllShapesOnly):this.invalidateRenderPoints()},n.prototype.onMovePoint=function(t,e){this.shouldChangeRenderPoints?(0!==t&&t!==this.points.length-1||(this.lockCreateRenderPoints=!1),this.replaceRenderPointsCore(this.routingStrategy.onMovePoint(this.points,t,e,this.renderPoints),this.lockCreateRenderPoints,g.ConnectorRoutingMode.AllShapesOnly)):this.invalidateRenderPoints()},n.prototype.replaceRenderPoints=function(t){void 0!==t?this.replaceRenderPointsCore(t.renderPoints,t.lockCreateRenderPoints,t.actualRoutingMode):this.invalidateRenderPoints()},n.prototype.replaceRenderPointsCore=function(t,e,n){this.renderPoints=t,this.lockCreateRenderPoints=e,this.actualRoutingMode=n,this.calculateRenderPointsWithoutSkipped(),this.invalidateRenderPoints()},n.prototype.calculateRenderPointsWithoutSkipped=function(){this.renderPointsWithoutSkipped=this.renderPoints.filter((function(t){return!t.skipped}))},n.prototype.getCalculator=function(){return this.properties.lineOption===S.ConnectorLineOption.Straight?new C.ConnectorPointsCalculator(this):new _.ConnectorPointsOrthogonalCalculator(this)},n.prototype.invalidateRenderPoints=function(){this.shouldInvalidateRenderPoints=!0},n.prototype.createPrimitives=function(){var t=[],e=this.getRenderPoints(),n=new d.PathPrimitive(e.map((function(t,e){return 0===e?new d.PathPrimitiveMoveToCommand(t.x,t.y):new d.PathPrimitiveLineToCommand(t.x,t.y)})),this.style);return t.push(n),t=t.concat(this.createLineEndingPrimitives(e,n)),t=t.concat(this.createTextPrimitives()),t},n.prototype.createLineEndingPrimitives=function(t,e){var n=[];if(t.length>1){var o=[{strategy:this.createLineEndingStrategy(this.properties.startLineEnding),point1:t[0],point2:t[1]},{strategy:this.createLineEndingStrategy(this.properties.endLineEnding),point1:t[t.length-1],point2:t[t.length-2]}];o.forEach((function(t){var o=t.strategy;if(o.hasCommands()){var i=e;o.needCreateSeparatePrimitive()&&n.push(i=o.createPrimitive()),i.commands=i.commands.concat(o.createCommands(t.point1,t.point2))}}))}return n},n.prototype.createLineEndingStrategy=function(t){switch(t){case S.ConnectorLineEnding.None:return new P.ConnectorLineEndingNoneStrategy(this.style);case S.ConnectorLineEnding.Arrow:return new P.ConnectorLineEndingArrowStrategy(this.style);case S.ConnectorLineEnding.OutlinedTriangle:return new P.ConnectorLineEndingOutlinedTriangleStrategy(this.style);case S.ConnectorLineEnding.FilledTriangle:return new P.ConnectorLineEndingFilledTriangleStrategy(this.style);default:return new P.ConnectorLineEndingStrategy(this.style)}},n.prototype.createSelectorPrimitives=function(){var t=[],e=this.getRenderPoints();return t.push(new d.PathPrimitive(e.map((function(t,e){return 0===e?new d.PathPrimitiveMoveToCommand(t.x,t.y):new d.PathPrimitiveLineToCommand(t.x,t.y)})),null,"selector")),t},n.prototype.createTextPrimitives=function(){var t=this;if(!this.enableText)return[];var e=[];return this.texts.forEach((function(n){var o=t.getText(n.position);if(o&&""!==o){var i=t.getTextPoint(n.position);e=e.concat([new f.TextPrimitive(i.x,i.y,o,h.TextOwner.Connector,void 0,void 0,void 0,t.styleText,!0,null,u.PAGE_BG_TEXTFLOOR_FILTER_ID,void 0,(function(e){m.RenderUtils.setElementEventData(e,p.MouseEventElementType.ConnectorText,t.key,n.position)}))])}})),e},n.prototype.getExtremeItem=function(t){return t===i.Begin?this.beginItem:t===i.End?this.endItem:null},n.prototype.getExtremeConnectionPointIndex=function(t){return t===i.Begin?this.beginConnectionPointIndex:t===i.End?this.endConnectionPointIndex:-1},n.prototype.getMinX=function(){var t=this.getRenderPoints(),e=t.map((function(t){return t.x}));return e.reduce((function(t,e){return Math.min(t,e)}),Number.MAX_VALUE)},n.prototype.getMinY=function(){var t=this.getRenderPoints(),e=t.map((function(t){return t.y}));return e.reduce((function(t,e){return Math.min(t,e)}),Number.MAX_VALUE)},n.prototype.getConnectionPoints=function(){return[]},n.prototype.getConnectionPointSide=function(t,e){return v.ConnectionPointSide.Undefined},n.prototype.getSegments=function(){var t=[],e=this.getRenderPoints();return e.forEach((function(n,o){o>0&&t.push(new s.Segment(e[o-1],n))})),t},n.prototype.intersectedByRect=function(t){return this.getSegments().some((function(e){return e.isIntersectedByRect(t)}))},n.prototype.toNative=function(t){var e=new l.NativeConnector(this.key,this.dataKey);return e.fromKey=this.beginItem&&this.beginItem.dataKey,e.toKey=this.endItem&&this.endItem.dataKey,e.texts=this.texts.map((function(t){return t})).sort((function(t,e){return t.position-e.position})).map((function(t){return t.value})),e.fromId=this.beginItem&&this.beginItem.key,e.fromPointIndex=this.beginConnectionPointIndex,e.toId=this.endItem&&this.endItem.key,e.toPointIndex=this.endConnectionPointIndex,e.points=this.points.map((function(t){return t.clone()})),e.applyUnits(t),e},n.minOffset=r.UnitConverter.pixelsToTwips(24),n.minTextHeight=r.UnitConverter.pixelsToTwips(12),n}(v.DiagramItem);e.Connector=w},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeDescription=e.ShapeTextPadding=e.ShapeDefaultSize=e.ShapeMinDimension=e.ShapeDefaultDimension=void 0;var o=n(11),i=n(2),r=n(34),a=n(43),s=n(22),c=n(58),u=n(3),l=n(45),p=n(8);e.ShapeDefaultDimension=1440,e.ShapeMinDimension=360,e.ShapeDefaultSize=new i.Size(e.ShapeDefaultDimension,e.ShapeDefaultDimension),e.ShapeTextPadding=o.UnitConverter.pixelsToTwips(10);var h=function(){function t(t,n){void 0===t&&(t=e.ShapeDefaultSize.clone()),this.defaultSize=t,this.hasDefaultText=n,this.onChanged=new u.EventDispatcher,this.connectionPoints=this.createConnectionPoints()}return Object.defineProperty(t.prototype,"enableText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowEditText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enableImage",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowEditImage",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasTemplate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enableChildren",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minWidth",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minHeight",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"toolboxSize",{get:function(){return this.defaultSize},enumerable:!1,configurable:!0}),t.prototype.getTitle=function(){return r.DiagramLocalizationService.shapeTexts[this.key]},t.prototype.getDefaultText=function(){return this.hasDefaultText?r.DiagramLocalizationService.shapeTexts[this.key]:""},t.prototype.getDefaultImageUrl=function(){return""},t.prototype.getConnectionPoints=function(){return this.connectionPoints},t.prototype.createConnectionPoints=function(){return[new l.ConnectionPoint(.5,0,p.ConnectionPointSide.North),new l.ConnectionPoint(1,.5,p.ConnectionPointSide.East),new l.ConnectionPoint(.5,1,p.ConnectionPointSide.South),new l.ConnectionPoint(0,.5,p.ConnectionPointSide.West)]},t.prototype.processConnectionPoint=function(t,e){},t.prototype.getConnectionPointIndexForItem=function(t,e){return e},t.prototype.getConnectionPointIndexForSide=function(t){return t},t.prototype.createParameters=function(t){},t.prototype.normalizeParameters=function(t,e){},t.prototype.modifyParameters=function(t,e,n,o){throw Error("Not implemented")},t.prototype.changeParameterValue=function(t,e,n){var o=t.get(e);o.value=n(o)},t.prototype.getParameterPoints=function(t){return[]},t.prototype.getExpandedSize=function(t){return t.size},t.prototype.getCollapsedSize=function(t){return t.size},t.prototype.getToolboxHeightToWidthRatio=function(t,e){return e/t},t.prototype.allowResizeHorizontally=function(t){return!0},t.prototype.allowResizeVertically=function(t){return!0},t.prototype.createPrimitives=function(t,e){var n=[];return n=n.concat(this.createShapePrimitives(t,e)),this.enableImage&&(n=n.concat(this.createImagePrimitives(t,e))),this.enableText&&(n=n.concat(this.createTextPrimitives(t,e))),n},t.prototype.createImagePrimitives=function(t,e){return[]},t.prototype.createTextPrimitives=function(e,n){if(void 0===e.text||""===e.text)return[];var o=this.getTextRectangle(e);return[new c.TextPrimitive(o.x,o.y,e.text,a.TextOwner.Shape,o.width,o.height,t.textSpacing,e.styleText,!1,this.getTextClipPathId(n),void 0,this.getTextAngle())]},t.prototype.getTextClipPathId=function(t){},t.prototype.getTextAngle=function(){return c.TextAngle.Angle0deg},t.prototype.getClientRectangle=function(t){return t.rectangle},t.prototype.getTextEditRectangle=function(t){return this.getTextRectangle(t)},t.prototype.createSelectorPrimitives=function(t){return[new s.RectanglePrimitive(t.position.x,t.position.y,t.size.width,t.size.height,null,"selector")]},t.prototype.raiseShapeDescriptionChanged=function(t){this.onChanged.raise1((function(e){return e.notifyShapeDescriptionChanged(t)}))},t.textSpacing=o.UnitConverter.pixelsToTwips(2),t}();e.ShapeDescription=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramItem=e.DEFAULT_ZINDEX=e.ConnectionPointSide=void 0;var o,i=n(3),r=n(12),a=n(29);(function(t){t[t["Undefined"]=-1]="Undefined",t[t["North"]=0]="North",t[t["East"]=1]="East",t[t["South"]=2]="South",t[t["West"]=3]="West"})(o=e.ConnectionPointSide||(e.ConnectionPointSide={})),e.DEFAULT_ZINDEX=0;var s=function(){function t(){this.key=void 0,this.dataKey=void 0,this.customData=void 0,this.attachedConnectors=[],this.zIndex=e.DEFAULT_ZINDEX,this.locked=!1,this.container=void 0,this.style=new a.Style,this.styleText=new a.TextStyle}return t.prototype.assign=function(t){t.key=this.key,t.dataKey=this.dataKey,t.customData=i.ObjectUtils.cloneObject(this.customData),t.locked=this.locked,t.attachedConnectors=this.attachedConnectors.slice(),t.style=this.style.clone(),t.styleText=this.styleText.clone(),t.zIndex=this.zIndex,t.container=this.container},t.prototype.getConnectionPointPosition=function(t,e){return this.getConnectionPoint(t,e).toPoint()},t.prototype.getConnectionPoint=function(t,e){t<0&&e&&(t=this.getNearestConnectionPoint(e));var n=this.getConnectionPoints();return n[t]||n[0]},t.prototype.getNearestConnectionPoint=function(t){var e,n=Number.MAX_VALUE;return this.getConnectionPoints().forEach((function(o,r){var a=i.GeometryUtils.getDistance(o,t);a<n&&(n=a,e=r)})),e},t.prototype.getConnectionPointIndex=function(t){var e=this.getConnectionPoints();return e.reduce((function(n,i,r){return t===o.North&&i.y<e[n].y||t===o.South&&i.y>e[n].y||t===o.West&&i.x<e[n].x||t===o.East&&i.x>e[n].x?r:n}),0)},t.prototype.getConnectionPointSideByIndex=function(t,e){var n=this.getConnectionPoint(t,e);return this.getConnectionPointSide(n,e)},t.prototype.getConnectionPointIndexForSide=function(t){return t},Object.defineProperty(t.prototype,"enableText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowEditText",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasTemplate",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enableChildren",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLocked",{get:function(){return this.locked||this.container&&this.container.isLocked},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowResizeHorizontally",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowResizeVertically",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return this.style.strokeWidth},enumerable:!1,configurable:!0}),t.prototype.intersectedByRect=function(t){return r.Rectangle.areIntersected(this.rectangle,t)},t}();e.DiagramItem=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModelUtils=void 0;var o=n(11),i=n(1),r=n(12),a=n(2),s=n(82),c=n(40),u=n(47),l=n(48),p=n(61),h=n(186),d=n(51),f=n(115),m=n(62),g=n(116),y=n(187),v=n(117),C=n(188),_=n(189),P=n(190),S=n(191),b=n(118),x=n(63),w=n(192),I=n(193),T=n(87),O=n(64),E=n(119),M=n(88),D=n(65),A=n(66),k=n(194),L=n(36),R=n(3),z=n(6),N=n(31),j=n(85),U=n(14),B=function(){function t(){}return t.setShapePosition=function(t,e,n,o){n.position.equals(o)||t.addAndRedo(new P.MoveShapeHistoryItem(n.key,o))},t.setShapeSize=function(t,e,n,o,i){n.size.equals(i)&&n.position.equals(o)||t.addAndRedo(new b.ResizeShapeHistoryItem(n.key,o,i))},t.addConnectorPoint=function(t,e,n,o){t.addAndRedo(new h.AddConnectorPointHistoryItem(e.key,n,o))},t.addConnectorCustomPoint=function(t,e,n,o){t.addAndRedo(new h.AddConnectorPointHistoryItem(e.key,n,o,!0))},t.deleteConnectorPoint=function(t,e,n){t.addAndRedo(new y.DeleteConnectorPointHistoryItem(e.key,n,!1,!1))},t.deleteConnectorUnnecessaryPoint=function(t,e,n){t.addAndRedo(new y.DeleteConnectorPointHistoryItem(e.key,n,!1))},t.deleteConnectorCustomPoint=function(t,e,n){t.addAndRedo(new y.DeleteConnectorPointHistoryItem(e.key,n,!0))},t.deleteConnectorPoints=function(t,e){while(e.points.length)this.deleteConnectorPoint(t,e,0)},t.deleteConnectorCustomPoints=function(t,e){while(e.points.length>2)this.deleteConnectorCustomPoint(t,e,1)},t.moveConnectorPoint=function(t,e,n,o){e.points[n].equals(o)||t.addAndRedo(new _.MoveConnectorPointHistoryItem(e.key,n,o))},t.updateConnectorAttachedPoints=function(t,e,n){t.beginTransaction();var o=n.beginItem&&e.findItemCollapsedContainer(n.beginItem),i=o&&(!n.endItem||!e.isContainerItem(o,n.endItem)),r=n.endItem&&e.findItemCollapsedContainer(n.endItem),a=r&&(!n.beginItem||!e.isContainerItem(r,n.beginItem));i?this.updateConnectorBeginPoint(t,n,o,a&&r||n.endItem,(function(t){return o.getConnectionPointIndexForItem(n.beginItem,t)})):this.updateConnectorBeginPoint(t,n,n.beginItem,a&&r||n.endItem),a?this.updateConnectorEndPoint(t,n,r,(function(t){return r.getConnectionPointIndexForItem(n.beginItem,t)})):this.updateConnectorEndPoint(t,n,n.endItem),t.endTransaction()},t.updateConnectorBeginPoint=function(t,e,n,o,r){if(n){var a=void 0!==r?r(e.beginConnectionPointIndex):e.beginConnectionPointIndex,s=e.points[1];o&&2===e.points.length&&(s=-1!==e.endConnectionPointIndex?o.getConnectionPointPosition(e.endConnectionPointIndex,i.Point.zero()):o.rectangle.center);var c=n.getConnectionPointPosition(a,s);this.moveConnectorPoint(t,e,0,c.clone())}},t.updateConnectorEndPoint=function(t,e,n,o){if(n){var i=void 0!==o?o(e.endConnectionPointIndex):e.endConnectionPointIndex,r=n.getConnectionPointPosition(i,e.points[e.points.length-2]);this.moveConnectorPoint(t,e,e.points.length-1,r)}},t.updateContainerConnectorsAttachedPoints=function(t,e,n,o){var i=this;void 0===o&&(o=n),t.beginTransaction();var r=e.getChildren(o);r.forEach((function(r){r instanceof U.Shape&&(r.attachedConnectors.forEach((function(r){var a=r.beginItem&&e.isContainerItem(o,r.beginItem),s=r.endItem&&e.isContainerItem(o,r.endItem);if(a&&!s){var c=e.findItemTopCollapsedContainer(r.beginItem),u=r.endItem&&e.findItemTopCollapsedContainer(r.endItem);c?i.updateConnectorBeginPoint(t,r,c,u||r.endItem,(function(t){return n.getConnectionPointIndexForItem(r.beginItem,t)})):i.updateConnectorBeginPoint(t,r,r.beginItem,u||r.endItem)}if(s&&!a){c=e.findItemTopCollapsedContainer(r.endItem);c?i.updateConnectorEndPoint(t,r,c,(function(t){return n.getConnectionPointIndexForItem(r.endItem,t)})):i.updateConnectorEndPoint(t,r,r.endItem)}})),i.updateContainerConnectorsAttachedPoints(t,e,n,r))})),t.endTransaction()},t.getConnectorsWithoutBeginItemInfo=function(t){var e=t.findConnectorsWithoutBeginItem();return e.map((function(t){return{connector:t,point:t.points[0].clone()}}))},t.getConnectorsWithoutEndItemInfo=function(t){var e=t.findConnectorsWithoutEndItem();return e.map((function(t){return{connector:t,point:t.points[t.points.length-1].clone()}}))},t.updateShapeAttachedConnectors=function(t,e,n){var o=this;n.attachedConnectors.forEach((function(n){o.removeConnectorIntermediatePoints(t,n),o.updateConnectorAttachedPoints(t,e,n)}))},t.updateMovingShapeConnections=function(t,e,n,o,i,r,a){var s=this;i(),n.forEach((function(n){var o=s.getMovingShapeConnectionPointIndex(e,n.point);e.rectangle.containsPoint(n.point)||o>-1?(r(e,o),o!==n.connector.beginConnectionPointIndex&&n.connector.beginItem&&t.addAndRedo(new m.DeleteConnectionHistoryItem(n.connector,z.ConnectorPosition.Begin)),a(n.connector),t.addAndRedo(new l.AddConnectionHistoryItem(n.connector,e,o,z.ConnectorPosition.Begin))):n.connector.beginItem&&(t.addAndRedo(new m.DeleteConnectionHistoryItem(n.connector,z.ConnectorPosition.Begin)),t.addAndRedo(new _.MoveConnectorPointHistoryItem(n.connector.key,0,n.point)))})),o.forEach((function(n){var o=s.getMovingShapeConnectionPointIndex(e,n.point);e.rectangle.containsPoint(n.point)||o>-1?(r(e,o),o!==n.connector.endConnectionPointIndex&&n.connector.endItem&&t.addAndRedo(new m.DeleteConnectionHistoryItem(n.connector,z.ConnectorPosition.End)),a(n.connector),t.addAndRedo(new l.AddConnectionHistoryItem(n.connector,e,o,z.ConnectorPosition.End))):n.connector.endItem&&(t.addAndRedo(new m.DeleteConnectionHistoryItem(n.connector,z.ConnectorPosition.End)),t.addAndRedo(new _.MoveConnectorPointHistoryItem(n.connector.key,n.connector.points.length-1,n.point)))}))},t.getMovingShapeConnectionPointIndex=function(t,e){var n=this,o=-1;return t.getConnectionPoints().forEach((function(t,i){R.GeometryUtils.getDistance(e,t)<n.connectionPointActionSize&&(o=i)})),o},t.removeUnnecessaryConnectorPoints=function(t,e,n,o){var i=this;t.beginTransaction(),R.GeometryUtils.removeUnnecessaryLinePoints(e.points,(function(r,a){var s=!0;if(n&&n.forEach((function(t){t&&t.equals(r)&&(s=!1)})),s)return i.deleteConnectorUnnecessaryPoint(t,e,a),void 0!==o&&o(a),!0})),t.endTransaction()},t.shouldRemoveConnectorIntermediatePoints=function(t){return t.properties.lineOption===N.ConnectorLineOption.Orthogonal&&t.points.length>2&&(this.isShapeIntersectConnectorPointsLine(t.beginItem,t)||this.isShapeIntersectConnectorPointsLine(t.endItem,t))},t.removeConnectorIntermediatePoints=function(t,e){this.shouldRemoveConnectorIntermediatePoints(e)&&this.removeConnectorIntermediatePointsCore(t,e)},t.removeConnectorIntermediatePointsCore=function(t,e){t.beginTransaction(),this.deleteConnectorCustomPoints(t,e),t.endTransaction()},t.isShapeIntersectConnectorPointsLine=function(t,e){if(!t)return!1;for(var n,i=z.Connector.minOffset-o.UnitConverter.pixelsToTwips(1),r=t.rectangle.clone().inflate(i,i),a=1;a<e.points.length-1;a++){if(void 0!==n){if(n.x===e.points[a].x&&r.x<=n.x&&n.x<=r.right)return!0;if(n.y===e.points[a].y&&r.y<=n.y&&n.y<=r.bottom)return!0}n=e.points[a]}return!1},t.getSnappedPos=function(t,e,n,o){var i=o?t.snapStartPoint.x:t.snapStartPoint.y;return Math.round((n-i)/e)*e+i},t.tryUpdateModelSize=function(t,e,n){var o=t.modelManipulator.getModelSizeUpdateOffset();if(!o.isEmpty()){if(t.addAndRedo(new w.ModelResizeHistoryItem(o)),o.left||o.top){var i=new s.Vector(o.left,o.top);t.addAndRedo(new I.UpdatePositionsOnPageResizeHistoryItem(i)),void 0!==n&&n(o.left,o.top)}t.modelManipulator.raiseModelRectangleChanged(e.getRectangle(!0))}},t.deleteItems=function(t,e,n,o,i){t.beginTransaction();var r={};o.forEach((function(t){return r[t.key]=t}));var a=n.getKeys().filter((function(t){return!r[t]}));t.addAndRedo(new x.SetSelectionHistoryItem(n,a)),this.deleteItemsCore(t,e,o,i),this.tryUpdateModelSize(t,e),t.endTransaction()},t.deleteItemsCore=function(t,e,n,o){var i=this;n.forEach((function(n){if(n.container&&i.removeFromContainer(t,e,n),n instanceof U.Shape){var r=e.getChildren(n);r.length&&(r.forEach((function(n){t.addAndRedo(new S.RemoveFromContainerHistoryItem(n)),i.updateAttachedConnectorsContainer(t,e,n)})),i.deleteItemsCore(t,e,r.filter((function(t){return!t.locked||o})),o)),e.findItem(n.key)&&i.deleteShape(t,n)}n instanceof z.Connector&&e.findItem(n.key)&&i.deleteConnector(t,n)}))},t.detachConnectors=function(t,e){t.beginTransaction();while(e.attachedConnectors.length>0){var n=e.attachedConnectors[0];t.addAndRedo(new m.DeleteConnectionHistoryItem(n,n.beginItem===e?z.ConnectorPosition.Begin:z.ConnectorPosition.End))}t.endTransaction()},t.deleteShape=function(t,e){t.beginTransaction(),this.detachConnectors(t,e),t.addAndRedo(new v.DeleteShapeHistoryItem(e.key)),t.endTransaction()},t.deleteConnector=function(t,e){t.beginTransaction(),e.beginItem&&t.addAndRedo(new m.DeleteConnectionHistoryItem(e,z.ConnectorPosition.Begin)),e.endItem&&t.addAndRedo(new m.DeleteConnectionHistoryItem(e,z.ConnectorPosition.End)),t.addAndRedo(new g.DeleteConnectorHistoryItem(e.key)),t.endTransaction()},t.deleteAllItems=function(t,e,n){this.deleteItems(t,e,n,e.items.slice(),!0)},t.deleteSelection=function(t,e,n){this.deleteItems(t,e,n,n.getSelectedItems())},t.changeSelectionLocked=function(e,n,o,i){e.beginTransaction();var r=o.getSelectedItems(!0);r.forEach((function(t){e.addAndRedo(new E.ChangeLockedHistoryItem(t,i))})),t.updateSelection(e,o),e.endTransaction()},t.copyStylesToItem=function(t,e,n,o){var i=e.findItem(o);n.styleText.forEach((function(e){n.styleText[e]!==i.styleText[e]&&t.addAndRedo(new D.ChangeStyleTextHistoryItem(o,e,n.styleText[e]))})),n.style.forEach((function(e){n.style[e]!==i.style[e]&&t.addAndRedo(new M.ChangeStyleHistoryItem(o,e,n.style[e]))}))},t.updateSelection=function(t,e){t.addAndRedo(new x.SetSelectionHistoryItem(e,e.getKeys(),!0))},t.cloneShapeToOffset=function(t,e,n,o,i){t.beginTransaction();var r=n.position.clone().offset(o,i),a=new d.AddShapeHistoryItem(n.description,r,n.text);t.addAndRedo(a);var s=a.shapeKey;return t.addAndRedo(new b.ResizeShapeHistoryItem(s,r,n.size.clone())),t.addAndRedo(new f.ChangeShapeParametersHistoryItem(s,n.parameters.clone())),this.copyStylesToItem(t,e,n,s),t.endTransaction(),s},t.applyOffsetToConnectorRenderPointsContext=function(t,e,n){return t&&t.renderPoints?new j.ConnectorRenderPointsContext(t.renderPoints.map((function(t){return t.clone().offset(e,n)})),!0,t.actualRoutingMode):void 0},t.cloneConnectorToOffset=function(t,e,n,o,i,r,a){t.beginTransaction();var s=n.points.map((function(t){return t.clone().offset(r,a)})),c=new p.AddConnectorHistoryItem(s,void 0,this.applyOffsetToConnectorRenderPointsContext(n.createRenderPointsContext(),r,a));t.addAndRedo(c);var u=c.connectorKey,h=e.findConnector(u);if(n.properties.forEach((function(e){n.properties[e]!==h.properties[e]&&t.addAndRedo(new T.ChangeConnectorPropertyHistoryItem(u,e,n.properties[e]))})),o){var d=e.findShape(o);t.addAndRedo(new l.AddConnectionHistoryItem(h,d,n.beginConnectionPointIndex,z.ConnectorPosition.Begin))}if(i){var f=e.findShape(i);t.addAndRedo(new l.AddConnectionHistoryItem(h,f,n.endConnectionPointIndex,z.ConnectorPosition.End))}var m=n.texts.clone();return m.forEach((function(e){t.addAndRedo(new O.ChangeConnectorTextHistoryItem(h,e.position,e.value))})),this.copyStylesToItem(t,e,n,u),t.endTransaction(),u},t.cloneSelectionToOffset=function(e,n,o,i,r,a){var s=this;e.beginTransaction();var c={},u=[];i.getSelectedShapes().forEach((function(t){var i=s.cloneShapeToOffset(e,n,t,r,a);c[t.key]=i,u.push(i),o&&o(i)})),i.getSelectedConnectors().forEach((function(t){var i=t.beginItem?c[t.beginItem.key]:null,l=t.endItem?c[t.endItem.key]:null,p=s.cloneConnectorToOffset(e,n,t,i,l,r,a);u.push(p),o&&o(p)})),e.addAndRedo(new x.SetSelectionHistoryItem(i,u)),t.tryUpdateModelSize(e,n),e.endTransaction()},t.findContainerByEventKey=function(e,n,o){var i=e.findContainer(o);if(i&&!i.isLocked)return i;var r=e.findShape(o);return r&&r.container&&!n.hasKey(r.key)?t.findContainerByEventKey(e,n,r.container.key):void 0},t.canInsertToContainer=function(t,e,n){return e!==n&&!(e instanceof U.Shape&&t.findChild(e,n.key))},t.canInsertSelectionToContainer=function(t,e,n){var o=!0;return e.getSelectedItems().forEach((function(e){e!==n?e instanceof U.Shape&&t.findChild(e,n.key)&&(o=!1):o=!1})),o},t.insertToContainer=function(t,e,n,o){if(!o.enableChildren)throw Error("Inpossible to add children to non-container shape.");if(this.canInsertToContainer(e,n,o)){var i=n.container;i!==o&&(t.beginTransaction(),i&&t.addAndRedo(new S.RemoveFromContainerHistoryItem(n)),t.addAndRedo(new C.InsertToContainerHistoryItem(n,o)),this.updateAttachedConnectorsContainer(t,e,n),t.endTransaction())}},t.removeFromContainer=function(t,e,n){n.container&&(t.beginTransaction(),t.addAndRedo(new S.RemoveFromContainerHistoryItem(n)),this.updateAttachedConnectorsContainer(t,e,n),t.endTransaction())},t.insertSelectionToContainer=function(t,e,n,o){var i=this;t.beginTransaction();var r=n.getSelectedItems(),a=r.filter((function(t){return!t.container||-1===r.indexOf(t.container)}));a.forEach((function(n){i.insertToContainer(t,e,n,o)})),t.endTransaction()},t.removeSelectionFromContainer=function(t,e,n){var o=this;t.beginTransaction(),n.getSelectedItems().forEach((function(i){i.container&&!n.hasKey(i.container.key)&&(t.addAndRedo(new S.RemoveFromContainerHistoryItem(i)),o.updateAttachedConnectorsContainer(t,e,i))})),t.endTransaction()},t.getConnectorContainer=function(t){if(t.beginItem&&t.endItem&&t.beginItem.container===t.endItem.container)return t.beginItem.container},t.updateAttachedConnectorsContainer=function(t,e,n){var o=this;t.beginTransaction(),n.attachedConnectors.forEach((function(n){o.updateConnectorContainer(t,e,n)})),t.endTransaction()},t.updateConnectorContainer=function(t,e,n){var o=this.getConnectorContainer(n);o?t.addAndRedo(new C.InsertToContainerHistoryItem(n,o)):n.container&&t.addAndRedo(new S.RemoveFromContainerHistoryItem(n))},t.updateNewShapeProperties=function(t,e,n){var o=e.inputPosition.getDefaultStyle();o.forEach((function(o){t.addAndRedo(new M.ChangeStyleHistoryItem(n,o,e.inputPosition.getDefaultStylePropertyValue(o)))}));var i=e.inputPosition.getDefaultTextStyle();i.forEach((function(o){t.addAndRedo(new D.ChangeStyleTextHistoryItem(n,o,e.inputPosition.getDefaultTextStylePropertyValue(o)))}))},t.updateNewConnectorProperties=function(t,e,n){var o=e.inputPosition.getDefaultConnectorProperties();o.forEach((function(o){t.addAndRedo(new T.ChangeConnectorPropertyHistoryItem(n,o,e.inputPosition.getDefaultConnectorPropertyValue(o)))}));var i=e.inputPosition.getDefaultStyle();i.forEach((function(o){t.addAndRedo(new M.ChangeStyleHistoryItem(n,o,e.inputPosition.getDefaultStylePropertyValue(o)))}));var r=e.inputPosition.getDefaultTextStyle();r.forEach((function(o){t.addAndRedo(new D.ChangeStyleTextHistoryItem(n,o,e.inputPosition.getDefaultTextStylePropertyValue(o)))}))},t.applyLayout=function(t,e,n,o,i,r,a,s,c,u){t.beginTransaction();var l=this.getOccupiedRectangles(r,n);return i=this.offsetLayoutToFreeSpace(i,n&&n.clientRectangle,l,a.containerPadding),s&&this.adjustLayoutToSnapGrid(e,i,c),n&&this.resizeContainerOnLayout(t,e,i,n,a.containerPadding),this.applyLayoutToNodes(t,e,i,o.edges.map((function(t){return e.findConnector(t.key)}))),this.applyLayoutToConnectors(t,e,i,o.edges.map((function(t){return e.findConnector(t.key)})),u),t.endTransaction(),i.getRectangle(!0)},t.getNonGraphItems=function(t,e,n,o,i){var r=e?t.getChildren(e):t.items.filter((function(t){return!t.container}));return r.filter((function(t){return t instanceof z.Connector?(!t.beginItem||!n[t.beginItem.key])&&(!t.endItem||!n[t.endItem.key])&&-1===i.indexOf(t):t instanceof U.Shape?!n[t.key]&&-1===o.indexOf(t):void 0}))},t.getOccupiedRectangles=function(t,e){var n=t.map((function(t){return t.rectangle}));if(e&&n.length){var o=e.clientRectangle;n.push(new r.Rectangle(o.right,o.y,1,1)),n.push(new r.Rectangle(o.right,o.bottom,1,1))}return n},t.offsetLayoutToFreeSpace=function(t,e,n,o){var i=t.getRectangle(!0),r=R.GeometryUtils.findFreeSpace(n,i.createSize().offset(o,o).nonNegativeSize(),!1,e);if(r){var a=r.x+o,s=r.y+o;return t.offsetNodes(a,s)}var c=n&&n.length?n.reduce((function(t,e){return e.right>t?e.right:t}),0):e?e.x:0,u=e?e.y:Math.max(0,i.y);return t.offsetNodes(c+o,u+o)},t.resizeContainerOnLayout=function(e,n,o,i,r){var s=o.getRectangle(!0),c=i.children.filter((function(t){return t instanceof U.Shape?-1===o.nodeKeys.indexOf(t.key):!!(t instanceof z.Connector&&t.beginItem&&t.endItem)&&(-1===o.nodeKeys.indexOf(t.beginItem.key)&&-1===o.nodeKeys.indexOf(t.endItem.key))})).map((function(t){return t.rectangle})),u=c.map((function(t){return t.right})).reduce((function(t,e){return Math.max(t,e)}),s.right),l=c.map((function(t){return t.bottom})).reduce((function(t,e){return Math.max(t,e)}),s.bottom),p=i.rectangle.width+u+r-i.rectangle.right,h=i.rectangle.height+l+r-i.rectangle.bottom;t.setShapeSize(e,n,i,i.position,new a.Size(p,h)),t.updateShapeAttachedConnectors(e,n,i)},t.applyLayoutToNodes=function(t,e,n,o){var i=this,r=o.reduce((function(t,e){return t[e.key]=t}),{});n.forEachNode((function(n,o){var a=e.findShape(o);i.applyLayoutToNode(t,e,a,n.position,r)}))},t.applyLayoutToNode=function(e,n,o,i,r){var a=this,s=i.clone().offset(-o.position.x,-o.position.y);t.setShapePosition(e,n,o,i),0===s.x&&0===s.y||(o.attachedConnectors.filter((function(t){return!r[t.key]})).forEach((function(t){a.updateConnectorAttachedPoints(e,n,t);for(var o=t.beginItem?1:0,i=t.endItem?t.points.length-2:t.points.length-1,r=o;r<=i;r++)a.moveConnectorPoint(e,t,r,t.points[r].offset(s.x,s.y))})),n.getChildren(o).forEach((function(t){if(t instanceof U.Shape){var o=t.position.clone().offset(s.x,s.y);a.applyLayoutToNode(e,n,t,o,r)}})))},t.applyLayoutToConnectors=function(e,n,o,i,r){var a=this;i.filter((function(t){return t.beginItem||t.endItem})).forEach((function(i){var s=o.edgeToPosition[i.key];if(i.beginItem&&i.endItem&&!r&&s){var c=i.beginItem.getConnectionPointIndexForSide(s.beginIndex);c!==i.beginConnectionPointIndex&&e.addAndRedo(new l.SetConnectionPointIndexHistoryItem(i,c,z.ConnectorPosition.Begin));var u=i.endItem.getConnectionPointIndexForSide(s.endIndex);u!==i.endConnectionPointIndex&&e.addAndRedo(new l.SetConnectionPointIndexHistoryItem(i,u,z.ConnectorPosition.End))}a.updateConnectorAttachedPoints(e,n,i),s&&t.deleteConnectorCustomPoints(e,i)}))},t.adjustLayoutToSnapGrid=function(t,e,n){var o=this;e.nodeKeys.forEach((function(i){e.nodeToLayout[i].position.x=o.getSnappedPos(t,n,e.nodeToLayout[i].position.x,!0),e.nodeToLayout[i].position.y=o.getSnappedPos(t,n,e.nodeToLayout[i].position.y,!1)}))},t.getGraphInfoByItems=function(t,e,n,o){void 0===o&&(o=!0);var i={},r=[].concat(e).concat(n);r.forEach((function(t){var e=t.container&&t.container.key;i[e]||(i[e]=[]),i[e].push(t)}));var a=[];for(var s in i)if(Object.prototype.hasOwnProperty.call(i,s)){var c=s&&t.findContainer(s);if(!c||c.expanded&&!t.findItemCollapsedContainer(c)){var u=c&&c.key,l=this.getGraphByItems(t,i[s],u,!o),p=!1;(l.nodes.length>1||l.nodes.length&&(o||c&&i[c.container&&c.container.key]))&&(p=!0),p&&a.push(new k.GraphInfo(c,l))}}return a.sort((function(t,e){return e.level-t.level}))},t.getGraphByItems=function(t,e,n,o){var i=this,r=new A.Graph([],[]),a={};return e.forEach((function(t){i.extendByConnectedComponents(t,r,n,a,o)})),r.nodes.sort((function(e,n){return t.getItemIndex(t.findItem(e))-t.getItemIndex(t.findItem(n))})),r.edges.sort((function(e,n){return t.getItemIndex(t.findItem(e.key))-t.getItemIndex(t.findItem(n.key))})),r.edges=r.edges.filter((function(t){return r.getNode(t.from)&&r.getNode(t.to)})),r},t.extendByConnectedComponents=function(t,e,n,o,i){var r=this;!t||i&&t.locked||o[t.key]||(o[t.key]=!0,!(t instanceof z.Connector&&(t.container&&t.container.key)===n&&t.beginItem)||t.beginItem.locked&&i||!t.endItem||t.endItem.locked&&i||t.beginItem===t.endItem?t instanceof U.Shape&&(t.container&&t.container.key)===n&&(e.addNode(t),t.attachedConnectors.forEach((function(t){return r.extendByConnectedComponents(t,e,n,o,i)}))):(e.addEdge(new L.Edge(t.key,t.beginItem&&t.beginItem.key,t.endItem&&t.endItem.key)),this.extendByConnectedComponents(t.beginItem,e,n,o,i),this.extendByConnectedComponents(t.endItem,e,n,o,i)))},t.getlUnitValue=function(t,e){switch(t){case u.DiagramUnit.Cm:return o.UnitConverter.twipsToCentimeters(e);case u.DiagramUnit.In:return o.UnitConverter.twipsToInches(e);case u.DiagramUnit.Px:return o.UnitConverter.twipsToPixels(e)}},t.getUnitText=function(t,e,n,o,i){void 0===i&&(i=2);var r=e[t]?" "+e[t]:"",a=this.getlUnitValue(t,o);switch(t){case u.DiagramUnit.Cm:return n(+a.toFixed(i))+r;case u.DiagramUnit.In:return n(+a.toFixed(i))+r;case u.DiagramUnit.Px:return n(+a.toFixed(0))+r}},t.getTwipsValue=function(t,e){switch(t){case u.DiagramUnit.Cm:return o.UnitConverter.centimetersToTwips(e);case u.DiagramUnit.In:return o.UnitConverter.inchesToTwips(e);case u.DiagramUnit.Px:return o.UnitConverter.pixelsToTwips(e)}},t.getGuidItemKey=function(){return c.MathUtils.generateGuid()},t.createSelectedItems=function(t){var e={};return t.getSelectedItems(!0).forEach((function(t){return e[t.key]=t})),e},t.canMoveConnector=function(t,e){var n=e.beginItem,o=e.endItem;return!n&&!o||!!t[e.key]&&(n===o?!!t[n.key]:n?o?!!t[n.key]&&!!t[o.key]:!!t[n.key]:!!t[o.key])},t.connectionPointActionSize=o.UnitConverter.pixelsToTwips(8),t}();e.ModelUtils=B},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleCommandBase=void 0;var i=n(196),r=n(197),a=n(9),s=n(34),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getState=function(){return new r.SimpleCommandState(this.isEnabled(),this.getValue(),this.getDefaultValue(),this.getItems(),this.isVisible())},e.prototype.isVisible=function(){return!0},e.prototype.isEnabled=function(){return!this.control.settings.readOnly||this.isEnabledInReadOnlyMode()},e.prototype.isEnabledInReadOnlyMode=function(){return!1},e.prototype.getValue=function(){},e.prototype.getDefaultValue=function(){},e.prototype.getItems=function(){},e.prototype.getModelUnit=function(t){return a.ModelUtils.getlUnitValue(this.control.model.units,t)},e.prototype.getModelUnitText=function(t){return a.ModelUtils.getUnitText(this.control.model.units,s.DiagramLocalizationService.unitItems,s.DiagramLocalizationService.formatUnit,t)},e.prototype.getModelUnitTwipsValue=function(t){return a.ModelUtils.getTwipsValue(this.control.model.units,t)},e.prototype.getViewUnit=function(t){return a.ModelUtils.getlUnitValue(this.control.settings.viewUnits,t)},e.prototype.getViewUnitText=function(t){return a.ModelUtils.getUnitText(this.control.settings.viewUnits,s.DiagramLocalizationService.unitItems,s.DiagramLocalizationService.formatUnit,t)},e.prototype.getViewUnitTwipsValue=function(t){return a.ModelUtils.getTwipsValue(this.control.settings.viewUnits,t)},e}(i.CommandBase);e.SimpleCommandBase=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnitConverter=void 0;var o=function(){function t(){}return t.hundredthsOfMillimeterToTwipsRound=function(t){return Math.round(1440*t/2540)},t.documentsToTwips=function(t){return 24*t/5},t.pixelsToTwips=function(e){return Math.round(t.pixelsToTwipsF(e))},t.pixelsToTwipsCustomDpi=function(e,n){return Math.round(t.pixelsToTwipsFCustomDpi(e,n))},t.inchesToTwips=function(e){return Math.round(t.inchesToTwipsF(e))},t.pointsToTwips=function(e){return Math.round(t.pointsToTwipsF(e))},t.picasToTwips=function(e){return Math.round(1440*e/t.PICAS_PER_INCH)},t.centimetersToTwips=function(e){return Math.round(t.centimetersToTwipsF(e))},t.pixelsToTwipsF=function(e){return 1440*e/t.DPI},t.pixelsToTwipsFCustomDpi=function(t,e){return 1440*t/e},t.inchesToTwipsF=function(t){return 1440*t},t.pointsToTwipsF=function(t){return 20*t},t.centimetersToTwipsF=function(e){return 1440*e/t.CENTIMETERS_PER_INCH},t.twipsToDegrees=function(t){return t/6e4},t.twipsToRadians=function(t){return t/6e4*Math.PI/180},t.degreesToTwips=function(t){return 6e4*t},t.radiansToTwips=function(t){return 6e4*t/Math.PI*180},t.radiansToDegrees=function(t){return t/Math.PI*180},t.twipsToFD=function(t){return Math.round(2048*t/1875)},t.fdToTwips=function(t){return Math.round(1875*t/2048)},t.emuToTwips=function(t){return t/635},t.twipsToPixels=function(e){return Math.round(t.twipsToPixelsF(e))},t.inchesToPixels=function(e){return Math.round(t.DPI*e)},t.centimeterToPixel=function(e){return Math.round(e/(t.CENTIMETERS_PER_INCH/t.DPI))},t.millimetersToPixel=function(e){return Math.round(e/(t.CENTIMETERS_PER_INCH/t.DPI)/10)},t.pointsToPixels=function(e){return Math.round(e*t.DPI/72)},t.pointsToPixelsF=function(e){return e*t.DPI/72},t.twipsToPixelsF=function(e){return e*t.DPI/1440},t.pixelsToPoints=function(e){return Math.round(72*e/t.DPI)},t.pixelsToPointsF=function(e){return 72*e/t.DPI},t.twipsToPoints=function(t){return Math.round(this.twipsToPointsF(t))},t.twipsToPointsF=function(t){return t/20},t.twipsToInches=function(t){return t/1440},t.pixelsToInches=function(e){return e/t.DPI},t.twipsToCentimeters=function(e){return e*t.CENTIMETERS_PER_INCH/1440},t.pixelToCentimeters=function(e){return e*t.CENTIMETERS_PER_INCH/t.DPI},t.twipsToHundredthsOfMillimeter=function(t){return Math.round(127*t/72)},t.pixelsToHundredthsOfMillimeter=function(e){return Math.round(2540*e/t.DPI)},t.hundredthsOfMillimeterToTwips=function(t){return 15*t/127},t.twipsToEmu=function(t){return 635*t},t.twipsToDegree=function(t){return t/6e4},t.DPI=96,t.CENTIMETERS_PER_INCH=2.54,t.PICAS_PER_INCH=6,t}();e.UnitConverter=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleDeviation=e.HitTestDeviation=e.Rectangle=void 0;var o,i=n(164),r=n(165),a=n(106),s=n(1),c=n(2),u=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o}return Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return t.center(this)},enumerable:!1,configurable:!0}),t.prototype.createRectangle=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.createSize=function(){return new c.Size(this.width,this.height)},t.prototype.createPosition=function(){return new s.Point(this.x,this.y)},t.prototype.createVerticalInterval=function(){return new a.FixedInterval(this.y,this.height)},t.prototype.createHorizontalInterval=function(){return new a.FixedInterval(this.x,this.width)},t.fromGeometry=function(e,n){return new t(e.x,e.y,n.width,n.height)},t.fromPoints=function(e,n){var o=Math.min(e.x,n.x),i=Math.min(e.y,n.y),r=Math.abs(e.x-n.x),a=Math.abs(e.y-n.y);return new t(o,i,r,a)},t.fromPositions=function(e,n,o,i){var r=Math.min(e,o),a=Math.min(n,i),s=Math.abs(o-e),c=Math.abs(i-n);return new t(r,a,s,c)},t.fromCenter=function(e,n){return new t(e.x-n,e.y-n,2*n,2*n)},t.prototype.isCollapsed=function(){return 0===this.width||0===this.height},t.prototype.isEmpty=function(){return 0===this.x&&0===this.y&&0===this.width&&0===this.height},t.prototype.toString=function(){return JSON.stringify(this)},t.prototype.setPosition=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.setSize=function(t){return this.width=t.width,this.height=t.height,this},t.prototype.setGeomerty=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.moveRectangle=function(t,e){return this.x+=t,this.y+=e,this},t.prototype.moveRectangleByPoint=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.resize=function(t,e){return this.width+=t,this.height+=e,this},t.prototype.nonNegativeSize=function(){return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this},t.prototype.multiply=function(t,e){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this},t.prototype.equals=function(e){return t.equals(this,e)},t.prototype.clone=function(){var e=new t(0,0,0,0);return e.copyFrom(this),e},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.containsPoint=function(e){return t.containsPoint(this,e)},t.prototype.containsRectangle=function(t){return this.x<=t.x&&this.right>=t.right&&this.y<=t.y&&this.bottom>=t.bottom},t.prototype.inflate=function(t,e){return void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.applyOffsetsInside=function(t){return this.x+=t.left,this.y+=t.top,this.width-=t.left+t.right,this.height-=t.top+t.bottom,this},t.prototype.applyNormalizedOffsetsInside=function(t){var e=Math.max(0,t.left),n=Math.max(0,t.right),o=e+n;0!==o&&(o<=this.width?(this.x+=e,this.width-=o):(this.x+=this.width*(e/o),this.width=0));var i=Math.max(0,t.top),r=Math.max(0,t.bottom),a=i+r;return 0!==a&&(a<=this.height?(this.y+=i,this.height-=a):(this.y+=this.height*(i/a),this.height=0)),this},t.prototype.applyOffsetsOutside=function(t){return this.x-=t.left,this.y-=t.top,this.width+=t.left+t.right,this.height+=t.top+t.bottom,this},t.prototype.applyConverter=function(t){return this.x=t(this.x),this.y=t(this.y),this.width=t(this.width),this.height=t(this.height),this},t.getHorizIntersection=function(t,e){return r.IntervalAlgorithms.getIntersection(new a.FixedInterval(t.x,t.width),new a.FixedInterval(e.x,e.width))},t.getVertIntersection=function(t,e){return r.IntervalAlgorithms.getIntersection(new a.FixedInterval(t.y,t.height),new a.FixedInterval(e.y,e.height))},t.getIntersection=function(e,n){var o=r.IntervalAlgorithms.getIntersection(new a.FixedInterval(e.x,e.width),new a.FixedInterval(n.x,n.width));if(!o)return null;var i=r.IntervalAlgorithms.getIntersection(new a.FixedInterval(e.y,e.height),new a.FixedInterval(n.y,n.height));return i?new t(o.start,i.start,o.length,i.length):null},t.getHorNonCollapsedIntersection=function(e,n){var o=t.getHorizIntersection(e,n);return o&&!o.isCollapsed()?o:null},t.getVertNonCollapsedIntersection=function(e,n){var o=t.getVertIntersection(e,n);return o&&!o.isCollapsed()?o:null},t.getNonCollapsedIntersection=function(e,n){var o=t.getIntersection(e,n);return o&&!o.isCollapsed()?o:null},t.areIntersected=function(t,e){return!(t.x>e.x+e.width||e.x>t.x+t.width)&&!(t.y>e.y+e.height||e.y>t.y+t.height)},t.union=function(e,n){var o=Math.max(e.x+e.width,n.x+n.width),i=Math.max(e.y+e.height,n.y+n.height),r=Math.min(e.x,n.x),a=Math.min(e.y,n.y);return new t(r,a,o-r,i-a)},t.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},t.center=function(t){return new s.Point(t.x+t.width/2,t.y+t.height/2)},t.containsPoint=function(t,e){var n=t.x+t.width,o=t.y+t.height;return e.y>=t.y&&o>=e.y&&e.x>=t.x&&n>=e.x},t}();e.Rectangle=u,function(t){t[t["None"]=0]="None",t[t["Top"]=1]="Top",t[t["Bottom"]=2]="Bottom",t[t["Left"]=4]="Left",t[t["Right"]=8]="Right"}(o=e.HitTestDeviation||(e.HitTestDeviation={}));var l=function(){function t(t,e){this.initRectangle=t,this.initPoint=e,this.deviation=new i.Flag(o.None)}return t.prototype.calcDeviation=function(){return this.initPoint.x<this.initRectangle.x?this.deviation.set(o.Left,!0):this.initPoint.x>this.initRectangle.right&&this.deviation.set(o.Right,!0),this.initPoint.y<this.initRectangle.y?this.deviation.set(o.Top,!0):this.initPoint.y>this.initRectangle.bottom&&this.deviation.set(o.Bottom,!0),this},t.prototype.calcAdditionalParams=function(){return this.insidePoint=this.initPoint.clone(),this.offsetToInside=new s.Point(0,0),this.deviation.get(o.Left)?(this.insidePoint.x=this.initRectangle.x,this.offsetToInside.x=this.insidePoint.x-this.initPoint.x):this.deviation.get(o.Right)&&(this.insidePoint.x=this.initRectangle.right,this.offsetToInside.x=this.initPoint.x-this.insidePoint.x),this.deviation.get(o.Top)?(this.insidePoint.y=this.initRectangle.y,this.offsetToInside.y=this.insidePoint.y-this.initPoint.y):this.deviation.get(o.Bottom)&&(this.insidePoint.y=this.initRectangle.bottom,this.offsetToInside.y=this.initPoint.y-this.insidePoint.y),this},t}();e.RectangleDeviation=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramClipboardEvent=e.DiagramKeyboardEvent=e.DiagramContextMenuEvent=e.DiagramWheelEvent=e.DiagramMouseEvent=e.DiagramMouseEventBase=e.DiagramMouseEventTouch=e.DiagramFocusEvent=e.DiagramEvent=e.ResizeEventSource=e.MouseEventSource=e.MouseEventElementType=e.MouseButton=void 0;var i=n(17);(function(t){t[t["None"]=0]="None",t[t["Left"]=1]="Left",t[t["Right"]=2]="Right",t[t["Middle"]=4]="Middle"})(e.MouseButton||(e.MouseButton={})),function(t){t[t["Undefined"]=0]="Undefined",t[t["Background"]=1]="Background",t[t["Document"]=2]="Document",t[t["Connector"]=3]="Connector",t[t["ConnectorPoint"]=4]="ConnectorPoint",t[t["ConnectorSide"]=5]="ConnectorSide",t[t["ConnectorOrthogonalSide"]=6]="ConnectorOrthogonalSide",t[t["ConnectorText"]=7]="ConnectorText",t[t["Shape"]=8]="Shape",t[t["ShapeResizeBox"]=9]="ShapeResizeBox",t[t["ShapeParameterBox"]=10]="ShapeParameterBox",t[t["SelectionRect"]=11]="SelectionRect",t[t["ShapeConnectionPoint"]=12]="ShapeConnectionPoint",t[t["ShapeExpandButton"]=13]="ShapeExpandButton"}(e.MouseEventElementType||(e.MouseEventElementType={}));var r=function(){function t(t,e,n){this.type=t,this.key=e,this.value=n}return t}();e.MouseEventSource=r,function(t){t[t["Undefined"]=0]="Undefined",t[t["ResizeBox_NW"]=1]="ResizeBox_NW",t[t["ResizeBox_NE"]=2]="ResizeBox_NE",t[t["ResizeBox_SE"]=3]="ResizeBox_SE",t[t["ResizeBox_SW"]=4]="ResizeBox_SW",t[t["ResizeBox_N"]=5]="ResizeBox_N",t[t["ResizeBox_E"]=6]="ResizeBox_E",t[t["ResizeBox_S"]=7]="ResizeBox_S",t[t["ResizeBox_W"]=8]="ResizeBox_W"}(e.ResizeEventSource||(e.ResizeEventSource={}));var a=function(){function t(t){this.modifiers=t}return t}();e.DiagramEvent=a;var s=function(t){function e(e){var n=t.call(this,i.ModifierKey.None)||this;return n.inputText=e,n}return o(e,t),e}(a);e.DiagramFocusEvent=s;var c=function(){function t(t,e){this.offsetPoint=t,this.modelPoint=e}return t}();e.DiagramMouseEventTouch=c;var u=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.offsetPoint=n,r.modelPoint=o,r.source=i,r}return o(e,t),e}(a);e.DiagramMouseEventBase=u;var l=function(t){function e(e,n,o,i,r,a){void 0===a&&(a=[]);var s=t.call(this,e,o,i,r)||this;return s.button=n,s.touches=a,s.scrollX=0,s.scrollY=0,s}return o(e,t),e}(u);e.DiagramMouseEvent=l;var p=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,i,r,a)||this;return s.deltaX=n,s.deltaY=o,s}return o(e,t),e}(u);e.DiagramWheelEvent=p;var h=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.eventPoint=n,i.modelPoint=o,i}return o(e,t),e}(a);e.DiagramContextMenuEvent=h;var d=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.keyCode=n,i.inputText=o,i}return o(e,t),e.prototype.getShortcutCode=function(){return this.modifiers|this.keyCode},e}(a);e.DiagramKeyboardEvent=d;var f=function(t){function e(e){var n=t.call(this,i.ModifierKey.None)||this;return n.clipboardData=e,n}return o(e,t),e}(a);e.DiagramClipboardEvent=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;var i=n(12),r=n(7),a=n(35),s=n(8),c=n(45),u=n(49),l=n(83),p=function(t){function e(e,n,o){var i=t.call(this)||this;if(i.description=e,i.children=[],i.expanded=!0,i.expandedSize=void 0,!e)throw Error("Shape type is incorrect");i.position=n.clone();var r=o?e.toolboxSize:e.defaultSize;return i.size=r.clone(),i.text=e.getDefaultText(),i.image=new u.ImageInfo(e.getDefaultImageUrl()),i.parameters=new a.ShapeParameters,e.createParameters(i.parameters),i}return o(e,t),e.prototype.assign=function(e){t.prototype.assign.call(this,e),e.size=this.size.clone(),e.text=this.text,e.image=this.image.clone(),e.parameters=this.parameters.clone(),e.children=this.children.slice(),e.expanded=this.expanded,this.expandedSize&&(e.expandedSize=this.expandedSize.clone())},e.prototype.clone=function(){var t=new e(this.description,this.position.clone());return this.assign(t),t},Object.defineProperty(e.prototype,"enableText",{get:function(){return this.description.enableText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowEditText",{get:function(){return this.description.allowEditText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasTemplate",{get:function(){return this.description.hasTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableChildren",{get:function(){return this.description.enableChildren},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableImage",{get:function(){return this.description.enableImage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowEditImage",{get:function(){return this.description.allowEditImage},enumerable:!1,configurable:!0}),e.prototype.getMinWidth=function(t){return"number"===typeof this.description.minWidth?this.description.minWidth:"number"===typeof t?t:r.ShapeMinDimension},e.prototype.getMinHeight=function(t){return"number"===typeof this.description.minHeight?this.description.minHeight:"number"===typeof t?t:r.ShapeMinDimension},e.prototype.getMaxWidth=function(t){return"number"===typeof this.description.maxWidth?this.description.maxWidth:"number"===typeof t?t:void 0},e.prototype.getMaxHeight=function(t){return"number"===typeof this.description.maxHeight?this.description.maxHeight:"number"===typeof t?t:void 0},e.prototype.createPrimitives=function(){return this.description.createPrimitives(this)},e.prototype.createSelectorPrimitives=function(){return this.description.createSelectorPrimitives(this)},e.prototype.normalizeX=function(t){return Math.max(this.position.x,Math.min(t,this.position.x+this.size.width))},e.prototype.normalizeY=function(t){return Math.max(this.position.y,Math.min(t,this.position.y+this.size.height))},e.prototype.getConnectionPoints=function(){var t=this,e=this.description.getConnectionPoints().map((function(e){var n=new c.ConnectionPoint(t.position.x+e.x*t.size.width,t.position.y+e.y*t.size.height,e.side);return t.description.processConnectionPoint(t,n),n}));return e},e.prototype.getConnectionPointSide=function(t,e){return t.side!==s.ConnectionPointSide.Undefined?t.side:this.getConnectionPointSideByGeometry(t)},e.prototype.getConnectionPointSideByGeometry=function(t){var e=t.clone().offset(-this.position.x,-this.position.y).multiply(1/this.size.width,1/this.size.height);return e.x>=e.y&&(e.x>0||e.y>0)?e.x<.5||1-e.x>=e.y?s.ConnectionPointSide.North:s.ConnectionPointSide.East:e.x>.5||1-e.x<=e.y?s.ConnectionPointSide.South:s.ConnectionPointSide.West},e.prototype.getConnectionPointIndexForItem=function(t,e){return this.description.getConnectionPointIndexForItem(t,e)},e.prototype.getConnectionPointIndexForSide=function(t){return this.description.getConnectionPointIndexForSide(t)},e.prototype.toggleExpandedSize=function(){this.expanded?(this.size=this.getExpandedSize(),this.expandedSize=void 0):(this.expandedSize=this.size.clone(),this.size=this.getCollapsedSize())},e.prototype.getExpandedSize=function(){return this.description.getExpandedSize(this)},e.prototype.getCollapsedSize=function(){return this.description.getCollapsedSize(this)},e.prototype.getToolboxHeightToWidthRatio=function(){return this.description.getToolboxHeightToWidthRatio(this.size.width,this.size.height)},Object.defineProperty(e.prototype,"allowResizeHorizontally",{get:function(){return this.description.allowResizeHorizontally(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowResizeVertically",{get:function(){return this.description.allowResizeVertically(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rectangle",{get:function(){return i.Rectangle.fromGeometry(this.position,this.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientRectangle",{get:function(){return this.description.getClientRectangle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textRectangle",{get:function(){return this.description.getTextRectangle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textEditRectangle",{get:function(){return this.description.getTextEditRectangle(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textAngle",{get:function(){return this.description.getTextAngle()},enumerable:!1,configurable:!0}),e.prototype.toNative=function(t){var e=new l.NativeShape(this.key,this.dataKey);return e.type=this.description.key,e.text=this.text,e.position=this.position.clone(),e.size=this.size.clone(),e.attachedConnectorIds=this.attachedConnectors.map((function(t){return t.key})),e.applyUnits(t),e},e}(s.DiagramItem);e.Shape=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RenderHelper=e.svgNS=void 0;var o=n(56);e.svgNS="http://www.w3.org/2000/svg";var i=function(){function t(){}return t.createSvgElement=function(t,n){void 0===n&&(n=!1);var o=document.createElementNS(e.svgNS,"svg");return o.className.baseVal="dxdi-canvas"+(n?" export":""),t&&t.appendChild(o),o},t.createMainElement=function(t,e){void 0===e&&(e=!1);var n=document.createElement("div");return n.setAttribute("class","dxdi-control"+(e?" measurer":"")),o.Diagnostics.optimizeLayers&&(n.style.transform="translateZ(0)"),t&&t.appendChild(n),n},t.addEventListener=function(t,e,n){t.addEventListener(e,n)},t.removeEventListener=function(t,e,n){t.removeEventListener(e,n)},t}();e.RenderHelper=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramModelOperation=e.ModelOperationSettings=void 0;var o=function(){function t(){this._addShape=!0,this._addShapeFromToolbox=!0,this._deleteShape=!0,this._deleteConnector=!0,this._changeConnection=!0,this._changeConnectorPoints=!0,this._changeShapeText=!0,this._changeConnectorText=!0,this._resizeShape=!0,this._moveShape=!0}return Object.defineProperty(t.prototype,"addShape",{get:function(){return this._addShape},set:function(t){t!==this._addShape&&(this._addShape=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addShapeFromToolbox",{get:function(){return this._addShapeFromToolbox},set:function(t){t!==this._addShapeFromToolbox&&(this._addShapeFromToolbox=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deleteShape",{get:function(){return this._deleteShape},set:function(t){t!==this._deleteShape&&(this._deleteShape=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deleteConnector",{get:function(){return this._deleteConnector},set:function(t){t!==this._deleteConnector&&(this._deleteConnector=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changeConnection",{get:function(){return this._changeConnection},set:function(t){t!==this._changeConnection&&(this._changeConnection=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changeConnectorPoints",{get:function(){return this._changeConnectorPoints},set:function(t){t!==this._changeConnectorPoints&&(this._changeConnectorPoints=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changeShapeText",{get:function(){return this._changeShapeText},set:function(t){t!==this._changeShapeText&&(this._changeShapeText=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changeConnectorText",{get:function(){return this._changeConnectorText},set:function(t){t!==this._changeConnectorText&&(this._changeConnectorText=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resizeShape",{get:function(){return this._resizeShape},set:function(t){t!==this._resizeShape&&(this._resizeShape=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moveShape",{get:function(){return this._moveShape},set:function(t){t!==this._moveShape&&(this._moveShape=t)},enumerable:!1,configurable:!0}),t.prototype.applySettings=function(t){t&&("boolean"===typeof t.addShape&&(this.addShape=t.addShape),"boolean"===typeof t.addShapeFromToolbox&&(this.addShapeFromToolbox=t.addShapeFromToolbox),"boolean"===typeof t.deleteShape&&(this.deleteShape=t.deleteShape),"boolean"===typeof t.deleteConnector&&(this.deleteConnector=t.deleteConnector),"boolean"===typeof t.changeConnection&&(this.changeConnection=t.changeConnection),"boolean"===typeof t.changeConnectorPoints&&(this.changeConnectorPoints=t.changeConnectorPoints),"boolean"===typeof t.changeShapeText&&(this.changeShapeText=t.changeShapeText),"boolean"===typeof t.changeConnectorText&&(this.changeConnectorText=t.changeConnectorText),"boolean"===typeof t.resizeShape&&(this.resizeShape=t.resizeShape),"boolean"===typeof t.moveShape&&(this.moveShape=t.moveShape))},t}();e.ModelOperationSettings=o,function(t){t[t["AddShape"]=0]="AddShape",t[t["AddShapeFromToolbox"]=1]="AddShapeFromToolbox",t[t["DeleteShape"]=2]="DeleteShape",t[t["DeleteConnector"]=3]="DeleteConnector",t[t["ChangeConnection"]=4]="ChangeConnection",t[t["ChangeConnectorPoints"]=5]="ChangeConnectorPoints",t[t["BeforeChangeShapeText"]=6]="BeforeChangeShapeText",t[t["ChangeShapeText"]=7]="ChangeShapeText",t[t["BeforeChangeConnectorText"]=8]="BeforeChangeConnectorText",t[t["ChangeConnectorText"]=9]="ChangeConnectorText",t[t["ResizeShape"]=10]="ResizeShape",t[t["MoveShape"]=11]="MoveShape"}(e.DiagramModelOperation||(e.DiagramModelOperation={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KeyCode=e.ModifierKey=e.KeyUtils=void 0;var o,i,r=n(19),a=n(174),s=n(57),c=function(){function t(){}return t.getKeyModifiers=function(t){var e=0;return t.altKey&&(e|=o.Alt),t.ctrlKey&&(e|=o.Ctrl),t.shiftKey&&(e|=o.Shift),e},t.getShortcutCode=function(t,e,n,i,r){var a=t;return a|=e?o.Ctrl:0,a|=n?o.Shift:0,a|=i?o.Alt:0,a|=r?o.Meta:0,a},t.getShortcutCodeByEvent=function(e){return t.getShortcutCode(t.getEventKeyCode(e),e.ctrlKey,e.shiftKey,e.altKey,!!r.Browser.MacOSPlatform&&e.metaKey)},t.getEventKeyCode=function(t){return r.Browser.NetscapeFamily||r.Browser.Opera?t.which:t.keyCode},t.parseShortcutString=function(e){if(!e)return 0;var n=!1,o=!1,r=!1,c=!1,u=null,l=e.toString().split("+");if(l.length>0)for(var p=0;p<l.length;p++){var h=s.StringUtils.trim(l[p].toUpperCase());switch(h){case"CONTROL":case"CONTROLKEY":case"CTRL":n=!0;break;case"SHIFT":case"SHIFTKEY":o=!0;break;case"ALT":r=!0;break;case"CMD":c=!0;break;case"F1":u=i.F1;break;case"F2":u=i.F2;break;case"F3":u=i.F3;break;case"F4":u=i.F4;break;case"F5":u=i.F5;break;case"F6":u=i.F6;break;case"F7":u=i.F7;break;case"F8":u=i.F8;break;case"F9":u=i.F9;break;case"F10":u=i.F10;break;case"F11":u=i.F11;break;case"F12":u=i.F12;break;case"RETURN":case"ENTER":u=i.Enter;break;case"HOME":u=i.Home;break;case"END":u=i.End;break;case"LEFT":u=i.Left;break;case"RIGHT":u=i.Right;break;case"UP":u=i.Up;break;case"DOWN":u=i.Down;break;case"PAGEUP":u=i.PageUp;break;case"PAGEDOWN":u=i.PageDown;break;case"SPACE":u=i.Space;break;case"TAB":u=i.Tab;break;case"BACKSPACE":case"BACK":u=i.Backspace;break;case"CONTEXT":u=i.ContextMenu;break;case"ESCAPE":case"ESC":u=i.Esc;break;case"DELETE":case"DEL":u=i.Delete;break;case"INSERT":case"INS":u=i.Insert;break;case"PLUS":u="+".charCodeAt(0);break;default:u=h.charCodeAt(0);break}}else alert(a.EncodeUtils.decodeViaTextArea("Invalid shortcut"));return t.getShortcutCode(u,n,o,r,c)},t}();e.KeyUtils=c,function(t){t[t["None"]=0]="None",t[t["Ctrl"]=65536]="Ctrl",t[t["Shift"]=262144]="Shift",t[t["Alt"]=1048576]="Alt",t[t["Meta"]=16777216]="Meta"}(o=e.ModifierKey||(e.ModifierKey={})),function(t){t[t["Backspace"]=8]="Backspace",t[t["Tab"]=9]="Tab",t[t["Enter"]=13]="Enter",t[t["Pause"]=19]="Pause",t[t["CapsLock"]=20]="CapsLock",t[t["Esc"]=27]="Esc",t[t["Space"]=32]="Space",t[t["PageUp"]=33]="PageUp",t[t["PageDown"]=34]="PageDown",t[t["End"]=35]="End",t[t["Home"]=36]="Home",t[t["Left"]=37]="Left",t[t["Up"]=38]="Up",t[t["Right"]=39]="Right",t[t["Down"]=40]="Down",t[t["Insert"]=45]="Insert",t[t["Delete"]=46]="Delete",t[t["Key_0"]=48]="Key_0",t[t["Key_1"]=49]="Key_1",t[t["Key_2"]=50]="Key_2",t[t["Key_3"]=51]="Key_3",t[t["Key_4"]=52]="Key_4",t[t["Key_5"]=53]="Key_5",t[t["Key_6"]=54]="Key_6",t[t["Key_7"]=55]="Key_7",t[t["Key_8"]=56]="Key_8",t[t["Key_9"]=57]="Key_9",t[t["Key_a"]=65]="Key_a",t[t["Key_b"]=66]="Key_b",t[t["Key_c"]=67]="Key_c",t[t["Key_d"]=68]="Key_d",t[t["Key_e"]=69]="Key_e",t[t["Key_f"]=70]="Key_f",t[t["Key_g"]=71]="Key_g",t[t["Key_h"]=72]="Key_h",t[t["Key_i"]=73]="Key_i",t[t["Key_j"]=74]="Key_j",t[t["Key_k"]=75]="Key_k",t[t["Key_l"]=76]="Key_l",t[t["Key_m"]=77]="Key_m",t[t["Key_n"]=78]="Key_n",t[t["Key_o"]=79]="Key_o",t[t["Key_p"]=80]="Key_p",t[t["Key_q"]=81]="Key_q",t[t["Key_r"]=82]="Key_r",t[t["Key_s"]=83]="Key_s",t[t["Key_t"]=84]="Key_t",t[t["Key_u"]=85]="Key_u",t[t["Key_v"]=86]="Key_v",t[t["Key_w"]=87]="Key_w",t[t["Key_x"]=88]="Key_x",t[t["Key_y"]=89]="Key_y",t[t["Key_z"]=90]="Key_z",t[t["Windows"]=91]="Windows",t[t["ContextMenu"]=93]="ContextMenu",t[t["Numpad_0"]=96]="Numpad_0",t[t["Numpad_1"]=97]="Numpad_1",t[t["Numpad_2"]=98]="Numpad_2",t[t["Numpad_3"]=99]="Numpad_3",t[t["Numpad_4"]=100]="Numpad_4",t[t["Numpad_5"]=101]="Numpad_5",t[t["Numpad_6"]=102]="Numpad_6",t[t["Numpad_7"]=103]="Numpad_7",t[t["Numpad_8"]=104]="Numpad_8",t[t["Numpad_9"]=105]="Numpad_9",t[t["Multiply"]=106]="Multiply",t[t["Add"]=107]="Add",t[t["Subtract"]=109]="Subtract",t[t["Decimal"]=110]="Decimal",t[t["Divide"]=111]="Divide",t[t["F1"]=112]="F1",t[t["F2"]=113]="F2",t[t["F3"]=114]="F3",t[t["F4"]=115]="F4",t[t["F5"]=116]="F5",t[t["F6"]=117]="F6",t[t["F7"]=118]="F7",t[t["F8"]=119]="F8",t[t["F9"]=120]="F9",t[t["F10"]=121]="F10",t[t["F11"]=122]="F11",t[t["F12"]=123]="F12",t[t["NumLock"]=144]="NumLock",t[t["ScrollLock"]=145]="ScrollLock",t[t["Semicolon"]=186]="Semicolon",t[t["Equals"]=187]="Equals",t[t["Comma"]=188]="Comma",t[t["Dash"]=189]="Dash",t[t["Period"]=190]="Period",t[t["ForwardSlash"]=191]="ForwardSlash",t[t["GraveAccent"]=192]="GraveAccent",t[t["OpenBracket"]=219]="OpenBracket",t[t["BackSlash"]=220]="BackSlash",t[t["CloseBracket"]=221]="CloseBracket",t[t["SingleQuote"]=222]="SingleQuote"}(i=e.KeyCode||(e.KeyCode={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.raiseEvent=e.RenderUtils=void 0;var o=n(13),i=n(40),r=n(19),a=function(){function t(){}return t.updateSvgElementSize=function(t,e,n,o){t.style.width=e+"px",t.style.height=n+"px",t.setAttribute("viewBox","0 0 "+e+" "+n),o&&(t.setAttribute("width",e.toString()),t.setAttribute("height",n.toString()))},t.removeElement=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},t.removeContent=function(t){while(t&&t.firstChild)t.removeChild(t.firstChild)},t.setElementEventData=function(t,e,n,i){e!==o.MouseEventElementType.Undefined&&(t.setAttribute("data-type",e.toString()),void 0!==n&&t.setAttribute("data-key",n.toString()),void 0!==i&&t.setAttribute("data-value",i.toString()))},t.getElementEventData=function(t){if(t.getAttribute&&t.getAttribute("data-type"))return new o.MouseEventSource(parseInt(t.getAttribute("data-type")),t.getAttribute("data-key"),t.getAttribute("data-value"));var e=t.getAttribute&&t.getAttribute("class");return"dxdi-page"===e||"dxdi-main"===e?new o.MouseEventSource(o.MouseEventElementType.Document):void 0},t.getHtmlElementStylePropertyName=function(t){switch(t){case"fill":return"color";case"text-anchor":return"text-align"}return t},t.getTextAnchorValue=function(t,e){if(void 0===e&&(e=!1),e){if("start"===t)return"end";if("end"===t)return"start"}return t},t.getStrokeDasharrayValue=function(t,e){if(e){var n=t&&t.toString(),o=n?n.split(/[\s,]+/):[];return o.map((function(t){return parseInt(t)/2*e})).join(",")}return t},t.applyStyleToElement=function(t,e,n){var o=this;void 0===n&&(n=!1);var i=t.getDefaultInstance();t.forEach((function(r){var a=t[r],s=e instanceof HTMLElement?o.getHtmlElementStylePropertyName(r):r;if(void 0!==a&&""!==a&&a!==i[r]){switch(r){case"text-anchor":a=o.getTextAnchorValue(a,n);break;case"stroke-dasharray":a=o.getStrokeDasharrayValue(a,parseInt(t["stroke-width"]));break}e.style.setProperty(s,a)}else e.style.setProperty(s,"")}))},t.generateSvgElementId=function(t){return t+"_"+i.MathUtils.generateGuid()},t.getUrlPathById=function(t){return r.Browser.Safari?"url("+location.protocol+"//"+location.host+location.pathname+"#"+t+")":"url(#"+t+")"},t}();function s(t,e,n){n(e),e.preventDefault&&t.preventDefault()}e.RenderUtils=a,e.raiseEvent=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Browser=void 0;var o=function(){function t(){}return t.IdentUserAgent=function(e,n){void 0===n&&(n=!1);var o=["Mozilla","IE","Firefox","Netscape","Safari","Chrome","Opera","Opera10","Edge"],i="IE",r="Win",a={Safari:2,Chrome:.1,Mozilla:1.9,Netscape:8,Firefox:2,Opera:9,IE:6,Edge:12};if(e&&0!==e.length){e=e.toLowerCase(),t.indentPlatformMajorVersion(e);try{for(var s={Windows:"Win",Macintosh:"Mac","Mac OS":"Mac",Mac_PowerPC:"Mac","cpu os":"MacMobile","cpu iphone os":"MacMobile",Android:"Android","!Windows Phone":"WinPhone","!WPDesktop":"WinPhone","!ZuneWP":"WinPhone"},c="(?:/|\\s*)?",u="(\\d+)(?:\\.((?:\\d+?[1-9])|\\d)0*?)?",l="(?:"+u+")?",p={Safari:"applewebkit(?:.*?(?:version/"+u+"[\\.\\w\\d]*?(?:\\s+mobile/\\S*)?\\s+safari))?",Chrome:"(?:chrome|crios)(?!frame)"+c+l,Mozilla:"mozilla(?:.*rv:"+l+".*Gecko)?",Netscape:"(?:netscape|navigator)\\d*/?\\s*"+l,Firefox:"firefox"+c+l,Opera:"(?:opera|\\sopr)"+c+l,Opera10:"opera.*\\s*version"+c+l,IE:"msie\\s*"+l,Edge:"edge"+c+l},h=null,d=-1,f=0;f<o.length;f++){var m=o[f],g=new RegExp(p[m],"i"),y=g.exec(e);if(y&&y.index>=0){if("IE"===h&&d>=11&&"Safari"===m)continue;h=m,"Opera10"===h&&(h="Opera");var v="trident"+c+l;d=t.GetBrowserVersion(e,y,v,t.getIECompatibleVersionString()),"Mozilla"===h&&d>=11&&(h="IE")}}h||(h=i);var C=-1!==d;C||(d=a[h]);var _=null,P=Number.MAX_VALUE;for(var S in s)if(Object.prototype.hasOwnProperty.call(s,S)){var b="!"===S.substr(0,1),x=e.indexOf((b?S.substr(1):S).toLowerCase());x>=0&&(x<P||b)&&(P=b?0:x,_=s[S])}var w="SM-[A-Z]",I=e.toUpperCase().match(w),T=I&&I.length>0;"WinPhone"===_&&d<9&&(d=Math.floor(t.getVersionFromTrident(e,"trident"+c+l))),!n&&"IE"===h&&d>7&&document.documentMode<d&&(d=document.documentMode),"WinPhone"===_&&(d=Math.max(9,d)),_||(_=r),_!==s["cpu os"]||C||(d=4),t.fillUserAgentInfo(o,h,d,_,T)}catch(O){t.fillUserAgentInfo(o,i,a[i],r)}}else t.fillUserAgentInfo(o,i,a[i],r)},t.GetBrowserVersion=function(e,n,o,i){var r=t.getVersionFromMatches(n);if(i){var a=t.getVersionFromTrident(e,o);if("edge"===i||parseInt(i)===a)return a}return r},t.getIECompatibleVersionString=function(){if(document.compatible)for(var t=0;t<document.compatible.length;t++)if("IE"===document.compatible[t].userAgent&&document.compatible[t].version)return document.compatible[t].version.toLowerCase();return""},t.isTouchEnabled=function(){return"ontouchstart"in window||navigator["maxTouchPoints"]>0||navigator["msMaxTouchPoints"]>0},t.fillUserAgentInfo=function(e,n,o,i,r){void 0===r&&(r=!1);for(var a=0;a<e.length;a++){var s=e[a];t[s]=s===n}t.Version=Math.floor(10*o)/10,t.MajorVersion=Math.floor(t.Version),t.WindowsPlatform="Win"===i||"WinPhone"===i,t.MacOSMobilePlatform="MacMobile"===i||"Mac"===i&&t.isTouchEnabled(),t.MacOSPlatform="Mac"===i&&!t.MacOSMobilePlatform,t.AndroidMobilePlatform="Android"===i,t.WindowsPhonePlatform="WinPhone"===i,t.WebKitFamily=t.Safari||t.Chrome||t.Opera&&t.MajorVersion>=15,t.NetscapeFamily=t.Netscape||t.Mozilla||t.Firefox,t.HardwareAcceleration=t.IE&&t.MajorVersion>=9||t.Firefox&&t.MajorVersion>=4||t.AndroidMobilePlatform&&t.Chrome||t.Chrome&&t.MajorVersion>=37||t.Safari&&!t.WindowsPlatform||t.Edge||t.Opera&&t.MajorVersion>=46,t.WebKitTouchUI=t.MacOSMobilePlatform||t.AndroidMobilePlatform;var c=t.IE&&t.MajorVersion>9&&t.WindowsPlatform&&t.UserAgent.toLowerCase().indexOf("touch")>=0;if(t.MSTouchUI=c||t.Edge&&!!window.navigator.maxTouchPoints,t.TouchUI=t.WebKitTouchUI||t.MSTouchUI,t.MobileUI=t.WebKitTouchUI||t.WindowsPhonePlatform,t.AndroidDefaultBrowser=t.AndroidMobilePlatform&&!t.Chrome,t.AndroidChromeBrowser=t.AndroidMobilePlatform&&t.Chrome,r&&(t.SamsungAndroidDevice=r),t.MSTouchUI){var u=t.UserAgent.toLowerCase().indexOf("arm;")>-1;t.VirtualKeyboardSupported=u||t.WindowsPhonePlatform}else t.VirtualKeyboardSupported=t.WebKitTouchUI;t.fillDocumentElementBrowserTypeClassNames(e)},t.indentPlatformMajorVersion=function(e){var n=/(?:(?:windows nt|macintosh|mac os|cpu os|cpu iphone os|android|windows phone|linux) )(\d+)(?:[-0-9_.])*/,o=n.exec(e);o&&(t.PlaformMajorVersion=o[1])},t.getVersionFromMatches=function(t){var e=-1,n="";return t&&(t[1]&&(n+=t[1],t[2]&&(n+="."+t[2])),""!==n&&(e=parseFloat(n),isNaN(e)&&(e=-1))),e},t.getVersionFromTrident=function(e,n){var o=4,i=new RegExp(n,"i").exec(e);return t.getVersionFromMatches(i)+o},t.fillDocumentElementBrowserTypeClassNames=function(e){for(var n="",o=e.concat(["WindowsPlatform","MacOSPlatform","MacOSMobilePlatform","AndroidMobilePlatform","WindowsPhonePlatform","WebKitFamily","WebKitTouchUI","MSTouchUI","TouchUI","AndroidDefaultBrowser"]),i=0;i<o.length;i++){var r=o[i];t[r]&&(n+="dx"+r+" ")}n+="dxBrowserVersion-"+t.MajorVersion,document&&document.documentElement&&(""!==document.documentElement.className&&(n=" "+n),document.documentElement.className+=n,t.Info=n)},t.UserAgent=navigator.userAgent.toLowerCase(),t._foo=t.IdentUserAgent(t.UserAgent),t}();e.Browser=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleShapeDescription=void 0;var i=n(7),r=n(2),a=n(22),s=n(0),c=function(t){function e(e,n){return void 0===e&&(e=new r.Size(i.ShapeDefaultDimension,.75*i.ShapeDefaultDimension)),t.call(this,e,n)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return s.ShapeTypes.Rectangle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,i=e.width,r=e.height;return[new a.RectanglePrimitive(n,o,i,r,t.style)]},e.prototype.getTextRectangle=function(t){return t.rectangle.clone().inflate(-i.ShapeTextPadding,-i.ShapeTextPadding)},e.prototype.getSizeByText=function(t,e){return t.clone().offset(2*i.ShapeTextPadding,2*i.ShapeTextPadding)},e}(i.ShapeDescription);e.RectangleShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Alignment=e.DataLayoutOrientation=e.LogicalDirectionKind=e.TreeLayoutSettings=e.LayoutSettings=void 0;var i=n(6),r=function(){function t(t){this.orientation=s.Vertical,this.direction=a.Forward;var e=t&&2*t>i.Connector.minOffset?2*t:i.Connector.minOffset;this.columnSpacing=e,this.layerSpacing=2*e,this.containerPadding=2*e,this.componentSpacing=2*e}return t}();e.LayoutSettings=r;var a,s,c,u=function(t){function e(e){var n=t.call(this,e)||this;return n.alignment=c.Center,n.subTreeColumnSpacing=n.componentSpacing/2,n}return o(e,t),e}(r);e.TreeLayoutSettings=u,function(t){t[t["Backward"]=0]="Backward",t[t["Forward"]=1]="Forward"}(a=e.LogicalDirectionKind||(e.LogicalDirectionKind={})),function(t){t[t["Horizontal"]=0]="Horizontal",t[t["Vertical"]=1]="Vertical"}(s=e.DataLayoutOrientation||(e.DataLayoutOrientation={})),function(t){t[t["Left"]=0]="Left",t[t["Center"]=1]="Center"}(c=e.Alignment||(e.Alignment={}))},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RectanglePrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r,a,s,c){var u=t.call(this,r,a,s,c)||this;return u.x=e,u.y=n,u.width=o,u.height=i,u}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"rect")},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"x",this.x),this.setUnitAttribute(e,"y",this.y),this.setUnitAttribute(e,"width",this.width),this.setUnitAttribute(e,"height",this.height),this.setPositionCorrectionAttribute(e),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.RectanglePrimitive=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorUtils=void 0;var o=n(57),i=function(){function t(){}return t.getAlpha=function(t){return t>>24&255},t.getRed=function(t){return t>>16&255},t.getGreen=function(t){return t>>8&255},t.getBlue=function(t){return 255&t},t.redPartToString=function(e){var n=t.getRed(e).toString(16);return n.length>1?n:"0"+n},t.greenPartToString=function(e){var n=t.getGreen(e).toString(16);return n.length>1?n:"0"+n},t.bluePartToString=function(e){var n=t.getBlue(e).toString(16);return n.length>1?n:"0"+n},t.fromArgbNumber=function(t,e,n,o){return t<<24|e<<16|n<<8|o},t.fromRgbaString=function(t,e){void 0===e&&(e=255);var n=t.replace(/ +/g,"").match(/(rgba?)|(\d+(\.\d+)?%?)|(\.\d+)/g);if(n&&n.length>3){for(var o=[],i=1,r=void 0;r=n[i];i++){var a=-1!==r.indexOf("%")?Math.round(2.55*parseFloat(r)):parseInt(r);if(a<0||a>255)return null;o.push(a)}if(0===t.indexOf("rgba")){if(isNaN(o[3])||o[3]<0||o[3]>1)return null;o[3]<=1&&(o[3]=Math.round(255*o[3]))}else if(o[3])return null;return(255&o[0])<<16|(255&o[1])<<8|255&o[2]|(255&(o.length>3?o[3]:e))<<24}return null},t.fromHashString=function(e,n){return void 0===n&&(n=255),t.isHashColorString(e)?("#"===e.charAt(0)&&(e=e.substr(1)),3===e.length&&(e=o.StringUtils.repeat(e.charAt(0),2)+o.StringUtils.repeat(e.charAt(1),2)+o.StringUtils.repeat(e.charAt(2),2)),parseInt(e,16)|n<<24):null},t.fromColorName=function(e,n){void 0===n&&(n=255);var o=t.colorNames[e.toLowerCase()];return o?t.fromHashString(o,n):null},t.fromString=function(e,n){void 0===n&&(n=255);var o=t.fromRgbaString(e,n);if(null!==o)return o;var i=t.fromHashString(e,n);return null!==i?i:t.fromColorName(e,n)},t.colorToHash=function(e){return"#"+t.redPartToString(e)+t.greenPartToString(e)+t.bluePartToString(e)},t.stringToHash=function(t){var e=this.fromString(t);return null!==e?this.colorToHash(e):null},t.isHashColorString=function(t){return/^#?([0-9a-f]{6})$/i.test(t)||/^#?([0-9a-f]{3})$/i.test(t)},t.isKnownColorName=function(e){return!!t.colorNames[e.toLowerCase()]},t.isGray=function(e){var n=t.getRed(e);return n===t.getGreen(e)&&n===t.getBlue(e)},t.DARK_COLOR=-16777216,t.LIGHT_COLOR=-1,t.colorNames={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#00ff00",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",windowtext:"#000000"},t}();e.ColorUtils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PermissionRequestEventArgs=e.RequestedEntity=void 0;var o=function(){function t(t){this.apiController=t}return Object.defineProperty(t.prototype,"allowed",{get:function(){return this.eventArgs.allowed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateUI",{get:function(){return this.eventArgs.updateUI},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eventArgs",{get:function(){return this._eventArgs||(this._eventArgs=this.createEventArgs()),this._eventArgs},enumerable:!1,configurable:!0}),t}();e.RequestedEntity=o;var i=function(){function t(){this.allowed=!0,this.updateUI=!1}return t}();e.PermissionRequestEventArgs=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SvgPrimitive=void 0;var i=n(18),r=n(110),a=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.className=n,r.clipPathId=o,r.onApplyProperties=i,r.children=[],r}return o(e,t),e.prototype.createElement=function(){var t=this.createMainElement();return this.createChildElements(t),this.createCustomContent(t),t},e.prototype.createChildElements=function(t){for(var e=0;e<this.children.length;e++)t.appendChild(this.children[e].createElement())},e.prototype.applyElementProperties=function(t,e){this.applyElementStyleProperties(t),this.className&&t.setAttribute("class",this.className),"string"===typeof this.clipPathId&&(this.clipPathId?t.setAttribute("clip-path",i.RenderUtils.getUrlPathById(this.clipPathId)):t.removeAttribute("clip-path")),this.onApplyProperties&&this.onApplyProperties(t),this.applyChildrenProperties(t,e)},e.prototype.applyChildrenProperties=function(t,e){for(var n=0;n<this.children.length;n++)this.children[n].applyElementProperties(t.childNodes[n],e)},e.prototype.applyElementStyleProperties=function(t){this.applyElementStylePropertiesCore(t)},e.prototype.applyElementStylePropertiesCore=function(t,e){void 0===e&&(e=!1),this.style&&i.RenderUtils.applyStyleToElement(this.style,t,e)},e.prototype.createCustomContent=function(t){},e.prototype.destroyCustomContent=function(t){},e.prototype.dispose=function(){this.children&&this.children.forEach((function(t){return t.dispose()}))},e}(r.PrimitiveObject);e.SvgPrimitive=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DomUtils=void 0;var o=n(19),i=n(60),r=n(40),a=n(57),s=function(){function t(){}return t.clearInnerHtml=function(t){while(t.firstChild)t.removeChild(t.firstChild)},t.setStylePosition=function(t,e){t.left=r.MathUtils.round(e.x,3)+"px",t.top=r.MathUtils.round(e.y,3)+"px"},t.setStyleSize=function(t,e){t.width=r.MathUtils.round(e.width,3)+"px",t.height=r.MathUtils.round(e.height,3)+"px"},t.setStyleSizeAndPosition=function(e,n){t.setStylePosition(e,n),t.setStyleSize(e,n)},t.hideNode=function(t){if(t){var e=t.parentNode;e&&e.removeChild(t)}},t.isHTMLElementNode=function(t){return t.nodeType===Node.ELEMENT_NODE},t.isTextNode=function(t){return t.nodeType===Node.TEXT_NODE},t.isElementNode=function(t){return t.nodeType===Node.ELEMENT_NODE},t.isHTMLTableRowElement=function(t){return"TR"===t.tagName},t.isItParent=function(t,e){if(!t||!e)return!1;while(e){if(e===t)return!0;if("BODY"===e.tagName)return!1;e=e.parentNode}return!1},t.getParentByTagName=function(t,e){e=e.toUpperCase();while(t){if("BODY"===t.tagName)return null;if(t.tagName===e)return t;t=t.parentNode}return null},t.getDocumentScrollTop=function(){var e=o.Browser.IE&&"hidden"===t.getCurrentStyle(document.body).overflow&&document.body.scrollTop>0;return o.Browser.WebKitFamily||o.Browser.Edge||e?o.Browser.MacOSMobilePlatform?window.pageYOffset:o.Browser.WebKitFamily&&document.documentElement.scrollTop||document.body.scrollTop:document.documentElement.scrollTop},t.getDocumentScrollLeft=function(){var e=o.Browser.IE&&"hidden"===t.getCurrentStyle(document.body).overflow&&document.body.scrollLeft>0;return o.Browser.Edge||e?document.body?document.body.scrollLeft:document.documentElement.scrollLeft:o.Browser.WebKitFamily?document.documentElement.scrollLeft||document.body.scrollLeft:document.documentElement.scrollLeft},t.getCurrentStyle=function(t){if(t.currentStyle)return t.currentStyle;if(document.defaultView&&document.defaultView.getComputedStyle){var e=document.defaultView.getComputedStyle(t,null);if(!e&&o.Browser.Firefox&&window.frameElement){var n=[],i=window.frameElement;while(!(e=document.defaultView.getComputedStyle(t,null)))n.push([i,i.style.display]),i.style.setProperty("display","block","important"),i="BODY"===i.tagName?i.ownerDocument.defaultView.frameElement:i.parentNode;e=c(e);for(var r=void 0,a=0;r=n[a];a++)r[0].style.display=r[1];document.body.offsetWidth}return e}return window.getComputedStyle(t,null)},t.setFocus=function(t){function e(){try{t.focus(),o.Browser.IE&&document.activeElement!==t&&t.focus()}catch(e){}}o.Browser.MacOSMobilePlatform?e():setTimeout((function(){e()}),100)},t.hasClassName=function(t,e){try{var n=e.split(" "),o=t.classList;if(o){for(var i=n.length-1;i>=0;i--)if(!o.contains(n[i]))return!1}else{var r=t.getAttribute&&t.getAttribute("class");if(!r)return!1;var a=r.split(" ");for(i=n.length-1;i>=0;i--)if(a.indexOf(n[i])<0)return!1}return!0}catch(s){return!1}},t.addClassName=function(e,n){if(!t.hasClassName(e,n)){var o=e.getAttribute&&e.getAttribute("class");e.setAttribute("class",""===o?n:o+" "+n)}},t.removeClassName=function(t,e){var n=t.getAttribute&&t.getAttribute("class"),o=" "+n+" ",i=o.replace(" "+e+" "," ");o.length!==i.length&&t.setAttribute("class",a.StringUtils.trim(i))},t.toggleClassName=function(e,n,o){void 0===o?t.hasClassName(e,n)?t.removeClassName(e,n):t.addClassName(e,n):o?t.addClassName(e,n):t.removeClassName(e,n)},t.pxToInt=function(t){return u(t,parseInt)},t.pxToFloat=function(t){return u(t,parseFloat)},t.getAbsolutePositionY=function(e){function n(e){return o.Browser.IE&&null===e.parentNode?0:e.getBoundingClientRect().top+t.getDocumentScrollTop()}function i(e){return Math.round(e.getBoundingClientRect().top+t.getDocumentScrollTop())}function r(e){var n=!0;e&&t.isHTMLTableRowElement(e)&&e.cells.length>0&&(e=e.cells[0]);var o=l(e,!1);while(null!=e)o+=e.offsetTop,n||(o-=e.scrollTop),e=e.offsetParent,n=!1;return o+=document.body.scrollTop,o}function a(e){var n=l(e,!1),i=!0;while(null!=e){if(n+=e.offsetTop,i||null==e.offsetParent||(n-=e.scrollTop),!i&&o.Browser.Firefox){var r=t.getCurrentStyle(e);"DIV"===e.tagName&&"visible"!==r.overflow&&(n+=t.pxToInt(r.borderTopWidth))}i=!1,e=e.offsetParent}return n}function s(t){var e=0,n=!0;while(null!=t)e+=t.offsetTop,n||null==t.offsetParent||(e-=t.scrollTop),n=!1,t=t.offsetParent;return e}return e?o.Browser.IE?n(e):o.Browser.Firefox&&o.Browser.Version>=3?i(e):o.Browser.Opera?r(e):o.Browser.NetscapeFamily&&(!o.Browser.Firefox||o.Browser.Version<3)?a(e):o.Browser.WebKitFamily||o.Browser.Edge?i(e):s(e):0},t.getAbsolutePositionX=function(e){function n(e){return o.Browser.IE&&null===e.parentNode?0:e.getBoundingClientRect().left+t.getDocumentScrollLeft()}function i(e){return Math.round(e.getBoundingClientRect().left+t.getDocumentScrollLeft())}function r(t){var e=!0,n=l(t,!0);while(null!=t)n+=t.offsetLeft,e||(n-=t.scrollLeft),t=t.offsetParent,e=!1;return n+=document.body.scrollLeft,n}function a(e){var n=l(e,!0),i=!0;while(null!=e){if(n+=e.offsetLeft,i||null==e.offsetParent||(n-=e.scrollLeft),!i&&o.Browser.Firefox){var r=t.getCurrentStyle(e);"DIV"===e.tagName&&"visible"!==r.overflow&&(n+=t.pxToInt(r.borderLeftWidth))}i=!1,e=e.offsetParent}return n}function s(t){var e=0,n=!0;while(null!=t)e+=t.offsetLeft,n||null==t.offsetParent||(e-=t.scrollLeft),n=!1,t=t.offsetParent;return e}return e?o.Browser.IE?n(e):o.Browser.Firefox&&o.Browser.Version>=3?i(e):o.Browser.Opera?r(e):o.Browser.NetscapeFamily&&(!o.Browser.Firefox||o.Browser.Version<3)?a(e):o.Browser.WebKitFamily||o.Browser.Edge?i(e):s(e):0},t.isInteractiveControl=function(t){return["A","INPUT","SELECT","OPTION","TEXTAREA","BUTTON","IFRAME"].indexOf(t.tagName)>-1},t.getClearClientHeight=function(e){return e.offsetHeight-(t.getTopBottomPaddings(e)+t.getVerticalBordersWidth(e))},t.getTopBottomPaddings=function(e,n){var o=n||t.getCurrentStyle(e);return t.pxToInt(o.paddingTop)+t.pxToInt(o.paddingBottom)},t.getVerticalBordersWidth=function(e,n){i.isDefined(n)||(n=o.Browser.IE&&9!==o.Browser.MajorVersion&&window.getComputedStyle?window.getComputedStyle(e):t.getCurrentStyle(e));var r=0;return"none"!==n.borderTopStyle&&(r+=t.pxToFloat(n.borderTopWidth)),"none"!==n.borderBottomStyle&&(r+=t.pxToFloat(n.borderBottomWidth)),r},t.getNodes=function(t,e){for(var n=t.all||t.getElementsByTagName("*"),o=[],i=0;i<n.length;i++){var r=n[i];e(r)&&o.push(r)}return o},t.getChildNodes=function(t,e){for(var n=t.childNodes,o=[],i=0;i<n.length;i++){var r=n[i];e(r)&&o.push(r)}return o},t.getNodesByClassName=function(e,n){if(e.querySelectorAll){var o=e.querySelectorAll("."+n),i=[];return o.forEach((function(t){return i.push(t)})),i}return t.getNodes(e,(function(e){return t.hasClassName(e,n)}))},t.getChildNodesByClassName=function(e,n){function o(t,e){var n=[];return t.forEach((function(t){e(t)&&n.push(t)})),n}if(e.querySelectorAll){var r=e.querySelectorAll("."+n);return o(r,(function(t){return t.parentNode===e}))}return t.getChildNodes(e,(function(e){return!!t.isElementNode(e)&&(i.isNonNullString(e.className)&&t.hasClassName(e,e.className))}))},t.getVerticalScrollBarWidth=function(){if(void 0===t.verticalScrollBarWidth){var e=document.createElement("DIV");e.style.cssText="position: absolute; top: 0px; left: 0px; visibility: hidden; width: 200px; height: 150px; overflow: hidden; box-sizing: content-box",document.body.appendChild(e);var n=document.createElement("P");e.appendChild(n),n.style.cssText="width: 100%; height: 200px;";var o=n.offsetWidth;e.style.overflow="scroll";var i=n.offsetWidth;o===i&&(i=e.clientWidth),t.verticalScrollBarWidth=o-i,document.body.removeChild(e)}return t.verticalScrollBarWidth},t.getHorizontalBordersWidth=function(e,n){i.isDefined(n)||(n=o.Browser.IE&&window.getComputedStyle?window.getComputedStyle(e):t.getCurrentStyle(e));var r=0;return"none"!==n.borderLeftStyle&&(r+=t.pxToFloat(n.borderLeftWidth)),"none"!==n.borderRightStyle&&(r+=t.pxToFloat(n.borderRightWidth)),r},t.getFontFamiliesFromCssString=function(t){return t.split(",").map((function(t){return a.StringUtils.trim(t.replace(/'|"/gi,""))}))},t.getInnerText=function(e){if(o.Browser.Safari&&o.Browser.MajorVersion<=5){null===t.html2PlainTextFilter&&(t.html2PlainTextFilter=document.createElement("DIV"),t.html2PlainTextFilter.style.width="0",t.html2PlainTextFilter.style.height="0",t.html2PlainTextFilter.style.overflow="visible",t.html2PlainTextFilter.style.display="none",document.body.appendChild(t.html2PlainTextFilter));var n=t.html2PlainTextFilter;n.innerHTML=e.innerHTML,n.style.display="";var i=n.innerText;return n.style.display="none",i}return o.Browser.NetscapeFamily||o.Browser.WebKitFamily||o.Browser.IE&&o.Browser.Version>=9||o.Browser.Edge?e.textContent:e.innerText},t.html2PlainTextFilter=null,t.verticalScrollBarWidth=void 0,t}();function c(t){if("object"!==typeof t||!i.isDefined(t))return t;var e={};for(var n in t)e[n]=t[n];return e}function u(t,e){var n=0;if(i.isDefined(t)&&""!==t)try{var o=t.indexOf("px");o>-1&&(n=e(t.substr(0,o)))}catch(r){}return n}function l(t,e){var n=0,o=!0;while(null!=t){if("BODY"===t.tagName)break;var i=s.getCurrentStyle(t);if("absolute"===i.position)break;o||"DIV"!==t.tagName||""!==i.position&&"static"!==i.position||(n-=e?t.scrollLeft:t.scrollTop),t=t.parentNode,o=!1}return n}e.DomUtils=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorRoutingMode=e.AutoZoomMode=e.DiagramSettings=void 0;var o,i,r=n(3),a=n(2),s=n(47),c=n(9),u=function(){function t(){this.onZoomChanged=new r.EventDispatcher,this.onViewChanged=new r.EventDispatcher,this.onReadOnlyChanged=new r.EventDispatcher,this.onConnectorRoutingModeChanged=new r.EventDispatcher,this._zoomLevel=1,this._zoomLevelItems=[.5,.75,1,1.25,1.5,2,3],this._simpleView=!1,this._fullscreen=!1,this._readOnly=!1,this._autoZoom=o.Disabled,this._snapToGrid=!0,this._showGrid=!0,this._gridSize=180,this._gridSizeItems=[90,180,360,720],this._pageSizeItems=[{size:new a.Size(12240,15840),text:"US-Letter ({width} x {height})"},{size:new a.Size(12240,20160),text:"US-Legal ({width} x {height})"},{size:new a.Size(15817,24491),text:"US-Tabloid ({width} x {height})"},{size:new a.Size(47679,67408),text:"A0 ({width} x {height})"},{size:new a.Size(33676,47679),text:"A1 ({width} x {height})"},{size:new a.Size(23811,33676),text:"A2 ({width} x {height})"},{size:new a.Size(16838,23811),text:"A3 ({width} x {height})"},{size:new a.Size(11906,16838),text:"A4 ({width} x {height})"},{size:new a.Size(8391,11906),text:"A5 ({width} x {height})"},{size:new a.Size(5953,8391),text:"A6 ({width} x {height})"},{size:new a.Size(4195,5953),text:"A7 ({width} x {height})"}],this._viewUnits=s.DiagramUnit.In,this._connectorRoutingMode=i.AllShapesOnly}return Object.defineProperty(t.prototype,"zoomLevel",{get:function(){return this._zoomLevel},set:function(e){var n=this;e=t.correctZoomLevel(e),e!==this._zoomLevel&&(this._zoomLevel=e,this.onZoomChanged.raise1((function(t){return t.notifyZoomChanged(e,n._autoZoom)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomLevelItems",{get:function(){return this._zoomLevelItems},set:function(e){e=e.map((function(e){return t.correctZoomLevel(e)})),e!==this._zoomLevelItems&&(this._zoomLevelItems=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoZoom",{get:function(){return this._autoZoom},set:function(t){var e=this;t!==this._autoZoom&&(this._autoZoom=t,this.onZoomChanged.raise1((function(n){return n.notifyZoomChanged(e._zoomLevel,t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"simpleView",{get:function(){return this._simpleView},set:function(t){t!==this._simpleView&&(this._simpleView=t,this.onViewChanged.raise1((function(e){return e.notifyViewChanged(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readOnly",{get:function(){return this._readOnly},set:function(t){t!==this._readOnly&&(this._readOnly=t,this.onReadOnlyChanged.raise1((function(e){return e.notifyReadOnlyChanged(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(t){this._fullscreen=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"snapToGrid",{get:function(){return this._snapToGrid},set:function(t){this._snapToGrid=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showGrid",{get:function(){return this._showGrid},set:function(t){var e=this;t!==this._showGrid&&(this._showGrid=t,this.onViewChanged.raise1((function(t){return t.notifyGridChanged(e.showGrid,e.gridSize)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gridSize",{get:function(){return this._gridSize},set:function(t){var e=this;t!==this._gridSize&&(this._gridSize=t,this.onViewChanged.raise1((function(t){return t.notifyGridChanged(e.showGrid,e.gridSize)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gridSizeItems",{get:function(){return this._gridSizeItems},set:function(t){t!==this._gridSizeItems&&(this._gridSizeItems=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSizeItems",{get:function(){return this._pageSizeItems},set:function(t){t!==this._pageSizeItems&&(this._pageSizeItems=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewUnits",{get:function(){return this._viewUnits},set:function(t){this._viewUnits=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectorRoutingMode",{get:function(){return this._connectorRoutingMode},set:function(t){t!==this._connectorRoutingMode&&(this._connectorRoutingMode=t,this.onConnectorRoutingModeChanged.raise1((function(e){return e.notifyConnectorRoutingModeChanged(t)})))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeMinWidth",{get:function(){return this._shapeMinWidth},set:function(t){this._shapeMinWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeMinHeight",{get:function(){return this._shapeMinHeight},set:function(t){this._shapeMinHeight=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeMaxWidth",{get:function(){return this._shapeMaxWidth},set:function(t){this._shapeMaxWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapeMaxHeight",{get:function(){return this._shapeMaxHeight},set:function(t){this._shapeMaxHeight=t},enumerable:!1,configurable:!0}),t.prototype.applyShapeSizeSettings=function(t,e){t&&("number"===typeof t.shapeMaxHeight&&(this.shapeMaxHeight=c.ModelUtils.getTwipsValue(e,t.shapeMaxHeight)),"number"===typeof t.shapeMinHeight&&(this.shapeMinHeight=c.ModelUtils.getTwipsValue(e,t.shapeMinHeight)),"number"===typeof t.shapeMaxWidth&&(this.shapeMaxWidth=c.ModelUtils.getTwipsValue(e,t.shapeMaxWidth)),"number"===typeof t.shapeMinWidth&&(this.shapeMinWidth=c.ModelUtils.getTwipsValue(e,t.shapeMinWidth)))},t.correctZoomLevel=function(t){return Math.min(10,Math.max(t,.01))},t}();e.DiagramSettings=u,function(t){t[t["Disabled"]=0]="Disabled",t[t["FitContent"]=1]="FitContent",t[t["FitToWidth"]=2]="FitToWidth"}(o=e.AutoZoomMode||(e.AutoZoomMode={})),function(t){t[t["None"]=0]="None",t[t["ConnectorShapesOnly"]=1]="ConnectorShapesOnly",t[t["AllShapesOnly"]=2]="AllShapesOnly"}(i=e.ConnectorRoutingMode||(e.ConnectorRoutingMode={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeParameterPoint=void 0;var o=function(){function t(t,e){this.key=t,this.point=e}return t}();e.ShapeParameterPoint=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EmptyStyle=e.StrokeStyle=e.TextAlignment=e.TextStyle=e.Style=e.DEFAULT_STROKE_DASHARRAY=e.DEFAULT_STROKE_WIDTH=e.StyleBase=void 0;var i=n(23),r=n(111),a=n(11),s=function(){function t(){this.createDefaultProperties()}return t.prototype.clone=function(){var t=this,e=this.createInstance();return this.forEach((function(n){e[n]=t[n]})),e},t.prototype.forEach=function(t){for(var e in this)Object.prototype.hasOwnProperty.call(this,e)&&t(e)},Object.defineProperty(t.prototype,"strokeWidthPx",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeWidth",{get:function(){return a.UnitConverter.pixelsToTwips(this.strokeWidthPx)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeOffset",{get:function(){return.5},enumerable:!1,configurable:!0}),t.prototype.toHash=function(){var t=this.toObject();return t?Object.keys(t).map((function(e){return e+"|"+t[e]})).join(""):""},t.prototype.toObject=function(){var t=this,e={},n=!1,o=this.getDefaultInstance();return this.forEach((function(i){t[i]!==o[i]&&(e[i]=t[i],n=!0)})),n?e:null},t.prototype.fromObject=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&void 0!==this[e]){var n=r.isColorProperty(e)?i.ColorUtils.stringToHash(t[e]):t[e];this[e]=n}},t}();e.StyleBase=s,e.DEFAULT_STROKE_WIDTH=2,e.DEFAULT_STROKE_DASHARRAY="";var c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.createInstance=function(){return new n},n.prototype.createDefaultProperties=function(){this["fill"]="#ffffff",this["stroke"]="#000000",this["stroke-width"]=e.DEFAULT_STROKE_WIDTH.toString(),this["stroke-dasharray"]=e.DEFAULT_STROKE_DASHARRAY},n.prototype.getDefaultInstance=function(){return n.defaultInstance},n.prototype.isDefaultStrokeDashArray=function(){return this["stroke-dasharray"]===e.DEFAULT_STROKE_DASHARRAY},n.prototype.resetStrokeDashArray=function(){this["stroke-dasharray"]=e.DEFAULT_STROKE_DASHARRAY},Object.defineProperty(n.prototype,"strokeWidthPx",{get:function(){return parseInt(this["stroke-width"])},enumerable:!1,configurable:!0}),n.defaultInstance=new n,n}(s);e.Style=c;var u,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createInstance=function(){return new e},e.prototype.createDefaultProperties=function(){this["fill"]="#000000",this["font-family"]="Arial",this["font-size"]="10pt",this["font-weight"]="",this["font-style"]="",this["text-decoration"]="",this["text-anchor"]="middle"},e.prototype.getDefaultInstance=function(){return e.defaultInstance},e.prototype.getAlignment=function(){switch(this["text-anchor"]){case"left":return u.Left;case"right":return u.Right;default:return u.Center}},e.defaultInstance=new e,e}(s);e.TextStyle=l,function(t){t[t["Left"]=0]="Left",t[t["Right"]=1]="Right",t[t["Center"]=2]="Center"}(u=e.TextAlignment||(e.TextAlignment={}));var p=function(t){function e(e,n){var o=t.call(this)||this;return o._strokeWidthPx=e,o._strokeOffset=n,o}return o(e,t),e.prototype.createInstance=function(){return new e},e.prototype.createDefaultProperties=function(){},e.prototype.getDefaultInstance=function(){return l.defaultInstance},Object.defineProperty(e.prototype,"strokeWidthPx",{get:function(){return this._strokeWidthPx||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strokeOffset",{get:function(){return this._strokeOffset||0},enumerable:!1,configurable:!0}),e.default1pxInstance=new e(1,.5),e.default1pxNegativeOffsetInstance=new e(1,-.5),e.default2pxInstance=new e(2),e}(c);e.StrokeStyle=p;var h=function(t){function e(e){var n=t.call(this)||this;return e&&Object.keys(e).forEach((function(t){return n[t]=e[t]})),n}return o(e,t),e.prototype.createInstance=function(){return new e},e.prototype.createDefaultProperties=function(){},e.prototype.getDefaultInstance=function(){return l.defaultInstance},e.defaultInstance=new e,e}(c);e.EmptyStyle=h},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorRenderPoint=void 0;var i=n(1),r=function(t){function e(e,n,o,i){void 0===o&&(o=-1),void 0===i&&(i=!1);var r=t.call(this,e,n)||this;return r.pointIndex=o,r.skipped=i,r}return o(e,t),e.prototype.offset=function(e,n){return t.prototype.offset.call(this,e,n),this.pointIndex=-1,this.skipped=!1,this},e.prototype.multiply=function(e,n){return t.prototype.multiply.call(this,e,n),this.pointIndex=-1,this.skipped=!1,this},e.prototype.clone=function(){return new e(this.x,this.y,this.pointIndex,this.skipped)},e}(i.Point);e.ConnectorRenderPoint=r},function(t,e,n){"use strict";var o,i;Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorProperties=e.DEFAULT_CONNECTOR_ENDLINEENDING=e.DEFAULT_CONNECTOR_STARTLINEENDING=e.DEFAULT_CONNECTOR_LINEOPTION=e.ConnectorLineEnding=e.ConnectorLineOption=void 0,function(t){t[t["Straight"]=0]="Straight",t[t["Orthogonal"]=1]="Orthogonal"}(o=e.ConnectorLineOption||(e.ConnectorLineOption={})),function(t){t[t["None"]=0]="None",t[t["Arrow"]=1]="Arrow",t[t["OutlinedTriangle"]=2]="OutlinedTriangle",t[t["FilledTriangle"]=3]="FilledTriangle"}(i=e.ConnectorLineEnding||(e.ConnectorLineEnding={})),e.DEFAULT_CONNECTOR_LINEOPTION=o.Orthogonal,e.DEFAULT_CONNECTOR_STARTLINEENDING=i.None,e.DEFAULT_CONNECTOR_ENDLINEENDING=i.Arrow;var r=function(){function t(){this.lineOption=e.DEFAULT_CONNECTOR_LINEOPTION,this.startLineEnding=e.DEFAULT_CONNECTOR_STARTLINEENDING,this.endLineEnding=e.DEFAULT_CONNECTOR_ENDLINEENDING}return t.prototype.clone=function(){var e=new t;return e.lineOption=this.lineOption,e.startLineEnding=this.startLineEnding,e.endLineEnding=this.endLineEnding,e},t.prototype.forEach=function(t){for(var e in this)Object.prototype.hasOwnProperty.call(this,e)&&t(e)},t.prototype.toObject=function(){var t={},n=!1;return this.lineOption!==e.DEFAULT_CONNECTOR_LINEOPTION&&(t["lineOption"]=this.lineOption,n=!0),this.startLineEnding!==e.DEFAULT_CONNECTOR_STARTLINEENDING&&(t["startLineEnding"]=this.startLineEnding,n=!0),this.endLineEnding!==e.DEFAULT_CONNECTOR_ENDLINEENDING&&(t["endLineEnding"]=this.endLineEnding,n=!0),n?t:null},t.prototype.fromObject=function(t){"number"===typeof t["lineOption"]&&(this.lineOption=t["lineOption"]),"number"===typeof t["startLineEnding"]&&(this.startLineEnding=t["startLineEnding"]),"number"===typeof t["endLineEnding"]&&(this.endLineEnding=t["endLineEnding"])},t}();e.ConnectorProperties=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramModel=void 0;var o=n(14),i=n(6),r=n(3),a=n(12),s=n(2),c=n(1),u=n(46),l=n(23),p=n(47),h=function(){function t(e){void 0===e&&(e=new s.Size(8391,11906)),this.items=[],this.itemIndexByKey={},this.keyCounter=0,this.pageSize=new s.Size(8391,11906),this.pageLandscape=!1,this.pageColor=t.defaultPageColor,this.units=p.DiagramUnit.In,this.snapStartPoint=new c.Point(0,0),this.pageSize=e,this.size=this.pageSize.clone(),this.rectangle=a.Rectangle.fromGeometry(new c.Point(0,0),new s.Size(0,0)),this.initializeKeyCounter()}return Object.defineProperty(t.prototype,"pageWidth",{get:function(){return this.pageLandscape?this.pageSize.height:this.pageSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageHeight",{get:function(){return this.pageLandscape?this.pageSize.width:this.pageSize.height},enumerable:!1,configurable:!0}),t.prototype.getRectangle=function(t){return t&&(this.rectangle=r.GeometryUtils.getCommonRectangle(this.items.map((function(t){return t.rectangle})))),this.rectangle},t.getRectangle=function(t){return r.GeometryUtils.getCommonRectangle(t.map((function(t){return t.rectangle})))},t.prototype.pushItem=function(t){var e=this.items.push(t);this.itemIndexByKey[t.key]=e-1,t instanceof o.Shape&&!t.image.isEmpty&&this.cacheShapeImage(t)},t.prototype.removeItem=function(t){var e=this.getItemIndex(t);delete this.itemIndexByKey[t.key],this.items.splice(e,1),this.updateIndicesHash(e)},t.prototype.updateIndicesHash=function(t){for(var e=t;e<this.items.length;e++)this.itemIndexByKey[this.items[e].key]=e},t.prototype.getItemIndex=function(t){return this.itemIndexByKey[t.key]},t.prototype.findShape=function(t){var e=this.findItem(t);return e instanceof o.Shape?e:void 0},t.prototype.findShapesCore=function(t){var e=[];return this.items.forEach((function(n){n instanceof o.Shape&&t(n)&&e.push(n)})),e},t.prototype.findShapeCore=function(t){for(var e=0;e<this.items.length;e++){var n=this.items[e];if(n instanceof o.Shape&&t(n))return n}},t.prototype.findShapeAtPosition=function(t){return this.findShapeCore((function(e){return e.position.equals(t)}))},t.prototype.findShapeByDataKey=function(t){return this.findShapeCore((function(e){return e.dataKey===t}))},t.prototype.findShapesByImageUrl=function(t){return this.findShapesCore((function(e){return e.image.url===t}))},t.prototype.findShapesByDescription=function(t){return this.findShapesCore((function(e){return e.description.key===t.key}))},t.prototype.cacheShapeImage=function(t){var e=u.ImageCache.instance.createUnloadedInfoByShapeImageInfo(t.image);e.isLoaded&&t.image.loadBase64Content(e.base64)},t.prototype.loadAllImages=function(t){u.ImageCache.instance.loadAllImages(t)},t.prototype.findContainer=function(t){var e=this.findShape(t);return e&&e.enableChildren?e:void 0},t.prototype.findNearestContainer=function(t){var e=this.findShape(t);return e?e.enableChildren?e:e.container:void 0},t.prototype.getChildren=function(t){var e=this;return t.children.map((function(t){return e.findItem(t.key)})).filter((function(t){return t}))},t.prototype.findChild=function(t,e,n){var i,r=this;return void 0===n&&(n=!0),t.children.forEach((function(t){i||(t.key!==e?n&&t instanceof o.Shape&&(i=r.findChild(t,e,n)):i=t)})),i},t.prototype.findItemContainerCore=function(t,e){var n=t.container;while(n){if(!e||e(n))break;n=n.container}return n},t.prototype.findItemContainer=function(t){return this.findItemContainerCore(t)},t.prototype.findItemCollapsedContainer=function(t){return this.findItemContainerCore(t,(function(t){return!t.expanded}))},t.prototype.findItemTopCollapsedContainer=function(t){var e,n=t.container;while(n)n.expanded||(e=n),n=n.container;return e},t.prototype.isContainerItem=function(t,e){return void 0!==this.findItemContainerCore(e,(function(e){return e.key===t.key}))},t.prototype.findConnector=function(t){var e=this.findItem(t);return e instanceof i.Connector?e:void 0},t.prototype.findConnectorCore=function(t){for(var e=0;e<this.items.length;e++){var n=this.items[e];if(n instanceof i.Connector&&t(n))return n}},t.prototype.findConnectorAtPoints=function(t){return this.findConnectorCore((function(e){return r.GeometryUtils.arePointsEqual(e.points,t)}))},t.prototype.findConnectorByDataKey=function(t){return this.findConnectorCore((function(e){return e.dataKey===t}))},t.prototype.findConnectorByBeginEndDataKeys=function(t,e){return this.findConnectorCore((function(n){return n.beginItem&&n.beginItem.dataKey===t&&n.endItem&&n.endItem.dataKey===e}))},t.prototype.findConnectorsCore=function(t){var e=[];return this.items.forEach((function(n){n instanceof i.Connector&&t(n)&&e.push(n)})),e},t.prototype.findConnectorsWithoutBeginItem=function(){return this.findConnectorsCore((function(t){return!t.beginItem}))},t.prototype.findConnectorsWithoutEndItem=function(){return this.findConnectorsCore((function(t){return!t.endItem}))},t.prototype.findItem=function(t){return this.items[this.itemIndexByKey[t]]},t.prototype.findItemByDataKey=function(t){return this.findItemCore((function(e){return e.dataKey===t}))},t.prototype.findItemCore=function(t){for(var e=0;e<this.items.length;e++)if(t(this.items[e]))return this.items[e]},t.isIntersectedItems=function(t,e){var n=!1;return t instanceof o.Shape?n=e.intersectedByRect(t.rectangle):t instanceof i.Connector&&t.getSegments().forEach((function(t){e instanceof o.Shape?n=n||t.isIntersectedByRect(e.rectangle):e instanceof i.Connector&&e.getSegments().forEach((function(e){n=n||t.isIntersected(e)}))})),n},t.prototype.getIntersectItems=function(e){var n=[];return this.items.forEach((function(o){o.container===e.container&&(e===o||o instanceof i.Connector&&-1!==e.attachedConnectors.indexOf(o)||!t.isIntersectedItems(o,e)||n.push(o))})),n},t.prototype.getIntersectItemsMinZIndex=function(t){var e=this.getIntersectItems(t);return e.map((function(t){return t.zIndex})).reduce((function(t,e){return Math.min(t,e)}),Number.MAX_VALUE)},t.prototype.getIntersectItemsMaxZIndex=function(t){var e=this.getIntersectItems(t);return e.map((function(t){return t.zIndex})).reduce((function(t,e){return Math.max(t,e)}),-Number.MAX_VALUE)},t.prototype.iterateItems=function(t){this.items.forEach(t)},t.prototype.getNextKey=function(){return(this.keyCounter++).toString()},t.prototype.initializeKeyCounter=function(){this.keyCounter=this.items.reduce((function(t,e){var n=parseInt(e.key);return Math.max(t,isNaN(n)?0:n+1)}),this.items.length)},t.defaultPageColor=l.ColorUtils.LIGHT_COLOR,t}();e.DiagramModel=h},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDraggingState=void 0;var i=n(38),r=n(13),a=n(11),s=function(t){function e(e,n){var o=t.call(this,e)||this;return o.history=n,o}return o(e,t),e.prototype.onMouseDown=function(t){this.mouseDownPoint=t.modelPoint.clone()},e.prototype.onMouseMove=function(t){this.mouseMoveEvent=t,t.button!==r.MouseButton.Left?(this.cancelChanges(),this.handler.switchToDefaultState()):t.button===r.MouseButton.Left&&(!this.mouseDownPoint||Math.abs(this.mouseDownPoint.x-t.modelPoint.x)>e.dragStartLimit||Math.abs(this.mouseDownPoint.y-t.modelPoint.y)>e.dragStartLimit)&&(this.onApplyChanges(t),this.modified||this.handler.raiseDragStart(this.getDraggingElementKeys()),this.modified=!0,this.mouseDownPoint=void 0)},e.prototype.onKeyDown=function(t){!this.mouseMoveEvent||16!==t.keyCode&&17!==t.keyCode&&18!==t.keyCode||this.performMouseMoveEvent(t.modifiers)},e.prototype.onKeyUp=function(t){!this.mouseMoveEvent||16!==t.keyCode&&17!==t.keyCode&&18!==t.keyCode||this.performMouseMoveEvent(t.modifiers)},e.prototype.onMouseUp=function(t){this.mouseDownPoint=void 0,this.mouseMoveEvent=void 0,this.handler.switchToDefaultState()},e.prototype.performMouseMoveEvent=function(t){this.mouseMoveEvent.modifiers=t,this.onMouseMove(this.mouseMoveEvent)},e.prototype.start=function(){this.handler.beginStorePermissions(),this.history.beginTransaction()},e.prototype.finish=function(){this.checkStoredPermissionsOnFinish(),this.modified?(this.onFinishWithChanges(),this.modified=!1,this.history.endTransaction(),this.handler.raiseDragEnd(this.getDraggingElementKeys())):this.history.endTransaction(),this.handler.endStorePermissions(),this.handler.clearInteractingItems()},e.prototype.checkStoredPermissionsOnFinish=function(){this.handler.isStoredPermissionsGranted()||(this.cancelChanges(),this.modified=!1)},e.prototype.onFinishWithChanges=function(){},e.prototype.cancelChanges=function(){this.handler.lockPermissions(),this.history.undoTransaction(),this.handler.unlockPermissions(),this.modified&&this.handler.raiseDragEnd(this.getDraggingElementKeys()),this.modified=!1},e.prototype.getSnappedPoint=function(t,e){return this.handler.getSnappedPoint(t,e)},e.dragStartLimit=a.UnitConverter.pixelsToTwips(4),e}(i.MouseHandlerCancellableState);e.MouseHandlerDraggingState=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramLocalizationService=void 0;var o=n(0),i=n(47),r=function(){function t(){}return t.unitItems={},t.formatUnit=function(t){return t.toString()},t.shapeTexts={},t}();e.DiagramLocalizationService=r,r.unitItems[i.DiagramUnit.In]="in",r.unitItems[i.DiagramUnit.Cm]="cm",r.unitItems[i.DiagramUnit.Px]="px",r.shapeTexts[o.ShapeTypes.Text]="Text",r.shapeTexts[o.ShapeTypes.Rectangle]="Rectangle",r.shapeTexts[o.ShapeTypes.Ellipse]="Ellipse",r.shapeTexts[o.ShapeTypes.Cross]="Cross",r.shapeTexts[o.ShapeTypes.Triangle]="Triangle",r.shapeTexts[o.ShapeTypes.Diamond]="Diamond",r.shapeTexts[o.ShapeTypes.Heart]="Heart",r.shapeTexts[o.ShapeTypes.Pentagon]="Pentagon",r.shapeTexts[o.ShapeTypes.Hexagon]="Hexagon",r.shapeTexts[o.ShapeTypes.Octagon]="Octagon",r.shapeTexts[o.ShapeTypes.Star]="Star",r.shapeTexts[o.ShapeTypes.ArrowLeft]="Left Arrow",r.shapeTexts[o.ShapeTypes.ArrowUp]="Up Arrow",r.shapeTexts[o.ShapeTypes.ArrowRight]="Right Arrow",r.shapeTexts[o.ShapeTypes.ArrowDown]="Down Arrow",r.shapeTexts[o.ShapeTypes.ArrowUpDown]="Up Down Arrow",r.shapeTexts[o.ShapeTypes.ArrowLeftRight]="Left Right Arrow",r.shapeTexts[o.ShapeTypes.Process]="Process",r.shapeTexts[o.ShapeTypes.Decision]="Decision",r.shapeTexts[o.ShapeTypes.Terminator]="Terminator",r.shapeTexts[o.ShapeTypes.PredefinedProcess]="Predefined Process",r.shapeTexts[o.ShapeTypes.Document]="Document",r.shapeTexts[o.ShapeTypes.MultipleDocuments]="Multiple Documents",r.shapeTexts[o.ShapeTypes.ManualInput]="Manual Input",r.shapeTexts[o.ShapeTypes.Preparation]="Preparation",r.shapeTexts[o.ShapeTypes.Data]="Data",r.shapeTexts[o.ShapeTypes.Database]="Database",r.shapeTexts[o.ShapeTypes.HardDisk]="Hard Disk",r.shapeTexts[o.ShapeTypes.InternalStorage]="Internal Storage",r.shapeTexts[o.ShapeTypes.PaperTape]="Paper Tape",r.shapeTexts[o.ShapeTypes.ManualOperation]="Manual Operation",r.shapeTexts[o.ShapeTypes.Delay]="Delay",r.shapeTexts[o.ShapeTypes.StoredData]="Stored Data",r.shapeTexts[o.ShapeTypes.Display]="Display",r.shapeTexts[o.ShapeTypes.Merge]="Merge",r.shapeTexts[o.ShapeTypes.Connector]="Connector",r.shapeTexts[o.ShapeTypes.Or]="Or",r.shapeTexts[o.ShapeTypes.SummingJunction]="Summing Junction",r.shapeTexts[o.ShapeTypes.Container]="Container",r.shapeTexts[o.ShapeTypes.VerticalContainer]="Vertical Container",r.shapeTexts[o.ShapeTypes.HorizontalContainer]="Horizontal Container",r.shapeTexts[o.ShapeTypes.Card]="Person's Name",r.shapeTexts[o.ShapeTypes.CardWithImageOnLeft]="Card with Image on the Left",r.shapeTexts[o.ShapeTypes.CardWithImageOnTop]="Card with Image on the Top",r.shapeTexts[o.ShapeTypes.CardWithImageOnRight]="Card with Image on the Right"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeParameters=e.ShapeParameter=void 0;var o=function(){function t(t,e){this.key=t,this.value=e}return t}();e.ShapeParameter=o;var i=function(){function t(){this.items={}}return t.prototype.add=function(t){this.items[t.key]=t},t.prototype.addRange=function(t){for(var e=0;e<t.length;e++)this.add(t[e])},t.prototype.get=function(t){return this.items[t]},t.prototype.forEach=function(t){for(var e in this.items)Object.prototype.hasOwnProperty.call(this.items,e)&&t(this.items[e])},t.prototype.clone=function(){var e=new t;return this.forEach((function(t){e.add(new o(t.key,t.value))})),e},t.prototype.toObject=function(){var t={},e=!1;return this.forEach((function(n){t[n.key]={value:n.value},e=!0})),e?t:null},t.prototype.fromObject=function(t){this.forEach((function(e){var n=t[e.key];n&&"number"===typeof n["value"]&&(e.value=n["value"])}))},t}();e.ShapeParameters=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMode=e.PositionInfo=e.Edge=void 0;var o=function(){function t(t,e,n,o){void 0===o&&(o=1),this.weight=o,this.key=t,this.from=e,this.to=n}return t.prototype.getHashKey=function(){return this.from+"_"+this.to},t.prototype.reverse=function(){return new t(this.key,this.to,this.from,this.weight)},t}();e.Edge=o;var i=function(){function t(t,e){this.item=t,this.position=e}return t}();e.PositionInfo=i,function(t){t[t["Outgoing"]=1]="Outgoing",t[t["Incoming"]=2]="Incoming",t[t["OutgoingAndIncoming"]=3]="OutgoingAndIncoming"}(e.ConnectionMode||(e.ConnectionMode={}))},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.GroupPrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r,a){var s=t.call(this,null,n,i,r)||this;return s.zIndex=o,s.onBeforeDispose=a,s.children=e,s}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"g")},e.prototype.applyElementProperties=function(e,n){(this.zIndex||0===this.zIndex)&&e.style.setProperty("z-index",this.zIndex.toString()),t.prototype.applyElementProperties.call(this,e,n)},e.prototype.dispose=function(){this.onBeforeDispose&&this.onBeforeDispose(),t.prototype.dispose.call(this)},e}(r.SvgPrimitive);e.GroupPrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerCancellableState=e.MouseHandlerStateBase=void 0;var i=n(17),r=function(){function t(t){this.handler=t}return t.prototype.start=function(){},t.prototype.finish=function(){},t.prototype.onMouseClick=function(t){},t.prototype.onMouseDblClick=function(t){this.handler.switchToDefaultState()},t.prototype.onMouseDown=function(t){},t.prototype.onMouseUp=function(t){},t.prototype.onMouseMove=function(t){},t.prototype.onMouseWheel=function(t){return!1},t.prototype.onDragStart=function(t){},t.prototype.onDragEnd=function(t){},t.prototype.onShortcut=function(t){return!1},t.prototype.onKeyDown=function(t){},t.prototype.onKeyUp=function(t){},t.prototype.onConnectionPointsShow=function(t,e){},t.prototype.onConnectionTargetShow=function(t,e){},t}();e.MouseHandlerStateBase=r;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onShortcut=function(t){return t===i.KeyCode.Esc&&(this.cancelChanges(),this.handler.switchToDefaultState(),!0)},e}(r);e.MouseHandlerCancellableState=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SearchUtils=void 0;var o=function(){function t(){}return t.binaryIndexOf=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=-2);var i=0===n;-2===o&&(o=t.length-1);while(n<=o){var r=n+(o-n>>1),a=e(t[r]);if(a<0)n=r+1;else{if(!(a>0))return r;o=r-1}}return i?~n:-1},t.normedBinaryIndexOf=function(e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=-2);var r=t.binaryIndexOf(e,n,o,i);return t.binaryIndexNormalizator(r)},t.binaryIndexNormalizator=function(t){return t<0?~t-1:t},t.normedInterpolationIndexOf=function(t,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=-2),-2===i&&(i=t.length-1);var r=t[Math.min(o,i)];if(void 0===r||n<e(r))return-1;var a=e(t[o]),s=e(t[i]);while(1){if(!(n>a&&n<s))return n===a?o:i;var c=o+Math.floor((n-a)*(i-o)/(s-a)),u=e(t[c]);if(n>u){if(o=c+1,a=e(t[o]),n<a)return c}else{if(!(n<u))return c;i=c-1,s=e(t[i])}}},t}();e.SearchUtils=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MathUtils=void 0;var o=n(81),i=function(){function t(){}return t.round=function(e,n){void 0===n&&(n=0);var o=t.powFactor[n];return Math.round(e*o)/o},t.numberCloseTo=function(t,e,n){return void 0===n&&(n=1e-5),Math.abs(t-e)<n},t.restrictValue=function(t,e,n){return n<e&&(n=e),t>n?n:t<e?e:t},t.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.generateGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)}))},t.powFactor=o.ListUtils.initByCallback(20,(function(t){return Math.pow(10,t)})),t.somePrimes=[1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003],t}();e.MathUtils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Segment=void 0;var o=n(40),i=n(108),r=n(1),a=n(12),s=function(){function t(t,e){this.startPoint=t,this.endPoint=e}return Object.defineProperty(t.prototype,"length",{get:function(){return i.Metrics.euclideanDistance(this.startPoint,this.endPoint)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xLength",{get:function(){return Math.abs(this.endPoint.x-this.startPoint.x)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yLength",{get:function(){return Math.abs(this.endPoint.y-this.startPoint.y)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return new r.Point(this.startPoint.x+(this.endPoint.x-this.startPoint.x)/2,this.startPoint.y+(this.endPoint.y-this.startPoint.y)/2)},enumerable:!1,configurable:!0}),t.prototype.isIntersected=function(t){return this.startPoint.equals(t.startPoint)||this.endPoint.equals(t.startPoint)||this.startPoint.equals(t.endPoint)||this.endPoint.equals(t.endPoint)||this.intersectCore(t)&&t.intersectCore(this)},t.prototype.containsPoint=function(t,e){return void 0===e&&(e=1e-7),this.startPoint.equals(t)||this.endPoint.equals(t)||o.MathUtils.numberCloseTo(this.length,i.Metrics.euclideanDistance(this.startPoint,t)+i.Metrics.euclideanDistance(this.endPoint,t),e)},t.prototype.isIntersectedByRect=function(e){if(a.Rectangle.containsPoint(e,this.startPoint)||a.Rectangle.containsPoint(e,this.endPoint))return!0;var n=e.x,o=e.x+e.width,i=e.y,s=e.y+e.height;return this.isIntersected(new t(new r.Point(n,i),new r.Point(n,s)))||this.isIntersected(new t(new r.Point(o,i),new r.Point(o,s)))||this.isIntersected(new t(new r.Point(n,i),new r.Point(o,i)))||this.isIntersected(new t(new r.Point(n,s),new r.Point(o,s)))},t.prototype.intersectCore=function(t){if(this.startPoint.x===this.endPoint.x){if(this.startPoint.x-t.endPoint.x!==0)return(this.startPoint.x-t.startPoint.x)/(this.startPoint.x-t.endPoint.x)<=0;if(t.endPoint.y-this.endPoint.y!==0)return(t.endPoint.y-this.startPoint.y)/(t.endPoint.y-this.endPoint.y)<=0}if(this.startPoint.y===this.endPoint.y){if(this.startPoint.y-t.endPoint.y!==0)return(this.startPoint.y-t.startPoint.y)/(this.startPoint.y-t.endPoint.y)<=0;if(t.endPoint.x-this.endPoint.x!==0)return(t.endPoint.x-this.startPoint.x)/(t.endPoint.x-this.endPoint.x)<=0}var e=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x),n=this.startPoint.y+(t.startPoint.x-this.startPoint.x)*e,o=this.startPoint.y+(t.endPoint.x-this.startPoint.x)*e,i=t.startPoint.y-n,r=t.endPoint.y-o;return 0===i&&0===r?(this.startPoint.y-n)/(this.endPoint.y-n)<=0||(this.startPoint.y-o)/(this.endPoint.y-o)<=0:0===i||0===r||i/r<0},t}();e.Segment=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasManagerBase=e.PAGE_BG_TEXTFLOOR_FILTER_ID=void 0;var o=n(173),i=n(11);e.PAGE_BG_TEXTFLOOR_FILTER_ID="page-text-flood";var r=function(){function t(t,e){this.elements={},this.actualZoom=t,this.dom=e}return t.prototype.createAndChangePrimitivesElements=function(t,e){var n=this;t.forEach((function(t){n.createAndChangePrimitiveElement(t,e)}))},t.prototype.createPrimitiveElement=function(t,e,n){return this.dom.createElement(t,e,n)},t.prototype.createAndChangePrimitiveElement=function(t,e,n){var o=this.createPrimitiveElement(t,e,n);return this.dom.changeByPrimitive(o,t),o},t.prototype.changePrimitiveElement=function(t,e){this.dom.changeByPrimitive(e,t)},t.prototype.getOrCreateElement=function(t,e,n,o){var i=t&&this.elements[t]||(this.elements[t]=this.createPrimitiveElement(e,n,o));return this.changePrimitiveElement(e,i),i},t.prototype.createTextFloodFilter=function(t,n,i){this.getOrCreateElement(t,new o.TextFloodFilterPrimitive(e.PAGE_BG_TEXTFLOOR_FILTER_ID,i),n)},t.prototype.getAbsoluteSize=function(t){return t.clone().applyConverter(i.UnitConverter.twipsToPixelsF).clone().multiply(this.actualZoom,this.actualZoom)},t}();e.CanvasManagerBase=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextOwner=void 0,function(t){t[t["Shape"]=0]="Shape",t[t["Connector"]=1]="Connector",t[t["ExtensionLine"]=2]="ExtensionLine",t[t["Resize"]=3]="Resize"}(e.TextOwner||(e.TextOwner={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Data=e.SetAbsoluteY=e.SetAbsoluteX=void 0;var o=n(26),i=n(60);function r(t){return!isNaN(parseFloat(t))&&isFinite(t)}function a(t,e){t.style.left=c(e,t,!0)+"px"}function s(t,e){t.style.top=c(e,t,!1)+"px"}function c(t,e,n){return t-=u(e,n),t}function u(t,e){var n=l(t);"static"===n.style.position&&(n.style.position="absolute"),t.parentNode.appendChild(n);var i=e?o.DomUtils.getAbsolutePositionX(n):o.DomUtils.getAbsolutePositionY(n);return t.parentNode.removeChild(n),Math.round(i)}function l(t){var e=document.createElement("DIV");return e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.position=o.DomUtils.getCurrentStyle(t).position,e}e.SetAbsoluteX=a,e.SetAbsoluteY=s;var p=function(){function t(){}return t.ArrayInsert=function(t,e,n){if(0<=n&&n<t.length){for(var o=t.length;o>n;o--)t[o]=t[o-1];t[n]=e}else t.push(e)},t.ArrayRemove=function(e,n){var o=t.ArrayIndexOf(e,n);o>-1&&t.ArrayRemoveAt(e,o)},t.ArrayRemoveAt=function(t,e){if(e>=0&&e<t.length){for(var n=e;n<t.length-1;n++)t[n]=t[n+1];t.pop()}},t.ArrayClear=function(t){while(t.length>0)t.pop()},t.ArrayIndexOf=function(t,e,n){if(n){for(o=0;o<t.length;o++)if(n(t[o],e))return o}else for(var o=0;o<t.length;o++)if(t[o]===e)return o;return-1},t.ArrayContains=function(e,n){return t.ArrayIndexOf(e,n)>=0},t.ArrayEqual=function(t,e){var n=t.length,o=e.length;if(n!==o)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0},t.ArraySame=function(e,n){return e.length===n.length&&e.every((function(e){return t.ArrayContains(n,e)}))},t.ArrayGetIntegerEdgeValues=function(e){var n=t.CollectionToArray(e);return t.ArrayIntegerAscendingSort(n),{start:n[0],end:n[n.length-1]}},t.ArrayIntegerAscendingSort=function(e){t.ArrayIntegerSort(e,!1)},t.ArrayIntegerSort=function(t,e){t.sort((function(t,n){var o=0;return t>n?o=1:t<n&&(o=-1),e&&(o*=-1),o}))},t.CollectionsUnionToArray=function(t,e){for(var n=[],o=t.length,i=e.length,r=0;r<o+i;r++)r<o?n.push(t[r]):n.push(e[r-o]);return n},t.CollectionToArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},t.CreateHashTableFromArray=function(t){for(var e=[],n=0;n<t.length;n++)e[t[n]]=1;return e},t.CreateIndexHashTableFromArray=function(t){for(var e=[],n=0;n<t.length;n++)e[t[n]]=n;return e},t.ArrayToHash=function(t,e,n){return t instanceof Array?t.reduce((function(t,o,i){var r=e(o,i),a=n(o,i);return t[r]=a,t}),{}):{}},t.Sum=function(t,e){return t instanceof Array?t.reduce((function(t,n){var o=e?e(n):n;return r(o)||(o=0),t+o}),0):0},t.Min=function(e,n){return t.CalculateArrayMinMax(e,n,!1)},t.Max=function(e,n){return t.CalculateArrayMinMax(e,n,!0)},t.NearestLeftBinarySearchComparer=function(t,e,n){var o=t[e],i=o<n,r=i&&e===t.length-1,a=r||i&&t[e+1]>=n;return a?0:o<n?-1:1},t.ArrayBinarySearch=function(e,n,o,r,a){o||(o=t.defaultBinarySearchComparer),i.isDefined(r)||(r=0),i.isDefined(a)||(a=e.length-r);var s=r+a-1;while(r<=s){var c=r+(s-r>>1),u=o(e,c,n);if(0===u)return c;u<0?r=c+1:s=c-1}return-(r+1)},t.ArrayFlatten=function(t){var e=[];return t.forEach((function(t){e=e.concat(t)})),e},t.GetDistinctArray=function(e){for(var n=[],o=0;o<e.length;o++){var i=e[o];-1===t.ArrayIndexOf(n,i)&&n.push(i)}return n},t.ForEach=function(t,e){if(Array.prototype.forEach)Array.prototype.forEach.call(t,e);else for(var n=0,o=t.length;n<o;n++)e(t[n],n,t)},t.MergeHashTables=function(t,e){if(!e||"string"===typeof e)return t;for(var n in t||(t={}),e)n&&!(n in t)&&(t[n]=e[n]);return t},t.Range=function(t,e){t=parseInt(t)||0,e=parseInt(e)||0,t<0&&(t=0),e<0&&(e=0);var n=Array(t);return n.map((function(t,n){return e+n}))},t.CalculateArrayMinMax=function(t,e,n){if(!(t instanceof Array))return 0;var o=n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;return t.reduce((function(t,i){var a=e?e(i):i;r(a)||(a=o);var s=n?Math.max:Math.min;return s(a,t)}),o)},t.byRange=function(t,e,n){return Math.min(Math.max(t,e),n)},t.defaultBinarySearchComparer=function(t,e,n){var o=t[e];return o===n?0:o<n?-1:1},t.cssTextToObject=function(t){return t?(t=t.replace(/\/\*(.|\s)*?\*\//g,"").replace(/\s+/g," "),t.split(";").reduce((function(t,e){if(e){var n=/\s*([^:]+?)\s*:\s*([^;]*)\s*$/.exec(e);if(n){var o=n[1],i=n[2];o&&i&&(t[o.trim()]=i.trim())}return t}return t}),{})):{}},t.objectToCssText=function(t){return t?Object.keys(t).reduce((function(e,n){var o=n.trim(),i=t[n];return o&&i&&e.push(o+": "+i.toString().trim()),e}),[]).join("; "):""},t}();e.Data=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionPoint=void 0;var i=n(1),r=n(8),a=function(t){function e(e,n,o){void 0===o&&(o=r.ConnectionPointSide.Undefined);var i=t.call(this,e,n)||this;return i.side=o,i}return o(e,t),e.prototype.offset=function(e,n){return t.prototype.offset.call(this,e,n),this.side=r.ConnectionPointSide.Undefined,this},e.prototype.multiply=function(e,n){return t.prototype.multiply.call(this,e,n),this.side=r.ConnectionPointSide.Undefined,this},e.prototype.clone=function(){return new e(this.x,this.y,this.side)},e.prototype.toPoint=function(){return new i.Point(this.x,this.y)},e}(i.Point);e.ConnectionPoint=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImageCache=e.CacheImageInfo=void 0;var o=n(112),i=n(49),r=n(3),a=function(){function t(t,e,n,i,r){this._base64=void 0!==t?o.Base64Utils.normalizeToDataUrl(t,"image/png"):void 0,this.actualId=e,this._referenceInfo=i,this._isLoaded=void 0!==r&&r,this.imageUrl=n}return Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._referenceInfo?this._referenceInfo._isLoaded:this._isLoaded},set:function(t){this._isLoaded=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"base64",{get:function(){return this._base64},set:function(t){this._base64=o.Base64Utils.normalizeToDataUrl(t,"image/png")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"referenceInfo",{get:function(){return this._referenceInfo},set:function(t){this._referenceInfo=t,this._base64=void 0,this._isLoaded=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._referenceInfo?this.referenceInfo._isLoading:this._isLoading},enumerable:!1,configurable:!0}),t.prototype.startLoading=function(){this._referenceInfo?this._referenceInfo.startLoading():this._isLoading=!0},t.prototype.finalizeLoading=function(){this._referenceInfo?this._referenceInfo.finalizeLoading():this._isLoading=!1},t}();e.CacheImageInfo=a;var s=function(){function t(){this.emptyImageId=0,this.lastActualId=0,this.onReadyStateChanged=new r.EventDispatcher,this.cache=[],this.nonLoadedImages=[];var t=this.createUnloadedInfoByBase64(i.ImageInfo.transparentOnePixelImage);t.isLoaded=!0}return t.prototype.reset=function(){this.cache.splice(1),this.nonLoadedImages=[],this.lastActualId=1},Object.defineProperty(t.prototype,"emptyImage",{get:function(){return this.cache[this.emptyImageId]},enumerable:!1,configurable:!0}),t.prototype.getImageData=function(t){return this.cache[t]},t.prototype.createUnloadedInfoByUrl=function(t){var e=this.findInfoByUrl(t);return e||this.registerImageData(new a(void 0,this.getNextActualId(),t))},t.prototype.createUnloadedInfoByBase64=function(t){var e=this.findInfoByBase64(t);return e||this.registerImageData(new a(t,this.getNextActualId()))},t.prototype.createUnloadedInfoByShapeImageInfo=function(t){var e=t.exportUrl;return o.Base64Utils.checkPrependDataUrl(e)?this.createUnloadedInfoByBase64(e):this.createUnloadedInfoByUrl(e)},t.prototype.registerImageData=function(t){var e=this.cache[t.actualId];return e||(e=t),void 0!==t.actualId&&(this.cache[t.actualId]=e),0!==t.actualId&&(this.nonLoadedImages.push(t),1===this.nonLoadedImages.length&&this.raiseReadyStateChanged(!1)),e},t.prototype.loadAllImages=function(t){var e=this;this.cache.forEach((function(n){e.emptyImageId===n.actualId||n.isLoaded||n.isLoading||t.load(n)}))},t.prototype.finalizeLoading=function(t,e){t.finalizeLoading(),t.isLoaded=!0;var n=this.nonLoadedImages.indexOf(t);if(this.nonLoadedImages.splice(n,1),0===this.nonLoadedImages.length&&this.raiseReadyStateChanged(!0),!t.referenceInfo&&e.base64){var i=o.Base64Utils.normalizeToDataUrl(e.base64,"image/png");this.cache.forEach((function(e){var n=e.base64===i&&e!==t&&e.isLoaded;return n&&(t.referenceInfo=e.referenceInfo?e.referenceInfo:e),n})),t.base64=i}},t.prototype.hasNonLoadedImages=function(){return 0!==this.nonLoadedImages.length},t.prototype.getNextActualId=function(){return this.lastActualId++},t.prototype.findInfoByBase64=function(t){return t=o.Base64Utils.normalizeToDataUrl(t,"image/png"),this.findInfoCore((function(e){return e.base64===t}))},t.prototype.findInfoByUrl=function(t){return this.findInfoCore((function(e){return e.imageUrl===t}))},t.prototype.findInfoCore=function(t){var e;return this.cache.forEach((function(n){t(n)&&(e=n)})),e},t.prototype.raiseReadyStateChanged=function(t){this.onReadyStateChanged.raise1((function(e){return e.notifyImageCacheReadyStateChanged(t)}))},t.instance=new t,t}();e.ImageCache=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PageOrientation=e.DiagramUnit=void 0,function(t){t[t["In"]=0]="In",t[t["Cm"]=1]="Cm",t[t["Px"]=2]="Px"}(e.DiagramUnit||(e.DiagramUnit={})),function(t){t[t["Portrait"]=0]="Portrait",t[t["Landscape"]=1]="Landscape"}(e.PageOrientation||(e.PageOrientation={}))},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SetConnectionPointIndexHistoryItem=e.AddConnectionHistoryItem=void 0;var i=n(5),r=n(6),a=function(t){function e(e,n,o,i){var r=t.call(this)||this;return r.connectorKey=e.key,r.itemKey=n.key,r.connectionPointIndex=o,r.position=i,r}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey),n=t.model.findItem(this.itemKey);t.addConnection(e,n,this.connectionPointIndex,this.position)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.deleteConnection(e,this.position)},e}(i.HistoryItem);e.AddConnectionHistoryItem=a;var s=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connectorKey=e.key,i.connectionPointIndex=n,i.position=o,i}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey);this.oldConnectionPointIndex=this.position===r.ConnectorPosition.Begin?e.beginConnectionPointIndex:e.endConnectionPointIndex,t.setConnectionPointIndex(e,this.connectionPointIndex,this.position)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.setConnectionPointIndex(e,this.oldConnectionPointIndex,this.position)},e}(i.HistoryItem);e.SetConnectionPointIndexHistoryItem=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImageInfo=void 0;var o=n(112),i=function(){function t(t){this.url=void 0,this.base64=void 0,t&&(o.Base64Utils.checkPrependDataUrl(t)?this.base64=t:this.url=t),this.loadFailed=!1}return t.prototype.clone=function(){var e=new t;return e.url=this.url,e.base64=this.base64,e},Object.defineProperty(t.prototype,"isEmpty",{get:function(){return void 0===this.url&&void 0===this.base64},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unableToLoad",{get:function(){return this.loadFailed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderUrl",{get:function(){return this.base64||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exportUrl",{get:function(){return this.base64?this.base64:this.url},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualUrl",{get:function(){return this.url?this.url:this.base64},enumerable:!1,configurable:!0}),Object.defineProperty(t,"transparentOnePixelImage",{get:function(){return this.transparentWhiteImage1_1},enumerable:!1,configurable:!0}),t.prototype.loadBase64Content=function(t){this.base64=o.Base64Utils.normalizeToDataUrl(t,"image/png")},t.prototype.setUnableToLoadFlag=function(){this.loadFailed=!0},t.transparentWhiteImage1_1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAANSURBVBhXY/j///9/AAn7A/0FQ0XKAAAAAElFTkSuQmCC",t}();e.ImageInfo=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalSideCalculatorBase=void 0;var o=n(12),i=n(8),r=n(6),a=function(){function t(t){this.parent=t}return Object.defineProperty(t.prototype,"connector",{get:function(){return this.parent.connector},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"beginRect",{get:function(){return this.parent.beginRect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endRect",{get:function(){return this.parent.endRect},enumerable:!1,configurable:!0}),t.prototype.getBeginOffsetPoints=function(t,e,n,o){if(e=this.getCorrectOriginPoint(e,o),t!==i.ConnectionPointSide.Undefined){if(this.isBeginEndSame())return this.getSameShapeOffsetPoints(t,e,n,o);if(this.isBeginEndOverlappedPoints(e,n))return this.getOverlappedPointsOffsetPoints(t,e,n,o);if(this.isBeginEndOverlapped())return this.getBeginOverlappedShapeOffsetPoints(t,e,n,o)}else if(this.isOriginRectContainsTargetPoint(o,n))return this.getOverlappedPointsOffsetPoints(t,e,n,o);return this.isOnSidePoint(e,n)?this.getBeginOnSideOffsetPoints(t,e,n,o):this.getBeginOffSideOffsetPoints(t,e,n,o)},t.prototype.getEndOffsetPoints=function(t,e,n,o){if(e=this.getCorrectOriginPoint(e,o),t!==i.ConnectionPointSide.Undefined){if(this.isBeginEndSame())return this.getSameShapeOffsetPoints(t,e,n,o);if(this.isBeginEndOverlappedPoints(n,e))return this.getOverlappedPointsOffsetPoints(t,e,n,o);if(this.isBeginEndOverlapped())return this.getEndOverlappedShapeOffsetPoints(t,e,n,o)}else if(this.isOriginRectContainsTargetPoint(o,n))return this.getOverlappedPointsOffsetPoints(t,e,n,o);return this.isOnSidePoint(e,n)?this.getEndOnSideOffsetPoints(t,e,n,o):this.getEndOffSideOffsetPoints(t,e,n,o)},t.prototype.getSide=function(t,e){var n=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);return n>o?e.x>t.x?i.ConnectionPointSide.East:i.ConnectionPointSide.West:e.y>t.y?i.ConnectionPointSide.South:i.ConnectionPointSide.North},t.prototype.getSideCalculator=function(t,e){return this.parent.getSideCalculator(this.getSide(t,e))},t.prototype.getMinOffset=function(){return r.Connector.minOffset},t.prototype.isBeginEndSame=function(){return this.connector.beginItem===this.connector.endItem},t.prototype.isBeginEndOverlapped=function(){return this.beginRect&&this.endRect&&o.Rectangle.areIntersected(this.beginRect,this.endRect)},t.prototype.isBeginEndOverlappedX=function(){return this.beginRect&&this.endRect&&!!o.Rectangle.getHorizIntersection(this.beginRect,this.endRect)},t.prototype.isBeginEndOverlappedY=function(){return this.beginRect&&this.endRect&&!!o.Rectangle.getVertIntersection(this.beginRect,this.endRect)},t.prototype.isBeginEndOverlappedPoints=function(t,e){return this.beginRect&&this.endRect&&(this.beginRect.containsPoint(e)||this.endRect.containsPoint(t))},t.prototype.isOriginRectContainsTargetPoint=function(t,e){return t&&t.containsPoint(e)},t}();e.ConnectorPointsOrthogonalSideCalculatorBase=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AddShapeHistoryItem=void 0;var i=n(5),r=n(14),a=function(t){function e(e,n,o,i){var r=t.call(this)||this;return r.shapeDescription=e,r.position=n,r.text=o,r.dataKey=i,r}return o(e,t),e.prototype.redo=function(t){var e=new r.Shape(this.shapeDescription,this.position);"string"===typeof this.text&&(e.text=this.text),void 0!==this.dataKey&&(e.dataKey=this.dataKey),t.addShape(e,this.shapeKey),this.shapeKey=e.key},e.prototype.undo=function(t){t.deleteShape(t.model.findShape(this.shapeKey))},e}(i.HistoryItem);e.AddShapeHistoryItem=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EllipsePrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r,a,s){var c=t.call(this,r,a,void 0,s)||this;return c.cx=e,c.cy=n,c.rx=o,c.ry=i,c}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"ellipse")},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"cx",this.cx),this.setUnitAttribute(e,"cy",this.cy),this.setUnitAttribute(e,"rx",this.rx),this.setUnitAttribute(e,"ry",this.ry),this.setPositionCorrectionAttribute(e),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.EllipsePrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ClipPathPrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n){var o=t.call(this)||this;return o.id=e,o.children=n,o}return o(e,t),e.prototype.createMainElement=function(){var t=document.createElementNS(i.svgNS,"clipPath");return t.setAttribute("id",this.id),t},e.prototype.applyElementProperties=function(e,n){this.id&&e.setAttribute("id",this.id),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.ClipPathPrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportImportCommandBase=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e}(i.SimpleCommandBase);e.ExportImportCommandBase=r},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return r})),n.d(e,"__rest",(function(){return a})),n.d(e,"__decorate",(function(){return s})),n.d(e,"__param",(function(){return c})),n.d(e,"__metadata",(function(){return u})),n.d(e,"__awaiter",(function(){return l})),n.d(e,"__generator",(function(){return p})),n.d(e,"__createBinding",(function(){return h})),n.d(e,"__exportStar",(function(){return d})),n.d(e,"__values",(function(){return f})),n.d(e,"__read",(function(){return m})),n.d(e,"__spread",(function(){return g})),n.d(e,"__spreadArrays",(function(){return y})),n.d(e,"__await",(function(){return v})),n.d(e,"__asyncGenerator",(function(){return C})),n.d(e,"__asyncDelegator",(function(){return _})),n.d(e,"__asyncValues",(function(){return P})),n.d(e,"__makeTemplateObject",(function(){return S})),n.d(e,"__importStar",(function(){return x})),n.d(e,"__importDefault",(function(){return w})),n.d(e,"__classPrivateFieldGet",(function(){return I})),n.d(e,"__classPrivateFieldSet",(function(){return T}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},o(t,e)};function i(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var r=function(){return r=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r.apply(this,arguments)};function a(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n}function s(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}function c(t,e){return function(n,o){e(n,o,t)}}function u(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,o){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o["throw"](t))}catch(e){r(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((o=o.apply(t,e||[])).next())}))}function p(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,o&&(i=2&r[0]?o["return"]:r[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}var h=Object.create?function(t,e,n,o){void 0===o&&(o=n),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]};function d(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||h(e,t,n)}function f(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,i,r=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(o=r.next()).done)a.push(o.value)}catch(s){i={error:s}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),i=0;for(e=0;e<n;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o}function v(t){return this instanceof v?(this.v=t,this):new v(t)}function C(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=n.apply(t,e||[]),r=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(t){i[t]&&(o[t]=function(e){return new Promise((function(n,o){r.push([t,e,n,o])>1||s(t,e)}))})}function s(t,e){try{c(i[t](e))}catch(n){p(r[0][3],n)}}function c(t){t.value instanceof v?Promise.resolve(t.value.v).then(u,l):p(r[0][2],t)}function u(t){s("next",t)}function l(t){s("throw",t)}function p(t,e){t(e),r.shift(),r.length&&s(r[0][0],r[0][1])}}function _(t){var e,n;return e={},o("next"),o("throw",(function(t){throw t})),o("return"),e[Symbol.iterator]=function(){return this},e;function o(o,i){e[o]=t[o]?function(e){return(n=!n)?{value:v(t[o](e)),done:"return"===o}:i?i(e):e}:i}}function P(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"===typeof f?f(t):t[Symbol.iterator](),e={},o("next"),o("throw"),o("return"),e[Symbol.asyncIterator]=function(){return this},e);function o(n){e[n]=t[n]&&function(e){return new Promise((function(o,r){e=t[n](e),i(o,r,e.done,e.value)}))}}function i(t,e,n,o){Promise.resolve(o).then((function(e){t({value:e,done:n})}),e)}}function S(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var b=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t["default"]=e};function x(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&h(e,t,n);return b(e,t),e}function w(t){return t&&t.__esModule?t:{default:t}}function I(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function T(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},function(t,e,n){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),e.Diagnostics=void 0,function(t){t[t["Disabled"]=0]="Disabled",t[t["Console"]=1]="Console",t[t["Document"]=2]="Document"}(o||(o={}));var i=function(){function t(){}return t.beginAverage=function(t){this.enableLogsAndTimers&&(this.lastAverageGroupName=t)},t.endAverage=function(){this.enableLogsAndTimers&&(this.lastAverageGroupName=null)},t.tryLogAverage=function(t){var e=this;if(this.lastAverageGroupName!==t){var n=Object.keys(this.timers).map((function(t){return e.timers[t]})).filter((function(e){return e.groupName===t}));if(!n.filter((function(t){return!t.endTime})).length){var o=n.reduce((function(t,e){return t+(e.endTime-e.startTime)}),0)/n.length;this.log("average: "+o)}}},t.timer=function(t){this.enableLogsAndTimers&&(this.lastCreatedTimer={message:t,startTime:performance.now(),groupName:this.lastAverageGroupName})},t.endTimer=function(){var t=this;if(this.enableLogsAndTimers){var e=this.lastCreatedTimer,n=setTimeout((function(){e.endTime=performance.now(),t.showMessage('timer "'+e.message+'": '+(e.endTime-e.startTime)),e.groupName&&t.tryLogAverage(e.groupName)}),0);this.timers[n]=e,this.lastCreatedTimer=null}},t.logPerfInfo=function(){var t=document.querySelector(".dxdi-control > svg").querySelectorAll("*").length,e=performance["memory"];this.log("nodes: "+t.toLocaleString()+(e?" memory: ":"")+(e?e["usedJSHeapSize"].toLocaleString():""))},t.log=function(t){this.showMessage(t)},t.showMessage=function(e){switch(t.mode){case o.Console:console.log(e);break;case o.Document:var n=this.getElement().value;if(this.lastMessage===e){var i=n.indexOf("\r\n");i<0&&(i=n.indexOf("\n"));var r=n.substr(0,i),a=/( \()([0-9]+)(\))$/;a.test(r)?r=r.replace(/( \()([0-9]+)(\))$/,(function(t,e,n,o){return e+ ++n+o})):r+=" (1)",this.getElement().value=r+n.substr(i)}else this.getElement().value=e+"\r\n"+n,this.lastMessage=e}},t.getElement=function(){var t=this;if(!this.el){this.el=document.createElement("textarea"),this.el.style.top="0px",this.el.style.right="0px",this.el.style.position="fixed",this.el.style.background="transparent",this.el.style.fontSize="11px",this.el.style.fontFamily="monospace",this.el.style.overflow="auto",this.el.style.width="400px",document.body.appendChild(this.el);var e=document.createElement("button");e.innerHTML="x",e.addEventListener("click",(function(){t.el.value="",t.lastMessage=""})),e.style.top="0px",e.style.right="400px",e.style.position="fixed",e.style.opacity="0.1",document.body.appendChild(e)}return this.el},t.mode=o.Document,t.optimizeUsingRAF=!0,t.optimizeLayers=!0,t.timers={},t.enableLogsAndTimers=!1,t}();e.Diagnostics=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StringUtils=void 0;var o=function(){function t(){}return t.isAlpha=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"},t.isDigit=function(t){return t>="0"&&t<="9"},t.stringHashCode=function(t){var e=0;if(0===t.length)return e;for(var n=t.length,o=0;o<n;o++)e=(e<<5)-e+t.charCodeAt(o),e|=0;return e},t.endsAt=function(t,e){var n=t.length-1,o=e.length-1,i=n-o;if(i<0)return!1;for(;n>=i;n--,o--)if(t[n]!==e[o])return!1;return!0},t.startsAt=function(t,e){return t.substr(0,e.length)===e},t.stringInLowerCase=function(t){return t.toLowerCase()===t},t.stringInUpperCase=function(t){return t.toUpperCase()===t},t.atLeastOneSymbolInUpperCase=function(e){for(var n=0,o=void 0;o=e[n];n++)if(t.stringInUpperCase(o)&&!t.stringInLowerCase(o))return!0;return!1},t.getSymbolFromEnd=function(t,e){return t[t.length-e]},t.trim=function(e,n){if(void 0===n)return t.trimInternal(e,!0,!0);var o=n.join("");return e.replace(new RegExp("(^["+o+"]*)|(["+o+"]*$)","g"),"")},t.trimStart=function(e,n){if(void 0===n)return t.trimInternal(e,!0,!1);var o=n.join("");return e.replace(new RegExp("^["+o+"]*","g"),"")},t.trimEnd=function(e,n){if(void 0===n)return t.trimInternal(e,!1,!0);var o=n.join("");return e.replace(new RegExp("["+o+"]*$","g"),"")},t.getDecimalSeparator=function(){return 1.1.toLocaleString().substr(1,1)},t.repeat=function(t,e){return new Array(e<=0?0:e+1).join(t)},t.isNullOrEmpty=function(t){return!t||!t.length},t.padLeft=function(e,n,o){return t.repeat(o,Math.max(0,n-e.length))+e},t.trimInternal=function(t,e,n){var o=t.length;if(!o)return t;if(o<764833){var i=t;return e&&(i=i.replace(/^\s+/,"")),n&&(i=i.replace(/\s+$/,"")),i}var r=0;if(n)while(o>0&&/\s/.test(t[o-1]))o--;if(e&&o>0)while(r<o&&/\s/.test(t[r]))r++;return t.substring(r,o)},t}();e.StringUtils=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TextPrimitive270degRenderHelper=e.TextPrimitive180degRenderHelper=e.TextPrimitive90degRenderHelper=e.TextPrimitiveRenderHelper=e.TextPrimitive=e.TextAngle=void 0;var i,r=n(11),a=n(15),s=n(25),c=n(18),u=n(59);(function(t){t[t["Angle0deg"]=0]="Angle0deg",t[t["Angle90deg"]=90]="Angle90deg",t[t["Angle180deg"]=180]="Angle180deg",t[t["Angle270deg"]=270]="Angle270deg"})(i=e.TextAngle||(e.TextAngle={}));var l=function(t){function e(e,n,o,i,r,a,s,c,l,p,h,d,f){var m=t.call(this,c,"",p,f)||this;return m.x=e,m.y=n,m.text=o,m.owner=i,m.textWidth=r,m.textHeight=a,m.textSpacing=s,m.reverseTextAhchor=l,m.angle=d,m.filterId=h,m.textSegmens=u.textToParagraphs(m.text),m.renderHelper=m.createRenderHelper(),void 0!==m.textWidth&&void 0!==m.textWidth&&(m.x=m.renderHelper.getTextX(m.x),m.y=m.renderHelper.getTextY(m.y)),m}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(a.svgNS,"text")},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"x",this.x),this.setUnitAttribute(e,"y",this.y),this.filterId&&e.setAttribute("filter",c.RenderUtils.getUrlPathById(this.filterId)),t.prototype.applyElementProperties.call(this,e,n),e.getAttribute("appliedText")!==this.text||e.getAttribute("appliedSize")!==(this.fitToSize&&this.fitToSize.toString())?(this.createTSpanElements(e,n),e.setAttribute("appliedText",this.text),e.setAttribute("appliedSize",this.fitToSize&&this.fitToSize.toString())):this.prepareTSpanElements(e),this.renderHelper.prepareMainElement(e,this.x,this.y)},e.prototype.createTSpanElements=function(t,e){var n=this;c.RenderUtils.removeContent(t),this.textSegmens.forEach((function(o,i){if(!o&&n.textSegmens.length>1){var a=n.createTSpanElement(t);a.textContent=" "}else if(n.fitToSize){var s=u.textToWords(o),c=u.wordsByLines(r.UnitConverter.twipsToPixels(n.fitToSize),s,(function(){return e.measureWords(s,n.style,n.owner)}));if(c.forEach((function(e){var o=n.createTSpanElement(t);o.textContent=e})),!c.length){a=n.createTSpanElement(t);a.textContent=" "}}else{var l=n.createTSpanElement(t);l.textContent=o}}));var o=t.firstChild;o&&this.prepareFirstTSpanElement(o,t.childNodes.length)},e.prototype.createTSpanElement=function(t){var e=document.createElementNS(a.svgNS,"tspan");return t.appendChild(e),this.prepareTSpanElement(e),e},e.prototype.prepareTSpanElements=function(t){for(var e=0;e<t.childNodes.length;e++){var n=t.childNodes[e];this.prepareTSpanElement(n)}var o=t.firstChild;o&&this.prepareFirstTSpanElement(o,t.childNodes.length)},e.prototype.prepareTSpanElement=function(t){this.renderHelper.prepareTSpanElement(t,this.x,this.y)},e.prototype.prepareFirstTSpanElement=function(t,e){this.renderHelper.prepareFirstTSpanElement(t,e)},e.prototype.applyElementStyleProperties=function(t){this.applyElementStylePropertiesCore(t,this.reverseTextAhchor)},Object.defineProperty(e.prototype,"fitToSize",{get:function(){return this.renderHelper.fitToSize},enumerable:!1,configurable:!0}),e.prototype.createRenderHelper=function(){switch(this.angle){case i.Angle90deg:return new h(this);case i.Angle180deg:return new d(this);case i.Angle270deg:return new f(this);default:return new p(this)}},e.baselineCorrection=.35,e}(s.SvgPrimitive);e.TextPrimitive=l;var p=function(){function t(t){this.primitive=t}return Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.primitive.textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.primitive.textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fitToSize",{get:function(){return this.textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textAnchor",{get:function(){return this.primitive.style["text-anchor"]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textSpacing",{get:function(){return this.primitive.textSpacing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needRotation",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.prepareMainElement=function(t,e,n){this.needRotation&&t.setAttribute("transform","rotate("+this.angle+", "+r.UnitConverter.twipsToPixels(e)+", "+r.UnitConverter.twipsToPixels(n)+")")},t.prototype.prepareTSpanElement=function(t,e,n){this.primitive.setUnitAttribute(t,"x",e),t.setAttribute("dy",u.LINE_HEIGHT+"em")},t.prototype.prepareFirstTSpanElement=function(t,e){var n=-(e-1)/2+l.baselineCorrection;t.setAttribute("dy",n.toFixed(2)+"em")},t.prototype.getTextX=function(t){return this.textAnchor&&"middle"!==this.textAnchor?"end"===this.textAnchor?t+this.textWidth-this.textSpacing:"start"===this.textAnchor?t+this.textSpacing:t:t+this.textWidth/2},t.prototype.getTextY=function(t){return t+this.textHeight/2},t.prototype.setUnitAttribute=function(t,e,n){this.primitive.setUnitAttribute(t,e,n)},t}();e.TextPrimitiveRenderHelper=p;var h=function(t){function e(e){return t.call(this,e)||this}return o(e,t),Object.defineProperty(e.prototype,"fitToSize",{get:function(){return this.textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return 90},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needRotation",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.getTextX=function(t){return t+this.textWidth/2},e.prototype.getTextY=function(t){return this.textAnchor&&"middle"!==this.textAnchor?"end"===this.textAnchor?t+this.textHeight-this.textSpacing:"start"===this.textAnchor?t+this.textSpacing:t:t+this.textHeight/2},e}(p);e.TextPrimitive90degRenderHelper=h;var d=function(t){function e(e){return t.call(this,e)||this}return o(e,t),Object.defineProperty(e.prototype,"angle",{get:function(){return 180},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needRotation",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.getTextX=function(t){return this.textAnchor&&"middle"!==this.textAnchor?"start"===this.textAnchor?t+this.textWidth-this.textSpacing:"end"===this.textAnchor?t+this.textSpacing:t:t+this.textWidth/2},e}(p);e.TextPrimitive180degRenderHelper=d;var f=function(t){function e(e){return t.call(this,e)||this}return o(e,t),Object.defineProperty(e.prototype,"angle",{get:function(){return 270},enumerable:!1,configurable:!0}),e.prototype.getTextY=function(t){return this.textAnchor&&"middle"!==this.textAnchor?"start"===this.textAnchor?t+this.textHeight-this.textSpacing:"end"===this.textAnchor?t+this.textSpacing:t:t+this.textHeight/2},e}(h);e.TextPrimitive270degRenderHelper=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getLineHeight=e.getTextHeight=e.getTextLineSize=e.getOptimalTextRectangle=e.TEXTRECT_RATIO_EPS=e.textToParagraphs=e.textToWords=e.wordsByLines=e.LINE_HEIGHT=void 0;var o=n(3),i=n(2),r=n(44),a=/\s/gm;function s(t,e,n){if(1===e.length)return e;for(var o=n(),i=o.words[" "].width,r=[],a=0,s=-1,c=0;c<e.length;c++){var u=e[c],l=o.words[u].width;-1===s||a+i+l>t?(s=r.push(u)-1,a=l):(a+=i+l,r[s]+=" "+u)}return r}function c(t){return t.split(a).filter((function(t){return t.length}))}function u(t){return t.split("\n")}e.LINE_HEIGHT=1.05,e.wordsByLines=s,e.textToWords=c,e.textToParagraphs=u,e.TEXTRECT_RATIO_EPS=1.2;var l=1;function p(t,e,n,a,s,c,l,p,d,f){if(void 0===l&&(l=0),void 0===p&&(p=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE),void 0===d&&(d=0),void 0===f&&(f=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE),!t)return new i.Size(r.Data.byRange(s.width,l,p),r.Data.byRange(s.height,d,f));if(l>p||d>f)throw new Error("Min size cannot exceed max size");if(l===p&&d===f)return new i.Size(l,d);var m=a.measureWords(t,e,n),g=u(t),v=Object.keys(m.words).reduce((function(t,e){return Math.max(t,m.words[e].width)}),0),C=new o.Range(r.Data.byRange(Math.max(s.width,v),l,p),p),_=new o.Range(r.Data.byRange(s.height,d,f),f);if(v<=s.width&&y(g,s.width,m,!1)<=s.height&&C.includes(s.width)&&_.includes(s.height))return s;var P=s.width/s.height;return h(g,m,P,C,_,c)}function h(t,n,o,a,s,c){for(var u,p,h=t.reduce((function(t,e){return Math.max(t,g(e,n).width)}),0),y=new i.Size(0,0),v=new i.Size(0,0),C=0,_=0,P=0;P<5;P++){if(0===P)v.width=m(h,a)[0];else{if(!(Math.abs(C)>l))break;v.width=m(y.width+C,a)[0]}if(u=f(t,v.width,n,s),v.height=u[0],p=u[1],0===P&&(y=v.clone(),_=y.width/y.height/o),0===P&&!p)break;var S=v.width/v.height,b=S/o;if(0===P)C=(v.width/b-v.width)/2;else if(p){if(!d(o,S,e.TEXTRECT_RATIO_EPS)){y=v.clone(),_=b;break}if(!(d(_,b,1)<0))break;y=v.clone(),_=b,C=(v.width/b-v.width)/2,b<1&&(C/=2)}else C/=2}return c&&(y.height=r.Data.byRange(y.width/o,y.height,s.to)),y}function d(t,e,n){var o=t<1?1/t:t,i=e<1?1/e:e,r=o/i,a=r<1?1/r:r;return a<=n?0:i>o?1:-1}function f(t,e,n,o){var i=y(t,e,n,!1);return m(i,o)}function m(t,e){return[r.Data.byRange(t,e.from,e.to),t<=e.to]}function g(t,e){var n=c(t);return n.reduce((function(t,n,o){var i=e.words[n];return t.width+=i.width,t.height=Math.max(t.height,i.height),o>0&&(t.width+=e.words[" "].width),t}),new i.Size(0,0))}function y(t,e,n,o){var i=Array.isArray(t)?t:u(t);return!o||i.length&&(1!==i.length||i[0].length)?i.reduce((function(t,o){return t+s(e,c(o),(function(){return n})).length}),0)*v(n):v(n)}function v(t){return t.fontSize*e.LINE_HEIGHT}e.getOptimalTextRectangle=p,e.getTextLineSize=g,e.getTextHeight=y,e.getLineHeight=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.numberToStringHex=e.numberToStringBin=e.isOdd=e.isEven=e.isNonNullString=e.isString=e.isNumber=e.boolToString=e.boolToInt=e.isDefined=void 0;var o=n(57);function i(t){return void 0!==t&&null!==t}function r(t){return t?1:0}function a(t){return t?"1":"0"}function s(t){return"number"===typeof t}function c(t){return"string"===typeof t}function u(t){return!!t}function l(t){return t%2!==0}function p(t){return t%2===0}function h(t,e){return void 0===e&&(e=0),o.StringUtils.padLeft(t.toString(2),e,"0")}function d(t,e){return void 0===e&&(e=0),o.StringUtils.padLeft(t.toString(16),e,"0")}e.isDefined=i,e.boolToInt=r,e.boolToString=a,e.isNumber=s,e.isString=c,e.isNonNullString=u,e.isEven=l,e.isOdd=p,e.numberToStringBin=h,e.numberToStringHex=d},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AddConnectorHistoryItem=void 0;var i=n(5),r=n(6),a=function(t){function e(e,n,o){var i=t.call(this)||this;return i.points=e,i.dataKey=n,i.renderPointsContext=o,i}return o(e,t),e.prototype.redo=function(t){var e=new r.Connector(this.points);void 0!==this.dataKey&&(e.dataKey=this.dataKey),void 0!==this.renderPointsContext&&e.replaceRenderPoints(this.renderPointsContext),t.addConnector(e,this.connectorKey),this.connectorKey=e.key},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.deleteConnector(e)},e}(i.HistoryItem);e.AddConnectorHistoryItem=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteConnectionHistoryItem=void 0;var i=n(5),r=n(6),a=function(t){function e(e,n){var o=t.call(this)||this;return o.connectorKey=e.key,o.position=n,o.itemKey=e.getExtremeItem(o.position).key,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey);this.oldConnectionPointIndex=this.position===r.ConnectorPosition.Begin?e.beginConnectionPointIndex:e.endConnectionPointIndex,t.deleteConnection(e,this.position)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey),n=t.model.findItem(this.itemKey);t.addConnection(e,n,this.oldConnectionPointIndex,this.position)},e}(i.HistoryItem);e.DeleteConnectionHistoryItem=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SetSelectionHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.selectedKeys=n,i.selection=e,i.forceChange=o,i}return o(e,t),e.prototype.redo=function(){this.oldSelection=this.selection.getKeys().slice(0),this.selection.set(this.selectedKeys,this.forceChange)},e.prototype.undo=function(){this.selection.set(this.oldSelection,this.forceChange)},e}(i.HistoryItem);e.SetSelectionHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorTextHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connectorKey=e.key,i.text=o,i.position=n,i}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey);this.oldText=e.getText(this.position),t.changeConnectorText(e,this.text,this.position)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.changeConnectorText(e,this.oldText,this.position)},e}(i.HistoryItem);e.ChangeConnectorTextHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStyleTextHistoryItem=void 0;var i=n(120),r=function(t){function e(e,n,o){return t.call(this,e,n,o)||this}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.oldStyleValue=e.styleText[this.styleProperty],t.changeStyleText(e,this.styleProperty,this.styleValue)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.changeStyleText(e,this.styleProperty,this.oldStyleValue)},e}(i.ChangeStyleHistoryItemBase);e.ChangeStyleTextHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.GraphIterator=e.FastGraph=e.Graph=void 0;var i=n(36),r=n(14),a=n(39),s=n(89),c=function(){function t(t,e){this.nodeMap={},this.edgeMap={},this.nodes=[],this.edges=[],this.onInit(),t.forEach(this.addNode.bind(this)),e.forEach(this.addEdge.bind(this))}return Object.defineProperty(t.prototype,"items",{get:function(){return this.nodes.map(this.getNode.bind(this))},enumerable:!1,configurable:!0}),t.prototype.onInit=function(){},t.prototype.addEdge=function(t){this.edgeMap[t.key]=t,this.edges.push(t)},t.prototype.addNode=function(t){this.nodeMap[t.key]=t,this.nodes.push(t.key)},t.prototype.getNode=function(t){return this.nodeMap[t]},t.prototype.getEdge=function(t){return this.edgeMap[t]},t.prototype.isEmpty=function(){return!this.nodes.length&&!this.edges.length},t.prototype.getAdjacentEdges=function(t,e){return void 0===e&&(e=i.ConnectionMode.OutgoingAndIncoming),this.edges.filter((function(n){return e&i.ConnectionMode.Incoming&&n.to===t||e&i.ConnectionMode.Outgoing&&n.from===t}))},t}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.cast=function(t,n){var o=this,i=this.nodes.map((function(e){return t(o.getNode(e))})),r=this.edges.map((function(t){return n?n(t):t}));return new e(i,r)},e.prototype.getConnectedComponents=function(){var t=this.createIterator(i.ConnectionMode.OutgoingAndIncoming);t.visitEachEdgeOnce=!0;for(var n=[],o=function(o){var i=[],a=[];t.onNode=function(t){return i.push(t)},t.onEdge=function(t){return a.push(t)},t.iterate(r.nodes[o]),i.length&&n.push(new e(i,a))},r=this,a=0;a<this.nodes.length;a++)o(a);return n},e.prototype.createIterator=function(t){var e=new p(this,t);return e.comparer=function(t,e){return t.weight-e.weight},e},e.prototype.getSpanningGraph=function(t,n,o){var i=this;if(void 0===o&&(o=void 0),!this.nodes.length)return new e([],[]);o||(o=function(t){return t.weight});var r=[],a=new s.HashSet,c=new s.HashSet([],(function(t){return t.getHashKey()}));this.addNodeToSpanningGraph(t,n,r,a,c,o);while(r.length&&a.length!==this.nodes.length){var u=r.shift();c.tryPush(u);var l=a.contains(u.from)?u.to:u.from;this.addNodeToSpanningGraph(l,n,r,a,c,o),r=r.filter((function(t){return!a.contains(t.from)||!a.contains(t.to)}))}return new e(a.list().map((function(t){return i.getNode(t)})),c.list())},e.prototype.addNodeToSpanningGraph=function(t,e,n,o,r,s){o.tryPush(t),this.getAdjacentEdges(t,e).filter((function(t){return!r.contains(t)})).forEach((function(t){var e=s(t),o=a.SearchUtils.binaryIndexOf(n,(function(t){return t.weight-e}));o=o<0?~o:o;while(o<n.length&&s(n[o])===e)o++;n.splice(o,0,new i.Edge(t.key,t.from,t.to,e))}))},e.create=function(t,n){var o=t,a=n.filter((function(t){return t.beginItem&&t.endItem instanceof r.Shape&&t.endItem&&t.endItem instanceof r.Shape&&t.beginItem!==t.endItem})).map((function(t){return new i.Edge(t.key,t.beginItem&&t.beginItem.key,t.endItem&&t.endItem.key)}));return new e(o,a)},e}(c);e.Graph=u;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onInit=function(){this.parentToChildren={},this.childToParents={}},e.prototype.addEdge=function(e){t.prototype.addEdge.call(this,e),(this.parentToChildren[e.from]||(this.parentToChildren[e.from]=[])).push(e.to),(this.childToParents[e.to]||(this.childToParents[e.to]=[])).push(e.from)},e.prototype.getChildren=function(t){return this.parentToChildren[t]||[]},e.prototype.getParents=function(t){return this.childToParents[t]||[]},e.prototype.createIterator=function(t){return new p(this,t)},e}(c);e.FastGraph=l;var p=function(){function t(t,e){void 0===e&&(e=i.ConnectionMode.OutgoingAndIncoming),this.graph=t,this.connectionMode=e,this.visitEachEdgeOnce=!0,this.visitEachNodeOnce=!0,this.visitedNodes={},this.visitedEdges={}}return t.prototype.iterate=function(t){if(!this.visitEachNodeOnce&&!this.visitEachEdgeOnce&&!this.skipNode)throw"skipNode or visitEachNodeOnce or visitEachEdgeOnce must be set to avoid SOF";this.iterateCore(t)},t.prototype.iterateCore=function(t){var e=this,n=this.graph.getNode(t);if(!(!n||this.skipNode&&this.skipNode(n)||this.visitEachNodeOnce&&this.isNodeVisited(t))){this.visitedNodes[t]=!0,this.onNode&&this.onNode(n);var o=this.graph.getAdjacentEdges(t,this.connectionMode);if(this.skipEdge&&(o=o.filter((function(t){return!e.skipEdge(t)}))),this.connectionMode&i.ConnectionMode.Outgoing){var r=o.filter((function(e){return e.from===t}));this.comparer&&r.sort(this.comparer),r.forEach((function(t){e.visitEachEdgeOnce&&e.visitedEdges[t.key]||(e.visitedEdges[t.key]=!0,e.onEdge&&e.onEdge(t,!0),e.iterateCore(t.to),e.onAfterEdge&&e.onAfterEdge(t,!0))}))}if(this.onAllEdges&&this.onAllEdges(n,!0),this.connectionMode&i.ConnectionMode.Incoming){var a=o.filter((function(e){return e.to===t}));this.comparer&&a.sort(this.comparer),a.forEach((function(t){e.visitEachEdgeOnce&&e.visitedEdges[t.key]||(e.visitedEdges[t.key]=!0,e.onEdge&&e.onEdge(t,!1),e.iterateCore(t.from),e.onAfterEdge&&e.onAfterEdge(t,!1))}))}this.onAllEdges&&this.onAllEdges(n,!1)}},t.prototype.isNodeVisited=function(t){return!!this.visitedNodes[t]},t.prototype.isEdgeVisited=function(t){return!!this.visitedEdges[t]},t}();e.GraphIterator=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Margin=e.EdgeLayout=e.NodeLayout=e.NodeInfo=void 0;var o=n(12),i=function(){function t(t,e,n,o){void 0===o&&(o=[]),this.key=t,this.margin=e,this.size=n,this.connectionPoints=o}return t}();e.NodeInfo=i;var r=function(){function t(t,e){this.info=t,this.position=e}return Object.defineProperty(t.prototype,"key",{get:function(){return this.info.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rectangle",{get:function(){return o.Rectangle.fromGeometry(this.position,this.info.size)},enumerable:!1,configurable:!0}),t}();e.NodeLayout=r;var a=function(){function t(t,e,n){this.key=t,this.beginIndex=e,this.endIndex=n}return t}();e.EdgeLayout=a;var s=function(){function t(t,e,n,o){void 0===e&&(e=t),void 0===n&&(n=t),void 0===o&&(o=t),this.top=t,this.right=e,this.bottom=n,this.left=o}return t.empty=function(){return new t(0)},t}();e.Margin=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EllipseShapeDescription=void 0;var i=n(7),r=n(2),a=n(52),s=n(0),c=n(3),u=n(12),l=function(t){function e(e){return t.call(this,new r.Size(i.ShapeDefaultDimension,.75*i.ShapeDefaultDimension),e)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return s.ShapeTypes.Ellipse},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getTextRectangle=function(t){var e=c.GeometryUtils.getMaxRectangleEnscribedInEllipse(t.size);return u.Rectangle.fromGeometry(t.position.clone().offset((t.size.width-e.width)/2,(t.size.height-e.height)/2),e)},e.prototype.getSizeByText=function(t,e){return c.GeometryUtils.getEllipseByEnscribedRectangle(t)},e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.width,o=e.height,i=e.center,r=i.x,s=i.y;return[new a.EllipsePrimitive(r,s,n/2,o/2,t.style)]},e}(i.ShapeDescription);e.EllipseShapeDescription=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exporter=void 0;var o=n(14),i=n(6),r=n(3),a=function(){function t(){}return t.prototype.export=function(t){var e={page:{},connectors:[],shapes:[]};return e.page={width:t.size.width,height:t.size.height,pageColor:t.pageColor,pageWidth:t.pageSize.width,pageHeight:t.pageSize.height,pageLandscape:t.pageLandscape,units:t.units},this.exportItemsCore(t.items,e),JSON.stringify(e)},t.prototype.exportItems=function(t){var e={connectors:[],shapes:[]};return this.exportItemsCore(t,e),JSON.stringify(e)},t.prototype.exportItemsCore=function(t,e){var n=this;t.forEach((function(t){if(t instanceof o.Shape)e.shapes.push(n.exportShape(t));else if(t instanceof i.Connector){var r=n.exportConnector(t);t.beginItem&&(r["beginItemKey"]=t.beginItem.key,r["beginConnectionPointIndex"]=t.beginConnectionPointIndex),t.endItem&&(r["endItemKey"]=t.endItem.key,r["endConnectionPointIndex"]=t.endConnectionPointIndex),e.connectors.push(r)}}))},t.prototype.exportItem=function(t){return{key:t.key,dataKey:t.dataKey,customData:r.ObjectUtils.cloneObject(t.customData),locked:t.locked,zIndex:t.zIndex}},t.prototype.exportShape=function(t){var e=this.exportItem(t);e["type"]=t.description.key,e["text"]=t.text,t.image.isEmpty||(e["imageUrl"]=t.image.exportUrl),e["x"]=t.position.x,e["y"]=t.position.y,e["width"]=t.size.width,e["height"]=t.size.height;var n=t.parameters.toObject();n&&(e["parameters"]=n);var o=t.style.toObject();o&&(e["style"]=o);var i=t.styleText.toObject();return i&&(e["styleText"]=i),t.children.length&&(e["childKeys"]=t.children.map((function(t){return t.key}))),t.expanded||(e["expanded"]=!1),t.expandedSize&&(e["expandedWidth"]=t.expandedSize.width,e["expandedHeight"]=t.expandedSize.height),e},t.prototype.exportConnector=function(t){var e=this.exportItem(t);e["points"]=t.points.map((function(t){return{x:t.x,y:t.y}}));var n=t.texts.toObject();n&&(e["texts"]=n);var o=t.properties.toObject();o&&(e["properties"]=o);var i=t.style.toObject();i&&(e["style"]=i);var r=t.styleText.toObject();return r&&(e["styleText"]=r),e},t.prototype.exportSvg=function(t,e,n,o){n.exportSvgImage(t,e,o)},t.prototype.exportPng=function(t,e,n,o){n.exportPngImage(t,e,o)},t.prototype.exportJpg=function(t,e,n,o){n.exportJpgImage(t,e,o)},t}();e.Exporter=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleStyleTextPropertyCommand=void 0;var i=n(136),r=n(65),a=n(29),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){var t=this.control.selection.inputPosition.getCurrentTextStylePropertyValue(this.getStyleProperty());return t===this.getStylePropertyValue()},e.prototype.executeCore=function(t){var e=this;this.control.history.beginTransaction();var n=this.getStyleProperty(),o=t.value?a.TextStyle.defaultInstance[n]:this.getStylePropertyValue(),i=this.control.selection.getSelectedItems();return i.forEach((function(t){e.control.history.addAndRedo(new r.ChangeStyleTextHistoryItem(t.key,n,o))})),this.control.selection.inputPosition.setTextStylePropertyValue(this.getStyleProperty(),o),this.control.history.endTransaction(),!0},e.prototype.getStyleObj=function(t){return t.styleText},e.prototype.getDefaultStyleObj=function(){return new a.TextStyle},e}(i.StylePropertyCommandBase);e.ToggleStyleTextPropertyCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStylePropertyCommand=void 0;var i=n(137),r=n(88),a=n(29),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentStylePropertyValue(this.getStyleProperty())},e.prototype.getStyleObj=function(t){return t.style},e.prototype.getDefaultStyleObj=function(){return new a.Style},e.prototype.createHistoryItem=function(t,e,n){return new r.ChangeStyleHistoryItem(t.key,e,n)},e.prototype.updateInputPosition=function(t){this.control.selection.inputPosition.setStylePropertyValue(this.getStyleProperty(),t)},e}(i.ChangeStylePropertyCommandBase);e.ChangeStylePropertyCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutCommandBase=void 0;var i=n(9),r=n(10),a=n(14),s=n(6),c=n(3),u=n(12),l=n(250),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.getAffectedShapes(),r=this.getAffectedConnectors(),a=this.createLayoutSettings(),s=i.ModelUtils.getGraphInfoByItems(this.control.model,o,r,!1);if(s.length){var p,h=this.control.model,d=c.GeometryUtils.getCommonRectangle(c.Utils.flatten(s.map((function(t){return t.graph.items.map((function(t){return h.findItem(t.key)}))}))).concat(s.map((function(t){return t.container}))).filter((function(t){return t})).map((function(t){return t.rectangle})));this.control.history.addAndRedo(new l.ScrollIntoViewOnUndoHistoryItem(this.control.view,d)),s.forEach((function(t){var e=n.createLayout(a,t.graph),s=i.ModelUtils.getNonGraphItems(n.control.model,t.container,e.nodeToLayout,o,r),c=i.ModelUtils.applyLayout(n.control.history,n.control.model,t.container,t.graph,e,s,a,n.control.settings.snapToGrid,n.control.settings.gridSize,!1);p=p&&u.Rectangle.union(p,c)||c})),i.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.addAndRedo(new l.ScrollIntoViewOnRedoHistoryItem(this.control.view,p))}return this.control.history.endTransaction(),!0},e.prototype.getAffectedShapes=function(){return this.control.selection.isEmpty()?this.control.model.items.filter((function(t){return t instanceof a.Shape&&!t.locked})):this.control.selection.getSelectedShapes(!1,!0)},e.prototype.getAffectedConnectors=function(){return this.control.selection.isEmpty()?this.control.model.items.filter((function(t){return t instanceof s.Connector&&!t.locked})):this.control.selection.getSelectedConnectors(!1,!0)},e}(r.SimpleCommandBase);e.AutoLayoutCommandBase=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePagePropertyCommand=void 0;var i=n(9),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.createHistoryItems(e);return o.forEach((function(t){n.control.history.addAndRedo(t)})),i.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.endTransaction(),!0},e.prototype.getItems=function(){return null},e}(r.SimpleCommandBase);e.ChangePagePropertyCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasItemsManager=e.CONNECTOR_CAN_MOVE=e.NOT_VALID_CSSCLASS=void 0;var i=n(98),r=n(13),a=n(37),s=n(18),c=n(14),u=n(6),l=n(26),p=n(142),h=n(9);e.NOT_VALID_CSSCLASS="not-valid",e.CONNECTOR_CAN_MOVE="can-move";var d=function(t){function n(e,n,o){var i=t.call(this,n,o)||this;return i.itemSelectorGroupContainers={},i.itemSelectorElements={},i.itemGroupContainers={},i.itemElements={},i.itemChildElements={},i.primitives={},i.selectorPrimitives={},i.selectedItems={},i.initializeContainerElements(e),i}return o(n,t),n.prototype.initializeContainerElements=function(t){this.itemSelectorsContainer=this.createAndChangePrimitiveElement(new a.GroupPrimitive([],null),t),this.itemsContainer=this.createAndChangePrimitiveElement(new a.GroupPrimitive([],null),t)},n.prototype.clear=function(){this.primitives={},this.selectorPrimitives={},s.RenderUtils.removeContent(this.itemSelectorsContainer),s.RenderUtils.removeContent(this.itemsContainer),this.itemSelectorGroupContainers={},this.itemSelectorElements={},this.itemGroupContainers={},this.itemElements={},this.itemChildElements={},this.selectedItems={}},n.prototype.applyChange=function(t){var e=t.item,n=this.getItemParent(e.zIndex,e.container&&e.container.key);return!!n&&(e instanceof c.Shape?this.applyShapeChange(e,t.type,t.isValid):e instanceof u.Connector&&this.applyConnectorChange(e,t.type,t.isValid),!0)},n.prototype.setPointerEventsNone=function(t,e){t.style.pointerEvents=e?"none":"";for(var n=0;n<t.children.length;n++)this.setPointerEventsNone(t.children[n],e)},n.prototype.notifyDragStart=function(t){var e=this;t.forEach((function(t){e.itemElements[t]&&e.setPointerEventsNone(e.itemElements[t],!0),e.itemChildElements[t]&&e.setPointerEventsNone(e.itemChildElements[t],!0),e.itemSelectorElements[t]&&e.setPointerEventsNone(e.itemSelectorElements[t],!0)}))},n.prototype.notifyDragEnd=function(t){var e=this;t.forEach((function(t){e.itemElements[t]&&e.setPointerEventsNone(e.itemElements[t],!1),e.itemChildElements[t]&&e.setPointerEventsNone(e.itemChildElements[t],!1),e.itemSelectorElements[t]&&e.setPointerEventsNone(e.itemSelectorElements[t],!1)}))},n.prototype.notifyDragScrollStart=function(){},n.prototype.notifyDragScrollEnd=function(){},n.prototype.notifyTextInputStart=function(t,e,n,o){var i=this.itemElements[t.key];l.DomUtils.addClassName(i,"text-input")},n.prototype.notifyTextInputEnd=function(t){var e=this.itemElements[t.key];l.DomUtils.removeClassName(e,"text-input")},n.prototype.notifyTextInputPermissionsCheck=function(t,n){var o=this.itemElements[t.key];n?l.DomUtils.removeClassName(o,e.NOT_VALID_CSSCLASS):l.DomUtils.addClassName(o,e.NOT_VALID_CSSCLASS)},n.prototype.notifyActualZoomChanged=function(t){var e="scale("+t+")";this.dom.changeByFunc(this.itemsContainer,(function(t){return t.setAttribute("transform",e)})),this.dom.changeByFunc(this.itemSelectorsContainer,(function(t){return t.setAttribute("transform",e)})),this.actualZoom=t},n.prototype.notifyViewAdjusted=function(t){},n.prototype.invalidatePrimitives=function(t){this.primitives[t.key]&&(this.primitives[t.key].forEach((function(t){t.dispose()})),delete this.primitives[t.key]),this.selectorPrimitives[t.key]&&(this.selectorPrimitives[t.key].forEach((function(t){t.dispose()})),delete this.selectorPrimitives[t.key])},n.prototype.getPrimitives=function(t){return this.primitives[t.key]||(this.primitives[t.key]=t.createPrimitives()),this.primitives[t.key]},n.prototype.getSelectorPrimitives=function(t){return this.selectorPrimitives[t.key]||(this.selectorPrimitives[t.key]=t.createSelectorPrimitives()),this.selectorPrimitives[t.key]},n.prototype.getShapeSelectorClassName=function(t){var e="shape";return t.enableChildren&&(e+=" container"),t.isLocked&&(e+=" locked"),e},n.prototype.getShapeClassName=function(t,n){var o=this.getShapeSelectorClassName(t);return n?o:o+" "+e.NOT_VALID_CSSCLASS},n.prototype.applyShapeChange=function(t,e,n){var o=t.key,a=t.container&&t.container.key,s=this.getItemSelectorGroupContainer(t.zIndex,a),c=this.getItemGroupContainer(t.zIndex,a),u=this.getShapeClassName(t,n);switch(e){case i.ItemChangeType.Create:this.itemSelectorElements[o]=this.createItemElements(o,this.getSelectorPrimitives(t),s,this.getShapeSelectorClassName(t),r.MouseEventElementType.Shape),this.itemElements[o]=this.createItemElements(o,this.getPrimitives(t),c,u,r.MouseEventElementType.Shape),t.enableChildren&&(this.itemChildElements[o]=this.createItemElements(o,[],c,"container-children",r.MouseEventElementType.Undefined),this.changeItemChildrenVisibility(this.itemChildElements[o],t.expanded));break;case i.ItemChangeType.Remove:this.removeItemCustomContent(this.itemSelectorElements[o],this.getSelectorPrimitives(t)),this.removeItemCustomContent(this.itemElements[o],this.getPrimitives(t)),this.invalidatePrimitives(t),this.removeItemElements(this.itemSelectorElements[o]),delete this.itemSelectorElements[o],this.removeItemElements(this.itemElements[o]),delete this.itemElements[o],this.itemChildElements[o]&&(this.removeItemElements(this.itemChildElements[o]),delete this.itemChildElements[o],delete this.itemGroupContainers[o],delete this.itemSelectorGroupContainers[o]);break;case i.ItemChangeType.UpdateStructure:case i.ItemChangeType.UpdateProperties:case i.ItemChangeType.Update:e!==i.ItemChangeType.Update&&(e===i.ItemChangeType.UpdateStructure&&(this.removeItemCustomContent(this.itemSelectorElements[o],this.getSelectorPrimitives(t)),this.removeItemCustomContent(this.itemElements[o],this.getPrimitives(t))),this.invalidatePrimitives(t)),this.changeItemElements(this.getSelectorPrimitives(t),this.itemSelectorElements[o],e===i.ItemChangeType.UpdateStructure),this.changeItemElements(this.getPrimitives(t),this.itemElements[o],e===i.ItemChangeType.UpdateStructure),this.changeItemClassName(this.itemElements[o],u),this.itemChildElements[o]&&this.changeItemChildrenVisibility(this.itemChildElements[o],t.expanded),s!==(this.itemSelectorElements[o]&&this.itemSelectorElements[o].parentNode)&&this.moveItemElements(s,this.itemSelectorElements[o]),c!==(this.itemElements[o]&&this.itemElements[o].parentNode)&&this.moveItemElements(c,this.itemElements[o]),this.itemChildElements[o]&&c!==this.itemChildElements[o].parentNode&&this.moveItemElements(c,this.itemChildElements[o]);break;case i.ItemChangeType.UpdateClassName:this.changeItemClassName(this.itemElements[o],u)}},n.prototype.getConnectorSelectorClassName=function(t){return"connector"},n.prototype.getConnectorClassName=function(t,n){var o=this.getConnectorSelectorClassName(t),i=h.ModelUtils.canMoveConnector(this.selectedItems,t)?o+" "+e.CONNECTOR_CAN_MOVE:o;return n?i:i+" "+e.NOT_VALID_CSSCLASS},n.prototype.applyConnectorChange=function(t,e,n){var o=t.key,a=t.container&&t.container.key,s=this.getItemSelectorGroupContainer(t.zIndex,a),c=this.getItemGroupContainer(t.zIndex,a),u=this.getConnectorClassName(t,n);switch(e){case i.ItemChangeType.Create:this.itemSelectorElements[o]=this.createItemElements(o,this.getSelectorPrimitives(t),s,this.getConnectorSelectorClassName(t),r.MouseEventElementType.Connector),this.itemElements[o]=this.createItemElements(o,this.getPrimitives(t),c,u,r.MouseEventElementType.Connector);break;case i.ItemChangeType.Remove:this.removeItemCustomContent(this.itemSelectorElements[o],this.getSelectorPrimitives(t)),this.removeItemCustomContent(this.itemElements[o],this.getPrimitives(t)),this.invalidatePrimitives(t),this.removeItemElements(this.itemSelectorElements[o]),delete this.itemSelectorElements[o],this.removeItemElements(this.itemElements[o]),delete this.itemElements[o];break;case i.ItemChangeType.UpdateStructure:case i.ItemChangeType.UpdateProperties:case i.ItemChangeType.Update:e!==i.ItemChangeType.Update&&(e===i.ItemChangeType.UpdateStructure&&(this.removeItemCustomContent(this.itemSelectorElements[o],this.getSelectorPrimitives(t)),this.removeItemCustomContent(this.itemElements[o],this.getPrimitives(t))),this.invalidatePrimitives(t)),this.changeItemElements(this.getSelectorPrimitives(t),this.itemSelectorElements[o],e===i.ItemChangeType.UpdateStructure),this.changeItemClassName(this.itemSelectorElements[o],this.getConnectorSelectorClassName(t)),this.changeItemElements(this.getPrimitives(t),this.itemElements[o],e===i.ItemChangeType.UpdateStructure),this.changeItemClassName(this.itemElements[o],u),s!==(this.itemSelectorElements[o]&&this.itemSelectorElements[o].parentNode)&&this.moveItemElements(s,this.itemSelectorElements[o]),c!==(this.itemElements[o]&&this.itemElements[o].parentNode)&&this.moveItemElements(c,this.itemElements[o]);break;case i.ItemChangeType.UpdateClassName:this.changeItemClassName(this.itemSelectorElements[o],this.getConnectorSelectorClassName(t)),this.changeItemClassName(this.itemElements[o],u)}},n.prototype.createItemElements=function(t,e,n,o,i){var r=this.createAndChangePrimitiveElement(new a.GroupPrimitive([],o,void 0,void 0,(function(e){return s.RenderUtils.setElementEventData(e,i,t)})),n);return this.createAndChangePrimitivesElements(e,r),r},n.prototype.changeItemElements=function(t,e,n){n||t.length!==e.childNodes.length?(s.RenderUtils.removeContent(e),this.createAndChangePrimitivesElements(t,e)):this.dom.changeChildrenByPrimitives(t,e)},n.prototype.changeItemClassName=function(t,e){e&&t&&this.changePrimitiveElement(new a.GroupPrimitive([],e),t)},n.prototype.removeItemElements=function(t){t&&t.parentNode&&t.parentNode.removeChild(t)},n.prototype.removeItemCustomContent=function(t,e){t&&e&&e.length===t.childNodes.length&&e.forEach((function(e,n){e.destroyCustomContent(t.childNodes[n])}))},n.prototype.moveItemElements=function(t,e,n){e&&t&&(n?t.insertBefore(e,n):t.appendChild(e))},n.prototype.changeItemChildrenVisibility=function(t,e){t.style.display=e?"":"none"},n.prototype.getItemGroupContainerKey=function(t,e){return void 0!==e?t+"_"+e:t.toString()},n.prototype.getItemGroupContainer=function(t,e){var n=void 0!==e?this.getItemParent(t,e):this.itemsContainer,o=e||"Main";return void 0!==this.itemGroupContainers[o]&&void 0!==this.itemGroupContainers[o][t]||(void 0===this.itemGroupContainers[o]&&(this.itemGroupContainers[o]=[]),this.itemGroupContainers[o][t]=this.createAndChangePrimitiveElement(new a.GroupPrimitive([],null,t),n,this.itemGroupContainers[o][t+1])),this.itemGroupContainers[o][t]},n.prototype.getItemSelectorGroupContainer=function(t,e){var n=void 0!==e?this.getItemSelectorParent(t,e):this.itemSelectorsContainer,o=e||"Main";return void 0!==this.itemSelectorGroupContainers[o]&&void 0!==this.itemSelectorGroupContainers[o][t]||(void 0===this.itemSelectorGroupContainers[o]&&(this.itemSelectorGroupContainers[o]=[]),this.itemSelectorGroupContainers[o][t]=this.createAndChangePrimitiveElement(new a.GroupPrimitive([],null,t),n,this.itemSelectorGroupContainers[o][t+1])),this.itemSelectorGroupContainers[o][t]},n.prototype.getItemParent=function(t,e){return void 0!==e?this.itemChildElements[e]:this.getItemGroupContainer(t)},n.prototype.getItemSelectorParent=function(t,e){return void 0!==e?this.itemChildElements[e]:this.getItemSelectorGroupContainer(t)},n.prototype.notifySelectionChanged=function(t){var e=this,n=h.ModelUtils.createSelectedItems(t),o=[];this.populateItems(o,n,this.selectedItems),this.populateItems(o,this.selectedItems,n),this.selectedItems=n,o.forEach((function(t){t instanceof u.Connector&&e.applyConnectorChange(t,i.ItemChangeType.UpdateClassName,!0)}))},n.prototype.populateItems=function(t,e,n){Object.keys(e).forEach((function(o){n[o]||t.push(e[o])}))},n}(p.CanvasManager);e.CanvasItemsManager=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextMeasurer=void 0;var o=n(2),i=n(18),r=n(14),a=n(6),s=n(43),c=n(15),u=n(59),l=function(){function t(t){this.cache={},this.fontSizeCache={},this.containers={},this.parent=t,this.createNodes()}return t.prototype.measureWords=function(t,e,n){var o=this,i={words:{},fontSize:-1},r="string"===typeof t?this.splitToWords(t,!1):t.reduce((function(t,e){return t.concat(o.splitToWords(e,!1))}),[]);r.push(" ");var a=this.getStyleHash(e,n),s=this.tryLoadWordsToMeasurer(r,e,a,n,void 0,void 0,void 0,void 0,i);if(s){var c=this.containers[n];this.putElementsInDOM(c,s),this.beforeMeasureInDOM(),this.measureElementsInDOM(s,i),this.afterMeasureInDOM()}return i},t.prototype.measureTextLine=function(t,e,n){var o=this.measureWords(t,e,n);return u.getTextLineSize(t,o)},t.prototype.onNewModel=function(t,e){var n=this;e.changeByFunc(null,(function(){return n.onNewModelCore(t)}))},t.prototype.onNewModelCore=function(t){var e=t.filter((function(t){return t instanceof r.Shape})),n=t.filter((function(t){return t instanceof a.Connector})),o=this.tryLoadShapeTexts(e),i=this.tryLoadConnectorTexts(n);(o||i)&&(o&&this.putElementsInDOM(this.containers[s.TextOwner.Shape],o),i&&this.putElementsInDOM(this.containers[s.TextOwner.Connector],i),this.beforeMeasureInDOM(),o&&this.measureElementsInDOM(o),i&&this.measureElementsInDOM(i),this.afterMeasureInDOM())},t.prototype.replaceParent=function(t){this.parent!==t&&(this.mainElement.parentNode&&t.appendChild(this.mainElement),this.parent=t)},t.prototype.clean=function(){i.RenderUtils.removeElement(this.mainElement)},t.prototype.tryLoadShapeTexts=function(t){var e=this,n={},o=[],i=[],r=[];return t.forEach((function(t){var a=e.getStyleHash(t.styleText,s.TextOwner.Shape);e.tryLoadWordsToMeasurer(e.splitToWords(t.text,!0),t.styleText,a,s.TextOwner.Shape,n,o,i,r)})),o.length?{elements:o,hashes:i,styleHashes:r}:null},t.prototype.tryLoadConnectorTexts=function(t){var e=this,n={},o=[],i=[],r=[];return t.forEach((function(t){var a=t.texts.map((function(t){return t.value})).reduce((function(t,n){return t.concat(e.splitToWords(n,!1))}),[]);if(a.length){a.push(" ");var c=e.getStyleHash(t.styleText,s.TextOwner.Connector);e.tryLoadWordsToMeasurer(a,t.styleText,c,s.TextOwner.Connector,n,o,i,r)}})),o.length?{elements:o,hashes:i,styleHashes:r}:null},t.prototype.tryLoadWordsToMeasurer=function(t,e,n,o,i,r,a,s,c){var u=this,l=[];return r=r||[],a=a||[],s=s||[],i=i||{},t.forEach((function(t){return u.tryLoadWordToMeasurer(t,e,n,o,i,r,a,s,l,c)})),r.length?{elements:r,hashes:a,styleHashes:s,newWords:l}:null},t.prototype.putElementsInDOM=function(t,e){t.parentNode&&t.parentNode.removeChild(t);while(t.firstChild)t.removeChild(t.firstChild);e.elements.forEach((function(e){return t.appendChild(e)})),this.svgElement.appendChild(t)},t.prototype.measureElementsInDOM=function(t,e){for(var n=t.hashes,o=t.elements,i=t.newWords,r=n.length,a=0;a<r;a++){var s=this.getDomElementSize(o[a]);s&&(this.cache[n[a]]=s,e&&(e.words[i[a]]=s));var c=t.styleHashes[a];void 0===this.fontSizeCache[c]&&(this.fontSizeCache[c]=this.getDomFontSize(o[a])),e&&e.fontSize<0&&(e.fontSize=this.fontSizeCache[c])}},t.prototype.beforeMeasureInDOM=function(){this.parent.appendChild(this.mainElement)},t.prototype.afterMeasureInDOM=function(){this.mainElement.parentNode&&this.mainElement.parentNode.removeChild(this.mainElement)},t.prototype.tryLoadWordToMeasurer=function(t,e,n,o,i,r,a,s,c,u){var l=this.getHash(t,e,o),p=this.cache[l];p||i[l]?p&&u&&(u.words[t]=p,u.fontSize=this.fontSizeCache[n]):(i[l]=!0,a.push(l),r.push(this.createElement(t,e)),s.push(n),c.push(t))},t.prototype.getHash=function(t,e,n){return n+"|"+(e&&e.toHash())+"|"+t},t.prototype.getStyleHash=function(t,e){return this.getHash(" ",t,e)},t.prototype.createElement=function(t,e){var n=document.createElementNS(c.svgNS,"text");return" "===t&&n.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.textContent=t,e&&i.RenderUtils.applyStyleToElement(e,n),n},t.prototype.splitToWords=function(t,e){var n=u.textToWords(t);return e&&n.push(" "),n},t.prototype.getDomFontSize=function(t){return parseFloat(window.getComputedStyle(t).fontSize)},t.prototype.getDomElementSize=function(t){var e;try{e=t.getBBox()}catch(n){}return e?new o.Size(e.width,e.height):null},t.prototype.createNodes=function(){this.mainElement=c.RenderHelper.createMainElement(void 0,!0),this.svgElement=c.RenderHelper.createSvgElement(this.mainElement,!1),this.createContainer(s.TextOwner.Shape,"shape"),this.createContainer(s.TextOwner.Connector,"connector"),this.createContainer(s.TextOwner.ExtensionLine,"extension-line"),this.createContainer(s.TextOwner.Resize,"resize-info")},t.prototype.createContainer=function(t,e){var n=document.createElementNS(c.svgNS,"g");n.setAttribute("class",e),this.containers[t]=n},t}();e.TextMeasurer=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EdgeOnLayer=e.NodeOnLayer=e.SugiyamaNodesOrderer=e.SugiyamaLayerDistributor=e.SugiyamaLayoutBuilder=void 0;var i=n(141),r=n(66),a=n(67),s=n(36),c=n(89),u=n(39),l=n(1),p=n(21),h=n(140),d=n(6),f=n(269),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.build=function(){var t=this,e=0,n=new h.GraphLayout,o=new y;return this.graph.getConnectedComponents().forEach((function(i){var r=f.CycleRemover.removeCycles(i),a=g.getLayers(r.graph),s=o.orderNodes(r.graph,a),c=Object.keys(r.removedEdges).map((function(t){return i.getEdge(t)})),u=o.assignAbsCoordinates(s),l=t.createInfoGraphLayout(u,r.reversedEdges,c);n.extend(t.setComponentOffset(l,e)),e+=t.getComponentOffset(l)})),n},e.prototype.createInfoGraphLayout=function(t,e,n){for(var o=this,i=new l.Point(0,0),r=t.items,a=new c.HashSet(r.map((function(t){return t.layer})).sort((function(t,e){return t-e}))),s=this.getAbsOffsetInfo(t.items),u={},d=0,f=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,m=Number.MIN_SAFE_INTEGER||Number.MAX_VALUE,g=function(t){var e=a.item(t),n=0;r.filter((function(t){return t.layer===e})).sort((function(t,e){return t.position-e.position})).forEach((function(t){var e=o.getDepthNodeSize(t),r=o.chooseDirectionValue(0,e),a=o.getAbsPosition(t.position,o.getBreadthNodeSize(t),s);i=o.setBreadth(i,a);var c=o.setDepthOffset(i,-r);if(u[t.key]=c,!t.isDummy){var l=o.settings.orientation===p.DataLayoutOrientation.Horizontal?c.y:c.x;f=Math.min(f,l),m=Math.max(m,l+o.getBreadthNodeSize(t)),n=Math.max(n,o.getDepthNodeSize(t))}})),d+=n,i=y.setBreadth(i,0),i=y.setDepthOffset(i,y.getDirectionValue(n+y.settings.layerSpacing))},y=this,v=0;v<a.length;v++)g(v);d+=(a.length-1)*this.settings.layerSpacing;var C=new h.GraphLayout;return this.createNodesLayout(t,C,f,d,u),this.createEdgesLayout(t,C,e,n),C},e.prototype.createNodesLayout=function(t,e,n,o,i){var r=this,s=this.settings.orientation===p.DataLayoutOrientation.Vertical?new l.Point(-n,this.chooseDirectionValue(0,o)):new l.Point(this.chooseDirectionValue(0,o),-n);t.items.forEach((function(t){if(!t.isDummy){var n=r.graph.getNode(t.key);e.addNode(new a.NodeLayout(n,i[t.key].clone().offset(s.x,s.y)))}}))},e.prototype.createEdgesLayout=function(t,e,n,o){var i=this.getDirectEdgeLayout(),r=this.getDiffLevelEdgeLayout(!0),s=this.getDiffLevelEdgeLayout(!1),c=this.getSameLevelEdgeLayout(!0),u=this.getSameLevelEdgeLayout(!1),l={};t.edges.filter((function(t){return!t.isDummy})).concat(o.map((function(t){return new _(t.key,!1,t.from,t.to)}))).sort((function(e,n){return t.getNode(e.originFrom).layer-t.getNode(n.originFrom).layer||t.getNode(e.to).layer-t.getNode(n.to).layer})).forEach((function(o){var p=n[o.key],h=t.getNode(p?o.to:o.originFrom),f=t.getNode(p?o.originFrom:o.to);if(f.layer-h.layer===1)e.addEdge(new a.EdgeLayout(o.key,i.from,i.to));else{var m=[];if(f.position-h.position>=1)m.push(r),m.push({from:i.from,to:r.to}),m.push({from:r.from,to:i.to});else if(f.position-h.position<=-1)m.push(s),m.push({from:i.from,to:s.to}),m.push({from:s.from,to:i.to});else{var g=h.position===f.position&&0===f.position?[c,u]:[u,c];g.forEach((function(t){return m.push(t)})),g.forEach((function(t){m.push({from:t.from,to:i.to}),m.push({from:i.from,to:t.to})}))}m.push(i);for(var y=0,v=void 0;v=m[y];y++){var C=h.key+"_"+v.from,_=f.key+"_"+v.to;if(l[C]!==d.ConnectorPosition.End&&l[_]!==d.ConnectorPosition.Begin){e.addEdge(new a.EdgeLayout(o.key,v.from,v.to)),l[C]=d.ConnectorPosition.Begin,l[_]=d.ConnectorPosition.End;break}}}}))},e.prototype.getDirectEdgeLayout=function(){return this.settings.orientation===p.DataLayoutOrientation.Horizontal?this.settings.direction===p.LogicalDirectionKind.Forward?{from:1,to:3}:{from:3,to:1}:this.settings.direction===p.LogicalDirectionKind.Forward?{from:2,to:0}:{from:0,to:2}},e.prototype.getDiffLevelEdgeLayout=function(t){return this.settings.orientation===p.DataLayoutOrientation.Horizontal?t?{from:2,to:0}:{from:0,to:2}:t?{from:3,to:1}:{from:1,to:3}},e.prototype.getSameLevelEdgeLayout=function(t){return this.settings.orientation===p.DataLayoutOrientation.Horizontal?t?{from:0,to:0}:{from:2,to:2}:t?{from:3,to:3}:{from:1,to:1}},e.prototype.getAbsOffsetInfo=function(t){var e=this,n={},o=function(t,o){void 0===n[o]&&(n[o]=e.getBreadthNodeSize(t)),n[o]=Math.max(n[o],e.getBreadthNodeSize(t))};t.forEach((function(t){var e=P(t.position);o(t,e),n[e]%1!==0&&o(t,e+1)}));var i={},r=0;return Object.keys(n).sort((function(t,e){return parseFloat(t)-parseFloat(e)})).forEach((function(t){i[t]={leftOffset:r,width:n[t]},r+=n[t]+e.settings.columnSpacing})),i},e.prototype.setBreadth=function(t,e){return this.settings.orientation===p.DataLayoutOrientation.Vertical?new l.Point(e,t.y):new l.Point(t.x,e)},e.prototype.setDepthOffset=function(t,e){return this.settings.orientation===p.DataLayoutOrientation.Horizontal?new l.Point(t.x+e,t.y):new l.Point(t.x,t.y+e)},e.prototype.getAbsPosition=function(t,e,n){var o=P(t),i=n[o].leftOffset,r=n[o].width;return t%1===0?i+(r-e)/2:i+r-(e-this.settings.columnSpacing)/2},e.prototype.getBreadthNodeSize=function(t){return t.isDummy?0:this.getBreadthNodeSizeCore(this.graph.getNode(t.key))},e.prototype.getDepthNodeSize=function(t){return t.isDummy?0:this.getDepthNodeSizeCore(this.graph.getNode(t.key))},e}(i.LayoutBuilder);e.SugiyamaLayoutBuilder=m;var g=function(){function t(){}return t.getLayers=function(t){var e=this.getFeasibleTree(t);return this.calcNodesLayers(e)},t.getFeasibleTree=function(t){var e=this.initLayerAssignment(t);return t.getSpanningGraph(t.nodes[0],s.ConnectionMode.OutgoingAndIncoming,(function(t){return e[t.to]-e[t.from]}))},t.initLayerAssignment=function(t){var e={},n=0,o={},i=t.nodes.filter((function(e){return!t.getAdjacentEdges(e,s.ConnectionMode.Incoming).length})),r=function(){i.forEach((function(t){e[t]=n,o[t]=!0})),Object.keys(o).forEach((function(n){0===t.getAdjacentEdges(n,s.ConnectionMode.Outgoing).filter((function(t){return void 0===e[t.to]})).length&&delete o[n]}));var r={};Object.keys(o).forEach((function(n){t.getAdjacentEdges(n,s.ConnectionMode.Outgoing).map((function(t){return t.to})).filter((function(n){return void 0===e[n]&&t.getAdjacentEdges(n,s.ConnectionMode.Incoming).reduce((function(t,n){return t&&void 0!==e[n.from]}),!0)})).forEach((function(t){return r[t]=!0}))})),i=Object.keys(r),n++};while(i.length)r();return e},t.calcNodesLayers=function(t){var e={},n=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,o=0,i=t.createIterator(s.ConnectionMode.OutgoingAndIncoming);for(var r in i.visitEachEdgeOnce=!1,i.onNode=function(t){e[t.key]=o,n=Math.min(n,o)},i.skipNode=function(t){return void 0!==e[t.key]},i.skipEdge=function(t){return void 0!==e[t.from]&&void 0!==e[t.to]},i.onEdge=function(t,n){o=n?e[t.from]+1:e[t.to]-1},i.iterate(t.nodes[0]),e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]-=n);return e},t}();e.SugiyamaLayerDistributor=g;var y=function(){function t(){this.idCounter=-1e4}return t.prototype.orderNodes=function(t,e){var n=14,o=1,i=this.initGraphInfo(t,e),r=i.items,a=this.initOrder(r),s=this.getNodeToPositionMap(r),c=this.getCrossCount(a,i),u=!0;while(o<n&&0!==c){a=this.getNodesOrder(a,i,u);var l=this.getCrossCount(a,i);l<c&&(s=this.getNodeToPositionMap(i.items),c=l),u=!u,o++}return i.items.forEach((function(t){return t.position=s[t.key]})),i},t.prototype.getNodesOrder=function(t,e,n){var o=this,i={},r=function(r){if(!Object.prototype.hasOwnProperty.call(t,r))return"continue";var s={},c=[];t[r].forEach((function(t){var i=(n?e.getChildren(t.key):e.getParents(t.key)).map((function(t){return e.getNode(t).position}));c.push(t.key),s[t.key]=o.getNodePosition(i)})),i[r]=a.sortNodes(c,s,e)},a=this;for(var s in t)r(s);return i},t.prototype.sortNodes=function(t,e,n){return t.sort((function(t,n){return e[t]-e[n]})).map((function(t,e){var o=n.getNode(t);return o.position=e,o}))},t.prototype.getNodePosition=function(t){if(t=t.sort((function(t,e){return t-e})),!t.length)return 0;var e=Math.floor(t.length/2);if(2===t.length||t.length%2===1)return t[e];var n=t[e-1]-t[0],o=t[t.length-1]-t[e];return Math.floor((t[e-1]*o+t[e]*n)/(n+o))},t.prototype.initOrder=function(t){var e={};return t.forEach((function(t){return(e[t.layer]||(e[t.layer]=[])).push(t)})),e},t.prototype.getCrossCount=function(t,e){var n=0,o=function(o){if(!Object.prototype.hasOwnProperty.call(t,o))return"continue";var i=[];t[o].forEach((function(t){var o=e.getChildren(t.key).map((function(t){return e.getNode(t).position}));o.forEach((function(t){n+=i.filter((function(e){return t<e})).length})),i=i.concat(o)}))};for(var i in t)o(i);return n},t.prototype.initGraphInfo=function(t,e){var n=this,o={},i={},a=[],s=[];return t.nodes.forEach((function(t){var n=e[t];void 0===o[n]&&(o[n]=0);var r=new v(t,!1,n,o[n]++);i[t]=r,a.push(r)})),t.edges.forEach((function(t){var r=e[t.to]-e[t.from];if(r>1){for(var c=i[t.from],u=1;u<r;u++){var l=new v(n.createDummyID(),!0,e[t.from]+u,o[e[t.from]+u]++);s.push(new _(n.createDummyID(),!0,c.key,l.key)),a.push(l),c=l}s.push(new _(t.key,!1,c.key,i[t.to].key,i[t.from].key))}else s.push(new _(t.key,!1,i[t.from].key,i[t.to].key))})),new r.FastGraph(a,s)},t.prototype.createDummyID=function(){return"dummy_"+--this.idCounter},t.prototype.getNodeToPositionMap=function(t){return t.reduce((function(t,e){return t[e.key]=e.position,t}),{})},t.prototype.assignAbsCoordinates=function(t){var e=this.getAbsCoodinate(t);return new r.FastGraph(t.items.map((function(t){return new v(t.key,t.isDummy,t.layer,e[t.key])})),t.edges.slice(0))},t.prototype.getAbsCoodinate=function(t){var e=this,n=t.items.reduce((function(t,e){t[e.layer]=t[e.layer]||[];var n=u.SearchUtils.binaryIndexOf(t[e.layer],(function(t){return t.position-e.position}));return t[e.layer].splice(n<0?~n:n,0,e),t}),{}),o=[C.TopLeft,C.TopRight,C.BottomLeft,C.BottomRight].map((function(o){return e.getPositionByMedian(t,o,n)})),i={};return t.items.forEach((function(t){var e=o.map((function(e){return e[t.key]})).sort((function(t,e){return t-e}));i[t.key]=(e[1]+e[2])/2})),i},t.prototype.getPositionByMedian=function(t,e,n){var o=t.items,i=this.getNodeToPositionMap(o),r=this.getMedians(t,o,e);return r=this.resolveMedianConflicts(t,n,r,e),this.getSortedBlocks(t,o,r,e).forEach((function(t){var e=t.reduce((function(t,e){return i[e.key]>t?i[e.key]:t}),-2);t.forEach((function(t){var o=e-i[t.key];o>0&&n[t.layer].filter((function(e){return e.position>t.position})).forEach((function(t){return i[t.key]+=o})),i[t.key]=e}))})),i},t.prototype.getSortedBlocks=function(t,e,n,o){var i=[],r=o===C.BottomLeft||o===C.BottomRight,a=new c.HashSet(e.slice(0).sort((function(t,e){return r?t.layer-e.layer:e.layer-t.layer})),(function(t){return t.key}));while(a.length){var s=a.item(0),u=this.getBlock(t,s,n,o);i.push(u),u.forEach((function(t){return a.remove(t)}))}return i.sort((function(t,e){var n=t.reduce((function(t,e){return e.position<t.position?e:t}),t[0]),o=e.filter((function(t){return t.layer===n.layer}))[0];if(o)return n.position>o.position?1:-1;var i=e.reduce((function(t,e){return e.position<t.position?e:t}),e[0]),r=t.filter((function(t){return t.layer===i.layer}))[0];return r?r.position>i.position?1:-1:n.layer>i.layer?1:-1})),i},t.prototype.getBlock=function(t,e,n,o){var i=[],r=null;do{r&&(e=o===C.TopLeft||o===C.TopRight?t.getNode(r.from):t.getNode(r.to)),i.push(e),r=n[e.key]}while(r);return i},t.prototype.resolveMedianConflicts=function(t,e,n,o){var i=this,r={},a=function(a){if(!Object.prototype.hasOwnProperty.call(e,a))return"continue";var s,c,u=e[a];o!==C.TopRight&&o!==C.BottomRight||(u=u.slice(0).sort((function(t,e){return e.position-t.position}))),u.forEach((function(e){var a=n[e.key];if(a){var u=o===C.TopLeft||o===C.TopRight?a.from:a.to,l=t.getNode(u).position;i.checkMedianConfict(s,c,l,o)?r[e.key]=null:(s=void 0===s?l:Math.min(s,l),c=void 0===c?l:Math.max(c,l),r[e.key]=a)}else r[e.key]=null}))};for(var s in e)a(s);return r},t.prototype.checkMedianConfict=function(t,e,n,o){return void 0!==t&&void 0!==e&&(o===C.TopLeft||o===C.BottomLeft?e>=n:t<=n)},t.prototype.getMedians=function(t,e,n){var o=this,i={};return e.forEach((function(e){var r=o.getActualAdjacentEdges(t,e,n),a=o.getMedianPosition(r.length,n);i[e.key]=r[a]})),i},t.prototype.getMedianPosition=function(t,e){if(0===t)return-1;if(t%2!==0)return Math.floor(t/2);if(e===C.TopLeft||e===C.BottomLeft)return Math.floor(t/2)-1;if(e===C.TopRight||e===C.BottomRight)return Math.floor(t/2);throw new Error("Invalid Operation")},t.prototype.getActualAdjacentEdges=function(t,e,n){return n===C.TopLeft||n===C.TopRight?t.getAdjacentEdges(e.key,s.ConnectionMode.Incoming).sort((function(e,n){return t.getNode(e.from).position-t.getNode(n.from).position})):t.getAdjacentEdges(e.key,s.ConnectionMode.Outgoing).sort((function(e,n){return t.getNode(e.to).position-t.getNode(n.to).position}))},t}();e.SugiyamaNodesOrderer=y;var v=function(){function t(t,e,n,o){this.key=t,this.isDummy=e,this.layer=n,this.position=o}return t.prototype.getHashCode=function(){return this.key.toString()},t}();e.NodeOnLayer=v;var C,_=function(){function t(t,e,n,o,i){this.key=t,this.isDummy=e,this.from=n,this.to=o,this._originFrom=i}return t.prototype.getHashCode=function(){return this.from+"-"+this.to},Object.defineProperty(t.prototype,"originFrom",{get:function(){return void 0!==this._originFrom?this._originFrom:this.from},enumerable:!1,configurable:!0}),t}();function P(t){return Math.trunc?Math.trunc(t):isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t}e.EdgeOnLayer=_,function(t){t[t["TopLeft"]=0]="TopLeft",t[t["TopRight"]=1]="TopRight",t[t["BottomLeft"]=2]="BottomLeft",t[t["BottomRight"]=3]="BottomRight"}(C||(C={}))},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveClonedDiagramItemState=void 0;var i=n(17),r=n(9),a=n(16),s=n(154),c=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o,i,r)||this;return s.model=o,s.selection=i,s.visualizerManager=r,s.moveStartPoint=a,s}return o(e,t),e.isMoveClonedEvent=function(t){return t.modifiers&i.ModifierKey.Ctrl&&t.modifiers&i.ModifierKey.Shift},e.prototype.onMouseDown=function(e){var n=this,o=this.moveStartPoint?e.modelPoint.x-this.moveStartPoint.x:0,i=this.moveStartPoint?e.modelPoint.y-this.moveStartPoint.y:0;r.ModelUtils.cloneSelectionToOffset(this.history,this.model,(function(t){var e=n.model.findItem(t);e&&n.handler.addInteractingItem(e,a.DiagramModelOperation.AddShape)}),this.selection,o,i),t.prototype.onMouseDown.call(this,e)},e.prototype.validateDraggingShapes=function(){return!0},e.prototype.validateDraggingConnectors=function(){return this.draggingShapes.length>0||this.draggingConnectors.length>0},e.prototype.createDraggingConnector=function(t){return new s.DraggingConnector(t,!0)},e.prototype.registerAttachedConnectorsInSelection=function(){},e}(s.MouseHandlerDragDiagramItemStateBase);e.MouseHandlerMoveClonedDiagramItemState=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EmptyBatchUpdatableObject=e.BatchUpdatableObject=void 0;var o=function(){function t(){this.suspendUpdateCount=0,this.occurredEvents=0}return t.prototype.beginUpdate=function(){0===this.suspendUpdateCount&&this.onUpdateLocked(),this.suspendUpdateCount<0?this.suspendUpdateCount--:this.suspendUpdateCount++},t.prototype.endUpdate=function(){if(this.suspendUpdateCount<0?this.suspendUpdateCount++:this.suspendUpdateCount>0&&this.suspendUpdateCount--,!this.isUpdateLocked()){var t=this.occurredEvents;this.occurredEvents=0,this.onUpdateUnlocked(t)}},t.prototype.suspendUpdate=function(){if(this.suspendUpdateCount>0){this.suspendUpdateCount*=-1;var t=this.occurredEvents;this.occurredEvents=0,this.onUpdateUnlocked(t)}},t.prototype.continueUpdate=function(){this.suspendUpdateCount<0&&(this.suspendUpdateCount*=-1)},t.prototype.isUpdateLocked=function(){return this.suspendUpdateCount>0},t.prototype.onUpdateLocked=function(){},t.prototype.registerOccurredEvent=function(t){this.occurredEvents|=t},t.prototype.resetOccurredEvents=function(){this.occurredEvents=0},t.prototype.isLocked=function(){return 0!==this.suspendUpdateCount},t}();e.BatchUpdatableObject=o;var i=function(){function t(){}return t.prototype.beginUpdate=function(){},t.prototype.endUpdate=function(){},t}();e.EmptyBatchUpdatableObject=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EvtUtils=void 0;var o=n(19),i=n(60),r=n(26),a=n(104),s=function(){function t(){}return t.preventEvent=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},t.getEventSource=function(t){return i.isDefined(t)?t.srcElement?t.srcElement:t.target:null},t.getEventSourceByPosition=function(e){return i.isDefined(e)?document.elementFromPoint&&void 0!==t.getEventX(e)&&void 0!==t.getEventY(e)?document.elementFromPoint(t.getEventX(e),t.getEventY(e)):e.srcElement?e.srcElement:e.target:null},t.getMouseWheelEventName=function(){return o.Browser.Safari?"mousewheel":o.Browser.NetscapeFamily&&o.Browser.MajorVersion<17?"DOMMouseScroll":"wheel"},t.isLeftButtonPressed=function(t){return!!a.TouchUtils.isTouchEvent(t)||(t=o.Browser.IE&&i.isDefined(event)?event:t,!!t&&(o.Browser.IE&&o.Browser.Version<11?!!o.Browser.MSTouchUI||t.button%2===1:o.Browser.WebKitFamily?"pointermove"===t.type?1===t.buttons:1===t.which:o.Browser.NetscapeFamily||o.Browser.Edge||o.Browser.IE&&o.Browser.Version>=11?t.type===a.TouchUtils.touchMouseMoveEventName?1===t.buttons:1===t.which:!o.Browser.Opera||0===t.button))},t.preventEventAndBubble=function(e){t.preventEvent(e),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},t.clientEventRequiresDocScrollCorrection=function(){var t=o.Browser.Safari&&o.Browser.Version<3,e=o.Browser.MacOSMobilePlatform&&o.Browser.Version<5.1;return o.Browser.AndroidDefaultBrowser||o.Browser.AndroidChromeBrowser||!(t||e)},t.getEventX=function(e){return a.TouchUtils.isTouchEvent(e)?a.TouchUtils.getEventX(e):e.clientX+(t.clientEventRequiresDocScrollCorrection()?r.DomUtils.getDocumentScrollLeft():0)},t.getEventY=function(e){return a.TouchUtils.isTouchEvent(e)?a.TouchUtils.getEventY(e):e.clientY+(t.clientEventRequiresDocScrollCorrection()?r.DomUtils.getDocumentScrollTop():0)},t.cancelBubble=function(t){t.cancelBubble=!0},t.getWheelDelta=function(t){var e;return e=o.Browser.NetscapeFamily&&o.Browser.MajorVersion<17?-t.detail:o.Browser.Safari?t.wheelDelta:-t.deltaY,o.Browser.Opera&&o.Browser.Version<9&&(e=-e),e},t}();e.EvtUtils=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommandManager=e.DiagramCommand=void 0;var o,i=n(163),r=n(198),a=n(199),s=n(200),c=n(237),u=n(238),l=n(239),p=n(240),h=n(241),d=n(242),f=n(243),m=n(244),g=n(245),y=n(246),v=n(247),C=n(248),_=n(249),P=n(17),S=n(139),b=n(252),x=n(253),w=n(254),I=n(256),T=n(258),O=n(260),E=n(261),M=n(262),D=n(263),A=n(264),k=n(267),L=n(270),R=n(271),z=n(144),N=n(272),j=n(273),U=n(274),B=n(275),H=n(145),V=n(146),F=n(276),K=n(277),W=n(278),G=n(279),Z=n(281),q=n(283),$=n(284),X=n(285),Y=n(286),J=n(287),Q=n(288),tt=n(289),et=n(291),nt=n(292),ot=n(293),it=n(294),rt=n(295),at=n(296),st=n(297),ct=n(298),ut=n(299);(function(t){t[t["Undo"]=0]="Undo",t[t["Redo"]=1]="Redo",t[t["Cut"]=2]="Cut",t[t["Copy"]=3]="Copy",t[t["Paste"]=4]="Paste",t[t["PasteInPosition"]=5]="PasteInPosition",t[t["SelectAll"]=6]="SelectAll",t[t["Delete"]=7]="Delete",t[t["Import"]=8]="Import",t[t["ImportBPMN"]=9]="ImportBPMN",t[t["Export"]=10]="Export",t[t["ExportSvg"]=11]="ExportSvg",t[t["ExportPng"]=12]="ExportPng",t[t["ExportJpg"]=13]="ExportJpg",t[t["BindDocument"]=14]="BindDocument",t[t["UnbindDocument"]=15]="UnbindDocument",t[t["Bold"]=16]="Bold",t[t["Italic"]=17]="Italic",t[t["Underline"]=18]="Underline",t[t["FontName"]=19]="FontName",t[t["FontSize"]=20]="FontSize",t[t["FontColor"]=21]="FontColor",t[t["FillColor"]=22]="FillColor",t[t["StrokeColor"]=23]="StrokeColor",t[t["TextLeftAlign"]=24]="TextLeftAlign",t[t["TextCenterAlign"]=25]="TextCenterAlign",t[t["TextRightAlign"]=26]="TextRightAlign",t[t["ConnectorLineOption"]=27]="ConnectorLineOption",t[t["ConnectorStartLineEnding"]=28]="ConnectorStartLineEnding",t[t["ConnectorEndLineEnding"]=29]="ConnectorEndLineEnding",t[t["BringToFront"]=30]="BringToFront",t[t["SendToBack"]=31]="SendToBack",t[t["MoveLeft"]=32]="MoveLeft",t[t["MoveStepLeft"]=33]="MoveStepLeft",t[t["MoveRight"]=34]="MoveRight",t[t["MoveStepRight"]=35]="MoveStepRight",t[t["MoveUp"]=36]="MoveUp",t[t["MoveStepUp"]=37]="MoveStepUp",t[t["MoveDown"]=38]="MoveDown",t[t["MoveStepDown"]=39]="MoveStepDown",t[t["CloneLeft"]=40]="CloneLeft",t[t["CloneRight"]=41]="CloneRight",t[t["CloneUp"]=42]="CloneUp",t[t["CloneDown"]=43]="CloneDown",t[t["AutoLayoutTree"]=44]="AutoLayoutTree",t[t["AutoLayoutFlow"]=45]="AutoLayoutFlow",t[t["AutoLayoutTreeVertical"]=46]="AutoLayoutTreeVertical",t[t["AutoLayoutTreeHorizontal"]=47]="AutoLayoutTreeHorizontal",t[t["AutoLayoutLayeredVertical"]=48]="AutoLayoutLayeredVertical",t[t["AutoLayoutLayeredHorizontal"]=49]="AutoLayoutLayeredHorizontal",t[t["Lock"]=50]="Lock",t[t["Unlock"]=51]="Unlock",t[t["Units"]=52]="Units",t[t["ViewUnits"]=53]="ViewUnits",t[t["PageSize"]=54]="PageSize",t[t["PageLandscape"]=55]="PageLandscape",t[t["PageColor"]=56]="PageColor",t[t["GridSize"]=57]="GridSize",t[t["ShowGrid"]=58]="ShowGrid",t[t["SnapToGrid"]=59]="SnapToGrid",t[t["ZoomLevel"]=60]="ZoomLevel",t[t["Fullscreen"]=61]="Fullscreen",t[t["ToggleSimpleView"]=62]="ToggleSimpleView",t[t["ToggleReadOnly"]=63]="ToggleReadOnly",t[t["EditShapeImage"]=64]="EditShapeImage",t[t["FitToScreen"]=65]="FitToScreen",t[t["SwitchAutoZoom"]=66]="SwitchAutoZoom",t[t["ToggleAutoZoom"]=67]="ToggleAutoZoom",t[t["FitToWidth"]=68]="FitToWidth",t[t["ZoomLevelItems"]=69]="ZoomLevelItems",t[t["GridSizeItems"]=70]="GridSizeItems",t[t["PageSizeItems"]=71]="PageSizeItems",t[t["ImportXML"]=72]="ImportXML",t[t["InsertShapeImage"]=73]="InsertShapeImage",t[t["DeleteShapeImage"]=74]="DeleteShapeImage",t[t["StrokeStyle"]=75]="StrokeStyle",t[t["StrokeWidth"]=76]="StrokeWidth",t[t["AutoLayoutTreeVerticalBottomToTop"]=77]="AutoLayoutTreeVerticalBottomToTop",t[t["AutoLayoutTreeHorizontalRightToLeft"]=78]="AutoLayoutTreeHorizontalRightToLeft",t[t["AutoLayoutLayeredVerticalBottomToTop"]=79]="AutoLayoutLayeredVerticalBottomToTop",t[t["AutoLayoutLayeredHorizontalRightToLeft"]=80]="AutoLayoutLayeredHorizontalRightToLeft",t[t["Zoom25"]=81]="Zoom25",t[t["Zoom50"]=82]="Zoom50",t[t["Zoom75"]=83]="Zoom75",t[t["Zoom100"]=84]="Zoom100",t[t["Zoom125"]=85]="Zoom125",t[t["Zoom150"]=86]="Zoom150",t[t["Zoom200"]=87]="Zoom200",t[t["AutoZoomToContent"]=88]="AutoZoomToContent",t[t["AutoZoomToWidth"]=89]="AutoZoomToWidth",t[t["ZoomLevelInPercentage"]=90]="ZoomLevelInPercentage",t[t["ConnectorRoutingMode"]=91]="ConnectorRoutingMode"})(o=e.DiagramCommand||(e.DiagramCommand={}));var lt=function(){function t(t){this.commands={},this.shortcutsToCommand={},this.lastCommandsChain=[],this.executingCommandsChain=[],this.executingCommandCounter=0,this.isPublicApiCall=!1,this.createCommand(t,o.Undo,r.UndoCommand,P.ModifierKey.Ctrl|P.KeyCode.Key_z,P.ModifierKey.Meta|P.KeyCode.Key_z),this.createCommand(t,o.Redo,a.RedoCommand,P.ModifierKey.Ctrl|P.KeyCode.Key_y,P.ModifierKey.Ctrl|P.ModifierKey.Shift|P.KeyCode.Key_z,P.ModifierKey.Meta|P.ModifierKey.Shift|P.KeyCode.Key_z),this.createCommand(t,o.Cut,D.CutSelectionCommand,P.KeyCode.Key_x|P.ModifierKey.Ctrl,P.KeyCode.Key_x|P.ModifierKey.Meta,P.KeyCode.Delete|P.ModifierKey.Shift),this.createCommand(t,o.Copy,M.CopySelectionCommand,P.KeyCode.Key_c|P.ModifierKey.Ctrl,P.KeyCode.Key_c|P.ModifierKey.Meta,P.KeyCode.Insert|P.ModifierKey.Ctrl),this.createCommand(t,o.Paste,A.PasteSelectionCommand),this.createCommand(t,o.PasteInPosition,Q.PasteSelectionInPositionCommand),this.createCommand(t,o.SelectAll,_.SelectAllCommand,P.KeyCode.Key_a|P.ModifierKey.Ctrl,P.KeyCode.Key_a|P.ModifierKey.Meta),this.createCommand(t,o.Delete,i.DeleteCommand,P.KeyCode.Delete,P.KeyCode.Backspace),this.createCommand(t,o.Import,s.ImportCommand),this.createCommand(t,o.ImportBPMN,k.ImportBPMNCommand),this.createCommand(t,o.ImportXML,tt.ImportXMLCommand),this.createCommand(t,o.Export,c.ExportCommand),this.createCommand(t,o.ExportSvg,O.ExportSvgCommand),this.createCommand(t,o.ExportPng,T.ExportPngCommand),this.createCommand(t,o.ExportJpg,E.ExportJpgCommand),this.createCommand(t,o.BindDocument,U.BindDocumentCommand),this.createCommand(t,o.UnbindDocument,B.UnbindDocumentCommand),this.createCommand(t,o.Bold,u.ToggleFontBoldCommand,P.ModifierKey.Ctrl|P.KeyCode.Key_b,P.ModifierKey.Meta|P.KeyCode.Key_b),this.createCommand(t,o.Italic,l.ToggleFontItalicCommand,P.ModifierKey.Ctrl|P.KeyCode.Key_i,P.ModifierKey.Meta|P.KeyCode.Key_i),this.createCommand(t,o.Underline,p.ToggleFontUnderlineCommand,P.ModifierKey.Ctrl|P.KeyCode.Key_u,P.ModifierKey.Meta|P.KeyCode.Key_u),this.createCommand(t,o.FontName,h.ChangeFontNameCommand),this.createCommand(t,o.FontSize,d.ChangeFontSizeCommand),this.createCommand(t,o.FontColor,f.ChangeFontColorCommand),this.createCommand(t,o.FillColor,m.ChangeFillColorCommand),this.createCommand(t,o.StrokeColor,g.ChangeStrokeColorCommand),this.createCommand(t,o.StrokeStyle,ot.ChangeStrokeStyleCommand),this.createCommand(t,o.StrokeWidth,it.ChangeStrokeWidthCommand),this.createCommand(t,o.TextLeftAlign,y.TextLeftAlignCommand),this.createCommand(t,o.TextCenterAlign,y.TextCenterAlignCommand),this.createCommand(t,o.TextRightAlign,y.TextRightAlignCommand),this.createCommand(t,o.ConnectorLineOption,C.ChangeConnectorLineOptionCommand),this.createCommand(t,o.ConnectorStartLineEnding,v.ChangeConnectorStartLineEndingCommand),this.createCommand(t,o.ConnectorEndLineEnding,v.ChangeConnectorEndLineEndingCommand),this.createCommand(t,o.BringToFront,R.BringToFrontCommand),this.createCommand(t,o.SendToBack,L.SendToBackCommand),this.createCommand(t,o.MoveLeft,N.MoveLeftCommand,P.ModifierKey.Shift|P.KeyCode.Left),this.createCommand(t,o.MoveStepLeft,N.MoveStepLeftCommand,P.KeyCode.Left),this.createCommand(t,o.MoveRight,N.MoveRightCommand,P.ModifierKey.Shift|P.KeyCode.Right),this.createCommand(t,o.MoveStepRight,N.MoveStepRightCommand,P.KeyCode.Right),this.createCommand(t,o.MoveUp,N.MoveUpCommand,P.ModifierKey.Shift|P.KeyCode.Up),this.createCommand(t,o.MoveStepUp,N.MoveStepUpCommand,P.KeyCode.Up),this.createCommand(t,o.MoveDown,N.MoveDownCommand,P.ModifierKey.Shift|P.KeyCode.Down),this.createCommand(t,o.MoveStepDown,N.MoveStepDownCommand,P.KeyCode.Down),this.createCommand(t,o.CloneLeft,W.CloneLeftCommand,P.ModifierKey.Ctrl|P.ModifierKey.Shift|P.KeyCode.Left),this.createCommand(t,o.CloneRight,W.CloneRightCommand,P.ModifierKey.Ctrl|P.ModifierKey.Shift|P.KeyCode.Right),this.createCommand(t,o.CloneUp,W.CloneUpCommand,P.ModifierKey.Ctrl|P.ModifierKey.Shift|P.KeyCode.Up),this.createCommand(t,o.CloneDown,W.CloneDownCommand,P.ModifierKey.Ctrl|P.ModifierKey.Shift|P.KeyCode.Down),this.createCommand(t,o.Lock,F.LockCommand),this.createCommand(t,o.Unlock,K.UnLockCommand),this.createCommand(t,o.AutoLayoutTree,S.AutoLayoutTreeVerticalCommand),this.createCommand(t,o.AutoLayoutFlow,z.AutoLayoutLayeredHorizontalCommand),this.createCommand(t,o.Units,G.ChangeUnitsCommand),this.createCommand(t,o.ViewUnits,G.ChangeViewUnitsCommand),this.createCommand(t,o.PageSize,I.ChangePageSizeCommand),this.createCommand(t,o.PageLandscape,w.ChangePageLandscapeCommand),this.createCommand(t,o.PageColor,Z.ChangePageColorCommand),this.createCommand(t,o.GridSize,x.ChangeGridSizeCommand),this.createCommand(t,o.ShowGrid,q.ChangeShowGridCommand),this.createCommand(t,o.SnapToGrid,b.ChangeSnapToGridCommand),this.createCommand(t,o.ZoomLevel,j.ChangeZoomLevelCommand),this.createCommand(t,o.ZoomLevelInPercentage,j.ChangeZoomLevelInPercentageCommand),this.createCommand(t,o.AutoLayoutTreeVertical,S.AutoLayoutTreeVerticalCommand),this.createCommand(t,o.AutoLayoutTreeVerticalBottomToTop,rt.AutoLayoutTreeVerticalBottomToTopCommand),this.createCommand(t,o.AutoLayoutTreeHorizontal,H.AutoLayoutTreeHorizontalCommand),this.createCommand(t,o.AutoLayoutTreeHorizontalRightToLeft,at.AutoLayoutTreeHorizontalRightToLeftCommand),this.createCommand(t,o.AutoLayoutLayeredVertical,V.AutoLayoutLayeredVerticalCommand),this.createCommand(t,o.AutoLayoutLayeredVerticalBottomToTop,st.AutoLayoutLayeredVerticalBottomToTopCommand),this.createCommand(t,o.AutoLayoutLayeredHorizontal,z.AutoLayoutLayeredHorizontalCommand),this.createCommand(t,o.AutoLayoutLayeredHorizontalRightToLeft,ct.AutoLayoutLayeredHorizontalRightToLeftCommand),this.createCommand(t,o.Fullscreen,$.ToggleFullscreenCommand,P.KeyCode.F11),this.createCommand(t,o.ToggleSimpleView,X.ToggleSimpleViewCommand),this.createCommand(t,o.ToggleReadOnly,Y.ToggleReadOnlyCommand),this.createCommand(t,o.InsertShapeImage,et.InsertShapeImageCommand),this.createCommand(t,o.EditShapeImage,J.EditShapeImageCommand),this.createCommand(t,o.DeleteShapeImage,nt.DeleteShapeImageCommand),this.createCommand(t,o.FitToScreen,j.FitToScreenCommand),this.createCommand(t,o.FitToWidth,j.FitToWidthCommand),this.createCommand(t,o.SwitchAutoZoom,j.SwitchAutoZoomCommand),this.createCommand(t,o.ToggleAutoZoom,j.ToggleAutoZoomCommand),this.createCommand(t,o.ZoomLevelItems,j.ChangeZoomLevelItemsCommand),this.createCommand(t,o.GridSizeItems,x.ChangeGridSizeItemsCommand),this.createCommand(t,o.PageSizeItems,I.ChangePageSizeItemsCommand),this.createCommand(t,o.Zoom25,j.ChangeZoomLevelTo25Command),this.createCommand(t,o.Zoom50,j.ChangeZoomLevelTo50Command),this.createCommand(t,o.Zoom75,j.ChangeZoomLevelTo75Command),this.createCommand(t,o.Zoom100,j.ChangeZoomLevelTo100Command),this.createCommand(t,o.Zoom125,j.ChangeZoomLevelTo125Command),this.createCommand(t,o.Zoom150,j.ChangeZoomLevelTo150Command),this.createCommand(t,o.Zoom200,j.ChangeZoomLevelTo200Command),this.createCommand(t,o.AutoZoomToContent,j.ToggleAutoZoomToContentCommand),this.createCommand(t,o.AutoZoomToWidth,j.ToggleAutoZoomToWidthCommand),this.createCommand(t,o.ConnectorRoutingMode,ut.ChangeConnectorRoutingModeCommand)}return t.prototype.getCommand=function(t){return this.commands[t]},t.prototype.beforeExecuting=function(t){this.executingCommandsChain.push(t),this.executingCommandCounter++},t.prototype.afterExecuting=function(){this.executingCommandCounter--,0===this.executingCommandCounter&&(this.lastCommandsChain=this.executingCommandsChain,this.executingCommandsChain=[])},t.prototype.processShortcut=function(t){var e=this.shortcutsToCommand[t];return!!e&&e.execute()},t.prototype.processPaste=function(t){var e=this.getCommand(o.Paste);return e&&e.isEnabled()&&e.performPaste(t),!0},t.prototype.notifySelectionChanged=function(t){this.lastCommandsChain=[]},t.prototype.notifyScrollPositionChanged=function(){},t.prototype.createCommand=function(t,e,n){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];this.commands[e]=new n(t);for(var r=0;r<o.length;r++){var a=o[r];"number"===typeof a&&(this.shortcutsToCommand[a]=this.commands[e])}},t}();e.CommandManager=lt},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ListUtils=void 0;var o=n(166),i=n(167),r=function(){function t(){}return t.remove=function(t,e){var n=t.indexOf(e,0);n>=0&&t.splice(n,1)},t.removeBy=function(t,e){for(var n=t.length,o=0;o<n;o++)if(e(t[o],o))return t.splice(o,1)[0];return null},t.shallowCopy=function(t){return t.slice()},t.deepCopy=function(e){return t.map(e,(function(t){return t.clone()}))},t.initByValue=function(t,e){for(var n=[];t>0;t--)n.push(e);return n},t.initByCallback=function(t,e){for(var n=[],o=0;o<t;o++)n.push(e(o));return n},t.forEachOnInterval=function(t,e){for(var n=t.end,o=t.start;o<n;o++)e(o)},t.reverseForEachOnInterval=function(t,e){for(var n=t.start,o=t.end-1;o>=n;o--)e(o)},t.reducedMap=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=[],r=n;r<o;r++){var a=e(t[r],r);null!==a&&i.push(a)}return i},t.filter=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=[],r=n;r<o;r++){var a=t[r];e(a,r)&&i.push(a)}return i},t.map=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=[],r=n;r<o;r++)i.push(e(t[r],r));return i},t.indexBy=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=n;i<o;i++)if(e(t[i],i))return i;return-1},t.reverseIndexBy=function(t,e,n,o){void 0===n&&(n=t.length-1),void 0===o&&(o=0);for(var i=n;i>=o;i--)if(e(t[i],i))return i;return-1},t.elementBy=function(e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=e.length);var r=t.indexBy(e,n,o,i);return r<0?null:e[r]},t.reverseElementBy=function(e,n,o,i){void 0===o&&(o=e.length-1),void 0===i&&(i=0);var r=t.reverseIndexBy(e,n,o,i);return r<0?null:e[r]},t.last=function(t){return t[t.length-1]},t.setLast=function(t,e){return t[t.length-1]=e},t.incLast=function(t){return++t[t.length-1]},t.decLast=function(t){return--t[t.length-1]},t.equals=function(e,n){return e.length===n.length&&t.allOf2(e,n,(function(t,e){return t.equals(e)}))},t.equalsByReference=function(t,e){var n=t.length,o=t.length;if(n!==o)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0},t.unique=function(e,n,o,i){void 0===o&&(o=n),void 0===i&&(i=function(){});var r=e.length;if(0===r)return[];e=e.sort(n);var a=e[0],s=t.reducedMap(e,(function(t){return 0!==o(a,t)?(a=t,t):(i(t),null)}),1,r);return s.unshift(e[0]),s},t.uniqueNumber=function(t){t=t.sort(i.Comparers.number);for(var e=Number.NaN,n=t.length-1;n>=0;n--)e===t[n]?t.splice(n,1):e=t[n];return t},t.forEach=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=n;i<o;i++)e(t[i],i)},t.forEach2=function(t,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=t.length);for(var r=o;r<i;r++)n(t[r],e[r],r)},t.reverseForEach=function(t,e,n,o){void 0===n&&(n=t.length-1),void 0===o&&(o=0);for(var i=n;i>=o;i--)e(t[i],i)},t.reverseIndexOf=function(t,e,n,o){void 0===n&&(n=t.length-1),void 0===o&&(o=0);for(var i=n;i>=o;i--)if(t[i]===e)return i;return-1},t.accumulate=function(t,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=t.length);for(var r=e,a=o;a<i;a++)r=n(r,t[a],a);return r},t.accumulateNumber=function(t,e,n,o,i){void 0===n&&(n=0),void 0===o&&(o=0),void 0===i&&(i=t.length);for(var r=n,a=o;a<i;a++)r+=e(t[a],a,r);return r},t.anyOf=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=n;i<o;i++)if(e(t[i],i))return!0;return!1},t.unsafeAnyOf=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=n;i<o;i++){var r=e(t[i],i);if(r)return r}return null},t.reverseAnyOf=function(t,e,n,o){void 0===n&&(n=t.length-1),void 0===o&&(o=0);for(var i=n;i>=o;i--)if(e(t[i],i))return!0;return!1},t.unsafeReverseAnyOf=function(t,e,n,o){void 0===n&&(n=t.length-1),void 0===o&&(o=0);for(var i=n;i>=o;i--){var r=e(t[i],i);if(r)return r}return null},t.anyOf2=function(t,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=t.length);for(var r=o;r<i;r++)if(n(t[r],e[r],r))return!0;return!1},t.allOf=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=t.length);for(var i=n;i<o;i++)if(!e(t[i],i))return!1;return!0},t.allOf2=function(t,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=t.length);for(var r=o;r<i;r++)if(!n(t[r],e[r],r))return!1;return!0},t.allOfOnInterval=function(t,e){for(var n=t.end,o=t.start;o<n;o++)if(!e(o))return!1;return!0},t.addListOnTail=function(t,e){for(var n=0,o=void 0;o=e[n];n++)t.push(o);return t},t.joinLists=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t.accumulate(n,[],(function(n,o){return t.addListOnTail(n,e(o)),n}))},t.push=function(t,e){return t.push(e),t},t.countIf=function(e,n){return t.accumulateNumber(e,(function(t,e){return n(t,e)?1:0}))},t.clear=function(t){t.splice(0)},t.merge=function(t,e,n,o,i,r){if(void 0===i&&(i=0),void 0===r&&(r=t.length),t=t.slice(i,r),r-i<2)return t;t=t.sort(e);for(var a=t[i],s=[a],c=i+1;c<r;c++){var u=t[c];n(a,u)?o(a,u):(a=u,s.push(a))}return s},t.min=function(e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=e.length);var r=t.minExtended(e,n,o,i);return r?r.minElement:null},t.max=function(e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=e.length);var r=t.maxExtended(e,n,o,i);return r?r.maxElement:null},t.minMax=function(e,n,i,r){void 0===i&&(i=0),void 0===r&&(r=e.length);var a=t.minMaxExtended(e,n,i,r);return a?new o.MinMax(a.minElement,a.maxElement):null},t.minExtended=function(t,e,n,i){if(void 0===n&&(n=0),void 0===i&&(i=t.length),0===t.length)return null;for(var r=t[n],a=e(r),s=n+1;s<i;s++){var c=t[s],u=e(c);u<a&&(a=u,r=c)}return new o.ExtendedMin(r,a)},t.maxExtended=function(t,e,n,i){if(void 0===n&&(n=0),void 0===i&&(i=t.length),0===t.length)return null;for(var r=t[n],a=e(r),s=n+1;s<i;s++){var c=t[s],u=e(c);u>a&&(a=u,r=c)}return new o.ExtendedMax(r,a)},t.minMaxExtended=function(t,e,n,i){if(void 0===n&&(n=0),void 0===i&&(i=t.length),0===t.length)return null;for(var r=t[n],a=r,s=e(r),c=s,u=n+1;u<i;u++){var l=t[u],p=e(l);p<s?(s=p,r=l):p>c&&(c=p,a=l)}return new o.ExtendedMinMax(r,s,a,c)},t.minByCmp=function(t,e,n,o){if(void 0===n&&(n=0),void 0===o&&(o=t.length),0===t.length)return null;for(var i=t[n],r=n+1;r<o;r++){var a=t[r];e(a,i)<0&&(i=a)}return i},t.maxByCmp=function(t,e,n,o){if(void 0===n&&(n=0),void 0===o&&(o=t.length),0===t.length)return null;for(var i=t[n],r=n+1;r<o;r++){var a=t[r];e(a,i)>0&&(i=a)}return i},t.minMaxByCmp=function(t,e,n,i){if(void 0===n&&(n=0),void 0===i&&(i=t.length),0===t.length)return null;for(var r=t[n],a=r,s=n+1;s<i;s++){var c=t[s],u=e(c,r);u>0?a=c:u<0&&(r=c)}return new o.MinMax(r,a)},t}();e.ListUtils=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=void 0;var o=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!1,configurable:!0}),t.fromPoints=function(e,n){return new t(n.x-e.x,n.y-e.y)},t.fromSegment=function(e){return new t(e.endPoint.x-e.startPoint.x,e.endPoint.y-e.startPoint.y)},t.prototype.normalize=function(){var t=this.length;return 0!==t&&(this.x/=t,this.y/=t),this},t.prototype.negative=function(){return this.x*=-1,this.y*=-1,this},Object.defineProperty(t,"axisX",{get:function(){return new t(1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"axisY",{get:function(){return new t(0,1)},enumerable:!1,configurable:!0}),t.angleBetween=function(e,n){var o=t.scalarProduct(e,n)/(e.length*n.length);return Math.acos(o)},t.scalarProduct=function(t,e){return t.x*e.x+t.y*e.y},t}();e.Vector=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.NativeConnector=e.NativeShape=e.NativeItem=void 0;var i=n(9),r=function(){function t(t,e){this.id=t,this.key=e,this.unitsApplied=!1}return t.prototype.applyUnits=function(t){this.unitsApplied||void 0===t||(this.applyUnitsCore(t),this.unitsApplied=!0)},t}();e.NativeItem=r;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.applyUnitsCore=function(t){this.position.x=i.ModelUtils.getlUnitValue(t,this.position.x),this.position.y=i.ModelUtils.getlUnitValue(t,this.position.y),this.size.width=i.ModelUtils.getlUnitValue(t,this.size.width),this.size.height=i.ModelUtils.getlUnitValue(t,this.size.height)},e}(r);e.NativeShape=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.applyUnitsCore=function(t){this.points.forEach((function(e){e.x=i.ModelUtils.getlUnitValue(t,e.x),e.y=i.ModelUtils.getlUnitValue(t,e.y)}))},e}(r);e.NativeConnector=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RightAngleConnectorRoutingMathOperations=void 0;var o=n(1),i=n(114),r=n(40),a=n(82),s=n(41),c=n(3),u=function(){function t(){}return t.createSegments=function(t){for(var e=[],n=1;n<t.length;n++)e.push(new s.Segment(t[n-1],t[n]));return e},t.createUnionSegments=function(t){for(var e=[],n=t[0].startPoint.clone(),o=t[0].endPoint.clone(),i=1;i<t.length;i++){var r=t[i];r.startPoint.equals(o)||(e.push(new s.Segment(n,o)),n=r.startPoint.clone()),o=r.endPoint.clone()}return e.push(new s.Segment(n,o)),e},t.unionPoints=function(t){var e=0;while(e<t.length-2)this.isCorner(t[e],t[e+1],t[e+2])?e++:(t.splice(e+1,1),e=Math.max(0,e-1))},t.isCorner=function(t,e,n){return!r.MathUtils.numberCloseTo(this.createAngle(t,e,n),0)},t.createAngle=function(t,e,n){var o=a.Vector.fromPoints(e,n),i=a.Vector.fromPoints(t,e),r=Math.atan2(o.x*i.y-i.x*o.y,o.x*i.x+o.y*i.y);return r>=0?r:2*Math.PI+r},t.getTurnDirection=function(t){return r.MathUtils.numberCloseTo(t,0)?i.RightAngleTurnDirection.Straight:r.MathUtils.numberCloseTo(t,Math.PI)?i.RightAngleTurnDirection.Backwards:t<Math.PI?i.RightAngleTurnDirection.Left:i.RightAngleTurnDirection.Right},t.containsSegmentsInRectanlePolygonalChain=function(t,e){return this.isIntersectedSegmentsByPoints(this.createRectanlePolygonalChain(e,(function(t,e){return new o.Point(t,e)})),this.getInnerPoints(t))},t.createRectanlePolygonalChain=function(t,e){var n=[],o=e(t.x,t.y),i=e(t.right,t.y),r=e(t.right,t.bottom),a=e(t.x,t.bottom);return n.push(new s.Segment(o,i)),n.push(new s.Segment(i,r)),n.push(new s.Segment(r,a)),n.push(new s.Segment(a,o)),n},t.getInnerPoints=function(t){for(var e=[],n=0;n<t.length-1;n++)e.push(t[n].endPoint);return e},t.isIntersectedSegmentsByPoints=function(t,e){for(var n=0;n<t.length;n++)for(var o=t[n],i=0;i<e.length;i++)if(o.containsPoint(e[i]))return!0},t.areRectanlesCut=function(t,e){if(!e||!t)return!1;for(var n=0;n<e.length;n++)if(this.isRectangleCut(t,e[n]))return!0;return!1},t.isRectangleCut=function(t,e){if(!e)return!1;for(var n=!1,o=0;o<t.length;o++){var i=t[o];if(e.containsPoint(i.startPoint)){if(!e.containsPoint(i.endPoint)&&n)return!0}else if(e.containsPoint(i.endPoint))n||(n=!0);else if(i.isIntersectedByRect(e))return!0}return!1},t.removeOrSkipUnnecessaryPoints=function(t){c.GeometryUtils.removeUnnecessaryLinePoints(t,(function(e,n){return-1===e.pointIndex?(t.splice(n,1),!0):(e.skipped=!0,!1)}),(function(t){return void 0!==t&&!t.skipped}))},t.skipUnnecessaryPoints=function(t){var e=t.map((function(t){return t.clone()}));this.removeOrSkipUnnecessaryPoints(e),t.forEach((function(t){t.skipped=e.some((function(e){return e.equals(t)&&e.skipped}))}))},t}();e.RightAngleConnectorRoutingMathOperations=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorRenderPointsContext=void 0;var o=function(){function t(t,e,n){this.renderPoints=t,this.lockCreateRenderPoints=e,this.actualRoutingMode=n}return t}();e.ConnectorRenderPointsContext=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Offsets=void 0;var o=function(){function t(t,e,n,o){this.left=t,this.right=e,this.top=n,this.bottom=o}return t.empty=function(){return new t(0,0,0,0)},Object.defineProperty(t.prototype,"horizontal",{get:function(){return this.left+this.right},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this.top+this.bottom},enumerable:!1,configurable:!0}),t.fromNumber=function(e){return new t(e,e,e,e)},t.fromOffsets=function(e){return new t(e.left,e.right,e.top,e.bottom)},t.fromSide=function(e,n){return new t(e,e,n,n)},t.prototype.normalize=function(){return this.left=Math.max(0,this.left),this.right=Math.max(0,this.right),this.top=Math.max(0,this.top),this.bottom=Math.max(0,this.bottom),this},t.prototype.toString=function(){return JSON.stringify(this)},t.prototype.isEmpty=function(){return 0===this.left&&0===this.right&&0===this.top&&0===this.bottom},t.prototype.offset=function(t){return this.left+=t.left,this.right+=t.right,this.top+=t.top,this.bottom+=t.bottom,this},t.prototype.multiply=function(t,e,n,o){switch(arguments.length){case 1:return this.left*=t,this.right*=t,this.top*=t,this.bottom*=t,this;case 2:return this.left*=t,this.right*=t,this.top*=e,this.bottom*=e,this;case 4:return this.left*=t,this.right*=e,this.top*=n,this.bottom*=o,this}return this},t.prototype.clone=function(){return new t(this.left,this.right,this.top,this.bottom)},t.prototype.copyFrom=function(t){this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom},t.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.right===t.right&&this.left===t.left},t.prototype.applyConverter=function(t){return this.left=t(this.left),this.right=t(this.right),this.top=t(this.top),this.bottom=t(this.bottom),this},t}();e.Offsets=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorPropertyHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connectorKey=e,i.propertyName=n,i.value=o,i}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey);this.oldValue=e.properties[this.propertyName],t.changeConnectorProperty(e,this.propertyName,this.value)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.changeConnectorProperty(e,this.propertyName,this.oldValue)},e}(i.HistoryItem);e.ChangeConnectorPropertyHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStyleHistoryItem=void 0;var i=n(120),r=function(t){function e(e,n,o){return t.call(this,e,n,o)||this}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.oldStyleValue=e.style[this.styleProperty],t.changeStyle(e,this.styleProperty,this.styleValue)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.changeStyle(e,this.styleProperty,this.oldStyleValue)},e}(i.ChangeStyleHistoryItemBase);e.ChangeStyleHistoryItem=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HashSet=void 0;var o=function(){function t(t,e){var n=this;void 0===t&&(t=[]),void 0===e&&(e=function(t){return t.toString()}),this.items=[],this.map={},this.getHashCode=e,t.forEach((function(t){return n.tryPush(t)}))}return t.prototype.tryPush=function(t){var e=this.getHashCode(t);return void 0===this.map[e]&&(this.map[e]=this.items.push(t)-1,!0)},t.prototype.contains=function(t){return void 0!==this.map[this.getHashCode(t)]},t.prototype.forEach=function(t){this.items.forEach(t)},t.prototype.filter=function(t){return this.items.filter(t)},t.prototype.list=function(){return this.items.slice(0)},t.prototype.item=function(t){return this.items[t]},t.prototype.first=function(){return this.items[0]},t.prototype.remove=function(t){var e=this.getHashCode(t),n=this.map[e];if("number"!==typeof n)throw"Item not found";delete this.map[e],this.items.splice(n,1);for(var o=n;o<this.items.length;o++)this.map[this.getHashCode(this.items[o])]--},Object.defineProperty(t.prototype,"length",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),t}();e.HashSet=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeDescriptionManager=void 0;var o=n(201),i=n(202),r=n(203),a=n(204),s=n(205),c=n(206),u=n(207),l=n(208),p=n(209),h=n(210),d=n(122),f=n(68),m=n(211),g=n(20),y=n(123),v=n(124),C=n(125),_=n(212),P=n(213),S=n(214),b=n(215),x=n(216),w=n(126),I=n(127),T=n(217),O=n(218),E=n(219),M=n(220),D=n(221),A=n(222),k=n(223),L=n(224),R=n(225),z=n(226),N=n(227),j=n(228),U=n(229),B=n(128),H=n(231),V=n(232),F=n(233),K=n(0),W=n(235),G=n(3),Z=n(236),q=function(){function t(){this.descriptions={},this.descriptionTypes={},this.descriptionCategories={},this.onShapeDecriptionChanged=new G.EventDispatcher,this.register(new y.TextShapeDescription,K.ShapeCategories.General),this.register(new g.RectangleShapeDescription,K.ShapeCategories.General),this.register(new f.EllipseShapeDescription,K.ShapeCategories.General),this.register(new h.CrossShapeDescription,K.ShapeCategories.General),this.register(new w.TriangleShapeDescription,K.ShapeCategories.General),this.register(new d.DiamondShapeDescription,K.ShapeCategories.General),this.register(new m.HeartShapeDescription,K.ShapeCategories.General),this.register(new v.PentagonShapeDescription,K.ShapeCategories.General),this.register(new C.HexagonShapeDescription,K.ShapeCategories.General),this.register(new _.OctagonShapeDescription,K.ShapeCategories.General),this.register(new P.StarShapeDescription,K.ShapeCategories.General),this.register(new p.ArrowUpShapeDescription,K.ShapeCategories.General),this.register(new S.ArrowDownShapeDescription,K.ShapeCategories.General),this.register(new x.ArrowLeftShapeDescription,K.ShapeCategories.General),this.register(new l.ArrowRightShapeDescription,K.ShapeCategories.General),this.register(new u.ArrowUpDownShapeDescription,K.ShapeCategories.General),this.register(new b.ArrowLeftRightShapeDescription,K.ShapeCategories.General),this.register(new o.ProcessShapeDescription,K.ShapeCategories.Flowchart),this.register(new i.DecisionShapeDescription,K.ShapeCategories.Flowchart),this.register(new s.TerminatorShapeDescription,K.ShapeCategories.Flowchart),this.register(new c.PredefinedProcessShapeDescription,K.ShapeCategories.Flowchart),this.register(new I.DocumentShapeDescription,K.ShapeCategories.Flowchart),this.register(new T.MultipleDocumentsShapeDescription,K.ShapeCategories.Flowchart),this.register(new r.ManualInputShapeDescription,K.ShapeCategories.Flowchart),this.register(new O.PreparationShapeDescription,K.ShapeCategories.Flowchart),this.register(new a.DataShapeDescription,K.ShapeCategories.Flowchart),this.register(new M.DatabaseShapeDescription,K.ShapeCategories.Flowchart),this.register(new E.HardDiskShapeDescription,K.ShapeCategories.Flowchart),this.register(new D.InternalStorageShapeDescription,K.ShapeCategories.Flowchart),this.register(new A.PaperTapeShapeDescription,K.ShapeCategories.Flowchart),this.register(new k.ManualOperationShapeDescription,K.ShapeCategories.Flowchart),this.register(new L.DelayShapeDescription,K.ShapeCategories.Flowchart),this.register(new R.StoredDataShapeDescription,K.ShapeCategories.Flowchart),this.register(new N.DisplayShapeDescription,K.ShapeCategories.Flowchart),this.register(new z.MergeShapeDescription,K.ShapeCategories.Flowchart),this.register(new W.ConnectorShapeDescription,K.ShapeCategories.Flowchart),this.register(new j.OrShapeDescription,K.ShapeCategories.Flowchart),this.register(new U.SummingJunctionShapeDescription,K.ShapeCategories.Flowchart),this.register(new Z.CardWithImageOnLeftDescription,K.ShapeCategories.OrgChart),this.register(new Z.CardWithImageOnRightDescription,K.ShapeCategories.OrgChart),this.register(new F.CardWithImageOnTopDescription,K.ShapeCategories.OrgChart),this.register(new H.VerticalContainerDescription,K.ShapeCategories.Containers),this.register(new V.HorizontalContainerDescription,K.ShapeCategories.Containers)}return Object.defineProperty(t,"default",{get:function(){return t.defaultInstance},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultContainer",{get:function(){return t.defaultContainerInstance},enumerable:!1,configurable:!0}),t.prototype.get=function(t){return this.descriptions[t]},t.prototype.getTypesByCategory=function(t){return this.descriptionTypes[t]||[]},t.prototype.getCategoryByType=function(t){return this.descriptionCategories[t]},t.prototype.getCategoryByDescription=function(t){return this.getCategoryByType(t.key)},t.prototype.register=function(t,e,n){if(void 0===n&&(n=t.key),void 0!==this.descriptions[n])throw Error("Description key is duplicated");this.descriptions[n]=t,this.descriptionTypes[e]||(this.descriptionTypes[e]=[]),this.descriptionTypes[e].push(n),this.descriptionCategories[n]=e,t.onChanged.add(this)},t.prototype.registerCustomShape=function(t){if(void 0===t.type)throw Error("Custom shape type is not defined");if(void 0!==this.descriptions[t.type])throw Error("Custom shape type is duplicated");var e=t.baseType&&this.descriptions[t.baseType];t.minWidth>t.maxWidth&&(t.maxWidth=t.minWidth),t.minHeight>t.maxHeight&&(t.maxHeight=t.minHeight),this.register(new B.CustomShapeDescription(t,e),t.category||K.ShapeCategories.Custom)},t.prototype.unregisterCustomShape=function(t){var e=this.descriptions[t];if(e instanceof B.CustomShapeDescription){e.onChanged.remove(this);var n=this.descriptionCategories[t];delete this.descriptions[t],delete this.descriptionCategories[t];var o=this.descriptionTypes[n].indexOf(t);this.descriptionTypes[n].splice(o,1),0===this.descriptionTypes[n].length&&delete this.descriptionTypes[n]}},t.prototype.notifyShapeDescriptionChanged=function(t){this.onShapeDecriptionChanged.raise1((function(e){return e.notifyShapeDescriptionChanged(t)}))},t.defaultInstance=new g.RectangleShapeDescription,t.defaultContainerInstance=new H.VerticalContainerDescription,t}();e.ShapeDescriptionManager=q},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowVerticalShapeDescription=e.ArrowVerticalLineWidthParameterName=e.ArrowVerticalTriangleHeightParameterName=void 0;var i=n(7),r=n(2),a=n(35),s=n(8);e.ArrowVerticalTriangleHeightParameterName="th",e.ArrowVerticalLineWidthParameterName="lw";var c=function(t){function n(){return t.call(this,new r.Size(.375*i.ShapeDefaultDimension,i.ShapeDefaultDimension))||this}return o(n,t),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createParameters=function(t){t.addRange([new a.ShapeParameter(e.ArrowVerticalTriangleHeightParameterName,Math.sqrt(Math.pow(this.defaultSize.width,2)-Math.pow(this.defaultSize.width/2,2))),new a.ShapeParameter(e.ArrowVerticalLineWidthParameterName,this.defaultSize.width/3)])},n.prototype.normalizeParameters=function(t,n){this.changeParameterValue(n,e.ArrowVerticalTriangleHeightParameterName,(function(e){return Math.max(0,Math.min(t.size.height,e.value))})),this.changeParameterValue(n,e.ArrowVerticalLineWidthParameterName,(function(e){return Math.max(0,Math.min(t.size.width,e.value))}))},n.prototype.processConnectionPoint=function(t,n){var o=(t.size.width-t.parameters.get(e.ArrowVerticalLineWidthParameterName).value)/2,i=t.getConnectionPointSide(n);i===s.ConnectionPointSide.East?n.x-=o:i===s.ConnectionPointSide.West&&(n.x+=o)},n.prototype.getTextRectangle=function(t){return t.rectangle.clone().inflate(-i.ShapeTextPadding,-i.ShapeTextPadding)},n.prototype.getSizeByText=function(t,e){return t.clone().offset(2*i.ShapeTextPadding,2*i.ShapeTextPadding)},n}(i.ShapeDescription);e.ArrowVerticalShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowHorizontalShapeDescription=e.ArrowVerticalLineHeightParameterName=e.ArrowVerticalTriangleWidthParameterName=void 0;var i=n(7),r=n(2),a=n(35),s=n(8);e.ArrowVerticalTriangleWidthParameterName="tw",e.ArrowVerticalLineHeightParameterName="lh";var c=function(t){function n(){return t.call(this,new r.Size(i.ShapeDefaultDimension,.375*i.ShapeDefaultDimension))||this}return o(n,t),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createParameters=function(t){t.addRange([new a.ShapeParameter(e.ArrowVerticalTriangleWidthParameterName,Math.sqrt(Math.pow(this.defaultSize.height,2)-Math.pow(this.defaultSize.height/2,2))),new a.ShapeParameter(e.ArrowVerticalLineHeightParameterName,this.defaultSize.height/3)])},n.prototype.normalizeParameters=function(t,n){this.changeParameterValue(n,e.ArrowVerticalTriangleWidthParameterName,(function(e){return Math.max(0,Math.min(t.size.width,e.value))})),this.changeParameterValue(n,e.ArrowVerticalLineHeightParameterName,(function(e){return Math.max(0,Math.min(t.size.height,e.value))}))},n.prototype.processConnectionPoint=function(t,n){var o=(t.size.height-t.parameters.get(e.ArrowVerticalLineHeightParameterName).value)/2,i=t.getConnectionPointSide(n);i===s.ConnectionPointSide.North?n.y+=o:i===s.ConnectionPointSide.South&&(n.y-=o)},n.prototype.getTextRectangle=function(t){return t.rectangle.clone().inflate(-i.ShapeTextPadding,-i.ShapeTextPadding)},n.prototype.getSizeByText=function(t,e){return t.clone().offset(2*i.ShapeTextPadding,2*i.ShapeTextPadding)},n}(i.ShapeDescription);e.ArrowHorizontalShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonShapeDescription=void 0;var i=n(7),r=function(t){function e(e){var n=t.call(this,void 0,e)||this;return n.defaultSize.height=n.calculateHeight(i.ShapeDefaultDimension),n}return o(e,t),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return Math.PI*(this.angleCount-2)/this.angleCount},enumerable:!1,configurable:!0}),e}(i.ShapeDescription);e.PolygonShapeDescription=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImportUtils=void 0;var o=function(){function t(){}return t.parseJSON=function(t){if(!t||""===t)return{};try{return JSON.parse(t)}catch(e){return{}}},t.createDocument=function(t){var e=new DOMParser;return e.parseFromString(t,"application/xml")},t}();e.ImportUtils=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStyleTextPropertyCommand=void 0;var i=n(137),r=n(65),a=n(29),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentTextStylePropertyValue(this.getStyleProperty())},e.prototype.getStyleObj=function(t){return t.styleText},e.prototype.getDefaultStyleObj=function(){return new a.TextStyle},e.prototype.createHistoryItem=function(t,e,n){return new r.ChangeStyleTextHistoryItem(t.key,e,n)},e.prototype.updateInputPosition=function(t){this.control.selection.inputPosition.setTextStylePropertyValue(this.getStyleProperty(),t)},e}(i.ChangeStylePropertyCommandBase);e.ChangeStyleTextPropertyCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TreeLayoutBuilder=void 0;var i=n(140),r=n(251),a=n(67),s=n(3),c=n(1),u=n(141),l=n(36),p=n(8),h=n(21),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeToLevel={},e.levelDepthSize={},e}return o(e,t),e.prototype.build=function(){var t=this,e=new i.GraphLayout,n=0;return this.graph.getConnectedComponents().forEach((function(o){var i=r.Tree.createSpanningTree(o),a=t.processTree(i);e.extend(t.setComponentOffset(a,n)),n+=t.getComponentOffset(a)})),e},e.prototype.preProcessTree=function(t,e,n){var o=this;if(e=e.filter((function(t){return(void 0===o.nodeToLevel[t.key]?o.nodeToLevel[t.key]=n:-1)>=0})),e.length){var i=this.getMaxDepthSize(e);this.levelDepthSize[n]=i,this.preProcessTree(t,[].concat.apply([],e.map((function(e){return t.getChildren(e)}))),n+1)}},e.prototype.loadNodes=function(t,e,n){return n?t.getChildren(n.info).map((function(t){return e.hasNode(t.key)?void 0:e.addNode(new a.NodeLayout(t,c.Point.zero()))})).filter((function(t){return t})):[e.addNode(new a.NodeLayout(t.root,c.Point.zero()))]},e.prototype.processTree=function(t){var e=this,n=new i.GraphLayout;if(this.preProcessTree(t,[t.root],0),this.processLevel(t,n,0,new s.Range(0),0),this.settings.direction===h.LogicalDirectionKind.Backward){var o=Object.keys(this.levelDepthSize).map((function(t){return e.levelDepthSize[t]})),r=o.reduce((function(t,e){return t+e}),0)+(o.length-1)*this.settings.layerSpacing;n.forEachNode((function(t){return e.setDepthPos(t,e.getDepthPos(t)+r)}))}return n},e.prototype.processLevel=function(t,e,n,o,i,r){var a,c=this,u=this.addNodes(t,e,i,r),p=r?this.graph.getAdjacentEdges(r.key,l.ConnectionMode.Outgoing):[],h=this.getDirectionValue(this.levelDepthSize[i]),d=this.getDirectionValue(this.settings.layerSpacing);if(u.forEach((function(r){var u=s.Range.fromLength(a?a.to+c.settings.columnSpacing:o.from,c.getBreadthNodeSizeCore(r.info));r.position=c.getNodePosition(u.from,n,h).clone().offset(r.info.margin.left,r.info.margin.top),c.processLevel(t,e,n+h+d,u,i+1,r),c.updateEdgeConnections(e,p,r),o.extend(u),a=u})),r&&u.length){var f=u[u.length-1],m=new s.Range(this.getBreadthPos(u[0]),this.getBreadthPos(f)+this.getBreadthNodeSizeCore(f.info,!0));this.alignParent(r,m,o)}},e.prototype.addNodes=function(t,e,n,o){var i=this;return 0===n?[e.addNode(new a.NodeLayout(t.root,c.Point.zero()))]:t.getChildren(o.info).reduce((function(t,o){return i.nodeToLevel[o.key]!==n||e.hasNode(o.key)||t.push(e.addNode(new a.NodeLayout(o,c.Point.zero()))),t}),[])},e.prototype.getMaxDepthSize=function(t){var e=this;return t.reduce((function(t,n){return Math.max(t,e.getDepthNodeSizeCore(n))}),0)},e.prototype.getNodePosition=function(t,e,n){return this.settings.direction===h.LogicalDirectionKind.Forward?this.settings.orientation===h.DataLayoutOrientation.Vertical?new c.Point(t,e):new c.Point(e,t):this.settings.orientation===h.DataLayoutOrientation.Vertical?new c.Point(t,e+n):new c.Point(e+n,t)},e.prototype.updateEdgeConnections=function(t,e,n){var o=this;e.filter((function(t){return t.to===n.key})).forEach((function(e){var n=o.getBeginEdgeIndex(),i=o.getEndEdgeIndex();t.addEdge(new a.EdgeLayout(e.key,n,i))}))},e.prototype.getBeginEdgeIndex=function(){return this.settings.direction===h.LogicalDirectionKind.Forward?this.isVertical()?p.ConnectionPointSide.South:p.ConnectionPointSide.East:this.isVertical()?p.ConnectionPointSide.North:p.ConnectionPointSide.West},e.prototype.getEndEdgeIndex=function(){return this.settings.direction===h.LogicalDirectionKind.Forward?this.isVertical()?p.ConnectionPointSide.North:p.ConnectionPointSide.West:this.isVertical()?p.ConnectionPointSide.South:p.ConnectionPointSide.East},e.prototype.alignParent=function(t,e,n){if(this.settings.alignment===h.Alignment.Center){var o=e.from+e.length/2-this.getBreadthNodeSizeCore(t.info,!0)/2;this.settings.orientation===h.DataLayoutOrientation.Vertical?(t.position.x=Math.max(n.from+t.info.margin.left,o),t.position.x=Math.min(n.to-t.info.size.width-t.info.margin.right,t.position.x)):(t.position.y=Math.max(n.from+t.info.margin.top,o),t.position.y=Math.min(n.to-t.info.size.height-t.info.margin.bottom,t.position.y))}},e.prototype.getDepthPos=function(t){return this.settings.orientation===h.DataLayoutOrientation.Vertical?t.position.y:t.position.x},e.prototype.getBreadthPos=function(t){return this.settings.orientation===h.DataLayoutOrientation.Vertical?t.position.x:t.position.y},e.prototype.setDepthPos=function(t,e){this.settings.orientation===h.DataLayoutOrientation.Vertical?t.position.y=e:t.position.x=e},e.prototype.isVertical=function(){return this.settings.orientation===h.DataLayoutOrientation.Vertical},e}(u.LayoutBuilder);e.TreeLayoutBuilder=d},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportImageCommand=void 0;var i=n(74),r=n(259),a=n(54),s=n(69),c=n(15),u=n(75),l=n(99),p=n(46),h=function(t){function e(e){var n=t.call(this,e)||this;return n.exporter=new s.Exporter,n}return o(e,t),e.prototype.isEnabled=function(){return!p.ImageCache.instance.hasNonLoadedImages()},e.prototype.executeCore=function(t,e){var n=this;try{var o=this.getExportManager(),i=this.getExportFunc();i(this.control.model.size.clone(),this.control.model.pageColor,o,(function(t){e(t,n.getExtension()),n.tryDispose()}))}catch(r){throw this.tryDispose(),r}return!0},e.prototype.getExportManager=function(){var t=this.getOrCreateMeasurer(),e=this.control.render&&this.control.render.items||this.createItemsManager(t);return this.exportManager||(this.exportManager=new r.CanvasExportManager(e.itemsContainer,t))},e.prototype.createItemsManager=function(t){this.svgElement=c.RenderHelper.createSvgElement(document.body,!0);var e=new i.CanvasItemsManager(this.svgElement,1,new l.ExportDOMManipulator(t));return this.control.modelManipulator.onModelChanged.add(e),this.control.modelManipulator.commitItemsCreateChanges(),e},e.prototype.tryDispose=function(){this.svgElement&&(document.body.removeChild(this.svgElement),delete this.svgElement,this.exportManager=void 0),this.tempMeasurer&&(this.tempMeasurer.clean(),this.tempMeasurer=void 0)},e.prototype.getOrCreateMeasurer=function(){return this.control.measurer||(this.tempMeasurer=new u.TextMeasurer(document.body))},e}(a.ExportImportCommandBase);e.ExportImageCommand=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ItemChange=e.ItemChangeType=void 0,function(t){t[t["Create"]=0]="Create",t[t["UpdateProperties"]=1]="UpdateProperties",t[t["UpdateStructure"]=2]="UpdateStructure",t[t["Update"]=3]="Update",t[t["Remove"]=4]="Remove",t[t["UpdateClassName"]=5]="UpdateClassName"}(e.ItemChangeType||(e.ItemChangeType={}));var o=function(){function t(t,e,n){void 0===n&&(n=!0),this.item=t,this.type=e,this.isValid=n}return Object.defineProperty(t.prototype,"key",{get:function(){return this.item.key},enumerable:!1,configurable:!0}),t}();e.ItemChange=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportDOMManipulator=e.DOMManipulator=void 0;var i=n(56),r=2e3,a=function(){function t(t){this.measurer=t,this.queue=[]}return t.prototype.createElement=function(t,e,n){var o=t.createElement();return null!=e&&(void 0!==n?e.insertBefore(o,n):e.appendChild(o)),o},t.prototype.changeChildrenByPrimitives=function(t,e){var n=this;t.forEach((function(t,o){var i=e.childNodes[o];n.changeByPrimitive(i,t)}))},t.prototype.changeByFunc=function(t,e){this.doChange(t,e)},t.prototype.changeByPrimitive=function(t,e){this.doChange(t,e)},t.prototype.cancelAnimation=function(){void 0!==this.rafId&&(cancelAnimationFrame(this.rafId),this.queue=[])},t.prototype.doChange=function(t,e){i.Diagnostics.optimizeUsingRAF?(this.queue.push([t,e]),this.requestAnimation()):this.doChangeSync(t,e)},t.prototype.doChangeSync=function(t,e){"function"===typeof e?e(t):e.applyElementProperties(t,this.measurer)},t.prototype.requestAnimation=function(){var t=this;if(!this.rafRequested){this.rafRequested=!0;var e=function(){t.queue.splice(0,r).forEach((function(e){return t.doChangeSync(e[0],e[1])})),t.queue.length?t.rafId=requestAnimationFrame(e):(t.rafRequested=!1,t.rafId=void 0)};this.rafId=requestAnimationFrame(e)}},t}();e.DOMManipulator=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.doChange=function(t,e){this.doChangeSync(t,e)},e}(a);e.ExportDOMManipulator=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ClipboardCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.setClipboardData=function(t){this.control.render&&this.control.render.input.setClipboardData(t),e.clipboardData=t},e.prototype.getClipboardData=function(t){this.control.render&&this.isPasteSupportedByBrowser()?this.control.render.input.getClipboardData(t):t(e.clipboardData)},e.prototype.isPasteSupportedByBrowser=function(){return this.control.render&&this.control.render.input.isPasteSupportedByBrowser()},e}(i.SimpleCommandBase);e.ClipboardCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeZindexHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.itemKey=e.key,o.zIndex=n,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.oldZIndex=e.zIndex,t.changeZIndex(e,this.zIndex)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.changeZIndex(e,this.oldZIndex)},e}(i.HistoryItem);e.ChangeZindexHistoryItem=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataLayoutParameters=e.DataLayoutType=void 0;var o,i=n(21),r=n(96),a=n(76);(function(t){t[t["Tree"]=0]="Tree",t[t["Sugiyama"]=1]="Sugiyama"})(o=e.DataLayoutType||(e.DataLayoutType={}));var s=function(){function t(t,e){this.sizeSettings=t,e&&(void 0!==e.type&&(this.layoutType=e.type,this.layoutSettings=this.layoutType===o.Sugiyama?new i.LayoutSettings:new i.TreeLayoutSettings),void 0!==e.orientation&&(this.layoutSettings.orientation=e.orientation),this.skipPointIndices=e.skipPointIndices,this.autoSizeEnabled=e.autoSizeEnabled)}return Object.defineProperty(t.prototype,"needAutoLayout",{get:function(){return void 0!==this.layoutType},enumerable:!1,configurable:!0}),t.prototype.getLayoutBuilder=function(t){return this.layoutType===o.Tree?new r.TreeLayoutBuilder(this.layoutSettings,t):new a.SugiyamaLayoutBuilder(this.layoutSettings,t)},t}();e.DataLayoutParameters=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EditShapeImageCommandBase=void 0;var i=n(148),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.getSelectedShape();return t.prototype.isEnabled.call(this)&&!!e&&!e.locked&&e.enableImage&&e.allowEditImage},e.prototype.getValue=function(){var t=this.getSelectedShape(),e=t?t.image.exportUrl:void 0;return e},e.prototype.getSelectedShape=function(){var t=this.control.selection.getSelectedShapes(!0);return 1===t.length?t[0]:void 0},e.prototype.executeCore=function(t,e){this.control.history.beginTransaction();var n=this.control.selection.getSelectedShapes(!1);return this.control.history.addAndRedo(new i.ChangeShapeImageHistoryItem(n[0],e)),this.control.history.endTransaction(),!0},e}(r.SimpleCommandBase);e.EditShapeImageCommandBase=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TouchUtils=void 0;var o=n(19),i=n(60),r=function(){function t(){}return t.onEventAttachingToDocument=function(e,n){return!o.Browser.MacOSMobilePlatform||!t.isTouchEventName(e)||(t.documentTouchHandlers[e]||(t.documentTouchHandlers[e]=[]),t.documentTouchHandlers[e].push(n),t.documentEventAttachingAllowed)},t.isTouchEventName=function(t){return o.Browser.WebKitTouchUI&&(t.indexOf("touch")>-1||t.indexOf("gesture")>-1)},t.isTouchEvent=function(t){return o.Browser.WebKitTouchUI&&i.isDefined(t.changedTouches)},t.getEventX=function(t){return o.Browser.IE?t.pageX:t.changedTouches[0].pageX},t.getEventY=function(t){return o.Browser.IE?t.pageY:t.changedTouches[0].pageY},t.touchMouseDownEventName=o.Browser.WebKitTouchUI?"touchstart":o.Browser.Edge&&o.Browser.MSTouchUI&&window.PointerEvent?"pointerdown":"mousedown",t.touchMouseUpEventName=o.Browser.WebKitTouchUI?"touchend":o.Browser.Edge&&o.Browser.MSTouchUI&&window.PointerEvent?"pointerup":"mouseup",t.touchMouseMoveEventName=o.Browser.WebKitTouchUI?"touchmove":o.Browser.Edge&&o.Browser.MSTouchUI&&window.PointerEvent?"pointermove":"mousemove",t.msTouchDraggableClassName="dxMSTouchDraggable",t.documentTouchHandlers={},t.documentEventAttachingAllowed=!0,t}();e.TouchUtils=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramModelOperation=e.Diagnostics=e.RenderHelper=e.DiagramLocalizationService=e.NativeConnector=e.NativeShape=e.ShapeType=e.ColorUtils=e.PageOrientation=e.ConnectorPosition=e.ConnectorLineOption=e.ConnectorLineEnding=e.AutoZoomMode=e.Browser=e.UnitConverter=e.EventDispatcher=e.DataLayoutOrientation=e.DataLayoutType=e.ShapeCategories=e.ShapeTypes=e.DiagramUnit=e.default=e.DiagramControl=e.DiagramCommand=e.Point=e.Size=void 0;var o=n(80);Object.defineProperty(e,"DiagramCommand",{enumerable:!0,get:function(){return o.DiagramCommand}});var i=n(300);Object.defineProperty(e,"DiagramControl",{enumerable:!0,get:function(){return i.DiagramControl}}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return i.DiagramControl}});var r=n(2);Object.defineProperty(e,"Size",{enumerable:!0,get:function(){return r.Size}});var a=n(1);Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return a.Point}});var s=n(3);Object.defineProperty(e,"EventDispatcher",{enumerable:!0,get:function(){return s.EventDispatcher}});var c=n(0);Object.defineProperty(e,"ShapeTypes",{enumerable:!0,get:function(){return c.ShapeTypes}}),Object.defineProperty(e,"ShapeCategories",{enumerable:!0,get:function(){return c.ShapeCategories}}),Object.defineProperty(e,"ShapeType",{enumerable:!0,get:function(){return c.ShapeType}});var u=n(11);Object.defineProperty(e,"UnitConverter",{enumerable:!0,get:function(){return u.UnitConverter}});var l=n(19);Object.defineProperty(e,"Browser",{enumerable:!0,get:function(){return l.Browser}});var p=n(27);Object.defineProperty(e,"AutoZoomMode",{enumerable:!0,get:function(){return p.AutoZoomMode}});var h=n(102);Object.defineProperty(e,"DataLayoutType",{enumerable:!0,get:function(){return h.DataLayoutType}});var d=n(21);Object.defineProperty(e,"DataLayoutOrientation",{enumerable:!0,get:function(){return d.DataLayoutOrientation}}),n(380);var f=n(31);Object.defineProperty(e,"ConnectorLineEnding",{enumerable:!0,get:function(){return f.ConnectorLineEnding}}),Object.defineProperty(e,"ConnectorLineOption",{enumerable:!0,get:function(){return f.ConnectorLineOption}});var m=n(23);Object.defineProperty(e,"ColorUtils",{enumerable:!0,get:function(){return m.ColorUtils}});var g=n(56);Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return g.Diagnostics}});var y=n(83);Object.defineProperty(e,"NativeShape",{enumerable:!0,get:function(){return y.NativeShape}}),Object.defineProperty(e,"NativeConnector",{enumerable:!0,get:function(){return y.NativeConnector}});var v=n(34);Object.defineProperty(e,"DiagramLocalizationService",{enumerable:!0,get:function(){return v.DiagramLocalizationService}});var C=n(15);Object.defineProperty(e,"RenderHelper",{enumerable:!0,get:function(){return C.RenderHelper}});var _=n(47);Object.defineProperty(e,"DiagramUnit",{enumerable:!0,get:function(){return _.DiagramUnit}}),Object.defineProperty(e,"PageOrientation",{enumerable:!0,get:function(){return _.PageOrientation}});var P=n(16);Object.defineProperty(e,"DiagramModelOperation",{enumerable:!0,get:function(){return P.DiagramModelOperation}});var S=n(6);Object.defineProperty(e,"ConnectorPosition",{enumerable:!0,get:function(){return S.ConnectorPosition}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FixedInterval=void 0;var o=n(55),i=n(168),r=function(t){function e(e,n){var o=t.call(this)||this;return o.start=e,o.length=n,o}return o.__extends(e,t),Object.defineProperty(e.prototype,"end",{get:function(){return this.start+this.length},set:function(t){this.length=t-this.start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.start+this.length/2},enumerable:!1,configurable:!0}),e.prototype.copyFrom=function(t){this.start=t.start,this.length=t.length},e.prototype.equals=function(t){return t&&this.start===t.start&&this.length===t.length},e.prototype.clone=function(){return new e(this.start,this.length)},e.prototype.makeByStartEnd=function(t,n){return new e(t,n-t)},e.prototype.makeByStartLength=function(t,n){return new e(t,n)},e.prototype.makeByLengthEnd=function(t,n){return new e(n-t,t)},e.fromPositions=function(t,n){return new e(t,n-t)},e.makeByConstInterval=function(t){return new e(t.start,t.length)},e.prototype.expand=function(t){var e=Math.max(t.end,this.end);return this.start=Math.min(t.start,this.start),this.end=e,this},e}(i.MutableInterval);e.FixedInterval=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SparseIntervalsIterator=void 0;var o=function(){function t(t){this.sparseIntervals=t,this.intervalIndex=-1}return Object.defineProperty(t.prototype,"isStarted",{get:function(){return!!this.curr},enumerable:!1,configurable:!0}),t.prototype.moveNext=function(){return this.curr&&this.posInInterval+1<this.curr.length?(this.posInInterval++,this.index++,this.initObject(),!0):this.intervalIndex+1<this.sparseIntervals.numIntervals&&(this.intervalIndex++,this.curr=this.sparseIntervals.getInterval(this.intervalIndex),this.curr.length?(this.posInInterval=0,this.index=this.curr.start,this.initObject(),!0):this.moveNext())},t.prototype.movePrev=function(){return this.curr&&this.posInInterval-1>=this.curr.start?(this.posInInterval--,this.index--,this.initObject(),!0):(this.isStarted||(this.intervalIndex=this.sparseIntervals.numIntervals),this.intervalIndex-1>=0&&(this.intervalIndex--,this.curr=this.sparseIntervals.getInterval(this.intervalIndex),this.posInInterval=Math.max(this.curr.length-1,this.curr.start),this.index=this.curr.start,this.initObject(),!0))},t.prototype.initObject=function(){},t}();e.SparseIntervalsIterator=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Metrics=void 0;var o=function(){function t(){}return t.euclideanDistance=function(t,e){var n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)},t.manhattanDistance=function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},t}();e.Metrics=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.FilterPrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r){var a=t.call(this)||this;return a.id=e,a.x=n,a.y=o,a.width=i,a.height=r,a}return o(e,t),e.prototype.createMainElement=function(){var t=document.createElementNS(i.svgNS,"filter");return t.setAttribute("id",this.id),t},e.prototype.applyElementProperties=function(e,n){this.id&&e.setAttribute("id",this.id),this.setUnitAttribute(e,"x",this.x),this.setUnitAttribute(e,"y",this.y),this.setUnitAttribute(e,"width",this.width),this.setUnitAttribute(e,"height",this.height),this.setPositionCorrectionAttribute(e),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.FilterPrimitive=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PrimitiveObject=void 0;var o=n(11),i=function(){function t(t){this.style=t}return Object.defineProperty(t.prototype,"strokeWidthPx",{get:function(){return this.style?this.style.strokeWidthPx:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeOffset",{get:function(){return this.style?this.style.strokeOffset:0},enumerable:!1,configurable:!0}),t.prototype.getUnitVaue=function(t){return"number"===typeof t?o.UnitConverter.twipsToPixels(t).toString():t},t.prototype.setUnitAttribute=function(t,e,n){void 0!==n&&null!==n&&t.setAttribute(e,this.getUnitVaue(n))},t.prototype.setPositionCorrectionAttribute=function(t){var e=this.strokeWidthPx%2===1?"translate("+this.strokeOffset+", "+this.strokeOffset+")":"";t.setAttribute("transform",e)},t}();e.PrimitiveObject=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isColorProperty=void 0;var o={stroke:!0,fill:!0};function i(t){return o[t]}e.isColorProperty=i},function(t,e,n){"use strict";var o,i;Object.defineProperty(e,"__esModule",{value:!0}),e.Base64Utils=e.DocmMimeType=e.PlainTextMimeType=e.RtfMimeType=e.OpenXmlMimeType=e.Base64MimeType=void 0,function(t){t[t["Unknown"]=0]="Unknown",t[t["OpenXml"]=1]="OpenXml",t[t["Rtf"]=2]="Rtf",t[t["PlainText"]=3]="PlainText",t[t["Docm"]=4]="Docm"}(i=e.Base64MimeType||(e.Base64MimeType={})),e.OpenXmlMimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.RtfMimeType="application/rtf",e.PlainTextMimeType="text/plain",e.DocmMimeType="application/vnd.ms-word.document.macroEnabled.12";var r=function(){function t(){}return t.normalizeToDataUrl=function(e,n){return t.checkPrependDataUrl(e)||(e=t.prependByDataUrl(e,n)),e},t.prependByDataUrl=function(t,e){return"data:"+e+";base64,"+t},t.checkPrependDataUrl=function(e){return t.dataUrl.test(e)},t.deleteDataUrlPrefix=function(e){return e.replace(t.dataUrl,"")},t.getUint8Array=function(t){t=atob(t);var e=t.length,n=new Uint8Array(e);while(e--)n[e]=t.charCodeAt(e);return n},t.fromArrayBuffer=function(t){for(var e=[],n=new Uint8Array(t),o=n.byteLength,i=0;i<o;i++)e.push(String.fromCharCode(n[i]));return window.btoa(e.join(""))},t.getFileFromBase64=function(e,n,o){void 0===n&&(n="");var i=t.getUint8Array(e);return new File([i],n,o)},t.getMimeTypeAsString=function(e){var n=e.match(t.dataUrl);return n?n[1]:null},t.getKnownMimeType=function(e){var n,o=e.match(t.dataUrl);return o&&null!==(n=t.mimeTypesMap[o[1]])&&void 0!==n?n:i.Unknown},t.fromBlobAsArrayBuffer=function(e,n){var o=new FileReader;o.onloadend=function(){return n(t.fromArrayBuffer(o.result))},o.readAsArrayBuffer(e)},t.fromBlobAsDataUrl=function(t,e){var n=new FileReader;n.onloadend=function(){return e(n.result)},n.readAsDataURL(t)},t.mimeTypesMap=(o={},o[e.OpenXmlMimeType]=i.OpenXml,o[e.RtfMimeType]=i.Rtf,o[e.PlainTextMimeType]=i.PlainText,o[e.DocmMimeType]=i.Docm,o),t.dataUrl=/^data:(.*?)(;(.*?))??(;base64)?,/,t}();e.Base64Utils=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsCalculatorBase=void 0;var o=function(){function t(t){this.connector=t}return t}();e.ConnectorPointsCalculatorBase=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AStarMetrics=e.RightAngleTurnDirection=void 0;var o,i=n(108);(function(t){t[t["Straight"]=0]="Straight",t[t["Left"]=1]="Left",t[t["Right"]=2]="Right",t[t["Backwards"]=3]="Backwards"})(o=e.RightAngleTurnDirection||(e.RightAngleTurnDirection={}));var r=function(){function t(){}return t.prototype.distance=function(t,e){return i.Metrics.manhattanDistance(t,e)},t.prototype.penalty=function(t,e,n,i){var r=t;switch(e){case o.Backwards:r*=2;break;case o.Left:r+=11e-5;break;case o.Right:r+=1e-4;break}return n&&n.length>0&&(r+=5*n.length*t),i&&i.length>0&&(r+=5*i.length*t),r},t}();e.AStarMetrics=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeShapeParametersHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.shapeKey=e,o.parameters=n,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);this.oldParameters=e.parameters.clone(),t.changeShapeParameters(e,this.parameters)},e.prototype.undo=function(t){var e=t.model.findShape(this.shapeKey);t.changeShapeParameters(e,this.oldParameters)},e}(i.HistoryItem);e.ChangeShapeParametersHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteConnectorHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.connectorKey=e,n}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey);this.connector=e.clone(),t.deleteConnector(e)},e.prototype.undo=function(t){t.addConnector(this.connector,this.connector.key)},e}(i.HistoryItem);e.DeleteConnectorHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteShapeHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.shapeKey=e,n}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);this.shape=e.clone(),t.deleteShape(e)},e.prototype.undo=function(t){t.addShape(this.shape,this.shape.key)},e}(i.HistoryItem);e.DeleteShapeHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeShapeHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.shapeKey=e,i.position=n,i.size=o,i}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);this.oldPosition=e.position.clone(),this.oldSize=e.size.clone(),t.resizeShape(e,this.position,this.size)},e.prototype.undo=function(t){var e=t.model.findShape(this.shapeKey);t.resizeShape(e,this.oldPosition,this.oldSize)},e}(i.HistoryItem);e.ResizeShapeHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeLockedHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.itemKey=e.key,o.locked=n,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.oldLocked=e.locked,t.changeLocked(e,this.locked)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.changeLocked(e,this.oldLocked)},e}(i.HistoryItem);e.ChangeLockedHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStyleHistoryItemBase=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.itemKey=e,i.styleProperty=n,i.styleValue=o,i}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.oldStyleValue=e.style[this.styleProperty],t.changeStyle(e,this.styleProperty,this.styleValue)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.changeStyle(e,this.styleProperty,this.oldStyleValue)},e}(i.HistoryItem);e.ChangeStyleHistoryItemBase=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Importer=void 0;var i=n(14),r=n(3),a=n(2),s=n(1),c=n(90),u=n(6),l=n(49),p=n(135),h=n(94),d=n(23),f=function(t){function e(e,n){var o=t.call(this,e)||this;return o.obj=h.ImportUtils.parseJSON(n),o}return o(e,t),e.prototype.getObject=function(){return this.obj},e.prototype.getPageObject=function(t){return t["page"]},e.prototype.getShapeObjects=function(t){return t["shapes"]},e.prototype.getConnectorObjects=function(t){return t["connectors"]},e.prototype.importPageSettings=function(t,e){e&&(this.assert(e["width"],"number"),this.assert(e["height"],"number"),"number"===typeof e["width"]&&(t.size.width=e["width"]),"number"===typeof e["height"]&&(t.size.height=e["height"]),"number"===typeof e["pageColor"]?t.pageColor=e["pageColor"]:"string"===typeof e["pageColor"]&&(t.pageColor=d.ColorUtils.fromString(e["pageColor"])),"number"===typeof e["pageWidth"]&&(t.pageSize.width=e["pageWidth"]),"number"===typeof e["pageHeight"]&&(t.pageSize.height=e["pageHeight"]),"boolean"===typeof e["pageLandscape"]&&(t.pageLandscape=e["pageLandscape"]),"number"===typeof e["units"]&&(t.units=e["units"]))},e.prototype.importShape=function(t){this.assert(t["key"],"string"),this.assert(t["x"],"number"),this.assert(t["y"],"number"),this.assert(t["type"],"string");var e=t["type"],n=this.shapeDescriptionManager.get(e),o=new s.Point(t["x"],t["y"]),u=new i.Shape(n||c.ShapeDescriptionManager.default,o);return u.key=t["key"],"string"!==typeof t["dataKey"]&&"number"!==typeof t["dataKey"]||(u.dataKey=t["dataKey"]),"object"===typeof t["customData"]&&(u.customData=r.ObjectUtils.cloneObject(t["customData"])),"boolean"===typeof t["locked"]&&(u.locked=t["locked"]),"number"===typeof t["width"]&&(u.size.width=t["width"]),"number"===typeof t["height"]&&(u.size.height=t["height"]),"string"===typeof t["text"]&&(u.text=t["text"]),"string"===typeof t["imageUrl"]&&(u.image=new l.ImageInfo(t["imageUrl"])),t["parameters"]&&(u.parameters.fromObject(t["parameters"]),u.description.normalizeParameters(u,u.parameters)),t["style"]&&u.style.fromObject(t["style"]),t["styleText"]&&u.styleText.fromObject(t["styleText"]),"number"===typeof t["zIndex"]&&(u.zIndex=t["zIndex"]),Array.isArray(t["childKeys"])&&(u["childKeys"]=t["childKeys"].slice()),"boolean"===typeof t["expanded"]&&(u.expanded=t["expanded"]),"number"===typeof t["expandedWidth"]&&"number"===typeof t["expandedHeight"]&&(u.expandedSize=new a.Size(t["expandedWidth"],t["expandedHeight"])),u},e.prototype.importShapeChildren=function(t,e){return[]},e.prototype.importConnector=function(t){var e=this;if(this.assert(t["key"],"string"),!Array.isArray(t["points"]))throw Error("Invalid Format");var n=t["points"].map((function(t){return e.assert(t["x"],"number"),e.assert(t["y"],"number"),new s.Point(t["x"],t["y"])})),o=new u.Connector(n);return o.key=t["key"],"string"!==typeof t["dataKey"]&&"number"!==typeof t["dataKey"]||(o.dataKey=t["dataKey"]),"object"===typeof t["customData"]&&(o.customData=r.ObjectUtils.cloneObject(t["customData"])),"boolean"===typeof t["locked"]&&(o.locked=t["locked"]),o.endConnectionPointIndex="number"===typeof t["endConnectionPointIndex"]?t["endConnectionPointIndex"]:-1,o.beginConnectionPointIndex="number"===typeof t["beginConnectionPointIndex"]?t["beginConnectionPointIndex"]:-1,void 0!==t["endItemKey"]&&this.assert(t["endItemKey"],"string"),void 0!==t["beginItemKey"]&&this.assert(t["beginItemKey"],"string"),o["endItemKey"]=t["endItemKey"],o["beginItemKey"]=t["beginItemKey"],t["texts"]&&o.texts.fromObject(t["texts"]),t["properties"]&&o.properties.fromObject(t["properties"]),t["style"]&&o.style.fromObject(t["style"]),t["styleText"]&&o.styleText.fromObject(t["styleText"]),"number"===typeof t["zIndex"]&&(o.zIndex=t["zIndex"]),o},e}(p.ImporterBase);e.Importer=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DiamondShapeDescription=void 0;var i=n(7),r=n(4),a=n(0),s=function(t){function e(e,n){return void 0===e&&(e=i.ShapeDefaultSize.clone()),t.call(this,e,n)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return a.ShapeTypes.Diamond},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,i=e.right,a=e.bottom,s=e.center,c=s.x,u=s.y;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(c,o),new r.PathPrimitiveLineToCommand(i,u),new r.PathPrimitiveLineToCommand(c,a),new r.PathPrimitiveLineToCommand(n,u),new r.PathPrimitiveClosePathCommand],t.style)]},e.prototype.getTextRectangle=function(t){return t.rectangle.clone().inflate(-t.size.width/4,-t.size.height/4)},e.prototype.getSizeByText=function(t,e){return t.clone().multiply(2,2)},e}(i.ShapeDescription);e.DiamondShapeDescription=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TextShapeDescription=void 0;var i=n(7),r=n(2),a=n(0),s=n(53),c=n(22),u=n(18),l=function(t){function e(){var e=t.call(this,new r.Size(i.ShapeDefaultDimension,.5*i.ShapeDefaultDimension),!0)||this;return e.textClipPathId=u.RenderUtils.generateSvgElementId("clipRect"),e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return a.ShapeTypes.Text},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t,e){if(e){var n=t.rectangle,o=n.x,i=n.y,r=n.width,a=n.height;return[new s.ClipPathPrimitive(this.getTextClipPathId(e),[new c.RectanglePrimitive(o,i,r,a)])]}return[]},e.prototype.getTextClipPathId=function(t){return t?this.textClipPathId:void 0},e.prototype.getSizeByTextRectangle=function(t){return t},e.prototype.getSizeByText=function(t,e){return t.clone()},e.prototype.getTextRectangle=function(t){return t.rectangle},e}(i.ShapeDescription);e.TextShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PentagonShapeDescription=void 0;var i=n(4),r=n(0),a=n(93),s=n(8),c=n(3),u=n(12),l=function(t){function e(e){var n=t.call(this,e)||this;return n.defaultRatio=n.defaultSize.height/n.defaultSize.width,n}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Pentagon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angleCount",{get:function(){return 5},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,r=e.right,a=e.bottom,s=e.width,c=e.height,u=e.center.x,l=c/s/this.defaultRatio,p=Math.PI-this.angle,h=s/2*Math.tan(p/2)*l,d=o+h,f=(c-h)/Math.tan(p)/l,m=n+f,g=r-f;return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(u,o),new i.PathPrimitiveLineToCommand(r,d),new i.PathPrimitiveLineToCommand(g,a),new i.PathPrimitiveLineToCommand(m,a),new i.PathPrimitiveLineToCommand(n,d),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.processConnectionPoint=function(t,e){var n=t.getConnectionPointSide(e);if(n===s.ConnectionPointSide.East||n===s.ConnectionPointSide.West){var o=t.rectangle,i=o.y,r=o.width,a=o.height,c=a/r/this.defaultRatio,u=Math.PI-this.angle,l=r/2*Math.tan(u/2)*c,p=i+l;(n===s.ConnectionPointSide.East||n===s.ConnectionPointSide.West)&&(e.y=p)}},e.prototype.calculateHeight=function(t){var e=Math.PI-this.angle,n=t/2*Math.tan(e/2),o=t/2/Math.cos(e/2),i=o*Math.sin(e);return n+i},e.prototype.getTextRectangle=function(t){var e=c.GeometryUtils.getMaxRectangleEnscribedInEllipse(t.size);return u.Rectangle.fromGeometry(t.position.clone().offset((t.size.width-e.width)/2,(t.size.height-e.height)/2),e)},e.prototype.getSizeByText=function(t,e){return c.GeometryUtils.getEllipseByEnscribedRectangle(t)},e}(a.PolygonShapeDescription);e.PentagonShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.HexagonShapeDescription=void 0;var i=n(4),r=n(0),a=n(93),s=n(3),c=n(12),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Hexagon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angleCount",{get:function(){return 6},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,r=e.right,a=e.bottom,s=e.width,c=e.center.y,u=Math.PI-this.angle,l=s/(1+2*Math.cos(u)),p=n+(s-l)/2,h=p+l;return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(p,o),new i.PathPrimitiveLineToCommand(h,o),new i.PathPrimitiveLineToCommand(r,c),new i.PathPrimitiveLineToCommand(h,a),new i.PathPrimitiveLineToCommand(p,a),new i.PathPrimitiveLineToCommand(n,c),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.calculateHeight=function(t){var e=Math.PI-this.angle,n=t/(1+2*Math.cos(e));return 2*n*Math.sin(e)},e.prototype.getTextRectangle=function(t){var e=s.GeometryUtils.getMaxRectangleEnscribedInEllipse(t.size);return c.Rectangle.fromGeometry(t.position.clone().offset((t.size.width-e.width)/2,(t.size.height-e.height)/2),e)},e.prototype.getSizeByText=function(t,e){return s.GeometryUtils.getEllipseByEnscribedRectangle(t)},e}(a.PolygonShapeDescription);e.HexagonShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TriangleShapeDescription=void 0;var i=n(7),r=n(4),a=n(0),s=n(45),c=n(8),u=n(12),l=n(2),p=function(t){function e(e){var n=t.call(this,void 0,e)||this;return n.defaultSize.height=n.calculateHeight(i.ShapeDefaultDimension),n}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return a.ShapeTypes.Triangle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createConnectionPoints=function(){return[new s.ConnectionPoint(.5,0,c.ConnectionPointSide.North),new s.ConnectionPoint(.75,.5,c.ConnectionPointSide.East),new s.ConnectionPoint(.5,1,c.ConnectionPointSide.South),new s.ConnectionPoint(.25,.5,c.ConnectionPointSide.West)]},e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,i=e.right,a=e.bottom;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(e.center.x,o),new r.PathPrimitiveLineToCommand(i,a),new r.PathPrimitiveLineToCommand(n,a),new r.PathPrimitiveClosePathCommand],t.style)]},e.prototype.calculateHeight=function(t){return Math.sqrt(Math.pow(t,2)-Math.pow(t/2,2))},e.prototype.getTextRectangle=function(t){return new u.Rectangle(t.position.x+t.size.width/4,t.position.y+t.size.height/2,t.size.width/2,t.size.height/2-i.ShapeTextPadding).nonNegativeSize()},e.prototype.getSizeByText=function(t,e){return new l.Size(2*t.width,2*t.height+i.ShapeTextPadding)},e}(i.ShapeDescription);e.TriangleShapeDescription=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DocumentShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(8),c=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){return this.createDocumentPrimitives(t.rectangle,t.style)},e.prototype.createDocumentPrimitives=function(t,n){var o=t.x,i=t.y,r=t.right,s=t.bottom,c=t.width,u=t.height,l=t.center.x,p=u*e.curveOffsetRatio,h=[];return h.concat([new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(o,i),new a.PathPrimitiveLineToCommand(r,i),new a.PathPrimitiveLineToCommand(r,s),new a.PathPrimitiveQuadraticCurveToCommand(r-.25*c,s-2*p,l,s-p),new a.PathPrimitiveQuadraticCurveToCommand(o+.25*c,s+p,o,s-p),new a.PathPrimitiveClosePathCommand],n)])},e.prototype.processConnectionPoint=function(t,n){var o=t.getConnectionPointSide(n);o===s.ConnectionPointSide.South&&(n.y-=t.size.height*e.curveOffsetRatio)},e.prototype.getTextRectangle=function(t){var n=t.rectangle;return n.clone().resize(0,-n.height*e.curveOffsetRatio)},e.curveOffsetRatio=.1,e}(i.RectangleShapeDescription);e.DocumentShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CustomShapeDescription=void 0;var i=n(129),r=n(12),a=n(2),s=n(45),c=n(8),u=n(130),l=n(7),p=n(49),h=n(46),d=n(132),f=n(230),m=function(t){function e(e,n){var o=t.call(this,new a.Size(e.defaultWidth||n&&n.defaultSize.width||l.ShapeDefaultDimension,e.defaultHeight||n&&n.defaultSize.height||l.ShapeDefaultDimension))||this;if(o.properties=e,o.baseDescription=n,o.imageLoader=new d.ImageLoader(o.updateSvgImage.bind(o)),o.defaultText=e.defaultText||n&&n.getDefaultText(),o.defaultImageUrl=e.defaultImageUrl||n&&n.getDefaultImageUrl(),o.title=e.title||n&&n.getTitle()||o.defaultText||"",o.connectionPoints=o.createConnectionPoints(),e.svgUrl){o.svgImage=new p.ImageInfo(e.svgUrl);var i=h.ImageCache.instance.createUnloadedInfoByShapeImageInfo(o.svgImage);o.imageLoader.load(i)}if(e.svgToolboxUrl){o.svgToolboxImage=new p.ImageInfo(e.svgToolboxUrl);i=h.ImageCache.instance.createUnloadedInfoByShapeImageInfo(o.svgToolboxImage);o.imageLoader.load(i)}return o}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this.properties.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowEditText",{get:function(){return!1!==this.properties.allowEditText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowEditImage",{get:function(){return!0===this.properties.allowEditImage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasTemplate",{get:function(){return!!this.properties.createTemplate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minWidth",{get:function(){return this.properties.minWidth||this.baseDescription&&this.baseDescription.minWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minHeight",{get:function(){return this.properties.minHeight||this.baseDescription&&this.baseDescription.minHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this.properties.maxWidth||this.baseDescription&&this.baseDescription.maxWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHeight",{get:function(){return this.properties.maxHeight||this.baseDescription&&this.baseDescription.maxHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return this.properties.keepRatioOnAutoSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"toolboxSize",{get:function(){return this.properties.toolboxWidthToHeightRatio?new a.Size(this.defaultSize.width,this.defaultSize.width/this.properties.toolboxWidthToHeightRatio):this.defaultSize},enumerable:!1,configurable:!0}),e.prototype.getTitle=function(){return void 0!==this.title?this.title:t.prototype.getTitle.call(this)},e.prototype.getDefaultText=function(){return void 0!==this.defaultText?this.defaultText:t.prototype.getDefaultText.call(this)},e.prototype.getDefaultImageUrl=function(){return void 0!==this.defaultImageUrl?this.defaultImageUrl:t.prototype.getDefaultImageUrl.call(this)},e.prototype.allowResizeHorizontally=function(e){return!1!==this.properties.allowResize&&(this.baseDescription?this.baseDescription.allowResizeHorizontally(e):t.prototype.allowResizeHorizontally.call(this,e))},e.prototype.allowResizeVertically=function(e){return!1!==this.properties.allowResize&&(this.baseDescription?this.baseDescription.allowResizeVertically(e):t.prototype.allowResizeVertically.call(this,e))},e.prototype.createConnectionPoints=function(){return this.properties&&this.properties.connectionPoints&&this.properties.connectionPoints.length?this.properties.connectionPoints.map((function(t){if(t&&"number"===typeof t["x"]&&"number"===typeof t["y"]){var e="number"===typeof t["side"]?t["side"]:c.ConnectionPointSide.Undefined;return new s.ConnectionPoint(t["x"],t["y"],e)}})).filter((function(t){return t})):t.prototype.createConnectionPoints.call(this)},e.prototype.createImagePrimitives=function(e,n){return this.baseDescription?this.baseDescription.createImagePrimitives(e,n):t.prototype.createImagePrimitives.call(this,e,n)},e.prototype.createShapePrimitives=function(t,e){var n=[],o=t.rectangle,r=o.x,a=o.y,s=o.width,c=o.height;if(this.baseDescription)n=this.baseDescription.createShapePrimitives(t,e);else{var u=e&&this.svgToolboxImage?this.svgToolboxImage:this.svgImage;if(u){var l=r+(this.properties.svgLeft&&!e?this.properties.svgLeft*s:0),p=a+(this.properties.svgTop&&!e?this.properties.svgTop*c:0),h=this.properties.svgWidth&&!e?this.properties.svgWidth*s:s,d=this.properties.svgHeight&&!e?this.properties.svgHeight*c:c;n=n.concat([new i.ImagePrimitive(l,p,h,d,u.exportUrl)])}}var m=e&&this.properties.createToolboxTemplate||this.properties.createTemplate;if(m){var g=r+(this.properties.templateLeft&&!e?this.properties.templateLeft*s:0),y=a+(this.properties.templateTop&&!e?this.properties.templateTop*c:0),v=this.properties.templateWidth&&!e?this.properties.templateWidth*s:s,C=this.properties.templateHeight&&!e?this.properties.templateHeight*c:c,_=this.properties.apiController?this.properties.apiController.createNativeShape(t):t.toNative();n=n.concat([new f.SvgElementPrimitive(g,y,v,C,m,this.properties.destroyTemplate,_)])}return n},e.prototype.createParameters=function(e){return this.baseDescription?this.baseDescription.createParameters(e):t.prototype.createParameters.call(this,e)},e.prototype.normalizeParameters=function(e,n){this.baseDescription?this.baseDescription.normalizeParameters(e,n):t.prototype.normalizeParameters.call(this,e,n)},e.prototype.modifyParameters=function(e,n,o,i){this.baseDescription?this.baseDescription.modifyParameters(e,n,o,i):t.prototype.modifyParameters.call(this,e,n,o,i)},e.prototype.getParameterPoints=function(e){return this.baseDescription?this.baseDescription.getParameterPoints(e):t.prototype.getParameterPoints.call(this,e)},e.prototype.getTextRectangle=function(t){if(this.baseDescription)return this.baseDescription.getTextRectangle(t);var e=t.rectangle,n=e.x,o=e.y,i=e.width,a=e.height;return new r.Rectangle(n+(this.properties.textLeft?this.properties.textLeft*i:0),o+(this.properties.textTop?this.properties.textTop*a:0),this.properties.textWidth?this.properties.textWidth*i:i,this.properties.textHeight?this.properties.textHeight*a:a)},e.prototype.getSizeByText=function(t,e){return this.baseDescription?this.baseDescription.getSizeByText(t,e):new a.Size(t.width/this.properties.textWidth,t.height/this.properties.textHeight)},e.prototype.getImageSize=function(t){return new a.Size(this.properties.imageWidth?this.properties.imageWidth*t.width:t.width,this.properties.imageHeight?this.properties.imageHeight*t.height:t.height).nonNegativeSize()},e.prototype.getImagePlacementRectangle=function(t,e){var n=t.x,o=t.y,i=t.width,a=t.height;return new r.Rectangle(n+(this.properties.imageLeft&&!e?this.properties.imageLeft*i:0),o+(this.properties.imageTop&&!e?this.properties.imageTop*a:0),this.properties.imageWidth&&!e?this.properties.imageWidth*i:0,this.properties.imageHeight&&!e?this.properties.imageHeight*a:0)},e.prototype.updateSvgImage=function(t){var e=t.imageUrl&&t.imageUrl===this.properties.svgToolboxUrl,n=e?this.svgToolboxImage:this.svgImage;t.base64?n.loadBase64Content(t.base64):n.setUnableToLoadFlag(),e||this.raiseShapeDescriptionChanged(this)},e}(u.ShapeWithImageDescription);e.CustomShapeDescription=m},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ImagePrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r,a,s,c){void 0===a&&(a="none");var u=t.call(this,s,c)||this;return u.x=e,u.y=n,u.width=o,u.height=i,u.url=r,u.preserveAspectRatio=a,u}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"image")},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"x",this.x),this.setUnitAttribute(e,"y",this.y),this.setUnitAttribute(e,"width",this.width),this.setUnitAttribute(e,"height",this.height),this.setPositionCorrectionAttribute(e),e.setAttribute("href",this.url),e.setAttribute("preserveAspectRatio",this.preserveAspectRatio),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.ImagePrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeWithImageDescription=e.SHAPE_IMAGE_CLASSNAMES=e.ShapeDefaultSize=e.ShapeDefaultDimension=void 0;var i=n(7),r=n(12),a=n(2),s=n(1),c=n(11),u=n(129),l=n(22),p=n(37),h=n(18),d=n(53),f=n(131);e.ShapeDefaultDimension=1440,e.ShapeDefaultSize=new a.Size(e.ShapeDefaultDimension,e.ShapeDefaultDimension),e.SHAPE_IMAGE_CLASSNAMES={IMAGE:"dxdi-image",IMAGE_PLACEHOLDER:"dxdi-image-placeholder",LOADING_INDICATOR:"dxdi-spinner",USER_PIC:"dxdi-user",WARNING_MARK:"dxdi-warning"};var m=function(t){function n(n,o){void 0===n&&(n=e.ShapeDefaultSize.clone());var i=t.call(this,n,o)||this;return i.hasDefaultText=o,i.defaultIconSize=480,i}return o(n,t),Object.defineProperty(n.prototype,"enableImage",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.getImageMargin=function(t){return t?c.UnitConverter.pixelsToTwips(2):c.UnitConverter.pixelsToTwips(3)},n.prototype.createImagePrimitives=function(t,n){if(!this.enableImage)return[];var o=this.getImagePlacementRectangle(t.rectangle,n);if(n)return this.createImagePlaceholder(o);var i=[];if(i=t.image.isEmpty||t.image.unableToLoad?i.concat(this.createEmptyImagePrimitives(o,t.image.unableToLoad)):""===t.image.renderUrl?i.concat(this.createLoadingImagePrimitives(o)):i.concat(this.createLoadedImagePrimitives(o,t.image.renderUrl)),""===t.image.renderUrl){var r=h.RenderUtils.generateSvgElementId("clipImage");return[].concat([new p.GroupPrimitive(i,e.SHAPE_IMAGE_CLASSNAMES.IMAGE,void 0,r),new d.ClipPathPrimitive(r,[new l.RectanglePrimitive(o.x,o.y,o.width,o.height)])])}return i},n.prototype.createImagePlaceholder=function(t){return[]},n.prototype.createLoadedImagePrimitives=function(t,o){return[new u.ImagePrimitive(t.x,t.y,t.width,t.height,o,n.imageScalingRule,void 0,e.SHAPE_IMAGE_CLASSNAMES.IMAGE)]},n.prototype.createLoadingImagePrimitives=function(t){var n=this.getIconPlacementRectangle(t);return[f.ShapeImageIndicator.createLoadingIndicatorPrimitives(n.x,n.y,this.defaultIconSize,c.UnitConverter.pixelsToTwips(5),e.SHAPE_IMAGE_CLASSNAMES.LOADING_INDICATOR)]},n.prototype.createEmptyImagePrimitives=function(t,e){var n=this.getIconPlacementRectangle(t),o=[];return o=o.concat(this.createEmptyImagePrimitive(n)),e&&(o=o.concat(this.createWarningPrimitive(n))),o},n.prototype.createEmptyImagePrimitive=function(t){return new p.GroupPrimitive([])},n.prototype.createWarningPrimitive=function(t){return new p.GroupPrimitive([])},n.prototype.getIconPlacementRectangle=function(t){var e=r.Rectangle.fromGeometry(new s.Point(t.x,t.y),new a.Size(this.defaultIconSize,this.defaultIconSize));return e.width<t.width&&(e.x=t.x+(t.width-e.width)/2),e.height<t.height&&(e.y=t.y+(t.height-e.height)/2),e},n.imageScalingRule="xMidYMid meet",n}(i.ShapeDescription);e.ShapeWithImageDescription=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeImageIndicator=void 0;var o=n(52),i=n(4),r=n(37),a=n(19),s=n(22),c=n(11),u=function(){function t(t,e,n,o,i){this.x=t,this.y=e,this.size=n,this.borderThickness=o,this.className=i,this.animationStarted=!1}return t.createLoadingIndicatorPrimitives=function(e,n,o,i,r){var a=new t(e,n,o,i,r);return a.createLoadingIndicatorPrimitive()},t.createUserIconPrimitives=function(e,n,o,i,r){var a=new t(e,n,o,i,r);return a.createUserIconPrimitive()},t.createWarningIconPrimitives=function(e,n,o,i){var r=new t(e,n,o,void 0,i);return r.createWarningIconPrimitive()},t.prototype.rotate=function(t,e,n,o){if(this.animationStarted){var i=Math.round(o)%1080/3,r="rotate("+i+" "+e+" "+n+")";t.setAttribute("transform",r),this.animationRequestId=requestAnimationFrame(function(o){this.rotate(t,e,n,o)}.bind(this))}},t.prototype.onApplyLoadingIndicatorElementProperties=function(t){var e=[c.UnitConverter.twipsToPixelsF(this.x+this.size/2),c.UnitConverter.twipsToPixelsF(this.y+this.size/2)],n=e[0],o=e[1];a.Browser.IE?(this.animationRequestId=requestAnimationFrame(function(e){this.rotate(t,n,o,e)}.bind(this)),this.animationStarted=!0):t.style.setProperty("transform-origin",n+"px "+o+"px")},t.prototype.center=function(){return[c.UnitConverter.twipsToPixelsF(this.x+this.size/2),c.UnitConverter.twipsToPixelsF(this.y+this.size/2)]},t.prototype.createLoadingIndicatorPrimitive=function(){var t=this.center(),e=t[0],n=t[1],a=c.UnitConverter.twipsToPixelsF(this.size/2-this.borderThickness/2);return new r.GroupPrimitive([new o.EllipsePrimitive(e+"",n+"",a+"",a+""),new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(e+a+"",n+""),new i.PathPrimitiveArcToCommand(a+"",a+"",0,!1,!1,e+"",n-a+"")])],this.className,void 0,void 0,this.onApplyLoadingIndicatorElementProperties.bind(this),this.onBeforeDispose.bind(this))},t.prototype.createUserIconPrimitive=function(){var t=this.center(),e=t[0],n=t[1],a=c.UnitConverter.twipsToPixelsF(this.size/2-this.borderThickness/2),s=c.UnitConverter.twipsToPixelsF(this.size);return new r.GroupPrimitive([new o.EllipsePrimitive(e+"",n+"",a+"",a+"",void 0,"dxdi-background"),new o.EllipsePrimitive(e+"",n-s/8+"",s/8+"",s/8+""),new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(e+"",n+s/16+""),new i.PathPrimitiveCubicCurveToCommand(e+.1375*s+"",n+s/16+"",e+s/4+"",n+.11875*s+"",e+s/4+"",n+.1875*s+""),new i.PathPrimitiveLineToCommand(e+s/4+"",n+s/4+""),new i.PathPrimitiveLineToCommand(e-s/4+"",n+s/4+""),new i.PathPrimitiveLineToCommand(e-s/4+"",n+.1875*s+""),new i.PathPrimitiveCubicCurveToCommand(e-s/4+"",n+.11875*s+"",e-.1375*s+"",n+s/16+"",e+"",n+s/16+""),new i.PathPrimitiveClosePathCommand])],this.className)},t.prototype.createWarningIconPrimitive=function(){var t=this.center(),e=t[0],n=t[1],i=c.UnitConverter.twipsToPixelsF(this.size/2)-1,a=c.UnitConverter.twipsToPixelsF(this.size/8);return new r.GroupPrimitive([new o.EllipsePrimitive(e+"",n+"",i+"",i+""),new s.RectanglePrimitive(e-a/2+.5+"",n+i-c.UnitConverter.twipsToPixelsF(this.size/4)+"",a+"",a+""),new s.RectanglePrimitive(e-a/2+.5+"",n-i+c.UnitConverter.twipsToPixelsF(this.size/4)-a+"",a+"",i+"")],this.className)},t.prototype.onBeforeDispose=function(){this.animationRequestId&&cancelAnimationFrame(this.animationRequestId),this.animationStarted=!1},t}();e.ShapeImageIndicator=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImageLoader=void 0;var o=n(46),i=function(){function t(t){this.loadedCallback=t}return t.prototype.load=function(t){t.isLoaded?this.loadedCallback(t):t.isLoading||this.loadInner(t)},t.prototype.loadInner=function(t){var e=this;return t.imageUrl?this.loadPictureByUrl(t,(function(){return e.finalizeLoading(t,t)})):t.base64&&this.loadPictureByBase64(t,(function(){return e.finalizeLoading(t,t)})),t},t.prototype.finalizeLoading=function(t,e){e||(e=o.ImageCache.instance.getImageData(t.actualId)),e.isLoaded||o.ImageCache.instance.finalizeLoading(e,t),this.loadedCallback(e)},t.prototype.loadPictureByBase64=function(t,e){var n=new Image;n.onload=function(){e(t)},n.src=t.base64},t.prototype.loadPictureByUrl=function(t,e){var n=this,o=new XMLHttpRequest;try{o.onload=function(){var i=new FileReader;i.onloadend=function(){t.base64=i.result,n.loadPictureByBase64(t,(function(t){return e(t)}))},i.readAsDataURL(o.response)},o.onerror=function(){return e(t)},o.onloadend=function(){404===o.status&&e(t)},o.open("GET",t.imageUrl,!0),o.responseType="blob",t.startLoading(),o.send()}catch(i){}},t}();e.ImageLoader=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerDescription=e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO=e.CONTAINER_EXPAND_BUTTON_RECT_RATIO=e.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO=e.CONTAINER_HEADER_SIZE=void 0;var i=n(7),r=n(2),a=n(0),s=n(22),c=n(4),u=n(18),l=n(13),p=n(37),h=n(45),d=n(8),f=n(34);e.CONTAINER_HEADER_SIZE=360,e.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO=.2,e.CONTAINER_EXPAND_BUTTON_RECT_RATIO=.5,e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO=.3;var m=function(t){function n(e){return void 0===e&&(e=new r.Size(2*i.ShapeDefaultDimension,1.5*i.ShapeDefaultDimension)),t.call(this,e,!0)||this}return o(n,t),Object.defineProperty(n.prototype,"enableChildren",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.getDefaultText=function(){return f.DiagramLocalizationService.shapeTexts[a.ShapeTypes.Container]},n.prototype.createConnectionPoints=function(){return[new h.ConnectionPoint(.25,0,d.ConnectionPointSide.North),new h.ConnectionPoint(.5,0,d.ConnectionPointSide.North),new h.ConnectionPoint(.75,0,d.ConnectionPointSide.North),new h.ConnectionPoint(1,.25,d.ConnectionPointSide.East),new h.ConnectionPoint(1,.5,d.ConnectionPointSide.East),new h.ConnectionPoint(1,.75,d.ConnectionPointSide.East),new h.ConnectionPoint(.75,1,d.ConnectionPointSide.South),new h.ConnectionPoint(.5,1,d.ConnectionPointSide.South),new h.ConnectionPoint(.25,1,d.ConnectionPointSide.South),new h.ConnectionPoint(0,.75,d.ConnectionPointSide.West),new h.ConnectionPoint(0,.5,d.ConnectionPointSide.West),new h.ConnectionPoint(0,.25,d.ConnectionPointSide.West)]},n.prototype.getConnectionPointIndexForItem=function(t,e){var n=t&&t.getConnectionPoints();return 4===n.length?3*e+1:e},n.prototype.getConnectionPointIndexForSide=function(t){return 3*t+1},n.prototype.createShapePrimitives=function(t,e){var n=t.rectangle,o=n.x,i=n.y,r=n.width,a=n.height,c=[];return t.expanded&&(c=c.concat([new s.RectanglePrimitive(o,i,r,a,t.style)])),c.concat(this.createHeaderPrimitives(t,e))},n.prototype.createExpandButtonPrimitives=function(t,n){var o=[new c.PathPrimitiveMoveToCommand(n.x+n.width*((1-e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2),n.center.y),new c.PathPrimitiveLineToCommand(n.x+n.width*((1-e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2+e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO),n.center.y)];t.expanded||(o=o.concat([new c.PathPrimitiveMoveToCommand(n.center.x,n.y+n.height*((1-e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2)),new c.PathPrimitiveLineToCommand(n.center.x,n.y+n.height*((1-e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO)/2+e.CONTAINER_EXPAND_BUTTON_SIGN_RATIO))]));var i=n.clone().inflate(-n.width*(1-e.CONTAINER_EXPAND_BUTTON_RECT_RATIO)/2,-n.height*(1-e.CONTAINER_EXPAND_BUTTON_RECT_RATIO)/2);return[new p.GroupPrimitive([new s.RectanglePrimitive(i.x,i.y,i.width,i.height,t.style),new c.PathPrimitive(o,t.style)],"shape-expand-btn",null,null,(function(e){u.RenderUtils.setElementEventData(e,l.MouseEventElementType.ShapeExpandButton,t.key)}))]},n}(i.ShapeDescription);e.ContainerDescription=m},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CardBaseDescription=void 0;var i=n(7),r=n(12),a=n(2),s=n(130),c=n(234),u=n(4),l=n(37),p=n(131),h=n(0),d=n(34),f=n(11),m=n(1),g=function(t){function e(e){return void 0===e&&(e=new a.Size(i.ShapeDefaultDimension,26/46*i.ShapeDefaultDimension)),t.call(this,e,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getDefaultText=function(){return d.DiagramLocalizationService.shapeTexts[h.ShapeTypes.Card]},e.prototype.createShapePrimitives=function(t,e){var n=t.rectangle,o=n.x,i=n.y,r=n.width,a=n.height;return[new c.RoundedRectanglePrimitive(o,i,r,a,e?30:60,e?30:60,t.style)]},e.prototype.createImagePlaceholder=function(t){return[new c.RoundedRectanglePrimitive(t.x,t.y,t.width,t.height,f.UnitConverter.pixelsToTwips(2),f.UnitConverter.pixelsToTwips(2),void 0,s.SHAPE_IMAGE_CLASSNAMES.IMAGE_PLACEHOLDER)]},e.prototype.createEmptyImagePrimitive=function(t){return p.ShapeImageIndicator.createUserIconPrimitives(t.x,t.y,this.defaultIconSize,f.UnitConverter.pixelsToTwips(1),s.SHAPE_IMAGE_CLASSNAMES.USER_PIC)},e.prototype.createWarningPrimitive=function(t){return p.ShapeImageIndicator.createWarningIconPrimitives(t.x+this.defaultIconSize/2,t.y+this.defaultIconSize/2,this.defaultIconSize/2,s.SHAPE_IMAGE_CLASSNAMES.WARNING_MARK)},e.prototype.getTextRectangle=function(t){var e=t.rectangle,n=e.clone().inflate(-i.ShapeTextPadding,-i.ShapeTextPadding),o=this.getImageSize(e.createSize(),!0);return this.isTextAfterImage&&n.moveRectangle(this.isHorizontal?o.width:0,this.isHorizontal?0:o.height),n.resize(this.isHorizontal?-o.width:0,this.isHorizontal?0:-o.height),n.nonNegativeSize()},e.prototype.getSizeByText=function(t,e){var n=t.clone().offset(2*i.ShapeTextPadding,2*i.ShapeTextPadding),o=this.getImageSizeByTextBlockSize(n);return this.isHorizontal?n.width+=o.width:n.height+=o.height,n},e.prototype.createTextPrimitives=function(e,n){return n?this.createGraphicalTextRepresentation(e.rectangle):t.prototype.createTextPrimitives.call(this,e,n)},e.prototype.createGraphicalTextRepresentation=function(t){var e=new r.Rectangle(0,0,0,0),n=this.getImageSize(t.createSize(),!0,!0);if(this.isHorizontal){var o=this.isTextAfterImage?t.width/2-f.UnitConverter.pixelsToTwips(2):0;e.x=t.x+o+f.UnitConverter.pixelsToTwips(4),e.y=t.y+f.UnitConverter.pixelsToTwips(5),e.width=n.width-f.UnitConverter.pixelsToTwips(4),e.height=t.height-f.UnitConverter.pixelsToTwips(6)}else{var i=this.isTextAfterImage?t.height/2-f.UnitConverter.pixelsToTwips(2):0;e.x=t.x+t.width/4,e.y=t.y+i+f.UnitConverter.pixelsToTwips(4),e.width=t.width/2,e.height=n.height-f.UnitConverter.pixelsToTwips(2)}return this.createTextRepresentationPrimitives(e)},e.prototype.getImagePlacementRectangle=function(t,e){var n=this.getImageSize(t.createSize(),!1,e),o=r.Rectangle.fromGeometry(new m.Point(t.x,t.y),n),i=this.getImageSize(t.createSize(),!0,e);return this.isHorizontal&&this.isTextAfterImage?o.x+=this.getImageMargin(e):this.isHorizontal&&(o.x=t.right-i.width-this.getImageMargin(e)),this.isHorizontal||this.isTextAfterImage?o.y+=this.getImageMargin(e):o.y=t.bottom-i.height-this.getImageMargin(e),this.isHorizontal||(o.x+=(t.width-o.width)/2),o},e.prototype.createTextRepresentationPrimitives=function(t){var e=f.UnitConverter.pixelsToTwips(f.UnitConverter.twipsToPixels(t.height/3));return[new l.GroupPrimitive([new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(t.x,t.y),new u.PathPrimitiveLineToCommand(t.x+t.width,t.y)]),new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(t.x,t.y+e),new u.PathPrimitiveLineToCommand(t.x+t.width,t.y+e)]),new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(t.x,t.y+2*e),new u.PathPrimitiveLineToCommand(t.x+.66*t.width,t.y+2*e)])],"dxdi-shape-text")]},e}(s.ShapeWithImageDescription);e.CardBaseDescription=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImporterBase=void 0;var o=n(32),i=n(14),r=function(){function t(t){this.shapeDescriptionManager=t}return t.prototype.import=function(){var t=new o.DiagramModel,e=this.getObject();this.importPageSettings(t,this.getPageObject(e));for(var n=this.importShapes(this.getShapeObjects(e)),i=0;i<n.length;i++){var r=n[i];if(t.findItem(r.key))throw Error("Item key is duplicated");t.pushItem(r)}var a=this.importConnectors(this.getConnectorObjects(e));for(i=0;i<a.length;i++){var s=a[i];if(s.endItem=t.findItem(s["endItemKey"])||void 0,delete s["endItemKey"],s.beginItem=t.findItem(s["beginItemKey"])||void 0,delete s["beginItemKey"],t.findItem(s.key))throw Error("Item key is duplicated");t.pushItem(s),this.updateConnections(s)}return this.updateChildren(t.items,(function(e){return t.findItem(e)})),t},t.prototype.importItems=function(t){for(var e,n=[],o=this.getObject(),i={},r=this.importShapes(this.getShapeObjects(o)),a=0;a<r.length;a++){var s=r[a],c=s.key;e=t.getNextKey(),s.key=e,i[c]=s,void 0!==s.dataKey&&(s.dataKey=void 0),n.push(s)}var u=this.importConnectors(this.getConnectorObjects(o));for(a=0;a<u.length;a++){var l=u[a];c=l.key;e=t.getNextKey(),l.key=e,i[c]=l,void 0!==l.dataKey&&(l.dataKey=void 0);var p=l["endItemKey"];l.endItem=i[p],delete l["endItemKey"];var h=l["beginItemKey"];l.beginItem=i[h],delete l["beginItemKey"],n.push(l),this.updateConnections(l)}return this.updateChildren(n,(function(t){return i[t]})),n},t.prototype.importItemsData=function(t){for(var e=this.getObject(),n=this.importShapes(this.getShapeObjects(e)),o={},i=0;i<n.length;i++){var r=n[i],a=void 0;void 0!==r.dataKey&&(a=t.findShapeByDataKey(r.dataKey)),a&&(a.dataKey=r.dataKey,o[r.key]=r.dataKey,a.locked=r.locked,a.position=r.position.clone(),a.expanded=r.expanded,r.expandedSize&&(a.expandedSize=r.expandedSize.clone()),a.size=r.size.clone(),a.parameters=r.parameters.clone(),a.style=r.style.clone(),a.styleText=r.styleText.clone(),a.zIndex=r.zIndex,a.text=r.text,a.description=r.description,a.image=r.image.clone())}var s=this.importConnectors(this.getConnectorObjects(e));for(i=0;i<s.length;i++){var c=s[i],u=void 0;void 0!==c.dataKey&&(u=t.findConnectorByDataKey(c.dataKey)),u||(u=t.findConnectorByBeginEndDataKeys(o[c["beginItemKey"]],o[c["endItemKey"]])),u&&(u.dataKey=c.dataKey,u.locked=c.locked,u.points=c.points.slice(),u.properties=c.properties.clone(),u.style=c.style.clone(),u.endConnectionPointIndex=c.endConnectionPointIndex,u.beginConnectionPointIndex=c.beginConnectionPointIndex,u.texts=c.texts.clone(),u.styleText=c.styleText.clone(),u.zIndex=c.zIndex)}},t.prototype.importShapes=function(t){var e=[];if(!t)return e;if(!Array.isArray(t))throw Error("Invalid Format");for(var n=0;n<t.length;n++){var o=t[n],i=this.importShape(o);e.push(i),e=e.concat(this.importShapeChildren(o,i))}return e},t.prototype.importConnectors=function(t){var e=[];if(!t)return e;if(!Array.isArray(t))throw Error("Invalid Format");for(var n=0;n<t.length;n++){var o=t[n];e.push(this.importConnector(o))}return e},t.prototype.updateChildren=function(t,e){t.forEach((function(t){t instanceof i.Shape&&t["childKeys"]&&(t["childKeys"].forEach((function(n){var o=e(n);o&&(t.children.push(o),o.container=t)})),delete t["childKeys"])}))},t.prototype.updateConnections=function(t){t.endItem&&(t.endItem instanceof i.Shape?(t.endItem.attachedConnectors.push(t),t.points[t.points.length-1]=t.endItem.getConnectionPointPosition(t.endConnectionPointIndex,t.points[t.points.length-2])):(t.endItem=void 0,t.endConnectionPointIndex=-1)),t.beginItem&&(t.beginItem instanceof i.Shape?(t.beginItem.attachedConnectors.push(t),t.points[0]=t.beginItem.getConnectionPointPosition(t.beginConnectionPointIndex,t.points[1])):(t.beginItem=void 0,t.beginConnectionPointIndex=-1))},t.prototype.assert=function(t,e){if(void 0===t)throw Error("Invalid Format");if(void 0!==e&&typeof t!==e)throw Error("Invalid Format")},t}();e.ImporterBase=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StylePropertyCommandBase=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.lockInputPositionUpdating=function(){return!0},e}(i.SimpleCommandBase);e.StylePropertyCommandBase=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStylePropertyCommandBase=void 0;var i=n(136),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.control.selection.getSelectedItems();return e=this.processParameter(e),o.forEach((function(t){var o=n.getStyleProperty();n.control.history.addAndRedo(n.createHistoryItem(t,o,e))})),this.updateInputPosition(e),this.control.history.endTransaction(),!0},e.prototype.getDefaultValue=function(){return this.getDefaultStyleObj()[this.getStyleProperty()]},e.prototype.processParameter=function(t){return t},e}(i.StylePropertyCommandBase);e.ChangeStylePropertyCommandBase=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorPropertyCommand=void 0;var i=n(87),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.selection.inputPosition.getCurrentConnectorPropertyValue(this.getPropertyName())},e.prototype.getDefaultValue=function(){return this.getPropertyDefaultValue()},e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.control.selection.getSelectedConnectors();return o.forEach((function(t){var o=n.getPropertyName();n.control.history.addAndRedo(new i.ChangeConnectorPropertyHistoryItem(t.key,o,e))})),this.control.selection.inputPosition.setConnectorPropertyValue(this.getPropertyName(),e),this.control.history.endTransaction(),!0},e.prototype.lockInputPositionUpdating=function(){return!0},e}(r.SimpleCommandBase);e.ChangeConnectorPropertyCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutTreeVerticalCommand=void 0;var i=n(72),r=n(96),a=n(21),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var t=this.control.settings.snapToGrid?this.control.settings.gridSize:void 0,e=new a.TreeLayoutSettings(t);return e.orientation=a.DataLayoutOrientation.Vertical,e},e.prototype.createLayout=function(t,e){return new r.TreeLayoutBuilder(t,e).build()},e}(i.AutoLayoutCommandBase);e.AutoLayoutTreeVerticalCommand=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GraphLayout=void 0;var o=n(3),i=n(67),r=function(){function t(){this.nodeKeys=[],this.nodeToLayout={},this.edgeToPosition={}}return t.prototype.forEachNode=function(t){var e=this;this.nodeKeys.forEach((function(n){return t(e.nodeToLayout[n],n)}))},t.prototype.reduce=function(t,e){var n=this;return this.nodeKeys.reduce((function(e,o,i){return t(e,n.nodeToLayout[o],i)}),e)},t.prototype.addNode=function(t){if(this.nodeToLayout[t.key])throw Error("Node layout is already registered");return this.nodeKeys.push(t.key),this.nodeToLayout[t.key]=t,t},t.prototype.hasNode=function(t){return!!this.nodeToLayout[t]},t.prototype.addEdge=function(t){if(this.edgeToPosition[t.key])throw Error("Edge layout is already registered");this.edgeToPosition[t.key]=t},t.prototype.getRectangle=function(t){var e=this;return o.GeometryUtils.getCommonRectangle(this.nodeKeys.map((function(t){return e.nodeToLayout[t].rectangle})))},t.prototype.offsetNodes=function(e,n){var o=this;void 0===e&&(e=0),void 0===n&&(n=0);var r=new t;return this.nodeKeys.forEach((function(t){var a=o.nodeToLayout[t];r.addNode(new i.NodeLayout(a.info,a.position.clone().offset(e,n)))})),r.copyEdges(this),r},t.prototype.extend=function(t){var e=this;t.forEachNode((function(t){return e.addNode(t)})),this.copyEdges(t)},t.prototype.copyEdges=function(t){var e=this;Object.keys(t.edgeToPosition).forEach((function(n){var o=t.edgeToPosition[n];e.addEdge(new i.EdgeLayout(o.key,o.beginIndex,o.endIndex))}))},t}();e.GraphLayout=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LayoutBuilder=void 0;var o=n(21),i=function(){function t(t,e){this.settings=t,this.graph=e}return t.prototype.getBreadthNodeSizeCore=function(t,e){var n=this.settings.orientation===o.DataLayoutOrientation.Vertical?t.size.width:t.size.height;return e||(n+=this.settings.orientation===o.DataLayoutOrientation.Vertical?t.margin.left+t.margin.right:t.margin.top+t.margin.bottom),n},t.prototype.getDepthNodeSizeCore=function(t){return this.settings.orientation===o.DataLayoutOrientation.Horizontal?t.size.width+t.margin.left+t.margin.right:t.size.height+t.margin.top+t.margin.bottom},t.prototype.chooseDirectionValue=function(t,e){return this.settings.direction===o.LogicalDirectionKind.Forward?t:e},t.prototype.getDirectionValue=function(t){return this.settings.direction===o.LogicalDirectionKind.Forward?t:-t},t.prototype.getComponentOffset=function(t){var e=t.getRectangle(!0),n=this.settings.orientation===o.DataLayoutOrientation.Vertical?e.width:e.height;return n+this.settings.componentSpacing},t.prototype.setComponentOffset=function(t,e){return this.settings.orientation===o.DataLayoutOrientation.Vertical?t.offsetNodes(e):t.offsetNodes(0,e)},t}();e.LayoutBuilder=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasManager=void 0;var i=n(98),r=n(42),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pendingChanges={},e.pendingRemoveChanges={},e.updatesLock=0,e}return o(e,t),e.prototype.beginUpdate=function(){this.updatesLock++},e.prototype.endUpdate=function(){this.updatesLock--,0===this.updatesLock&&this.applyPendingChanges()},e.prototype.getPendingChanges=function(){var t=this;return Object.keys(this.pendingChanges).map((function(e){return t.pendingChanges[e]}))},e.prototype.getPendingRemoveChanges=function(){var t=this;return Object.keys(this.pendingRemoveChanges).map((function(e){return t.pendingRemoveChanges[e]}))},e.prototype.applyPendingChanges=function(){var t=this.getPendingRemoveChanges();t.length&&(this.applyChangesCore(t),this.pendingRemoveChanges={});var e=this.getPendingChanges();e.length&&(this.applyChangesCore(e),this.pendingChanges={})},e.prototype.applyChangesCore=function(t){var e=this,n=[];t.forEach((function(t){e.applyChange(t)||n.push(t)})),n.length&&n.length!==t.length&&this.applyChangesCore(n)},e.prototype.postponeChanges=function(t){var e=this;t.forEach((function(t){if(t.type===i.ItemChangeType.Remove)e.pendingRemoveChanges[t.key]=t,delete e.pendingChanges[t.key];else if(e.pendingChanges[t.key])t.type===i.ItemChangeType.Create?e.pendingChanges[t.key]=t:t.type===i.ItemChangeType.UpdateStructure?e.pendingChanges[t.key].type===i.ItemChangeType.UpdateProperties&&(e.pendingChanges[t.key]=t):t.type===i.ItemChangeType.UpdateProperties&&e.pendingChanges[t.key].type===i.ItemChangeType.Update&&(e.pendingChanges[t.key]=t);else{if(e.pendingRemoveChanges[t.key]&&t.type!==i.ItemChangeType.Create)throw new Error("Incorrect model changes sequence.");e.pendingChanges[t.key]=t}}))},e.prototype.notifyModelChanged=function(t){0===this.updatesLock?this.applyChangesCore(t):this.postponeChanges(t)},e.prototype.notifyPageColorChanged=function(t){},e.prototype.notifyPageSizeChanged=function(t,e){},e}(r.CanvasManagerBase);e.CanvasManager=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PasteSelectionCommandBase=void 0;var i=n(100),r=n(121),a=n(14),s=n(265),c=n(6),u=n(266),l=n(9),p=n(63),h=n(11),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=t.prototype.isEnabled.call(this)&&(this.isPasteSupportedByBrowser()||void 0!==i.ClipboardCommand.clipboardData);if(e){var n=this.parseClipboardData(i.ClipboardCommand.clipboardData);e=e&&(n.length>1||this.permissionsProvider.canAddItems(n))}return e},e.prototype.isVisible=function(){return this.isPasteSupportedByBrowser()||void 0!==i.ClipboardCommand.clipboardData},e.prototype.parseClipboardData=function(t,e){var n=[],o=new r.Importer(this.control.shapeDescriptionManager,t);n=o.importItems(this.control.model);var i=this.control.getPastePosition()||e;i&&this.calculateSelectionOffset(n,i);for(var s=0;s<n.length;s++){var u=n[s];u instanceof a.Shape?u.position=this.getShapeNewPosition(u.position):u instanceof c.Connector&&this.changeConnectorPoints(u)}return n},e.prototype.executeCore=function(t,e){var n=this;return this.getClipboardData((function(t){n.performPaste(t,e)})),!0},e.prototype.performPaste=function(t,e){this.control.beginUpdateCanvas(),this.control.history.beginTransaction();for(var n=[],o=this.parseClipboardData(t,e),i=0;i<o.length;i++){var r=o[i];r instanceof a.Shape?this.control.history.addAndRedo(new s.ImportShapeHistoryItem(r)):r instanceof c.Connector&&this.control.history.addAndRedo(new u.ImportConnectorHistoryItem(r));var h=r.container&&r.container.key;h&&-1!==n.indexOf(h)||n.push(r.key)}l.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.addAndRedo(new p.SetSelectionHistoryItem(this.control.selection,n)),this.control.history.endTransaction(),this.control.endUpdateCanvas(),this.control.barManager.updateItemsState()},e.prototype.calculateSelectionOffset=function(t,e){},Object.defineProperty(e.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),e.getShapeNewPosition=function(t,n){while(t.findShapeAtPosition(n))n=n.clone().offset(e.positionOffset,e.positionOffset);return n},e.changeConnectorPoints=function(t,n){while(t.findConnectorAtPoints(n.points))n.points.forEach((function(t){t.x+=e.positionOffset,t.y+=e.positionOffset}))},e.positionOffset=h.UnitConverter.pixelsToTwips(10),e}(i.ClipboardCommand);e.PasteSelectionCommandBase=d},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutLayeredHorizontalCommand=void 0;var i=n(72),r=n(76),a=n(21),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var t=new a.LayoutSettings;return t.orientation=a.DataLayoutOrientation.Horizontal,t},e.prototype.createLayout=function(t,e){return new r.SugiyamaLayoutBuilder(t,e).build()},e}(i.AutoLayoutCommandBase);e.AutoLayoutLayeredHorizontalCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutTreeHorizontalCommand=void 0;var i=n(72),r=n(96),a=n(21),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var t=this.control.settings.snapToGrid?this.control.settings.gridSize:void 0,e=new a.TreeLayoutSettings(t);return e.orientation=a.DataLayoutOrientation.Horizontal,e},e.prototype.createLayout=function(t,e){return new r.TreeLayoutBuilder(t,e).build()},e}(i.AutoLayoutCommandBase);e.AutoLayoutTreeHorizontalCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutLayeredVerticalCommand=void 0;var i=n(72),r=n(76),a=n(21),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var t=new a.LayoutSettings;return t.orientation=a.DataLayoutOrientation.Vertical,t},e.prototype.createLayout=function(t,e){return new r.SugiyamaLayoutBuilder(t,e).build()},e}(i.AutoLayoutCommandBase);e.AutoLayoutLayeredVerticalCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeLockedCommand=void 0;var i=n(9),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this,n=this.control.selection.getSelectedItems(!0),o=!1;return n.forEach((function(t){t.locked!==e.getLockState()&&(o=!0)})),t.prototype.isEnabled.call(this)&&o},e.prototype.executeCore=function(t,e){return i.ModelUtils.changeSelectionLocked(this.control.history,this.control.model,this.control.selection,this.getLockState()),!0},e}(r.SimpleCommandBase);e.ChangeLockedCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeShapeImageHistoryItem=void 0;var i=n(5),r=n(49),a=function(t){function e(e,n){var o=t.call(this)||this;return o.shapeKey=e.key,o.imageUrl=n,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);this.oldImage=e.image,t.changeShapeImage(e,new r.ImageInfo(this.imageUrl))},e.prototype.undo=function(t){var e=t.model.findShape(this.shapeKey);t.changeShapeImage(e,this.oldImage)},e}(i.HistoryItem);e.ChangeShapeImageHistoryItem=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDefaultState=void 0;var i=n(13),r=n(304),a=n(305),s=n(306),c=n(307),u=n(308),l=n(309),p=n(310),h=n(311),d=n(151),f=n(153),m=n(17),g=n(77),y=n(6),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.finish=function(){this.visualizerManager.resetConnectionPoints(),t.prototype.finish.call(this)},e.prototype.onMouseDownCore=function(e){if(e.modifiers===m.ModifierKey.Ctrl)this.startScrolling(e);else if(e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ConnectorText){var n=e.source.key;this.modifySelection(e,n),this.handler.switchState(new h.MouseHandlerMoveConnectorTextState(this.handler,this.history,this.model))}else e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ShapeResizeBox?this.handler.switchState(new a.MouseHandlerResizeShapeState(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.settings)):e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ShapeParameterBox?this.handler.switchState(new c.MouseHandlerDragParameterPointState(this.handler,this.history,this.model)):e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ConnectorPoint?this.handler.switchState(new r.MouseHandlerMoveConnectorPointState(this.handler,this.history,this.model,this.visualizerManager)):e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ConnectorSide?this.handler.switchState(new s.MouseHandlerMoveConnectorSideState(this.handler,this.history,this.model)):e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ConnectorOrthogonalSide?this.handler.switchState(new l.MouseHandlerMoveConnectorOrthogonalSideState(this.handler,this.history,this.model)):e.button===i.MouseButton.Left&&e.source.type===i.MouseEventElementType.ShapeConnectionPoint?this.handler.switchState(new u.MouseHandlerCreateConnectorState(this.handler,this.history,this.model,this.visualizerManager,this.shapeDescriptionManager,this.selection)):t.prototype.onMouseDownCore.call(this,e)},e.prototype.onShapeMouseDown=function(e){if(e.button===i.MouseButton.Left){var n=e.source.key;g.MouseHandlerMoveClonedDiagramItemState.isMoveClonedEvent(e)?(this.selection.add(n),this.handler.switchToMoveClonedShapeState()):(this.modifySelection(e,n),this.selection.getSelectedShapes(!1).length&&(this.handler.switchState(new f.MouseHandlerMoveShapeState(this.handler,this.history,this.model,this.selection,this.visualizerManager)),this.handler.state.onMouseDown(e)))}else t.prototype.onShapeMouseDown.call(this,e)},e.prototype.onDragStart=function(t){this.handler.switchState(new p.MouseHandlerBeforeToolboxDraggingState(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.shapeDescriptionManager)),this.handler.state.onDragStart(t)},e.prototype.onMouseMoveCore=function(e){this.updateConnectionsOnMouseMove(e),t.prototype.onMouseMoveCore.call(this,e)},e.prototype.updateConnectionsOnMouseMove=function(t){var e=this.model.findItem(t.source.key);this.visualizerManager.updateConnections(e,t.source.type,t.source.value)},e.prototype.canDragObjectOnMouseDown=function(t){return!0},e.prototype.canExpandContainerOnMouseDown=function(t){return!0},e.prototype.canClearSelectionOnMouseDown=function(){return!1},e.prototype.processOnMouseMoveAfterLimit=function(t){this.startSelection(t)},e.prototype.canSelectOnMouseUp=function(t){return!1},e.prototype.canClearSelectionOnMouseUp=function(){return!0},e.prototype.onConnectionPointsShow=function(t,e){var n=this,o=this.model.findShape(t);o&&e.forEach((function(t,e){t.allowed=n.handler.canPerformChangeConnectionOnUpdateUI(void 0,{item:o,position:y.ConnectorPosition.Begin,connectionPointIndex:e})}))},e}(d.MouseHandlerDefaultStateBase);e.MouseHandlerDefaultState=v},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveConnectorPointStateBase=void 0;var i=n(6),r=n(13),a=n(33),s=n(62),c=n(48),u=n(9),l=n(17),p=function(t){function e(e,n,o,i){var r=t.call(this,e,n)||this;return r.model=o,r.visualizerManager=i,r}return o(e,t),e.prototype.finish=function(){this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints(),t.prototype.finish.call(this)},e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),this.connector&&this.handler.addInteractingItem(this.connector)},e.prototype.onMouseMove=function(e){if(t.prototype.onMouseMove.call(this,e),this.allowAttachToObjects(e,!1,!1)){if(this.connector){var n=this.connector.getExtremeItem(this.pointPosition);this.visualizerManager.setConnectionTarget(n,e.source.type);var o=this.connector.getExtremeConnectionPointIndex(this.pointPosition);(n||-1===this.oppositeConnectionPointIndex)&&this.allowAttachToObjects(e,!0,!1)||(n=this.model.findItem(e.source.key)),this.visualizerManager.setConnectionPoints(n,e.source.type,o,!0)}}else this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints()},e.prototype.onApplyChanges=function(t){var e=this.getSnappedPoint(t,t.modelPoint);if(void 0!==this.pointPosition){void 0===this.oppositePointPosition&&(this.oppositePointPosition=this.getOppositePointPosition(),this.oppositeItem=this.connector.getExtremeItem(this.oppositePointPosition),this.oppositeConnectionPointIndex=this.connector.getExtremeConnectionPointIndex(this.oppositePointPosition)),this.targetItem=this.model.findItem(t.source.key);var n=this.allowAttachToObjects(t,!0,!0)?this.targetItem:void 0,o=-1;t.source.type===r.MouseEventElementType.ShapeConnectionPoint&&(o=parseInt(t.source.value)),!n||t.source.type!==r.MouseEventElementType.Shape&&t.source.type!==r.MouseEventElementType.ShapeConnectionPoint||this.connector.getExtremeItem(this.oppositePointPosition)===n&&(-1===o||-1===this.oppositeConnectionPointIndex||o===this.oppositeConnectionPointIndex)?this.connector.getExtremeItem(this.pointPosition)&&(this.history.addAndRedo(new s.DeleteConnectionHistoryItem(this.connector,this.pointPosition)),this.oppositeItem&&this.updateOppositeItemConnectionPointIndex(this.oppositeConnectionPointIndex)):(this.connector.getExtremeItem(this.pointPosition)===n&&this.connector.getExtremeConnectionPointIndex(this.pointPosition)===o||(this.connector.getExtremeItem(this.pointPosition)&&this.history.addAndRedo(new s.DeleteConnectionHistoryItem(this.connector,this.pointPosition)),this.history.addAndRedo(new c.AddConnectionHistoryItem(this.connector,n,o,this.pointPosition)),this.oppositeItem&&this.updateOppositeItemConnectionPointIndex(o)),e=n.getConnectionPointPosition(o,this.connector.points[this.pointIndex+(this.pointPosition===i.ConnectorPosition.End?-1:1)]),this.visualizerManager.setConnectionPointIndex(o))}u.ModelUtils.moveConnectorPoint(this.history,this.connector,this.pointIndex,e),u.ModelUtils.updateConnectorAttachedPoints(this.history,this.model,this.connector),this.handler.tryUpdateModelSize()},e.prototype.updateOppositeItemConnectionPointIndex=function(t){var e=-1===t?-1:this.oppositeConnectionPointIndex;e!==this.connector.getExtremeConnectionPointIndex(this.oppositePointPosition)&&(this.history.addAndRedo(new s.DeleteConnectionHistoryItem(this.connector,this.oppositePointPosition)),this.history.addAndRedo(new c.AddConnectionHistoryItem(this.connector,this.oppositeItem,e,this.oppositePointPosition)))},e.prototype.onFinishWithChanges=function(){u.ModelUtils.updateConnectorContainer(this.history,this.model,this.connector),u.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector)},e.prototype.getDraggingElementKeys=function(){return this.connector?[this.connector.key]:[]},e.prototype.getOppositePointPosition=function(){return this.pointPosition===i.ConnectorPosition.Begin?i.ConnectorPosition.End:i.ConnectorPosition.Begin},e.prototype.allowAttachToObjects=function(t,e,n){if(t.modifiers&l.ModifierKey.Ctrl||t.modifiers&l.ModifierKey.Shift)return!1;var o=this.connector;if(o&&t.source.type===r.MouseEventElementType.Shape){var i=this.model.findItem(t.source.key);if(e&&this.model.findItemContainerCore(o,(function(t){return t===i})))return!1;if(e&&this.oppositeItem&&this.model.findItemContainerCore(this.oppositeItem,(function(t){return t===i})))return!1;if(n&&this.oppositeItem===i&&-1===this.oppositeConnectionPointIndex)return!1}return!0},e.prototype.onConnectionPointsShow=function(t,e){var n=this;if(this.connector&&void 0!==this.pointPosition&&(this.connector.endItem&&this.connector.endItem.key===t||this.connector.beginItem&&this.connector.beginItem.key===t)){var o=this.connector.beginItem&&this.connector.beginItem.key===t?i.ConnectorPosition.Begin:i.ConnectorPosition.End;e.forEach((function(t,e){t.allowed=n.handler.canPerformChangeConnectionOnUpdateUI(n.connector,{item:n.connector.getExtremeItem(o),position:o,connectionPointIndex:e})}))}},e.prototype.onConnectionTargetShow=function(t,e){if(this.connector&&void 0!==this.pointPosition&&(this.connector.endItem&&this.connector.endItem.key===t||this.connector.beginItem&&this.connector.beginItem.key===t)){var n=this.connector.beginItem&&this.connector.beginItem.key===t?i.ConnectorPosition.Begin:i.ConnectorPosition.End;e.allowed=this.handler.canPerformChangeConnectionOnUpdateUI(this.connector,{item:this.connector.getExtremeItem(n),position:n,connectionPointIndex:-1})}},e}(a.MouseHandlerDraggingState);e.MouseHandlerMoveConnectorPointStateBase=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDefaultStateBase=void 0;var i=n(38),r=n(13),a=n(17),s=n(313),c=n(315),u=n(316),l=n(152),p=n(11),h=n(317),d=n(77),f=function(t){function e(e,n,o,i,r,a,s,c){var u=t.call(this,e)||this;return u.history=n,u.selection=o,u.model=i,u.view=r,u.visualizerManager=a,u.shapeDescriptionManager=s,u.settings=c,u}return o(e,t),e.prototype.onMouseDown=function(t){this.handler.canFinishTextEditing()&&(this.onMouseDownCore(t),this.handler.state!==this&&this.handler.state.onMouseDown(t))},e.prototype.onMouseDownCore=function(t){t.modifiers===a.ModifierKey.Ctrl?this.startScrolling(t):t.source.type===r.MouseEventElementType.Shape&&this.canDragObjectOnMouseDown(t.source.key)?this.onShapeMouseDown(t):t.source.type===r.MouseEventElementType.Connector&&this.canDragObjectOnMouseDown(t.source.key)?this.onConnectorMouseDown(t):t.button===r.MouseButton.Left&&t.source.type===r.MouseEventElementType.ShapeExpandButton&&this.canExpandContainerOnMouseDown(t.source.key)?this.onShapeExpandBtnMouseDown(t):(t.source.type!==r.MouseEventElementType.Shape&&t.source.type!==r.MouseEventElementType.Connector&&this.canClearSelectionOnMouseDown()&&this.clearSelection(),this.startPoint=t.modelPoint)},e.prototype.onMouseMove=function(t){this.onMouseMoveCore(t),this.handler.state!==this&&(this.handler.state.onMouseDown(this.handler.mouseDownEvent),this.handler.state.onMouseMove(t))},e.prototype.onMouseMoveCore=function(t){this.startPoint&&(Math.abs(this.startPoint.x-t.modelPoint.x)>e.startLimit||Math.abs(this.startPoint.y-t.modelPoint.y)>e.startLimit)&&(this.processOnMouseMoveAfterLimit(t),this.startPoint=void 0)},e.prototype.onMouseUp=function(t){this.onMouseUpCore(t),this.handler.state!==this&&this.handler.state.onMouseUp(t)},e.prototype.onMouseUpCore=function(t){t.source.type===r.MouseEventElementType.Shape&&this.canSelectOnMouseUp(t.source.key)||t.source.type===r.MouseEventElementType.Connector&&this.canSelectOnMouseUp(t.source.key)||t.source.type===r.MouseEventElementType.ShapeExpandButton&&this.canSelectOnMouseUp(t.source.key)?this.modifySelection(t,t.source.key):this.startPoint&&this.canClearSelectionOnMouseUp()&&this.clearSelection(),this.startPoint=void 0},e.prototype.onMouseWheel=function(t){return!!(t.modifiers&a.ModifierKey.Ctrl)&&(this.handler.switchState(new u.MouseHandlerZoomOnWheelState(this.handler,this.settings,this.view)),this.handler.state.onMouseWheel(t),!0)},e.prototype.onLongTouch=function(t){this.modifySelection(t,t.source.key,!0)},e.prototype.onConnectorMouseDown=function(t){d.MouseHandlerMoveClonedDiagramItemState.isMoveClonedEvent(t)?this.handler.switchState(new d.MouseHandlerMoveClonedDiagramItemState(this.handler,this.history,this.model,this.selection,this.visualizerManager)):(this.modifySelection(t,t.source.key),this.handler.switchState(new h.MouseHandlerMoveConnectorState(this.handler,this.history,this.model,this.selection,this.visualizerManager)))},e.prototype.onShapeMouseDown=function(t){this.modifySelection(t,t.source.key)},e.prototype.onShapeExpandBtnMouseDown=function(t){this.modifySelection(t,t.source.key),this.handler.switchState(new s.MouseHandlerToggleShapeExpandedState(this.handler,this.history,this.model,this.selection))},e.prototype.finish=function(){this.startPoint=void 0},e.prototype.startSelection=function(t){t.button===r.MouseButton.Left&&this.handler.switchState(new c.MouseHandlerSelectionState(this.handler,this.selection,this.visualizerManager))},e.prototype.startScrolling=function(t){t.button===r.MouseButton.Left&&this.handler.switchState(new l.MouseHandlerScrollingState(this.handler,this.view,this.selection))},e.prototype.modifySelection=function(t,e,n){this.isMultipleSelectionModifier(t)||n?this.selection.hasKey(e)?this.selection.remove(e):this.selection.add(e):this.selection.hasKey(e)||this.selection.set([e])},e.prototype.clearSelection=function(){this.selection.set([])},e.prototype.inSelection=function(t){return this.selection.hasKey(t)},e.prototype.isMultipleSelectionModifier=function(t){return t.modifiers&a.ModifierKey.Ctrl||t.modifiers&a.ModifierKey.Shift},e.startLimit=p.UnitConverter.pixelsToTwips(1),e}(i.MouseHandlerStateBase);e.MouseHandlerDefaultStateBase=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerScrollingState=void 0;var i=n(38),r=n(13),a=n(1),s=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.view=n,i.selection=o,i.lastOffset=new a.Point(0,0),i}return o(e,t),e.prototype.onMouseDown=function(t){t.preventDefault=!0,this.startPoint=this.getPointByEvent(t)},e.prototype.onMouseMove=function(t){if(t.button===r.MouseButton.Left){var e=this.currentPoint||this.startPoint;t.preventDefault=!0;var n=this.getPointByEvent(t),o=this.view.scrollBy(new a.Point(n.x-e.x,n.y-e.y));this.lastOffset=this.lastOffset.clone().offset(o.x,o.y),this.currentPoint=n}else this.handler.switchToDefaultState()},e.prototype.onMouseUp=function(t){this.handler.switchToDefaultState()},e.prototype.cancelChanges=function(){this.currentPoint&&this.view.scrollBy(this.lastOffset.clone().multiply(-1,-1))},e.prototype.start=function(){this.handler.raiseDragScrollStart(),t.prototype.start.call(this)},e.prototype.finish=function(){this.handler.raiseDragScrollEnd(),this.currentPoint&&this.startPoint&&!this.currentPoint.equals(this.startPoint)||this.selection.set([]),t.prototype.finish.call(this)},e.prototype.getPointByEvent=function(t){return t.offsetPoint},e}(i.MouseHandlerCancellableState);e.MouseHandlerScrollingState=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveShapeState=void 0;var i=n(17),r=n(77),a=n(154),s=n(16),c=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o,i,r)||this;return a.model=o,a.selection=i,a.visualizerManager=r,a}return o(e,t),e.prototype.onMouseDown=function(e){var n=this;t.prototype.onMouseDown.call(this,e),this.draggingShapes.forEach((function(t){return n.handler.addInteractingItem(t.shape,s.DiagramModelOperation.MoveShape)}))},e.prototype.onApplyChanges=function(e){this.calculateFixedPosition(e),t.prototype.onApplyChanges.call(this,e)},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),this.switchToMoveClonedShapeState(e)},e.prototype.switchToMoveClonedShapeState=function(t){r.MouseHandlerMoveClonedDiagramItemState.isMoveClonedEvent(t)&&(this.cancelChanges(),this.handler.switchToMoveClonedShapeState(this.startPoint),this.handler.onMouseDown(t))},e.prototype.getXPosition=function(e,n){return this.fixedX?n:t.prototype.getXPosition.call(this,e,n)},e.prototype.getYPosition=function(e,n){return this.fixedY?n:t.prototype.getYPosition.call(this,e,n)},e.prototype.validateDraggingShapes=function(){return this.draggingShapes.length>0},e.prototype.validateDraggingConnectors=function(){return!0},e.prototype.calculateFixedPosition=function(t){if(this.fixedX=!1,this.fixedY=!1,t.modifiers&i.ModifierKey.Shift){var e=Math.abs(this.startPoint.x-t.modelPoint.x),n=Math.abs(this.startPoint.y-t.modelPoint.y);e<n?this.fixedX=!0:this.fixedY=!0}},e}(a.MouseHandlerDragDiagramItemStateBase);e.MouseHandlerMoveShapeState=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDragDiagramItemStateBase=e.DraggingConnector=void 0;var i=n(1),r=n(82),a=n(17),s=n(318),c=n(30),u=n(85),l=n(9),p=n(13),h=n(33),d=function(){function t(t,e){this.connector=t,this.shouldClone=e,this.startPoints=t.points.map((function(t){return t.clone()})),this.startRenderContext=t.createRenderPointsContext()}return t.prototype.shouldOffset=function(t){return!!this.shouldClone||l.ModelUtils.canMoveConnector(t,this.connector)},t}();e.DraggingConnector=d;var f=function(){function t(t){this.shape=t,this.startPosition=t.position.clone()}return t}(),m=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n)||this;return a.model=o,a.selection=i,a.visualizerManager=r,a.startScrollLeft=0,a.startScrollTop=0,a}return o(e,t),e.prototype.finish=function(){this.visualizerManager.resetExtensionLines(),this.visualizerManager.resetContainerTarget(),this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints(),t.prototype.finish.call(this)},e.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.selectedItems=l.ModelUtils.createSelectedItems(this.selection),this.draggingShapes=this.selection.getSelectedShapes(!1,!0).map((function(t){return new f(t)})),this.validateDraggingShapes()?(this.draggingConnectors=[],this.draggingConnectorsIndexByKey={},this.registerSelectedConnectors(),this.registerAttachedConnectorsInSelection(),this.validateDraggingConnectors()?(this.modelConnectorsWithoutBeginItemInfo=this.createModelConnectorsWithoutBeginItemInfo(),this.modelConnectorsWithoutEndItemInfo=this.createModelConnectorsWithoutEndItemInfo(),t.prototype.onMouseDown.call(this,e)):this.handler.switchToDefaultState()):this.handler.switchToDefaultState()},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e),this.visualizerManager.setExtensionLines(this.selection.getSelectedShapes(!1,!0));var n=l.ModelUtils.findContainerByEventKey(this.model,this.selection,e.source.key);n&&this.allowInsertToContainer(e,n)?this.visualizerManager.setContainerTarget(n,e.source.type):this.visualizerManager.resetContainerTarget()},e.prototype.onApplyChanges=function(t){var e=this;if(this.draggingShapes.length){this.draggingShapes.forEach((function(n){return e.moveShape(n.shape,e.getPosition(t,n.startPosition))}));var n=this.draggingShapes[0];this.moveConnectors(r.Vector.fromPoints(n.startPosition.clone(),n.shape.position.clone()))}else this.moveConnectors(r.Vector.fromPoints(this.startPoint.clone(),this.getSnappedPoint(t,t.modelPoint).clone()));var o=l.ModelUtils.findContainerByEventKey(this.model,this.selection,t.source.key);o&&this.allowInsertToContainer(t,o)?l.ModelUtils.insertSelectionToContainer(this.history,this.model,this.selection,o):l.ModelUtils.removeSelectionFromContainer(this.history,this.model,this.selection),this.handler.tryUpdateModelSize((function(t,n){e.modelConnectorsWithoutBeginItemInfo.forEach((function(e){e.point.x+=t,e.point.y+=n})),e.modelConnectorsWithoutEndItemInfo.forEach((function(e){e.point.x+=t,e.point.y+=n}))}))},e.prototype.getDraggingElementKeys=function(){return this.draggingShapes.map((function(t){return t.shape.key})).concat(this.draggingConnectors.map((function(t){return t.connector.key})))},e.prototype.getXPosition=function(t,e){return e+t.modelPoint.x-this.startPoint.x},e.prototype.getYPosition=function(t,e){return e+t.modelPoint.y-this.startPoint.y},e.prototype.getPosition=function(t,e){return new i.Point(this.handler.getSnappedPos(t,this.getXPosition(t,e.x),!0),this.handler.getSnappedPos(t,this.getYPosition(t,e.y),!1))},e.prototype.registerAttachedConnectorsInSelection=function(){var t=this;this.draggingShapes.forEach((function(e){var n=e.shape.attachedConnectors;n&&n.forEach((function(e){t.containsDraggingConnectorByKey(e.key)||t.registerConnector(e)}))}))},e.prototype.createDraggingConnector=function(t){return new d(t,!1)},e.prototype.containsDraggingConnectorByKey=function(t){return void 0!==this.draggingConnectorsIndexByKey[t]},e.prototype.allowInsertToContainer=function(t,e){return!(t.modifiers&a.ModifierKey.Ctrl||t.modifiers&a.ModifierKey.Shift)&&(e&&e.expanded&&l.ModelUtils.canInsertSelectionToContainer(this.model,this.selection,e))},e.prototype.registerSelectedConnectors=function(){var t=this;this.selection.getSelectedConnectors(!1,!0).forEach((function(e){return t.registerConnector(e)}))},e.prototype.registerConnector=function(t){this.draggingConnectorsIndexByKey[t.key]=this.draggingConnectors.push(this.createDraggingConnector(t))-1},e.prototype.createModelConnectorsWithoutBeginItemInfo=function(){var t=this,e=this.model.findConnectorsCore((function(e){return!e.beginItem&&!t.containsDraggingConnectorByKey(e.key)}));return e.map((function(t){return{connector:t,point:t.points[0].clone()}}))},e.prototype.createModelConnectorsWithoutEndItemInfo=function(){var t=this,e=this.model.findConnectorsCore((function(e){return!e.endItem&&!t.containsDraggingConnectorByKey(e.key)}));return e.map((function(t){return{connector:t,point:t.points[t.points.length-1].clone()}}))},e.prototype.moveConnectors=function(t){var e=this;(t.x||t.y)&&this.draggingConnectors.forEach((function(n){n.shouldOffset(e.selectedItems)?e.offsetConnector(n.connector,n.startPoints,n.startRenderContext,t):e.changeConnector(n.connector)}))},e.prototype.moveShape=function(t,e){var n=this;l.ModelUtils.setShapePosition(this.history,this.model,t,e),l.ModelUtils.updateMovingShapeConnections(this.history,t,this.modelConnectorsWithoutBeginItemInfo,this.modelConnectorsWithoutEndItemInfo,(function(){n.visualizerManager.resetConnectionTarget(),n.visualizerManager.resetConnectionPoints()}),(function(t,e){n.visualizerManager.setConnectionTarget(t,p.MouseEventElementType.Shape),n.visualizerManager.setConnectionPoints(t,p.MouseEventElementType.Shape,e,!0)}),(function(t){return n.handler.addInteractingItem(t)})),this.draggingConnectors.filter((function(t){return!!n.selectedItems[t.connector.key]})).length||l.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,t)},e.prototype.offsetConnector=function(t,e,n,o){var i=this,r=e.map((function(t){return i.offsetPoint(t,o)}));r[0].equals(t.points[0])||this.history.addAndRedo(new s.ChangeConnectorPointsHistoryItem(t.key,r,this.offsetRenderContext(n,o)))},e.prototype.offsetRenderContext=function(t,e){var n=this;if(void 0!==t)return new u.ConnectorRenderPointsContext(t.renderPoints.map((function(t){var o=n.offsetPoint(t,e);return new c.ConnectorRenderPoint(o.x,o.y,t.pointIndex,t.skipped)})),!0,t.actualRoutingMode)},e.prototype.offsetPoint=function(t,e){var n=r.Vector.fromPoints(t,this.startPoint);return this.startPoint.clone().offset(e.x-n.x,e.y-n.y)},e.prototype.changeConnector=function(t){l.ModelUtils.shouldRemoveConnectorIntermediatePoints(t)&&l.ModelUtils.removeConnectorIntermediatePointsCore(this.history,t),l.ModelUtils.updateConnectorAttachedPoints(this.history,this.model,t)},e}(h.MouseHandlerDraggingState);e.MouseHandlerDragDiagramItemStateBase=m},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDefaultReadOnlyState=void 0;var i=n(151),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.canDragObjectOnMouseDown=function(t){return!1},e.prototype.canExpandContainerOnMouseDown=function(t){return!1},e.prototype.canClearSelectionOnMouseDown=function(){return!1},e.prototype.processOnMouseMoveAfterLimit=function(t){this.startSelection(t)},e.prototype.canSelectOnMouseUp=function(t){return!0},e.prototype.canClearSelectionOnMouseUp=function(){return!0},e.prototype.updateConnectionsOnMouseMove=function(t){},e}(i.MouseHandlerDefaultStateBase);e.MouseHandlerDefaultReadOnlyState=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeShapeTextHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.shapeKey=e.key,o.text=n,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);this.oldText=e.text,t.changeShapeText(e,this.text)},e.prototype.undo=function(t){var e=t.model.findShape(this.shapeKey);t.changeShapeText(e,this.oldText)},e}(i.HistoryItem);e.ChangeShapeTextHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenuHandler=void 0;var i=n(3),r=n(13),a=n(17),s=n(78),c=n(19),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contextMenuVisible=!1,e.textInputStarted=!1,e.canHideContextMenu=!0,e.onVisibilityChanged=new i.EventDispatcher,e}return o(e,t),e.prototype.onMouseDown=function(t){t.button===r.MouseButton.Left&&t.source.type!==r.MouseEventElementType.Undefined&&this.hideContextMenu()},e.prototype.onMouseUp=function(t){(!c.Browser.MacOSPlatform||c.Browser.MacOSPlatform&&this.canHideContextMenu)&&this.hideContextMenu(),this.canHideContextMenu=!0},e.prototype.onContextMenu=function(t){c.Browser.MacOSPlatform&&(this.canHideContextMenu=!1),this.showContextMenu(t.eventPoint,t.modelPoint)},e.prototype.onFocus=function(t){},e.prototype.onBlur=function(t){},e.prototype.onTextInputFocus=function(t){},e.prototype.onTextInputBlur=function(t){},e.prototype.onLongTouch=function(t){},e.prototype.onKeyDown=function(t){t.keyCode===a.KeyCode.Esc&&this.hideContextMenu()},e.prototype.onShortcut=function(t){this.hideContextMenu()},e.prototype.showContextMenu=function(t,e){this.textInputStarted||(this.onVisibilityChanged.raise1((function(n){return n.notifyShowContextMenu(t,e)})),this.contextMenuVisible=!0)},e.prototype.hideContextMenu=function(){this.contextMenuVisible&&(this.onVisibilityChanged.raise1((function(t){return t.notifyHideContextMenu()})),this.contextMenuVisible=!1)},e.prototype.notifyDragStart=function(t){},e.prototype.notifyDragEnd=function(t){},e.prototype.notifyDragScrollStart=function(){},e.prototype.notifyDragScrollEnd=function(){},e.prototype.notifyShowContextToolbox=function(t,e,n,o,i){},e.prototype.notifyHideContextToolbox=function(){},e.prototype.notifyTextInputStart=function(t,e,n,o){this.textInputStarted=!0},e.prototype.notifyTextInputEnd=function(t){this.textInputStarted=!1},e.prototype.notifyTextInputPermissionsCheck=function(t,e){},e.prototype.onUpdateUnlocked=function(t){},e}(s.BatchUpdatableObject);e.ContextMenuHandler=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.VisualizerManager=void 0;var i=n(324),r=n(325),a=n(160),s=n(32),c=n(13),u=n(326),l=n(14),p=n(3),h=n(41),d=n(1),f=n(161),m=n(9),g=n(327),y=n(328),v=n(78),C=n(34),_=function(t){function e(e,n,o,s,c){void 0===c&&(c=s.readOnly);var l=t.call(this)||this;return l.selection=e,l.model=n,l.eventManager=o,l.settings=s,l.readOnly=c,l.onVisualizersUpdate=new p.EventDispatcher,l.connectionPointsVisualizer=new u.ConnectionPointsVisualizer(l.onVisualizersUpdate),l.connectionPointsVisualizer=new u.ConnectionPointsVisualizer(l.onVisualizersUpdate),l.connectionTargetVisualizer=new i.ConnectionTargetVisualizer(l.onVisualizersUpdate),l.containerTargetVisualizer=new r.ContainerTargetVisualizer(l.onVisualizersUpdate),l.extensionLinesVisualizer=new a.ExtensionLinesVisualizer(l.onVisualizersUpdate),l.resizeInfoVisualizer=new g.ResizeInfoVisualizer(l.onVisualizersUpdate),l.selectionRectangleVisualizer=new y.SelectionRectVisualizer(l.onVisualizersUpdate),l}return o(e,t),e.prototype.initialize=function(t){this.model=t},e.prototype.onMouseDown=function(t){},e.prototype.onMouseUp=function(t){},e.prototype.onMouseEnter=function(t){},e.prototype.onMouseLeave=function(t){this.resetConnectionPoints(),this.resetConnectionTarget(),this.resetExtensionLines(),this.resetContainerTarget(),this.resetResizeInfo(),this.resetSelectionRectangle()},e.prototype.onBlur=function(t){},e.prototype.onFocus=function(t){},e.prototype.updateConnections=function(t,e,n){var o=-1;n&&e===c.MouseEventElementType.ShapeConnectionPoint&&(o=parseInt(n));var i=t&&(!t.allowResizeHorizontally&&!t.allowResizeVertically||t.isLocked);this.setConnectionPoints(t,e,o,i)},e.prototype.setConnectionPoints=function(t,e,n,o){if(this.eventManager.isFocused())if(!t||e!==c.MouseEventElementType.Shape&&e!==c.MouseEventElementType.ShapeResizeBox&&e!==c.MouseEventElementType.ShapeConnectionPoint||void 0===t)this.connectionPointsVisualizer.reset();else{var i=t.key,r=this.selection.hasKey(i),a=t.getConnectionPoints();this.connectionPointsVisualizer.setPoints(i,a.map((function(e){return new u.ConnectionPointInfo(e,t.getConnectionPointSide(e))})),n,r&&!o&&t.rectangle)}},e.prototype.setConnectionPointIndex=function(t){this.connectionPointsVisualizer.setPointIndex(t)},e.prototype.updateConnectionPoints=function(){var t=this.model.findItem(this.connectionPointsVisualizer.getKey());void 0!==t?this.connectionPointsVisualizer.update():this.connectionPointsVisualizer.reset()},e.prototype.resetConnectionPoints=function(){this.connectionPointsVisualizer.reset()},e.prototype.setConnectionTarget=function(t,e){!t||e!==c.MouseEventElementType.Shape&&e!==c.MouseEventElementType.ShapeConnectionPoint?this.connectionTargetVisualizer.reset():this.connectionTargetVisualizer.setTargetRect(t.key,t.rectangle,t.strokeWidth)},e.prototype.resetConnectionTarget=function(){this.connectionTargetVisualizer.reset()},e.prototype.setContainerTarget=function(t,e){t&&!t.isLocked&&e===c.MouseEventElementType.Shape&&t.enableChildren?this.containerTargetVisualizer.setTargetRect(t.key,t.rectangle,t.strokeWidth):this.containerTargetVisualizer.reset()},e.prototype.resetContainerTarget=function(){this.containerTargetVisualizer.reset()},e.prototype.setExtensionLines=function(t){var e=this;if(this.eventManager.isFocused()){this.extensionLinesVisualizer.reset();var n=s.DiagramModel.getRectangle(t.filter((function(t){return t})));this.addPageExtensionLines(n),this.model.items.forEach((function(o){t.indexOf(o)>-1||o instanceof l.Shape&&e.addShapeExtensionLines(o,n)}))}},e.prototype.addPageExtensionLines=function(t){for(var e=Math.round(this.model.size.width/this.model.pageWidth),n=Math.round(this.model.size.height/this.model.pageHeight),o=0;o<e;o++)for(var i=0;i<n;i++){var r=new d.Point(o*this.model.pageWidth+this.model.pageWidth/2,i*this.model.pageHeight+this.model.pageHeight/2);if(Math.abs(t.center.x-r.x)<this.settings.gridSize/2){var s=new h.Segment(new d.Point(t.center.x,0),new d.Point(t.center.x,this.model.size.height));this.extensionLinesVisualizer.addSegment(a.ExtensionLineType.HorizontalCenterToPageCenter,s,"")}if(Math.abs(t.center.y-r.y)<this.settings.gridSize/2){s=new h.Segment(new d.Point(0,t.center.y),new d.Point(this.model.size.width,t.center.y));this.extensionLinesVisualizer.addSegment(a.ExtensionLineType.VerticalCenterToPageCenter,s,"")}if(Math.abs(t.x-r.x)<this.settings.gridSize/2){s=new h.Segment(new d.Point(t.x,0),new d.Point(t.x,this.model.size.height));this.extensionLinesVisualizer.addSegment(a.ExtensionLineType.LeftToPageCenter,s,"")}if(Math.abs(t.y-r.y)<this.settings.gridSize/2){s=new h.Segment(new d.Point(0,t.y),new d.Point(this.model.size.width,t.y));this.extensionLinesVisualizer.addSegment(a.ExtensionLineType.TopToPageCenter,s,"")}if(Math.abs(t.right-r.x)<this.settings.gridSize/2){s=new h.Segment(new d.Point(t.right,0),new d.Point(t.right,this.model.size.height));this.extensionLinesVisualizer.addSegment(a.ExtensionLineType.RightToPageCenter,s,"")}if(Math.abs(t.bottom-r.y)<this.settings.gridSize/2){s=new h.Segment(new d.Point(0,t.bottom),new d.Point(this.model.size.width,t.bottom));this.extensionLinesVisualizer.addSegment(a.ExtensionLineType.BottomToPageCenter,s,"")}}},e.prototype.addShapeExtensionLines=function(t,e){var n,o,i,r,s,c,u,l,p=t.rectangle,m=t.strokeWidth-f.CanvasSelectionManager.extensionLineWidth,g=!0;if(e.right<p.x?(n=e.right,i=p.x,s=n+m+f.CanvasSelectionManager.extensionLineOffset,u=i-f.CanvasSelectionManager.extensionLineOffset):e.x>p.right&&(n=e.x,i=p.right,s=n-f.CanvasSelectionManager.extensionLineOffset,u=i+m+f.CanvasSelectionManager.extensionLineOffset),e.bottom<p.y?(o=e.bottom,r=p.y,c=o+m+f.CanvasSelectionManager.extensionLineOffset,l=r-f.CanvasSelectionManager.extensionLineOffset):e.y>p.bottom&&(o=e.y,r=p.bottom,c=o-f.CanvasSelectionManager.extensionLineOffset,l=r+m+f.CanvasSelectionManager.extensionLineOffset),void 0!==s&&void 0!==u){var y=this.getViewUnitText(Math.abs(n-i));if(e.center.y===p.center.y){var v=new h.Segment(new d.Point(s,e.center.y),new d.Point(u,p.center.y));this.extensionLinesVisualizer.addSegment(s>u?a.ExtensionLineType.VerticalCenterAfter:a.ExtensionLineType.VerticalCenterBefore,v,g?y:""),g=!1}if(e.y===p.y){v=new h.Segment(new d.Point(s,e.y),new d.Point(u,p.y));this.extensionLinesVisualizer.addSegment(s>u?a.ExtensionLineType.TopToTopAfter:a.ExtensionLineType.TopToTopBefore,v,g?y:"")}if(e.bottom===p.bottom){v=new h.Segment(new d.Point(s,e.bottom+m),new d.Point(u,p.bottom+m));this.extensionLinesVisualizer.addSegment(s>u?a.ExtensionLineType.BottomToBottomAfter:a.ExtensionLineType.BottomToBottomBefore,v,g?y:"")}if(e.y===p.bottom){v=new h.Segment(new d.Point(s,e.y),new d.Point(u,p.bottom+m));this.extensionLinesVisualizer.addSegment(s>u?a.ExtensionLineType.TopToBottomAfter:a.ExtensionLineType.TopToBottomBefore,v,g?y:"")}if(e.bottom===p.y){v=new h.Segment(new d.Point(s,e.bottom+m),new d.Point(u,p.y));this.extensionLinesVisualizer.addSegment(s>u?a.ExtensionLineType.BottomToTopAfter:a.ExtensionLineType.BottomToTopBefore,v,g?y:"")}}if(void 0!==c&&void 0!==l){y=this.getViewUnitText(Math.abs(o-r));if(e.center.x===p.center.x){v=new h.Segment(new d.Point(e.center.x,c),new d.Point(p.center.x,l));this.extensionLinesVisualizer.addSegment(c>l?a.ExtensionLineType.HorizontalCenterBelow:a.ExtensionLineType.HorizontalCenterAbove,v,g?y:""),g=!1}if(e.x===p.x){v=new h.Segment(new d.Point(e.x,c),new d.Point(p.x,l));this.extensionLinesVisualizer.addSegment(c>l?a.ExtensionLineType.LeftToLeftBelow:a.ExtensionLineType.LeftToLeftAbove,v,g?y:"")}if(e.right===p.right){v=new h.Segment(new d.Point(e.right+m,c),new d.Point(p.right+m,l));this.extensionLinesVisualizer.addSegment(c>l?a.ExtensionLineType.RightToRightBelow:a.ExtensionLineType.RightToRightAbove,v,g?y:"")}if(e.x===p.right){v=new h.Segment(new d.Point(e.x,c),new d.Point(p.right+m,l));this.extensionLinesVisualizer.addSegment(c>l?a.ExtensionLineType.LeftToRightBelow:a.ExtensionLineType.LeftToRightAbove,v,g?y:"")}if(e.right===p.x){v=new h.Segment(new d.Point(e.right+m,c),new d.Point(p.x,l));this.extensionLinesVisualizer.addSegment(c>l?a.ExtensionLineType.RightToLeftBelow:a.ExtensionLineType.RightToLeftAbove,v,g?y:"")}}},e.prototype.resetExtensionLines=function(){this.extensionLinesVisualizer.reset()},e.prototype.setResizeInfo=function(t){var e=s.DiagramModel.getRectangle(t),n=new d.Point(e.center.x,e.bottom+f.CanvasSelectionManager.resizeInfoOffset),o=this.getViewUnitText(e.width)+" x "+this.getViewUnitText(e.height);this.resizeInfoVisualizer.set(n,o)},e.prototype.resetResizeInfo=function(){this.resizeInfoVisualizer.reset()},e.prototype.setSelectionRectangle=function(t){this.selectionRectangleVisualizer.setRectangle(t)},e.prototype.resetSelectionRectangle=function(){this.selectionRectangleVisualizer.reset()},e.prototype.getViewUnitText=function(t){return m.ModelUtils.getUnitText(this.settings.viewUnits,C.DiagramLocalizationService.unitItems,C.DiagramLocalizationService.formatUnit,t)},e.prototype.notifyReadOnlyChanged=function(t){this.readOnly=t,this.readOnly&&(this.resetConnectionPoints(),this.resetConnectionTarget(),this.resetExtensionLines(),this.resetContainerTarget(),this.resetResizeInfo(),this.resetSelectionRectangle())},e.prototype.notifyDragStart=function(t){},e.prototype.notifyDragEnd=function(t){},e.prototype.notifyDragScrollStart=function(){},e.prototype.notifyDragScrollEnd=function(){},e.prototype.onUpdateUnlocked=function(t){},e}(v.BatchUpdatableObject);e.VisualizerManager=_},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TargetVisualizerBase=void 0;var o=function(){function t(t){this.dispatcher=t}return t.prototype.getKey=function(){return this.key},t.prototype.setTargetRect=function(t,e,n){this.key!==t&&(this.key=t,this.targetRect=e,this.targetStrokeWidth=n,this.raiseShow())},t.prototype.reset=function(){"-1"!==this.key&&(this.key="-1",this.targetRect=void 0,this.targetStrokeWidth=0,this.raiseHide())},t}();e.TargetVisualizerBase=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtensionLinesVisualizer=e.ExtensionLine=e.ExtensionLineType=void 0,function(t){t[t["LeftToLeftAbove"]=0]="LeftToLeftAbove",t[t["LeftToLeftBelow"]=1]="LeftToLeftBelow",t[t["RightToRightAbove"]=2]="RightToRightAbove",t[t["RightToRightBelow"]=3]="RightToRightBelow",t[t["LeftToRightAbove"]=4]="LeftToRightAbove",t[t["LeftToRightBelow"]=5]="LeftToRightBelow",t[t["RightToLeftAbove"]=6]="RightToLeftAbove",t[t["RightToLeftBelow"]=7]="RightToLeftBelow",t[t["TopToTopBefore"]=8]="TopToTopBefore",t[t["TopToTopAfter"]=9]="TopToTopAfter",t[t["BottomToBottomBefore"]=10]="BottomToBottomBefore",t[t["BottomToBottomAfter"]=11]="BottomToBottomAfter",t[t["TopToBottomBefore"]=12]="TopToBottomBefore",t[t["TopToBottomAfter"]=13]="TopToBottomAfter",t[t["BottomToTopBefore"]=14]="BottomToTopBefore",t[t["BottomToTopAfter"]=15]="BottomToTopAfter",t[t["HorizontalCenterAbove"]=16]="HorizontalCenterAbove",t[t["HorizontalCenterBelow"]=17]="HorizontalCenterBelow",t[t["VerticalCenterBefore"]=18]="VerticalCenterBefore",t[t["VerticalCenterAfter"]=19]="VerticalCenterAfter",t[t["VerticalCenterToPageCenter"]=20]="VerticalCenterToPageCenter",t[t["HorizontalCenterToPageCenter"]=21]="HorizontalCenterToPageCenter",t[t["LeftToPageCenter"]=22]="LeftToPageCenter",t[t["RightToPageCenter"]=23]="RightToPageCenter",t[t["TopToPageCenter"]=24]="TopToPageCenter",t[t["BottomToPageCenter"]=25]="BottomToPageCenter"}(e.ExtensionLineType||(e.ExtensionLineType={}));var o=function(){function t(t,e,n){this.type=t,this.segment=e,this.text=n}return t}();e.ExtensionLine=o;var i=function(){function t(t){this.dispatcher=t,this.lines=[],this.lineIndexByType={}}return t.prototype.addSegment=function(t,e,n){var i=this.lineIndexByType[t];if(void 0===i){var r=new o(t,e,n),a=this.lines.push(r);this.lineIndexByType[r.type]=a-1,this.raiseShow()}else if(e.length<this.lines[i].segment.length){r=new o(t,e,n);this.lines.splice(i,1,r),this.raiseShow()}},t.prototype.update=function(){this.raiseShow()},t.prototype.reset=function(){this.lines.length&&(this.lines=[],this.lineIndexByType={},this.raiseHide())},t.prototype.raiseShow=function(){var t=this;this.dispatcher.raise1((function(e){return e.notifyExtensionLinesShow(t.lines)}))},t.prototype.raiseHide=function(){this.dispatcher.raise1((function(t){return t.notifyExtensionLinesHide()}))},t}();e.ExtensionLinesVisualizer=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasSelectionManager=e.ACTIVE_SELECTION_CSSCLASS=e.SELECTION_ELEMENT_CLASSNAMES=void 0;var i=n(42),r=n(37),a=n(18),s=n(13),c=n(8),u=n(3),l=n(1),p=n(160),h=n(14),d=n(6),f=n(31),m=n(22),g=n(4),y=n(58),v=n(52),C=n(29),_=n(11),P=n(43),S=n(19),b=n(26),x=n(74),w=n(142),I="-1";e.SELECTION_ELEMENT_CLASSNAMES={SELECTION_RECTANGLE:"selection-rect",CONNECTION_POINT:"connection-point",ACTIVE:"active",CONTAINER_TARGET:"container-target",CONNECTION_TARGET:"connection-target",EXTENSION_LINE:"extension-line",CONNECTION_MARK:"connection-mark",SELECTION_MARK:"selection-mark",LOCKED_SELECTION_MARK:"locked-selection-mark",ITEMS_SELECTION_RECT:"items-selection-rect",CONNECTOR_MULTI_SELECTION:"connector-multi-selection",CONNECTOR_SELECTION:"connector-selection",CONNECTOR_POINT_MARK:"connector-point-mark",CONNECTOR_SELECTION_MASK:"connector-selection-mask",CONNECTOR_SIDE_MARK:"connector-side-mark",ITEM_SELECTION_RECT:"item-selection-rect",ITEM_MULTI_SELECTION:"item-multi-selection-rect"},e.ACTIVE_SELECTION_CSSCLASS="dxdi-active-selection";var T=function(t){function n(e,n,o,i){var r=t.call(this,n,i)||this;return r.readOnly=o,r.connectionPointElements=[],r.extensionLineElements=[],r.selectionMap={},r.parentContainer=e,r.initializeContainerElements(e),r}return o(n,t),n.prototype.initializeContainerElements=function(t){this.itemSelectionContainer=this.createAndChangePrimitiveElement(new r.GroupPrimitive([],null),t),this.visualizersContainer=this.createAndChangePrimitiveElement(new r.GroupPrimitive([],null),t),this.selectionMarksContainer=this.createAndChangePrimitiveElement(new r.GroupPrimitive([],null),t)},n.prototype.clear=function(){a.RenderUtils.removeContent(this.itemSelectionContainer),a.RenderUtils.removeContent(this.selectionMarksContainer),a.RenderUtils.removeContent(this.visualizersContainer),this.selectionRectElement=void 0,this.resizeInfoElement=void 0,this.connectionPointElements=[],this.connectionTargetElement=void 0,this.containerTargetElement=void 0,this.extensionLineElements=[],this.selectionMap={}},n.prototype.showSelectionRect=function(t){b.DomUtils.addClassName(this.parentContainer,e.ACTIVE_SELECTION_CSSCLASS);var n=new m.RectanglePrimitive(t.x,t.y,t.width,t.height,C.StrokeStyle.default1pxInstance,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_RECTANGLE),o=this.getSelectionRectElement(n);this.changePrimitiveElement(n,o)},n.prototype.hideSelectionRect=function(){b.DomUtils.removeClassName(this.parentContainer,e.ACTIVE_SELECTION_CSSCLASS),void 0!==this.selectionRectElement&&this.dom.changeByFunc(this.selectionRectElement,(function(t){return t.style.display="none"}))},n.prototype.getSelectionRectElement=function(t){return void 0!==this.selectionRectElement?this.dom.changeByFunc(this.selectionRectElement,(function(t){return t.style.display=""})):this.selectionRectElement=this.createPrimitiveElement(t,this.visualizersContainer),this.selectionRectElement},n.prototype.showResizeInfo=function(t,e){var o=new m.RectanglePrimitive(t.x,t.y,0,0,C.StrokeStyle.default1pxInstance),i=new r.GroupPrimitive([o,new y.TextPrimitive(t.x,t.y,e,P.TextOwner.Resize)],"resize-info"),a=this.getResizeInfoElement(i);this.changePrimitiveElement(i,a);var s=this.dom.measurer.measureTextLine(e,null,P.TextOwner.Resize).applyConverter(_.UnitConverter.pixelsToTwips);o.width=s.width+2*n.resizeInfoTextOffset,o.height=s.height+2*n.resizeInfoTextOffset,o.x=t.x-s.width/2-n.resizeInfoTextOffset,o.y=t.y-s.height/2-n.resizeInfoTextOffset,this.changePrimitiveElement(i,a)},n.prototype.hideResizeInfo=function(){void 0!==this.resizeInfoElement&&this.dom.changeByFunc(this.resizeInfoElement,(function(t){return t.style.display="none"}))},n.prototype.getResizeInfoElement=function(t){return void 0!==this.resizeInfoElement?this.dom.changeByFunc(this.resizeInfoElement,(function(t){return t.style.display=""})):this.resizeInfoElement=this.createPrimitiveElement(t,this.visualizersContainer),this.resizeInfoElement},n.prototype.getConnectionPointClassName=function(t,n){var o=e.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_POINT;return t&&(o+=" "+e.SELECTION_ELEMENT_CLASSNAMES.ACTIVE),n||(o+=" "+x.NOT_VALID_CSSCLASS),o},n.prototype.showConnectionPoint=function(t,o,i,r,a,c){this.showConnectionPointCore(2*t,o.x,o.y,n.connectionPointLargeSize,n.connectionPointLargeSize,s.MouseEventElementType.ShapeConnectionPoint,i,r,e.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_POINT+" selector"+(c?"":" "+x.NOT_VALID_CSSCLASS)),this.showConnectionPointCore(2*t+1,o.x,o.y,n.connectionPointSmallSize,n.connectionPointSmallSize,s.MouseEventElementType.ShapeConnectionPoint,i,r,this.getConnectionPointClassName(a,c))},n.prototype.showConnectionPointCore=function(t,e,n,o,i,r,s,c,u){var l=new v.EllipsePrimitive(e,n,o,i,null,u,(function(t){return a.RenderUtils.setElementEventData(t,r,s,c)})),p=this.getConnectionPointElement(l,t);this.changePrimitiveElement(l,p)},n.prototype.hideConnectionPoints=function(){for(var t=0;t<this.connectionPointElements.length;t++)this.dom.changeByFunc(this.connectionPointElements[t],(function(t){return t.style.display="none"}))},n.prototype.getConnectionPointElement=function(t,e){var n=this.connectionPointElements[e];return void 0!==n?this.dom.changeByFunc(n,(function(t){return t.style.display=""})):(n=this.createPrimitiveElement(t,this.visualizersContainer),this.connectionPointElements[e]=n),n},n.prototype.showContainerTarget=function(t,n){var o=new m.RectanglePrimitive(n.x,n.y,n.width,n.height,null,e.SELECTION_ELEMENT_CLASSNAMES.CONTAINER_TARGET),i=this.getContainerTargetElement(o);this.changePrimitiveElement(o,i)},n.prototype.hideContainerTarget=function(){this.containerTargetElement&&this.dom.changeByFunc(this.containerTargetElement,(function(t){return t.style.display="none"}))},n.prototype.getContainerTargetElement=function(t){return void 0!==this.containerTargetElement?this.dom.changeByFunc(this.containerTargetElement,(function(t){return t.style.display=""})):this.containerTargetElement=this.createPrimitiveElement(t,this.itemSelectionContainer),this.containerTargetElement},n.prototype.showConnectionTarget=function(t,n){var o=new m.RectanglePrimitive(n.x,n.y,n.width,n.height,null,e.SELECTION_ELEMENT_CLASSNAMES.CONNECTION_TARGET),i=this.getConnectionTargetElement(o);this.changePrimitiveElement(o,i)},n.prototype.hideConnectionTarget=function(){this.connectionTargetElement&&this.dom.changeByFunc(this.connectionTargetElement,(function(t){return t.style.display="none"}))},n.prototype.getConnectionTargetElement=function(t){return void 0!==this.connectionTargetElement?this.dom.changeByFunc(this.connectionTargetElement,(function(t){return t.style.display=""})):this.connectionTargetElement=this.createPrimitiveElement(t,this.itemSelectionContainer),this.connectionTargetElement},n.prototype.showExtensionLine=function(t,o,a,s,c){var u=e.SELECTION_ELEMENT_CLASSNAMES.EXTENSION_LINE;o!==p.ExtensionLineType.VerticalCenterAfter&&o!==p.ExtensionLineType.VerticalCenterBefore&&o!==p.ExtensionLineType.HorizontalCenterAbove&&o!==p.ExtensionLineType.HorizontalCenterBelow||(u+=" center"),o!==p.ExtensionLineType.VerticalCenterToPageCenter&&o!==p.ExtensionLineType.HorizontalCenterToPageCenter&&o!==p.ExtensionLineType.LeftToPageCenter&&o!==p.ExtensionLineType.RightToPageCenter&&o!==p.ExtensionLineType.TopToPageCenter&&o!==p.ExtensionLineType.BottomToPageCenter||(u+=" page");var l=0,h=0,d=0,f=0,m=0,v=0,_=0,S=0;a.y===s.y?(l=a.x-n.extensionLineWidth,h=a.y-n.extensionLineEndingSize,d=a.x-n.extensionLineWidth,f=a.y+n.extensionLineEndingSize,m=s.x-n.extensionLineWidth,v=a.y-n.extensionLineEndingSize,_=s.x-n.extensionLineWidth,S=a.y+n.extensionLineEndingSize):a.x===s.x&&(l=a.x-n.extensionLineEndingSize,h=a.y-n.extensionLineWidth,d=a.x+n.extensionLineEndingSize,f=a.y-n.extensionLineWidth,m=a.x-n.extensionLineEndingSize,v=s.y-n.extensionLineWidth,_=a.x+n.extensionLineEndingSize,S=s.y-n.extensionLineWidth);var b=0,x=0;o!==p.ExtensionLineType.RightToRightAbove&&o!==p.ExtensionLineType.RightToRightBelow||(b-=n.extensionLineWidth),o!==p.ExtensionLineType.BottomToBottomAfter&&o!==p.ExtensionLineType.BottomToBottomBefore||(x-=n.extensionLineWidth);var w=[new g.PathPrimitive([g.PathPrimitiveMoveToCommand.fromPoint(a.clone().offset(b,x)),g.PathPrimitiveLineToCommand.fromPoint(s.clone().offset(b,x))],C.StrokeStyle.default1pxInstance,"size-line"),new g.PathPrimitive([new g.PathPrimitiveMoveToCommand(l,h),new g.PathPrimitiveLineToCommand(d,f),new g.PathPrimitiveMoveToCommand(m,v),new g.PathPrimitiveLineToCommand(_,S)],C.StrokeStyle.default1pxInstance),new y.TextPrimitive((s.x+a.x)/2,(s.y+a.y)/2,c,P.TextOwner.ExtensionLine,void 0,void 0,void 0,null,void 0,null,i.PAGE_BG_TEXTFLOOR_FILTER_ID)],I=new r.GroupPrimitive(w,u),T=this.getExtensionLineElement(I,t);this.changePrimitiveElement(I,T)},n.prototype.hideExtensionLines=function(){for(var t=0;t<this.extensionLineElements.length;t++)this.extensionLineElements[t]&&this.dom.changeByFunc(this.extensionLineElements[t],(function(t){return t.style.display="none"}))},n.prototype.getExtensionLineElement=function(t,e){var n=this.extensionLineElements[e];return void 0!==n?this.dom.changeByFunc(n,(function(t){return t.style.display=""})):(n=this.createPrimitiveElement(t,this.visualizersContainer),this.extensionLineElements[e]=n),n},n.prototype.getOrCreateShapeSelection=function(t,e){var n=this.selectionMap[t.key];return n||(n=new D(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom,t.key,t.isLocked,t.rectangle,t.style,t.allowResizeHorizontally,t.allowResizeVertically,t.description.getParameterPoints(t)),this.selectionMap[t.key]=n),e&&(e[t.key]=!0),n},n.prototype.getOrCreateConnectorSelection=function(t,e){var n=this.selectionMap[t.key],o=t.getRenderPoints();return n||(n=new A(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom,t.key,t.isLocked,t.rectangle,o,t.style,t.styleText,t.enableText,t.texts.map((function(e){var n=u.GeometryUtils.getPathPointByPosition(o,e.position);return{text:t.getText(e.position),point:n[0],pointIndex:n[1],pos:e.position}})).sort((function(t,e){return t.pos-e.pos})),t.points,t.properties.lineOption),this.selectionMap[t.key]=n),e&&(e[t.key]=!0),n},n.prototype.getOrCreateMultipleSelection=function(t){var e=this.selectionMap[I];return e||(e=new M(this.itemSelectionContainer,this.selectionMarksContainer,this.actualZoom,this.readOnly,this.dom),this.selectionMap[I]=e),t[I]=!0,e},n.prototype.getMultipleSelection=function(){return this.selectionMap[I]},n.prototype.updateShapeSelection=function(t,e){t.key in this.selectionMap&&(this.getOrCreateShapeSelection(t).onModelChanged(t.isLocked,t.rectangle,t.style,t.allowResizeHorizontally,t.allowResizeVertically,t.description.getParameterPoints(t)),e&&e.onModelItemChanged(t.key,t.rectangle))},n.prototype.updateConnectorSelection=function(t,e){if(t.key in this.selectionMap){var n=t.getRenderPoints();this.getOrCreateConnectorSelection(t).onModelChanged(t.isLocked,t.rectangle,n,t.style,t.styleText,t.enableText,t.texts.map((function(e){var o=u.GeometryUtils.getPathPointByPosition(n,e.position);return{text:t.getText(e.position),pointIndex:o[1],pos:e.position,point:o[0]}})).sort((function(t,e){return t.pos-e.pos})),t.points,t.properties.lineOption),e&&e.onModelItemChanged(t.key,t.rectangle)}},n.prototype.hideOutdatedSelection=function(t){var e=this;Object.keys(this.selectionMap).filter((function(e){return!t[e]})).forEach((function(t){e.selectionMap[t].destroy(),delete e.selectionMap[t]}))},n.prototype.selectionCanBeDrawn=function(t){return!t.container||t.container.expanded&&this.selectionCanBeDrawn(t.container)},n.prototype.notifySelectionChanged=function(t){var e=this,n=t.getSelectedItems(!0).filter((function(t){return e.selectionCanBeDrawn(t)})),o={},i=n.length>1,r=t.getSelectedShapes(!0).filter((function(t){return e.selectionCanBeDrawn(t)})),a=t.getSelectedConnectors(!0).filter((function(t){return e.selectionCanBeDrawn(t)}));if(r.forEach((function(t){return e.getOrCreateShapeSelection(t,o).onSelectionChanged(i)})),a.forEach((function(t){return e.getOrCreateConnectorSelection(t,o).onSelectionChanged(i)})),i){var s=n.length>0?n[0].strokeWidth:0,c={};n.filter((function(t){return!t.isLocked})).forEach((function(t){return c[t.key]=t.rectangle})),this.getOrCreateMultipleSelection(o).onSelectionChanged(!!r.filter((function(t){return!t.isLocked})).length,s,c)}this.hideOutdatedSelection(o)},n.prototype.applyChangesCore=function(e){t.prototype.applyChangesCore.call(this,e);var n=this.getMultipleSelection();n&&n.onModelChanged()},n.prototype.applyChange=function(t){var e=this.getMultipleSelection();t.item instanceof h.Shape?this.updateShapeSelection(t.item,e):t.item instanceof d.Connector&&this.updateConnectorSelection(t.item,e)},n.prototype.notifyPageColorChanged=function(t){},n.prototype.notifyPageSizeChanged=function(t,e){},n.prototype.notifyActualZoomChanged=function(t){var e=this;Object.keys(this.selectionMap).forEach((function(n){return e.selectionMap[n].notifyZoomChanged(t)})),this.actualZoom=t},n.prototype.notifyViewAdjusted=function(t){},n.prototype.notifyReadOnlyChanged=function(t){var e=this;this.readOnly=t,Object.keys(this.selectionMap).forEach((function(n){return e.selectionMap[n].notifyReadOnlyChanged(t)}))},n.prototype.notifySelectionRectShow=function(t){this.showSelectionRect(t.clone().multiply(this.actualZoom,this.actualZoom))},n.prototype.notifySelectionRectHide=function(){this.hideSelectionRect()},n.prototype.notifyResizeInfoShow=function(t,e){this.showResizeInfo(t.clone().multiply(this.actualZoom,this.actualZoom),e)},n.prototype.notifyResizeInfoHide=function(){this.hideResizeInfo()},n.prototype.notifyConnectionPointsShow=function(t,e,o,i){var r=this;this.hideConnectionPoints(),e.forEach((function(e,a){var s=e.point.clone().multiply(r.actualZoom,r.actualZoom);if(i)switch(e.side){case c.ConnectionPointSide.North:s.y=i.y*r.actualZoom-n.connectionPointShift;break;case c.ConnectionPointSide.South:s.y=i.bottom*r.actualZoom+n.connectionPointShift;break;case c.ConnectionPointSide.West:s.x=i.x*r.actualZoom-n.connectionPointShift;break;case c.ConnectionPointSide.East:s.x=i.right*r.actualZoom+n.connectionPointShift;break}r.showConnectionPoint(a,s,t,a,a===o,e.allowed)}))},n.prototype.notifyConnectionPointsHide=function(){this.hideConnectionPoints()},n.prototype.notifyConnectionTargetShow=function(t,e){if(e.allowed){var o=n.correctSelectionRect(e.rect.clone().multiply(this.actualZoom,this.actualZoom),e.strokeWidth,n.connectionTargetBorderWidth,this.actualZoom,0);this.showConnectionTarget(0,o)}},n.prototype.notifyConnectionTargetHide=function(){this.hideConnectionTarget()},n.prototype.notifyContainerTargetShow=function(t,e){var o=n.correctSelectionRect(e.rect.clone().multiply(this.actualZoom,this.actualZoom),e.strokeWidth,n.connectionTargetBorderWidth,this.actualZoom,0);this.showContainerTarget(0,o)},n.prototype.notifyContainerTargetHide=function(){this.hideContainerTarget()},n.prototype.notifyExtensionLinesShow=function(t){var e=this;this.hideExtensionLines(),t.forEach((function(t,n){e.showExtensionLine(n,t.type,t.segment.startPoint.clone().multiply(e.actualZoom,e.actualZoom),t.segment.endPoint.clone().multiply(e.actualZoom,e.actualZoom),t.text)}))},n.prototype.notifyExtensionLinesHide=function(){this.hideExtensionLines()},n.prototype.notifyDragStart=function(t){this.dom.changeByFunc(this.selectionMarksContainer,(function(t){return t.style.display="none"}))},n.prototype.notifyDragEnd=function(t){this.dom.changeByFunc(this.selectionMarksContainer,(function(t){return t.style.display=""}))},n.prototype.notifyDragScrollStart=function(){},n.prototype.notifyDragScrollEnd=function(){},n.prototype.notifyTextInputStart=function(t,e,n,o){this.dom.changeByFunc(this.visualizersContainer,(function(t){return t.style.display="none"}))},n.prototype.notifyTextInputEnd=function(t){this.dom.changeByFunc(this.visualizersContainer,(function(t){return t.style.display=""}))},n.prototype.notifyTextInputPermissionsCheck=function(t,e){},n.correctSelectionRect=function(t,e,o,i,r){void 0===r&&(r=n.selectionOffset);var a=_.UnitConverter.twipsToPixels(e)%2!==_.UnitConverter.twipsToPixels(o)%2,s=Math.ceil(e/2*i);t=t.clone().inflate(s,s);var c=Math.floor(o/2);if(t.x-=c,t.y-=c,t.width+=o,t.height+=o,a){var u=n.evenOddSelectionCorrection*(_.UnitConverter.twipsToPixels(o)%2===1?-1:1);t=t.clone().moveRectangle(u,u)}return t.clone().inflate(r,r)},n.selectionMarkSize=_.UnitConverter.pixelsToTwips(10),n.lockedSelectionMarkSize=_.UnitConverter.pixelsToTwips(8),n.selectionOffset=_.UnitConverter.pixelsToTwips(2),n.selectionRectLineWidth=_.UnitConverter.pixelsToTwips(1),n.multiSelectionRectLineWidth=_.UnitConverter.pixelsToTwips(1),n.connectionPointSmallSize=_.UnitConverter.pixelsToTwips(5),n.connectionPointLargeSize=_.UnitConverter.pixelsToTwips(12),n.connectionPointShift=_.UnitConverter.pixelsToTwips(16),n.connectionTargetBorderWidth=_.UnitConverter.pixelsToTwips(2),n.geomertyMarkSize=_.UnitConverter.pixelsToTwips(8),n.connectorPointMarkSize=_.UnitConverter.pixelsToTwips(6),n.connectorSideMarkSize=_.UnitConverter.pixelsToTwips(6),n.extensionLineWidth=_.UnitConverter.pixelsToTwips(1),n.extensionLineOffset=_.UnitConverter.pixelsToTwips(1),n.extensionLineEndingSize=_.UnitConverter.pixelsToTwips(6),n.resizeInfoOffset=_.UnitConverter.pixelsToTwips(16),n.resizeInfoTextOffset=_.UnitConverter.pixelsToTwips(2),n.resizeInfoLineWidth=_.UnitConverter.pixelsToTwips(1),n.evenOddSelectionCorrection=_.UnitConverter.pixelsToTwips(1),n}(w.CanvasManager);e.CanvasSelectionManager=T;var O=function(){function t(t,e,n,o,i,r){this.rectsContainer=t,this.marksContainer=e,this.key=n,this.zoomLevel=o,this.readOnly=i,this.dom=r,this.elements={},this.updatedElements={}}return t.prototype.notifyZoomChanged=function(t){this.zoomLevel!==t&&(this.zoomLevel=t,this.redraw())},t.prototype.notifyReadOnlyChanged=function(t){this.readOnly=t,this.redraw()},t.prototype.destroy=function(){var t=this;Object.keys(this.elements).forEach((function(e){t.elements[e].parentNode.removeChild(t.elements[e]),delete t.elements[e]}))},t.prototype.redraw=function(){var t=this;this.updatedElements={},this.redrawCore(),Object.keys(this.elements).filter((function(e){return!t.updatedElements[e]})).forEach((function(e){t.elements[e].parentNode.removeChild(t.elements[e]),delete t.elements[e]})),this.updatedElements={}},t.prototype.drawSelectionMarks=function(t,n,o){if(!this.readOnly){var i=n&&t.height>3*T.selectionMarkSize,r=o&&t.width>3*T.selectionMarkSize,a=n||o;a&&this.drawSelectionMark(0,new l.Point(t.x,t.y),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_NW,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),r&&!S.Browser.TouchUI&&this.drawSelectionMark(1,new l.Point(t.x+t.width/2,t.y),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_N,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),a&&this.drawSelectionMark(2,new l.Point(t.right,t.y),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_NE,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),i&&!S.Browser.TouchUI&&this.drawSelectionMark(3,new l.Point(t.right,t.y+t.height/2),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_E,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),a&&this.drawSelectionMark(4,new l.Point(t.right,t.bottom),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_SE,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),r&&!S.Browser.TouchUI&&this.drawSelectionMark(5,new l.Point(t.x+t.width/2,t.bottom),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_S,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),a&&this.drawSelectionMark(6,new l.Point(t.x,t.bottom),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_SW,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK),i&&!S.Browser.TouchUI&&this.drawSelectionMark(7,new l.Point(t.x,t.y+t.height/2),T.selectionMarkSize,s.MouseEventElementType.ShapeResizeBox,s.ResizeEventSource.ResizeBox_W,e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK)}},t.prototype.drawSelectionMark=function(t,e,n,o,i,r){var s=this;this.getOrCreateElement("SM"+t,new m.RectanglePrimitive(e.x-n/2,e.y-n/2,n,n,null,r,void 0,(function(t){a.RenderUtils.setElementEventData(t,o,s.key,i)})),this.marksContainer)},t.prototype.drawSelectionRect=function(t,e,n){var o=new m.RectanglePrimitive(t.x,t.y,t.width,t.height,C.StrokeStyle.default1pxInstance,n,void 0,(function(t){a.RenderUtils.setElementEventData(t,e,"-1",-1)}));this.getOrCreateElement("shapeSelection",o,this.rectsContainer)},t.prototype.getOrCreateElement=function(t,e,n){var o=this.elements[t];return o||(o=e.createElement(),this.elements[t]=o,n.appendChild(o)),this.updatedElements[t]=!0,this.dom.changeByPrimitive(o,e),o},t}(),E=function(t){function e(e,n,o,i,r,a,s,c){var u=t.call(this,e,n,o,i,r,a)||this;return u.isLocked=s,u.rectangle=c,u}return o(e,t),e.prototype.onSelectionChanged=function(t){this.isMultipleSelection!==t&&(this.isMultipleSelection=t,this.redraw())},e.prototype.isLockedRender=function(){return this.isLocked&&!this.readOnly},e.prototype.drawLockedSelectionMark=function(t,e,n,o){var i=new g.PathPrimitive([new g.PathPrimitiveMoveToCommand(e.x-n/2,e.y-n/2),new g.PathPrimitiveLineToCommand(e.x+n/2,e.y+n/2),new g.PathPrimitiveMoveToCommand(e.x+n/2,e.y-n/2),new g.PathPrimitiveLineToCommand(e.x-n/2,e.y+n/2)],null,o);this.getOrCreateElement("LSM"+t,i,this.marksContainer)},e}(O),M=function(t){function n(e,n,o,i,r){var a=t.call(this,e,n,"-1",o,i,r)||this;return a.rectangles={},a}return o(n,t),n.prototype.onModelItemChanged=function(t,e){t in this.rectangles&&(this.rectangles[t]=e)},n.prototype.onModelChanged=function(){this.redraw()},n.prototype.onSelectionChanged=function(t,e,n){this.needDrawSelectionMarks=t,this.strokeWidth=e,this.rectangles=n,this.redraw()},n.prototype.redrawCore=function(){var t=this,n=Object.keys(this.rectangles);if(n.length){var o=u.GeometryUtils.getCommonRectangle(n.map((function(e){return t.rectangles[e]}))).clone().multiply(this.zoomLevel,this.zoomLevel),i=T.correctSelectionRect(o,this.strokeWidth,T.selectionRectLineWidth,this.zoomLevel);this.drawSelectionRect(i,s.MouseEventElementType.SelectionRect,e.SELECTION_ELEMENT_CLASSNAMES.ITEMS_SELECTION_RECT),this.needDrawSelectionMarks&&this.drawSelectionMarks(o,!0,!0)}},n}(O),D=function(t){function n(e,n,o,i,r,a,s,c,u,l,p,h){var d=t.call(this,e,n,a,o,i,r,s,c)||this;return d.style=u,d.allowResizeHorizontally=l,d.allowResizeVertically=p,d.shapeParameterPoints=h,d}return o(n,t),n.prototype.onModelChanged=function(t,e,n,o,i,r){this.isLocked=t,this.rectangle=e,this.style=n,this.allowResizeHorizontally=o,this.allowResizeVertically=i,this.shapeParameterPoints=r,this.redraw()},n.prototype.redrawCore=function(){var t=this.rectangle.clone().multiply(this.zoomLevel,this.zoomLevel);this.isLockedRender()?this.drawLockedSelection(t):this.drawUnlockedSelection(t)},n.prototype.drawLockedSelection=function(t){this.drawLockedSelectionMark(0,new l.Point(t.x,t.y),T.lockedSelectionMarkSize,e.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK),this.drawLockedSelectionMark(1,new l.Point(t.right,t.y),T.lockedSelectionMarkSize,e.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK),this.drawLockedSelectionMark(2,new l.Point(t.right,t.bottom),T.lockedSelectionMarkSize,e.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK),this.drawLockedSelectionMark(3,new l.Point(t.x,t.bottom),T.lockedSelectionMarkSize,e.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK)},n.prototype.drawUnlockedSelection=function(t){var n=T.correctSelectionRect(t,this.style.strokeWidth,T.selectionRectLineWidth,this.zoomLevel);this.drawSelectionRect(n,s.MouseEventElementType.SelectionRect,this.isMultipleSelection?e.SELECTION_ELEMENT_CLASSNAMES.ITEM_MULTI_SELECTION:e.SELECTION_ELEMENT_CLASSNAMES.ITEM_SELECTION_RECT),this.isMultipleSelection||this.drawSelectionMarks(t,this.allowResizeHorizontally,this.allowResizeVertically),this.drawShapeParameterPoints()},n.prototype.drawShapeParameterPoints=function(){var t=this;this.readOnly||this.shapeParameterPoints.forEach((function(e,n){var o=e.point.clone().multiply(t.zoomLevel,t.zoomLevel);t.drawShapeParameterPoint(o,n,e.key)}))},n.prototype.drawShapeParameterPoint=function(t,e,n){var o=this,i=T.geomertyMarkSize,r=new m.RectanglePrimitive(t.x-i/2,t.y-i/2,i,i,null,"geometry-mark",void 0,(function(t){a.RenderUtils.setElementEventData(t,s.MouseEventElementType.ShapeParameterBox,o.key,n)}));this.getOrCreateElement("pp"+e.toString(),r,this.marksContainer)},n}(E),A=function(t){function n(e,n,o,i,r,a,s,c,u,l,p,h,d,f,m){var g=t.call(this,e,n,a,o,i,r,s,c)||this;return g.renderPoints=u,g.style=l,g.styleText=p,g.enableText=h,g.texts=d,g.points=f,g.lineType=m,g}return o(n,t),n.prototype.onModelChanged=function(t,e,n,o,i,r,a,s,c){this.isLocked=t,this.rectangle=e,this.renderPoints=n,this.style=o,this.styleText=i,this.enableText=r,this.texts=a,this.points=s,this.lineType=c,this.redraw()},n.prototype.redrawCore=function(){this.isLockedRender()?this.drawLockedSelection():this.drawUnlockedSelection()},n.prototype.drawLockedSelection=function(){var t=this;this.renderPoints.forEach((function(n,o){t.drawLockedSelectionMark(o,n,T.lockedSelectionMarkSize,e.SELECTION_ELEMENT_CLASSNAMES.LOCKED_SELECTION_MARK)}))},n.prototype.drawUnlockedSelection=function(){this.drawConnectorSelection(this.isMultipleSelection?e.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_MULTI_SELECTION:e.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_SELECTION),this.isMultipleSelection||this.readOnly||this.drawConnectorSelectionMarks()},n.prototype.drawConnectorSelection=function(t){for(var e,n,o,i,r,a,s,c=this.texts,u=0,l=this.styleText.getAlignment(),p=[],h=[],d=this.renderPoints,f=this.zoomLevel,m=d[0],y=1,v=void 0;v=d[y];y++){var _=d[y+1];void 0===i&&(e=this.getSelectionOffsetPoints(m,v),i=e[0],r=e[1]),_&&(n=this.getSelectionOffsetPoints(v,_),a=n[0],s=n[1]);var P=i.x,S=i.y,b=-i.x,x=-i.y,w=a&&a.x,I=a&&a.y,O=a&&-a.x,E=a&&-a.y;this.style.strokeWidthPx%2===0&&(b>0?b-=T.evenOddSelectionCorrection:P>0&&(P-=T.evenOddSelectionCorrection),x>0?x-=T.evenOddSelectionCorrection:S>0&&(S-=T.evenOddSelectionCorrection),O>0?O-=T.evenOddSelectionCorrection:w>0&&(w-=T.evenOddSelectionCorrection),E>0?E-=T.evenOddSelectionCorrection:I>0&&(I-=T.evenOddSelectionCorrection));while(c[u]&&c[u].pointIndex<=y){var M=c[u],D=(v.x-m.x)/r,A=(v.y-m.y)/r,k=this.getTextStartEndPoints(A,D,M.point,M.text,l);c[u].pointIndex<y?(m=k[1],p.push(g.PathPrimitiveMoveToCommand.fromPoint(m.clone().offset(P,S).multiply(f,f))),h.push(g.PathPrimitiveLineToCommand.fromPoint(m.clone().offset(b,x).multiply(f,f)))):(p.length||(p.push(g.PathPrimitiveMoveToCommand.fromPoint(m.clone().offset(P,S).multiply(f,f))),h.push(g.PathPrimitiveLineToCommand.fromPoint(m.clone().offset(b,x).multiply(f,f)))),p.push(g.PathPrimitiveLineToCommand.fromPoint(k[0].clone().offset(P,S).multiply(f,f))),p.push(g.PathPrimitiveMoveToCommand.fromPoint(k[1].clone().offset(P,S).multiply(f,f))),h.push(g.PathPrimitiveMoveToCommand.fromPoint(k[0].clone().offset(b,x).multiply(f,f))),h.push(g.PathPrimitiveLineToCommand.fromPoint(k[1].clone().offset(b,x).multiply(f,f))),m=k[1]),u++}if(p.length||(p.push(g.PathPrimitiveMoveToCommand.fromPoint(m.clone().offset(P,S).multiply(f,f))),h.push(g.PathPrimitiveLineToCommand.fromPoint(m.clone().offset(b,x).multiply(f,f)))),_){var L=v.y-m.y,R=m.x-v.x,z=L*(m.x+P)+R*(m.y+S),N=L*(m.x+b)+R*(m.y+x),j=_.y-v.y,U=v.x-_.x,B=j*(v.x+w)+U*(v.y+I),H=j*(v.x+O)+U*(v.y+E),V=L*U-j*R;0!==V&&(p.push(new g.PathPrimitiveLineToCommand(f*(U*z-R*B)/V,f*(L*B-j*z)/V)),h.push(new g.PathPrimitiveLineToCommand(f*(U*N-R*H)/V,f*(L*H-j*N)/V))),o=[a,s],i=o[0],r=o[1]}else p.push(g.PathPrimitiveLineToCommand.fromPoint(v.clone().offset(P,S).multiply(f,f))),h.push(g.PathPrimitiveMoveToCommand.fromPoint(v.clone().offset(b,x).multiply(f,f)));m=v}var F=new g.PathPrimitive(p.concat(h.reverse()),C.StrokeStyle.default1pxInstance,t);this.getOrCreateElement("CS",F,this.rectsContainer)},n.prototype.getSelectionOffset=function(){return T.selectionOffset+_.UnitConverter.pixelsToTwips(Math.round(this.style.strokeWidthPx/2)+(this.style.strokeWidthPx+1)%2)},n.prototype.getSelectionOffsetPoints=function(t,e){var n=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));return[new l.Point(this.getSelectionOffset()/n*(t.y-e.y),this.getSelectionOffset()/n*(e.x-t.x)),n]},n.prototype.getTextStartEndPoints=function(t,e,n,o,i){var r=this.dom.measurer.measureTextLine(o,this.styleText,P.TextOwner.Connector).applyConverter(_.UnitConverter.pixelsToTwips).clone().offset(this.getSelectionOffset(),this.getSelectionOffset()).nonNegativeSize(),a=r.width*e+r.height*t;switch(i){case C.TextAlignment.Left:return[n,new l.Point(n.x+e*a,n.y+t*a)];case C.TextAlignment.Right:return[new l.Point(n.x-e*a,n.y-t*a),n];default:return[new l.Point(n.x-.5*e*a,n.y-.5*t*a),new l.Point(n.x+.5*e*a,n.y+.5*t*a)]}},n.prototype.drawConnectorSelectionMarks=function(){var t=this,n=this.points.length-1;this.points.forEach((function(o,i){var r=0===i||i===n,a=r?e.SELECTION_ELEMENT_CLASSNAMES.SELECTION_MARK:e.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_POINT_MARK,c=r?T.selectionMarkSize:T.connectorPointMarkSize;r||t.lineType===f.ConnectorLineOption.Straight?t.drawSelectionMark(i,o.clone().multiply(t.zoomLevel,t.zoomLevel),c,s.MouseEventElementType.ConnectorPoint,i,a):t.drawSelectionMark(i,o.clone().multiply(t.zoomLevel,t.zoomLevel),c,s.MouseEventElementType.Undefined,-1,a+" disabled")})),this.drawConnectorSideMarks()},n.prototype.drawConnectorSideMarks=function(){var t,n,o=this,i=this.lineType===f.ConnectorLineOption.Straight?s.MouseEventElementType.ConnectorSide:s.MouseEventElementType.ConnectorOrthogonalSide;this.renderPoints.filter((function(t){return!t.skipped})).forEach((function(r,a){if(!r.skipped){if(void 0!==t&&o.canDrawConnectorSideMark(r,t)){var s=o.lineType===f.ConnectorLineOption.Orthogonal?r.x-t.x===0?"vertical":"horizontal":"";o.drawSelectionMark(o.points.length+a-1,new l.Point(t.x+(r.x-t.x)/2,t.y+(r.y-t.y)/2).clone().multiply(o.zoomLevel,o.zoomLevel),T.connectorSideMarkSize,i,n+"_"+a,e.SELECTION_ELEMENT_CLASSNAMES.CONNECTOR_SIDE_MARK+" "+s)}t=r,n=a}}))},n.prototype.canDrawConnectorSideMark=function(t,e){if(this.lineType===f.ConnectorLineOption.Straight){var n=T.selectionMarkSize+T.connectorSideMarkSize;return u.GeometryUtils.getDistance(t,e)>n}return this.lineType===f.ConnectorLineOption.Orthogonal&&((t.x-e.x===0||Math.abs(t.x-e.x)>d.Connector.minOffset)&&(t.y-e.y===0||Math.abs(t.y-e.y)>d.Connector.minOffset))},n}(E)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramDraggingEvent=e.ToolboxDraggingObject=e.Toolbox=void 0;var o,i=n(3),r=n(1),a=n(79),s=n(44),c=n(26),u=n(104),l=n(19),p=n(15),h=n(74),d="dxdi-toolbox",f="dxdi-tb-drag-captured",m=800,g=function(){function t(t,e,n,r,a,s){this.readOnly=e,this.allowDragging=n,this.shapeDescriptionManager=r,this.shapeTypes=a,this.getAllowedShapeTypes=s,this.dragPrepareTimeout=-1,this.dragState=o.None,this.emulateDragEvents=l.Browser.WebKitTouchUI||l.Browser.AndroidMobilePlatform,this.onDragOperation=new i.EventDispatcher,this.onClickOperation=new i.EventDispatcher,t&&(this.mainElement=this.createMainElement(t),this.attachHandlers(this.mainElement))}return t.prototype.clean=function(t){this.detachHandlers(this.mainElement),t&&t(this.mainElement)},t.prototype.createMainElement=function(t){var e=document.createElement("div");return e.setAttribute("class",d),e.draggable=!0,this.emulateDragEvents&&(e.tabIndex=0),t.appendChild(e),e},t.prototype.attachHandlers=function(t){this.onElementMouseDownHandler=this.onElementMouseDown.bind(this),this.onElementMouseUpHandler=this.onElementMouseUp.bind(this),this.onMouseDownHandler=this.onMouseDown.bind(this),this.onMouseMoveHandler=this.onMouseMove.bind(this),this.onMouseUpHandler=this.onMouseUp.bind(this),this.onDragStartHandler=this.onDragStart.bind(this),this.onTouchMoveHandler=this.onTouchMove.bind(this),this.emulateDragEvents&&(this.onSelectionChangeHandler=this.onSelectionChange.bind(this)),this.emulateDragEvents||p.RenderHelper.addEventListener(t,"dragstart",this.onDragStartHandler),p.RenderHelper.addEventListener(t,"touchmove",this.onTouchMoveHandler),p.RenderHelper.addEventListener(t,u.TouchUtils.touchMouseDownEventName,this.onElementMouseDownHandler),p.RenderHelper.addEventListener(t,u.TouchUtils.touchMouseUpEventName,this.onElementMouseUpHandler),p.RenderHelper.addEventListener(t,u.TouchUtils.touchMouseDownEventName,this.onMouseDownHandler),p.RenderHelper.addEventListener(document,u.TouchUtils.touchMouseMoveEventName,this.onMouseMoveHandler),p.RenderHelper.addEventListener(document,u.TouchUtils.touchMouseUpEventName,this.onMouseUpHandler),this.emulateDragEvents&&p.RenderHelper.addEventListener(document,"selectionchange",this.onSelectionChangeHandler)},t.prototype.detachHandlers=function(t){this.emulateDragEvents||p.RenderHelper.removeEventListener(t,"dragstart",this.onDragStartHandler),p.RenderHelper.removeEventListener(t,"touchmove",this.onTouchMoveHandler),p.RenderHelper.removeEventListener(t,u.TouchUtils.touchMouseDownEventName,this.onElementMouseDownHandler),p.RenderHelper.removeEventListener(t,u.TouchUtils.touchMouseUpEventName,this.onElementMouseUpHandler),p.RenderHelper.removeEventListener(t,u.TouchUtils.touchMouseDownEventName,this.onMouseDownHandler),p.RenderHelper.removeEventListener(document,u.TouchUtils.touchMouseMoveEventName,this.onMouseMoveHandler),p.RenderHelper.removeEventListener(document,u.TouchUtils.touchMouseUpEventName,this.onMouseUpHandler),this.emulateDragEvents&&p.RenderHelper.removeEventListener(document,"selectionchange",this.onSelectionChangeHandler)},t.prototype.render=function(t){this.mainElement.childNodes&&(this.mainElement.innerHTML="");var e=this.shapeTypes;return e=this.getAllowedShapeTypes?this.getAllowedShapeTypes(e):e,e=t?e.filter(t):e,e.length&&this.createElements(this.mainElement,e),!!e.length},t.prototype.createDraggingObject=function(t){var e=new v;return e.data=t,e.onFinishDragging=this.resetDragState.bind(this),e.onCaptured=this.capture.bind(this),new y(e)},t.prototype.getDragShapeType=function(t){while(t&&!c.DomUtils.hasClassName(t,d)){if(t.getAttribute&&t.getAttribute("data-tb-type"))return t.getAttribute("data-tb-type");t=t.parentNode}},t.prototype.onElementMouseDown=function(t){this.mouseDownShapeType=this.getDragShapeType(a.EvtUtils.getEventSource(t))},t.prototype.onElementMouseUp=function(t){var e=this.getDragShapeType(a.EvtUtils.getEventSource(t));e&&e===this.mouseDownShapeType&&this.onClickOperation.raise("notifyToolboxClick",e),this.mouseDownShapeType=void 0},t.prototype.onMouseDown=function(t){this.setDragState(o.Prepare,t)},t.prototype.onDragStart=function(t){this.setDragState(o.Start,t),t.preventDefault()},t.prototype.onTouchMove=function(t){this.draggingObject&&t.preventDefault()},t.prototype.onSelectionChange=function(){},t.prototype.onMouseMove=function(t){this.setDragState(a.EvtUtils.isLeftButtonPressed(t)?o.Dragging:o.None,t)},t.prototype.onMouseUp=function(t){this.setDragState(o.None,t)},t.prototype.updateDraggingElementPosition=function(t,e){var n=this.draggingObject.element,o=t-n.offsetWidth/2,i=e-n.offsetHeight/2;s.SetAbsoluteX(n,o),s.SetAbsoluteY(n,i)},t.prototype.setDragState=function(t,e){if(!this.readOnly&&this.allowDragging&&(t!==o.None||t!==this.dragState)&&(this.dragPrepareTimeout>-1&&(clearTimeout(this.dragPrepareTimeout),this.dragPrepareTimeout=-1),!(t-this.dragState>1||t!==o.None&&t<this.dragState)))switch(this.dragState=t,t){case o.Prepare:this.prepareDragging(e)||this.setDragState(o.None,e),this.emulateDragEvents&&(this.dragPrepareTimeout=setTimeout(this.onDragPrepareTimeout.bind(this),m));break;case o.Start:c.DomUtils.addClassName(document.body,"dxdi-dragging"),this.startDragging();break;case o.Dragging:this.doDragging(e);break;case o.None:this.finishDragging();break}},t.prototype.resetDragState=function(t){this.setDragState(o.None,t)},t.prototype.onDragPrepareTimeout=function(){this.dragPrepareTimeout=-1,this.dragState===o.Prepare&&this.setDragState(o.Start,null)},t.prototype.prepareDragging=function(t){return this.dragStartPoint=new r.Point(a.EvtUtils.getEventX(t),a.EvtUtils.getEventY(t)),this.dragStartShapeType=this.getDragShapeType(a.EvtUtils.getEventSource(t)),this.emulateDragEvents&&this.mainElement.focus(),!!this.dragStartShapeType},t.prototype.startDragging=function(){this.draggingObject=this.createDraggingObject(this.dragStartShapeType),this.dragStartShapeType?(this.raiseDragStart(),this.draggingObject.element=this.createDraggingElement(this.draggingObject),void 0!==this.draggingObject.captured&&this.capture(this.draggingObject.captured,!0),this.updateDraggingElementPosition(this.dragStartPoint.x,this.dragStartPoint.y)):c.DomUtils.addClassName(document.body,h.NOT_VALID_CSSCLASS)},t.prototype.doDragging=function(t){this.draggingObject.element&&this.updateDraggingElementPosition(a.EvtUtils.getEventX(t),a.EvtUtils.getEventY(t))},t.prototype.finishDragging=function(){if(this.draggingObject){this.raiseDragEnd();var t=this.draggingObject.element;t&&t.parentNode.removeChild(t),delete this.draggingObject}this.dragStartPoint=void 0,this.dragStartShapeType=void 0,c.DomUtils.removeClassName(document.body,h.NOT_VALID_CSSCLASS),setTimeout((function(){return c.DomUtils.removeClassName(document.body,"dxdi-dragging")}),500)},t.prototype.capture=function(t,e){this.draggingObject&&(this.draggingObject.captured!==t||e)&&(this.draggingObject.captured=t,this.draggingObject.element&&c.DomUtils.toggleClassName(this.draggingObject.element,f,t))},t.prototype.raiseDragStart=function(){this.onDragOperation.raise("notifyToolboxDragStart")},t.prototype.raiseDragEnd=function(){this.onDragOperation.raise("notifyToolboxDragEnd")},t.prototype.notifyReadOnlyChanged=function(t){this.readOnly=t},t}();e.Toolbox=g,function(t){t[t["None"]=-1]="None",t[t["Prepare"]=0]="Prepare",t[t["Start"]=1]="Start",t[t["Dragging"]=2]="Dragging"}(o||(o={}));var y=function(){function t(t){this.evt=t}return t}();e.ToolboxDraggingObject=y;var v=function(){function t(){}return t}();e.DiagramDraggingEvent=v},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteCommand=void 0;var i=n(9),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.control.selection.getSelectedItems();return t.prototype.isEnabled.call(this)&&e.length&&(e.length>1||this.permissionsProvider.canDeleteItems(e))},e.prototype.executeCore=function(t){return this.permissionsProvider.beginDeleteItems(this.control.selection.getSelectedItems()),i.ModelUtils.deleteSelection(this.control.history,this.control.model,this.control.selection),this.permissionsProvider.endDeleteItems(),!0},Object.defineProperty(e.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),e}(r.SimpleCommandBase);e.DeleteCommand=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Flag=void 0;var o=function(){function t(t){void 0===t&&(t=0),this.value=t}return t.prototype.get=function(t){return(this.value&t)===t},t.prototype.set=function(t,e){var n=(this.value&t)===t;return n!==e&&(e?this.value|=t:this.value^=t),this},t.prototype.add=function(t){this.value|=t},t.prototype.anyOf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0,o=t;n<o.length;n++){var i=o[n];if((this.value&i)===i)return!0}return!1},t.prototype.getValue=function(){return this.value},t.prototype.clone=function(){return new t(this.value)},t}();e.Flag=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IntervalAlgorithms=void 0;var o=n(81),i=n(39),r=n(106),a=n(170),s=function(){function t(){}return t.oneConstainsOtherArraysOfInterval=function(t,e){var n=o.ListUtils.deepCopy(e),i=n.pop();while(i){if(!o.ListUtils.unsafeAnyOf(t,(function(t){return t.containsInterval(i)})))return!1;i=n.pop()}return!0},t.getIntersection=function(e,n){return t.getIntersectionTemplate(e,n,e)},t.getIntersectionTemplate=function(t,e,n){var o=Math.max(t.start,e.start),i=Math.min(t.end,e.end);return o>i?null:n.makeByStartEnd(o,i)},t.getIntersectionNonNullLength=function(e,n){return t.getIntersectionNonNullLengthTemplate(e,n,e)},t.getIntersectionNonNullLengthTemplate=function(e,n,o){var i=t.getIntersectionTemplate(e,n,o);return i&&i.length?i:null},t.getIntersectionsTwoArraysOfInterval=function(e,n){return t.getIntersectionsTwoArraysOfIntervalTemplate(e,n,e[0])},t.getIntersectionsTwoArraysOfIntervalTemplate=function(e,n,o){var i=[],r=e.length,a=n.length,s=0,c=0,u=e[s],l=n[c],p=null;while(s<r&&c<a){var h=t.getIntersectionTemplate(u,l,o);h&&(p&&p.end===h.start?p.length+=h.length:(p=h,i.push(p))),u.end<l.end?(s++,u=e[s]):(c++,l=n[c])}return i},t.getAffectedObjects=function(e,n,o,r){return void 0===o&&(o=function(t){return i.SearchUtils.normedInterpolationIndexOf(e,(function(t){return t.interval.start}),t)}),void 0===r&&(r=function(t,e,n){return t.start===n&&0===e}),t.getAffectedObjectsTemplate(e,n,n[0],o,r)},t.getAffectedObjectsTemplate=function(e,n,o,r,s){void 0===r&&(r=function(t){return i.SearchUtils.normedInterpolationIndexOf(e,(function(t){return t.interval.start}),t)}),void 0===s&&(s=function(t,e,n){return t.start===n&&0===e});for(var c=new a.SparseIntervalsCollector(o),u=0,l=n;u<l.length;u++)for(var p=l[u],h=Math.max(0,r(p.start,e)),d=void 0;d=e[h];h++){var f=d.interval;if(f.start>p.end)break;var m=t.getIntersectionTemplate(f,p,o);m&&(m.length||s(f,p.length,m.start))&&c.add(h)}return c.getIntervals()},t.handleAffectedObjects=function(e,n,o,a){void 0===a&&(a=function(t){return i.SearchUtils.normedInterpolationIndexOf(e,(function(t){return t.interval.start}),t)});for(var s=new r.FixedInterval(0,0),c=0,u=n;c<u.length;c++)for(var l=u[c],p=Math.max(0,a(l.start,e)),h=void 0;h=e[p];p++){var d=h.interval;if(d.start>l.end)break;var f=t.getIntersectionTemplate(d,l,s);f&&o(h,p,l,f)}},t.getMergedIntervals=function(e,n){return t.getMergedIntervalsTemplate(e,n,e[0])},t.getMergedIntervalsTemplate=function(t,e,n){if(t.length<2)return t.length>0?[n.makeByStartLength(t[0].start,t[0].length)]:[];for(var o=e?[].concat(t).sort((function(t,e){return t.start-e.start})):t,i=[],r=0,a=void 0;a=o[r];){var s=a.start,c=a.end;for(++r;void 0!==(a=o[r])&&a.start<=c;r++)a.end>c&&(c=a.end);i.push(n.makeByStartEnd(s,c))}return i},t.reflectIntervals=function(e,n){return t.reflectIntervalsTemplate(e,n,n)},t.reflectIntervalsTemplate=function(e,n,i){if(!e.length)return[i.makeByStartLength(n.start,n.length)];var r=o.ListUtils.last(e).end,a=o.ListUtils.reducedMap(e,(function(o,r){return t.getIntersectionNonNullLengthTemplate(i.makeByStartEnd(e[r-1].end,o.start),n,i)}),1);return n.start<e[0].start&&a.unshift(i.makeByStartEnd(n.start,e[0].start)),n.end>r&&a.push(i.makeByStartEnd(r,n.end)),a},t.reflectionOfPointOnInterval=function(t,e,n){return(t-e.start)/e.length*n.length+n.start},t}();e.IntervalAlgorithms=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedMinMax=e.ExtendedMax=e.ExtendedMin=e.MinMaxNumber=e.MinMax=void 0;var o=n(55),i=function(){function t(t,e){this.minElement=t,this.maxElement=e}return t}();e.MinMax=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this.maxElement-this.minElement},enumerable:!1,configurable:!0}),e}(i);e.MinMaxNumber=r;var a=function(){function t(t,e){this.minElement=t,this.minValue=e}return t}();e.ExtendedMin=a;var s=function(){function t(t,e){this.maxElement=t,this.maxValue=e}return t}();e.ExtendedMax=s;var c=function(t){function e(e,n,o,i){var r=t.call(this,e,o)||this;return r.minValue=n,r.maxValue=i,r}return o.__extends(e,t),e}(i);e.ExtendedMinMax=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Equals=e.Comparers=void 0;var o=function(){function t(){}return t.number=function(t,e){return t-e},t.string=function(t,e){return t===e?0:t>e?1:-1},t.stringIgnoreCase=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),t===e?0:t>e?1:-1},t}();e.Comparers=o;var i=function(){function t(){}return t.simpleType=function(t,e){return t===e},t.object=function(t,e){return t&&e&&(t===e||t.equals(e))},t}();e.Equals=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MutableInterval=void 0;var o=n(55),i=n(169),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.__extends(e,t),e.prototype.normalizeLength=function(){return this.length<0&&(this.length=0),this},e}(i.ConstInterval);e.MutableInterval=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConstInterval=void 0;var o=function(){function t(){}return Object.defineProperty(t.prototype,"center",{get:function(){return this.start+this.length/2},enumerable:!1,configurable:!0}),t.prototype.isNormalized=function(){return this.end>=this.start},t.prototype.isCollapsed=function(){return 0===this.length},t.prototype.equals=function(t){return this.start===t.start&&this.end===t.end},t.isCollapsed=function(t){return!t[1]&&t[0].isCollapsed()},t.prototype.containsInterval=function(t){return this.start<=t.start&&this.end>=t.end},t.prototype.containsIntervalWithoutEnd=function(t){return this.start<=t.start&&this.end>t.end},t.prototype.contains=function(t){return this.start<=t&&t<this.end},t.prototype.containsWithIntervalEnd=function(t){return this.start<=t&&t<=this.end},t.prototype.containsWithoutIntervalEndAndStart=function(t){return this.start<t&&t<this.end},t}();e.ConstInterval=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SparseIntervalsCollector=void 0;var o=n(171),i=function(){function t(t){this.intervals=[],this.template=t}return t.prototype.add=function(t){this.curr&&this.curr.end===t?this.curr.length++:(this.curr=this.template.makeByStartLength(t,1),this.intervals.push(this.curr))},t.prototype.getIntervals=function(){return new o.SparseIntervals(this.intervals)},t}();e.SparseIntervalsCollector=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SparseIntervals=void 0;var o=n(107),i=n(172),r=function(){function t(t){void 0===t&&(t=[]),this.list=t,this._count=0,this._numIntervals=0;for(var e=0,n=t;e<n.length;e++){var o=n[e];this._count+=o.length,this._numIntervals++}}return Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numIntervals",{get:function(){return this._numIntervals},enumerable:!1,configurable:!0}),t.prototype.getInterval=function(t){return this.list[t]},t.prototype.getNativeIterator=function(){return new o.SparseIntervalsIterator(this)},t.prototype.getObjectsIterator=function(t){return new i.SparseObjectsIterator(this,t)},t}();e.SparseIntervals=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SparseObjectsIterator=void 0;var o=n(55),i=n(107),r=function(t){function e(e,n){var o=t.call(this,e)||this;return o.objects=n,o}return o.__extends(e,t),e.prototype.initObject=function(){this.obj=this.objects[this.index]},e}(i.SparseIntervalsIterator);e.SparseObjectsIterator=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TextFloodFilterPrimitive=e.TextFilterPrimitive=void 0;var i=n(15),r=n(109),a=n(32),s=n(23),c=function(t){function e(e,n,o,i,r){void 0===n&&(n="-0.05"),void 0===o&&(o="-0.05"),void 0===i&&(i="1.1"),void 0===r&&(r="1.1");var a=t.call(this,e,n,o,i,r)||this;return a.id=e,a.x=n,a.y=o,a.width=i,a.height=r,a}return o(e,t),e.prototype.createChildElements=function(t){var e=document.createElementNS(i.svgNS,"feFlood");t.appendChild(e);var n=document.createElementNS(i.svgNS,"feComposite");n.setAttribute("in","SourceGraphic"),n.setAttribute("operator","atop"),t.appendChild(n)},e}(r.FilterPrimitive);e.TextFilterPrimitive=c;var u=function(t){function e(e,n,o,i,r,a){void 0===o&&(o="-0.05"),void 0===i&&(i="-0.05"),void 0===r&&(r="1.1"),void 0===a&&(a="1.1");var s=t.call(this,e,o,i,r,a)||this;return s.id=e,s.floodColor=n,s.x=o,s.y=i,s.width=r,s.height=a,s}return o(e,t),e.prototype.applyChildrenProperties=function(t){for(var e=void 0,n=0;e=t.childNodes[n];n++)if(e.nodeName&&"FEFLOOD"===e.nodeName.toUpperCase()){this.prepareFEFloodNode(e);break}},e.prototype.prepareFEFloodNode=function(t){var e=s.ColorUtils.colorToHash(this.floodColor);t.setAttribute("flood-color",e),t.setAttribute("class","text-filter-flood"),this.floodColor!==a.DiagramModel.defaultPageColor?t.style.setProperty("flood-color",e):t.style.setProperty("flood-color","")},e}(c);e.TextFloodFilterPrimitive=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EncodeUtils=void 0;var o=function(){function t(){}return t.encodeHtml=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.decodeHtml=function(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},t.prepareTextForRequest=function(t){return t.replace(/%/g,"%25").replace(/&/g,"%26amp;").replace(/\+/g,"%2B").replace(/</g,"%26lt;").replace(/>/g,"%26gt;").replace(/"/g,"%26quot;")},t.prepareTextForCallBackRequest=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},t.decodeViaTextArea=function(t){var e=document.createElement("TEXTAREA");return e.innerHTML=t,e.value},t}();e.EncodeUtils=o},function(t,e,n){"use strict";n(176).polyfill()},function(t,e,n){"use strict";function o(t,e){if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),o=1;o<arguments.length;o++){var i=arguments[o];if(void 0!==i&&null!==i)for(var r=Object.keys(Object(i)),a=0,s=r.length;a<s;a++){var c=r[a],u=Object.getOwnPropertyDescriptor(i,c);void 0!==u&&u.enumerable&&(n[c]=i[c])}}return n}function i(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:o})}t.exports={assign:o,polyfill:i}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsCalculator=void 0;var i=n(113),r=n(30),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPoints=function(){return this.connector.points.map((function(t,e){return new r.ConnectorRenderPoint(t.x,t.y,e)}))},e}(i.ConnectorPointsCalculatorBase);e.ConnectorPointsCalculator=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalCalculator=void 0;var i=n(12),r=n(8),a=n(113),s=n(179),c=n(180),u=n(181),l=n(182),p=n(183),h=n(30),d=n(84),f=function(t){function e(e){var n=t.call(this,e)||this;return n.sideCalculators={},n.sideCalculators[r.ConnectionPointSide.Undefined]=new s.ConnectorPointsOrthogonalUndefinedSideCalculator(n),n.sideCalculators[r.ConnectionPointSide.South]=new c.ConnectorPointsOrthogonalSouthSideCalculator(n),n.sideCalculators[r.ConnectionPointSide.North]=new u.ConnectorPointsOrthogonalNorthSideCalculator(n),n.sideCalculators[r.ConnectionPointSide.East]=new l.ConnectorPointsOrthogonalEastSideCalculator(n),n.sideCalculators[r.ConnectionPointSide.West]=new p.ConnectorPointsOrthogonalWestSideCalculator(n),n}return o(e,t),Object.defineProperty(e.prototype,"beginRect",{get:function(){return this.connector.beginItem?this.connector.beginItem.rectangle:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endRect",{get:function(){return this.connector.endItem?this.connector.endItem.rectangle:void 0},enumerable:!1,configurable:!0}),e.prototype.getPoints=function(){var t=this.connector.points.map((function(t,e){return new h.ConnectorRenderPoint(t.x,t.y,e)}));d.RightAngleConnectorRoutingMathOperations.removeOrSkipUnnecessaryPoints(t);var e=0,n=t.length-1,o=this.getPointSide(t,0),i=this.getPointSide(t,1),r=this.getPointSide(t,t.length-1),a=this.getPointSide(t,t.length-1-1),s=this.getSideCalculator(o),c=this.getSideCalculator(r),u=this.beginRect,l=s.getCorrectOriginPoint(t[e],u),p=t[e+1];if(2===t.length&&s.isOnSidePoint(l,p)&&s.isDirectConnectionAllowed(i,l,p)){var f=s.getDirectConnectionPoints(l,p);f.forEach((function(o){t.splice(e+1,0,o),e++,n++}))}else{var m=s.getBeginOffsetPoints(i,t[e],t[e+1],this.beginRect);m.forEach((function(n){t.splice(e+1,0,n)})),e+=m.length,n+=m.length;var g=c.getEndOffsetPoints(a,t[n],t[n-1],this.endRect);g.forEach((function(e,o){t.splice(n+o,0,e)})),this.addMiddlePoints(t,e,n)}return d.RightAngleConnectorRoutingMathOperations.removeOrSkipUnnecessaryPoints(t),t},e.prototype.getSideCalculator=function(t){return this.sideCalculators[t]},e.prototype.getPointSide=function(t,e){if(0===e&&this.connector.beginItem){var n=this.connector.beginConnectionPointIndex;return this.connector.beginItem.getConnectionPointSideByIndex(n,t[1])}if(e===t.length-1&&this.connector.endItem){n=this.connector.endConnectionPointIndex;return this.connector.endItem.getConnectionPointSideByIndex(n,t[t.length-2])}return r.ConnectionPointSide.Undefined},e.prototype.addMiddlePoints=function(t,e,n){for(var o=e;o<n;o++){var i=o+1,r=this.getMiddlePoint(t[o],t[o-1],o-1===0,t[i],t[i+1],i+1===t.length-1);void 0!==r&&(t.splice(o+1,0,r),o++,n++)}},e.prototype.getMiddlePoints=function(t,e){return t.x===e.x||t.y===e.y?[]:[new h.ConnectorRenderPoint(t.x,e.y),new h.ConnectorRenderPoint(e.x,t.y)]},e.prototype.getMiddlePoint=function(t,e,n,o,r,a){var s,c=this,u=this.getMiddlePoints(t,o);return u.forEach((function(n){var a=c.createPointsRect(t,n),u=c.createPointsRect(n,o),l=c.connector.beginItem?c.connector.beginItem.rectangle:void 0,p=c.connector.endItem?c.connector.endItem.rectangle:void 0;l&&(i.Rectangle.areIntersected(l,a)||i.Rectangle.areIntersected(l,u))||p&&(i.Rectangle.areIntersected(p,a)||i.Rectangle.areIntersected(p,u))||c.isReturnPoint(n,t,e)&&!c.isIntermediatePoints(t,e)||c.isReturnPoint(n,o,r)&&!c.isIntermediatePoints(o,r)||(void 0===s||c.isPriorMiddlePoint(n,t,e,o,r))&&(s=n)})),void 0===s&&u.length>0&&(s=u[0]),s},e.prototype.createPointsRect=function(t,e){var n=i.Rectangle.fromPoints(t,e);return n.width>0&&(n=n.clone().inflate(-1,0)),n.height>0&&(n=n.clone().inflate(0,-1)),n},e.prototype.isPriorMiddlePoint=function(t,e,n,o,i){return!(!n||t.x!==n.x&&t.y!==n.y)||!(!i||t.x!==i.x&&t.y!==i.y)},e.prototype.isReturnPoint=function(t,e,n){if(void 0!==e&&void 0!==n){if(t.x===n.x&&(e.y<t.y&&t.y<n.y||e.y>t.y&&t.y>n.y))return!0;if(t.y===n.y&&(e.x<t.x&&t.x<n.x||e.x>t.x&&t.x>n.x))return!0}return!1},e.prototype.isIntermediatePoints=function(t,e){return 0<t.pointIndex&&t.pointIndex<this.connector.points.length-1&&0<e.pointIndex&&e.pointIndex<this.connector.points.length-1},e}(a.ConnectorPointsCalculatorBase);e.ConnectorPointsOrthogonalCalculator=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalUndefinedSideCalculator=void 0;var i=n(50),r=n(30),a=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.getCorrectOriginPoint=function(t,e){return t},e.prototype.getSameShapeOffsetPoints=function(t,e,n,o){return[]},e.prototype.getOverlappedPointsOffsetPoints=function(t,e,n,o){return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(t,e,n,o){return[]},e.prototype.getEndOverlappedShapeOffsetPoints=function(t,e,n,o){return[]},e.prototype.getBeginOnSideOffsetPoints=function(t,e,n,o){return[]},e.prototype.getEndOnSideOffsetPoints=function(t,e,n,o){return[]},e.prototype.getBeginOffSideOffsetPoints=function(t,e,n,o){return[]},e.prototype.getEndOffSideOffsetPoints=function(t,e,n,o){return[]},e.prototype.isOnSidePoint=function(t,e){return!0},e.prototype.isDirectConnectionAllowed=function(t,e,n){var o=this.getSideCalculator(e,n);return void 0===o||o.isDirectConnectionAllowed(t,e,n)},e.prototype.getDirectConnectionPoints=function(t,e){var n=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);if(n>o){var i=Math.min(t.x,e.x),a=i+n/2;return[new r.ConnectorRenderPoint(a,t.y),new r.ConnectorRenderPoint(a,e.y)]}var s=Math.min(t.y,e.y),c=s+o/2;return[new r.ConnectorRenderPoint(t.x,c),new r.ConnectorRenderPoint(e.x,c)]},e}(i.ConnectorPointsOrthogonalSideCalculatorBase);e.ConnectorPointsOrthogonalUndefinedSideCalculator=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalSouthSideCalculator=void 0;var i=n(8),r=n(50),a=n(30),s=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.getCorrectOriginPoint=function(t,e){return t.y<e.bottom&&(t=t.clone().offset(0,e.bottom-t.y)),t},e.prototype.getSameShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:case i.ConnectionPointSide.West:case i.ConnectionPointSide.South:return[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.North:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.South:return[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.North:return[e.clone().offset(0,-this.getMinOffset())]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return e.y<n.y?e.x>n.x?[]:[e.clone().offset(0,this.getMinOffset())]:e.y>this.endRect.bottom?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.West:return e.y<n.y?e.x<n.x?[]:[e.clone().offset(0,this.getMinOffset())]:e.y>this.endRect.bottom?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.South:return[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.North:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),e.x<n.x)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return n.y<e.y?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):e.x<n.x?[e.clone().offset(0,this.getMinOffset())]:[];case i.ConnectionPointSide.West:return n.y<e.y?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):e.x>n.x?[e.clone().offset(0,this.getMinOffset())]:[];case i.ConnectionPointSide.South:return[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.North:var r=this.getMinOffset();return this.beginRect.bottom>e.y&&(r+=this.beginRect.bottom-e.y),[e.clone().offset(0,r)]}},e.prototype.getBeginOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(0,this.getScaleableOffsetY(e,n,!1))]},e.prototype.getEndOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(0,this.getScaleableOffsetY(e,n,!0))]},e.prototype.getBeginOffSideOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!1);break;case i.ConnectionPointSide.West:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!0);break;case i.ConnectionPointSide.South:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(e,n,o,!1);break;case i.ConnectionPointSide.Undefined:case i.ConnectionPointSide.North:return this.getScaleableAsideOffsetPoints(e,n,o,!1)}return[e.clone().offset(0,this.getScaleableOffsetY(e,n,!1))]},e.prototype.getEndOffSideOffsetPoints=function(t,e,n,o){if(t===i.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(e,n,o,!0);if(this.isBeginEndOverlappedX()){var r=this.beginRect.center.x>this.endRect.center.x;return this.getScaleableAsideOffsetPoints(e,n,o,!0,r)}return[e.clone().offset(0,this.getScaleableOffsetY(e,n,!0))]},e.prototype.getAsideOffsetPoints=function(t,e,n,o,i,r){var a=[];return void 0!==n&&(void 0===r&&(r=e.x<t.x),r?a.push(t.clone().offset(-(t.x-n.x+i),o)):a.push(t.clone().offset(n.right-t.x+i,o))),a.push(t.clone().offset(0,o)),a},e.prototype.getScaleableAsideOffsetPoints=function(t,e,n,o,i){var r=this.getScaleableOffsetY(t,e,o),a=this.getScaleableOffsetX(t,e,o);return this.getAsideOffsetPoints(t,e,n,r,a,i)},e.prototype.getScaleableOffsetX=function(t,e,n){if(this.beginRect&&this.endRect&&!n&&!this.isBeginEndOverlappedX()){var o=void 0;if(o=e.x<t.x?this.beginRect.x-this.endRect.right:this.endRect.x-this.beginRect.right,o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(t,e,n){if(this.beginRect&&this.endRect){var o=n?this.beginRect.y-t.y:this.endRect.y-t.y;if(o>0&&o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(t,e){return e.y>t.y},e.prototype.isDirectConnectionAllowed=function(t,e,n){return t===i.ConnectionPointSide.North||t===i.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(t,e){var n=t.y+(e.y-t.y)/2;return[new a.ConnectorRenderPoint(t.x,n),new a.ConnectorRenderPoint(e.x,n)]},e}(r.ConnectorPointsOrthogonalSideCalculatorBase);e.ConnectorPointsOrthogonalSouthSideCalculator=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalNorthSideCalculator=void 0;var i=n(8),r=n(50),a=n(30),s=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.getCorrectOriginPoint=function(t,e){return t.y>e.y&&(t=t.clone().offset(0,e.y-t.y)),t},e.prototype.getSameShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:case i.ConnectionPointSide.West:case i.ConnectionPointSide.North:return[e.clone().offset(0,-this.getMinOffset())];case i.ConnectionPointSide.South:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.South:return[e.clone().offset(0,this.getMinOffset())];case i.ConnectionPointSide.North:return[e.clone().offset(0,-this.getMinOffset())]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return e.y>n.y?e.x>n.x?[]:[e.clone().offset(0,-this.getMinOffset())]:e.y<this.endRect.y?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):[e.clone().offset(0,-this.getMinOffset())];case i.ConnectionPointSide.West:return e.y>n.y?e.x<n.x?[]:[e.clone().offset(0,-this.getMinOffset())]:e.y<this.endRect.y?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):[e.clone().offset(0,-this.getMinOffset())];case i.ConnectionPointSide.North:return[e.clone().offset(0,-this.getMinOffset())];case i.ConnectionPointSide.South:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),e.x<n.x)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return n.y>e.y?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):e.x<n.x?[e.clone().offset(0,-this.getMinOffset())]:[];case i.ConnectionPointSide.West:return n.y>e.y?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):e.x>n.x?[e.clone().offset(0,-this.getMinOffset())]:[];case i.ConnectionPointSide.North:return[e.clone().offset(0,-this.getMinOffset())];case i.ConnectionPointSide.South:var r=-this.getMinOffset();return this.beginRect.y<e.y&&(r-=e.y-this.beginRect.y),[e.clone().offset(0,r)]}},e.prototype.getBeginOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(0,-this.getScaleableOffsetY(e,n,!1))]},e.prototype.getEndOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(0,-this.getScaleableOffsetY(e,n,!0))]},e.prototype.getBeginOffSideOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!1);break;case i.ConnectionPointSide.West:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!0);break;case i.ConnectionPointSide.North:if(this.isBeginEndOverlappedX())return this.getScaleableAsideOffsetPoints(e,n,o,!1);break;case i.ConnectionPointSide.Undefined:case i.ConnectionPointSide.South:return this.getScaleableAsideOffsetPoints(e,n,o,!1)}return[e.clone().offset(0,-this.getScaleableOffsetY(e,n,!1))]},e.prototype.getEndOffSideOffsetPoints=function(t,e,n,o){if(t===i.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(e,n,o,!0);if(this.isBeginEndOverlappedX()){var r=this.beginRect.center.x>this.endRect.center.x;return this.getScaleableAsideOffsetPoints(e,n,o,!0,r)}return[e.clone().offset(0,-this.getScaleableOffsetY(e,n,!0))]},e.prototype.getAsideOffsetPoints=function(t,e,n,o,i,r){var a=[];return void 0!==n&&(void 0===r&&(r=e.x<t.x),r?a.push(t.clone().offset(-(t.x-n.x+i),-o)):a.push(t.clone().offset(n.right-t.x+i,-o))),a.push(t.clone().offset(0,-o)),a},e.prototype.getScaleableAsideOffsetPoints=function(t,e,n,o,i){var r=this.getScaleableOffsetY(t,e,o),a=this.getScaleableOffsetX(t,e,o);return this.getAsideOffsetPoints(t,e,n,r,a,i)},e.prototype.getScaleableOffsetX=function(t,e,n){if(this.beginRect&&this.endRect&&!n&&!this.isBeginEndOverlappedX()){var o=void 0;if(o=e.x<t.x?this.beginRect.x-this.endRect.right:this.endRect.x-this.beginRect.right,o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(t,e,n){if(this.beginRect&&this.endRect){var o=n?t.y-this.beginRect.bottom:t.y-this.endRect.bottom;if(o>0&&o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(t,e){return e.y<t.y},e.prototype.isDirectConnectionAllowed=function(t,e,n){return t===i.ConnectionPointSide.South||t===i.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(t,e){var n=e.y+(t.y-e.y)/2;return[new a.ConnectorRenderPoint(t.x,n),new a.ConnectorRenderPoint(e.x,n)]},e}(r.ConnectorPointsOrthogonalSideCalculatorBase);e.ConnectorPointsOrthogonalNorthSideCalculator=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalEastSideCalculator=void 0;var i=n(8),r=n(50),a=n(30),s=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.getCorrectOriginPoint=function(t,e){return t.x<e.right&&(t=t.clone().offset(e.right-t.x,0)),t},e.prototype.getSameShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.North:case i.ConnectionPointSide.South:case i.ConnectionPointSide.East:return[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.West:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.West:return[e.clone().offset(-this.getMinOffset(),0)]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.North:return e.x<n.x?e.y<n.y?[]:[e.clone().offset(this.getMinOffset(),0)]:e.x>this.endRect.right?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.South:return e.x<n.x?e.y>n.y?[]:[e.clone().offset(this.getMinOffset(),0)]:e.x>this.endRect.right?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.East:return[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.West:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),e.y<n.y)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.West:var r=this.getMinOffset();return this.beginRect.right>e.x&&(r+=this.beginRect.right-e.x),[e.clone().offset(r,0)];case i.ConnectionPointSide.North:return n.x<e.x?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):e.y>n.y?[e.clone().offset(this.getMinOffset(),0)]:[];case i.ConnectionPointSide.South:return n.x<e.x?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):e.y<n.y?[e.clone().offset(this.getMinOffset(),0)]:[]}},e.prototype.getBeginOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(this.getScaleableOffsetX(e,n,!1),0)]},e.prototype.getEndOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(this.getScaleableOffsetX(e,n,!0),0)]},e.prototype.getBeginOffSideOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.South:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!1);break;case i.ConnectionPointSide.North:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!0);break;case i.ConnectionPointSide.East:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(e,n,o,!1);break;case i.ConnectionPointSide.Undefined:case i.ConnectionPointSide.West:return this.getScaleableAsideOffsetPoints(e,n,o,!1)}return[e.clone().offset(this.getScaleableOffsetX(e,n,!1),0)]},e.prototype.getEndOffSideOffsetPoints=function(t,e,n,o){if(t===i.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(e,n,o,!0);if(this.isBeginEndOverlappedY()){var r=this.beginRect.center.y>this.endRect.center.y;return this.getScaleableAsideOffsetPoints(e,n,o,!0,r)}return[e.clone().offset(this.getScaleableOffsetX(e,n,!0),0)]},e.prototype.getAsideOffsetPoints=function(t,e,n,o,i,r){var a=[];return void 0!==n&&(void 0===r&&(r=e.y<t.y),r?a.push(t.clone().offset(o,-(t.y-n.y+i))):a.push(t.clone().offset(o,n.bottom-t.y+i))),a.push(t.clone().offset(o,0)),a},e.prototype.getScaleableAsideOffsetPoints=function(t,e,n,o,i){var r=this.getScaleableOffsetX(t,e,o),a=this.getScaleableOffsetY(t,e,o);return this.getAsideOffsetPoints(t,e,n,r,a,i)},e.prototype.getScaleableOffsetX=function(t,e,n){if(this.beginRect&&this.endRect){var o=n?this.beginRect.x-t.x:this.endRect.x-t.x;if(o>0&&o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(t,e,n){if(this.beginRect&&this.endRect&&!n&&!this.isBeginEndOverlappedY()){var o=void 0;if(o=e.y<t.y?this.beginRect.y-this.endRect.bottom:this.endRect.y-this.beginRect.bottom,o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(t,e){return e.x>t.x},e.prototype.isDirectConnectionAllowed=function(t,e,n){return t===i.ConnectionPointSide.West||t===i.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(t,e){var n=t.x+(e.x-t.x)/2;return[new a.ConnectorRenderPoint(n,t.y),new a.ConnectorRenderPoint(n,e.y)]},e}(r.ConnectorPointsOrthogonalSideCalculatorBase);e.ConnectorPointsOrthogonalEastSideCalculator=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorPointsOrthogonalWestSideCalculator=void 0;var i=n(8),r=n(50),a=n(30),s=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.getCorrectOriginPoint=function(t,e){return t.x>e.x&&(t=t.clone().offset(e.x-t.x,0)),t},e.prototype.getSameShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.North:case i.ConnectionPointSide.South:case i.ConnectionPointSide.West:return[e.clone().offset(-this.getMinOffset(),0)];case i.ConnectionPointSide.East:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset())}},e.prototype.getOverlappedPointsOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:return[e.clone().offset(this.getMinOffset(),0)];case i.ConnectionPointSide.West:return[e.clone().offset(-this.getMinOffset(),0)]}return[]},e.prototype.getBeginOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.North:return e.x>n.x?e.y<n.y?[]:[e.clone().offset(-this.getMinOffset(),0)]:e.x<this.endRect.x?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):[e.clone().offset(-this.getMinOffset(),0)];case i.ConnectionPointSide.South:return e.x>n.x?e.y>n.y?[]:[e.clone().offset(-this.getMinOffset(),0)]:e.x<this.endRect.x?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):[e.clone().offset(-this.getMinOffset(),0)];case i.ConnectionPointSide.West:return[e.clone().offset(-this.getMinOffset(),0)];case i.ConnectionPointSide.East:return this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),e.y<n.y)}},e.prototype.getEndOverlappedShapeOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.East:var r=-this.getMinOffset();return this.beginRect.x<e.x&&(r-=e.x-this.beginRect.x),[e.clone().offset(r,0)];case i.ConnectionPointSide.West:return[e.clone().offset(-this.getMinOffset(),0)];case i.ConnectionPointSide.North:return n.x>e.x?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!0):e.y>n.y?[e.clone().offset(-this.getMinOffset(),0)]:[];case i.ConnectionPointSide.South:return n.x>e.x?this.getAsideOffsetPoints(e,n,o,this.getMinOffset(),this.getMinOffset(),!1):e.y<n.y?[e.clone().offset(-this.getMinOffset(),0)]:[]}},e.prototype.getBeginOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(-this.getScaleableOffsetX(e,!1),0)]},e.prototype.getEndOnSideOffsetPoints=function(t,e,n,o){return[e.clone().offset(-this.getScaleableOffsetX(e,!0),0)]},e.prototype.getBeginOffSideOffsetPoints=function(t,e,n,o){switch(t){case i.ConnectionPointSide.South:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!1);break;case i.ConnectionPointSide.North:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(e,n,o,!1,!0);break;case i.ConnectionPointSide.West:if(this.isBeginEndOverlappedY())return this.getScaleableAsideOffsetPoints(e,n,o,!1);break;case i.ConnectionPointSide.Undefined:case i.ConnectionPointSide.East:return this.getScaleableAsideOffsetPoints(e,n,o,!1)}return[e.clone().offset(-this.getScaleableOffsetX(e,!1),0)]},e.prototype.getEndOffSideOffsetPoints=function(t,e,n,o){if(t===i.ConnectionPointSide.Undefined)return this.getScaleableAsideOffsetPoints(e,n,o,!0);if(this.isBeginEndOverlappedY()){var r=this.beginRect.center.y>this.endRect.center.y;return this.getScaleableAsideOffsetPoints(e,n,o,!0,r)}return[e.clone().offset(-this.getScaleableOffsetX(e,!0),0)]},e.prototype.getAsideOffsetPoints=function(t,e,n,o,i,r){var a=[];return void 0!==n&&(void 0===r&&(r=e.y<t.y),r?a.push(t.clone().offset(-o,-(t.y-n.y+i))):a.push(t.clone().offset(-o,n.bottom-t.y+i))),a.push(t.clone().offset(-o,0)),a},e.prototype.getScaleableAsideOffsetPoints=function(t,e,n,o,i){var r=this.getScaleableOffsetX(t,o),a=this.getScaleableOffsetY(t,e,o);return this.getAsideOffsetPoints(t,e,n,r,a,i)},e.prototype.getScaleableOffsetX=function(t,e){if(this.beginRect&&this.endRect){var n=e?t.x-this.beginRect.right:t.x-this.endRect.right;if(n>0&&n<2*this.getMinOffset())return n/2}return this.getMinOffset()},e.prototype.getScaleableOffsetY=function(t,e,n){if(this.beginRect&&this.endRect&&!n&&!this.isBeginEndOverlappedY()){var o=void 0;if(o=e.y<t.y?this.beginRect.y-this.endRect.bottom:this.endRect.y-this.beginRect.bottom,o<2*this.getMinOffset())return o/2}return this.getMinOffset()},e.prototype.isOnSidePoint=function(t,e){return e.x<t.x},e.prototype.isDirectConnectionAllowed=function(t,e,n){return t===i.ConnectionPointSide.East||t===i.ConnectionPointSide.Undefined},e.prototype.getDirectConnectionPoints=function(t,e){var n=e.x+(t.x-e.x)/2;return[new a.ConnectorRenderPoint(n,t.y),new a.ConnectorRenderPoint(n,e.y)]},e}(r.ConnectorPointsOrthogonalSideCalculatorBase);e.ConnectorPointsOrthogonalWestSideCalculator=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorLineEndingFilledTriangleStrategy=e.ConnectorLineEndingOutlinedTriangleStrategy=e.ConnectorLineEndingArrowStrategy=e.ConnectorLineEndingNoneStrategy=e.ConnectorLineEndingStrategy=void 0;var i=n(3),r=n(4),a=function(){function t(t){this.style=t}return t.prototype.hasCommands=function(){return!0},t.prototype.needCreateSeparatePrimitive=function(){return!1},t.prototype.createPrimitive=function(){return new r.PathPrimitive([],this.getStyle(),this.getCssClass())},t.prototype.createCommands=function(t,e){return[]},t.prototype.getStyle=function(){var t=this.style.clone();return t.resetStrokeDashArray(),t},t.prototype.getCssClass=function(){},t}();e.ConnectorLineEndingStrategy=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.hasCommands=function(){return!1},e}(a);e.ConnectorLineEndingNoneStrategy=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"arrowHeight",{get:function(){return 6*this.style.strokeWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"arrowWidth",{get:function(){return 2*this.style.strokeWidth},enumerable:!1,configurable:!0}),e.prototype.needCreateSeparatePrimitive=function(){return!this.style.isDefaultStrokeDashArray()},e.prototype.createCommands=function(t,e){var n=this.getArrowPoints(t,e),o=[new r.PathPrimitiveMoveToCommand(n.point1.x,n.point1.y),new r.PathPrimitiveLineToCommand(t.x,t.y),new r.PathPrimitiveLineToCommand(n.point2.x,n.point2.y)];return this.style.isDefaultStrokeDashArray()||(o=o.concat([new r.PathPrimitiveMoveToCommand(t.x,t.y),new r.PathPrimitiveLineToCommand(n.point3.x,n.point3.y)])),o},e.prototype.getArrowPoints=function(t,e){var n=this.arrowHeight;if(t.x===e.x){var o=Math.abs(t.y-e.y);o<n&&(n=o)}if(t.y===e.y){o=Math.abs(t.x-e.x);o<n&&(n=o)}return i.GeometryUtils.getArrowPoints(t,e,n,this.arrowWidth)},e}(a);e.ConnectorLineEndingArrowStrategy=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.needCreateSeparatePrimitive=function(){return!0},e.prototype.createCommands=function(t,e){var n=this.getArrowPoints(t,e);return[new r.PathPrimitiveMoveToCommand(n.point1.x,n.point1.y),new r.PathPrimitiveLineToCommand(t.x,t.y),new r.PathPrimitiveLineToCommand(n.point2.x,n.point2.y),new r.PathPrimitiveClosePathCommand]},e.prototype.getCssClass=function(){return"outlined-line-ending"},e}(c);e.ConnectorLineEndingOutlinedTriangleStrategy=u;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyle=function(){var e=t.prototype.getStyle.call(this);return e["fill"]=e["stroke"],e},e.prototype.getCssClass=function(){return"filled-line-ending"},e}(u);e.ConnectorLineEndingFilledTriangleStrategy=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorTexts=e.ConnectorText=void 0;var o=function(){function t(t,e){this.position=t,this.value=e}return t}();e.ConnectorText=o;var i=function(){function t(){this.items={}}return t.prototype.get=function(t){return this.items[t]},t.prototype.set=function(t,e){this.items[t]=e},t.prototype.remove=function(t){delete this.items[t]},t.prototype.map=function(t){var e=[];return this.forEach((function(n){return e.push(t(n))})),e},t.prototype.forEach=function(t){for(var e in this.items)Object.prototype.hasOwnProperty.call(this.items,e)&&t(this.items[e])},t.prototype.count=function(){return Object.keys(this.items).length},t.prototype.clone=function(){var e=new t;return this.forEach((function(t){e.set(t.position,new o(t.position,t.value))})),e},t.prototype.toObject=function(){var t={},e=!1;return this.forEach((function(n){t[n.position]=n.value,e=!0})),e?t:null},t.prototype.fromObject=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var n=parseFloat(e);isNaN(n)||"string"!==typeof t[e]||this.set(n,new o(n,t[e]))}},t}();e.ConnectorTexts=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AddConnectorPointHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o,i){void 0===i&&(i=!1);var r=t.call(this)||this;return r.connectorKey=e,r.pointIndex=n,r.isCustomPoint=i,r.point=o.clone(),r}return o(e,t),e.prototype.redo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);this.renderContext=n.createRenderPointsContext(),t.addDeleteConnectorPoint(n,(function(t){t.addPoint(e.pointIndex,e.point),t.onAddPoint(e.pointIndex,e.point,e.isCustomPoint)}))},e.prototype.undo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);t.addDeleteConnectorPoint(n,(function(t){t.deletePoint(e.pointIndex),t.replaceRenderPoints(e.renderContext)}))},e}(i.HistoryItem);e.AddConnectorPointHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteConnectorPointHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o,i){var r=t.call(this)||this;return r.connectorKey=e,r.isCustomPoint=o,r.lockCreateRenderPoints=i,r.pointIndex=n,r}return o(e,t),e.prototype.redo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);this.point=n.points[this.pointIndex].clone(),this.renderContext=n.createRenderPointsContext(),t.addDeleteConnectorPoint(n,(function(t){t.deletePoint(e.pointIndex),t.onDeletePoint(e.pointIndex,e.isCustomPoint,e.isCustomPoint?t.points.length>2:e.lockCreateRenderPoints)}))},e.prototype.undo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);t.addDeleteConnectorPoint(n,(function(t){t.addPoint(e.pointIndex,e.point),t.replaceRenderPoints(e.renderContext)}))},e}(i.HistoryItem);e.DeleteConnectorPointHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.InsertToContainerHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.containerKey=n.key,o.itemKey=e.key,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey),n=t.model.findShape(this.containerKey);t.insertToContainer(e,n)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.removeFromContainer(e)},e}(i.HistoryItem);e.InsertToContainerHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MoveConnectorPointHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connectorKey=e,i.pointIndex=n,i.newPoint=o.clone(),i}return o(e,t),e.prototype.redo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);this.oldPoint=n.points[this.pointIndex].clone(),this.renderContext=n.createRenderPointsContext(),t.moveConnectorPoint(n,this.pointIndex,(function(t){t.movePoint(e.pointIndex,e.newPoint),t.onMovePoint(e.pointIndex,e.newPoint)}))},e.prototype.undo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);t.moveConnectorPoint(n,this.pointIndex,(function(t){t.movePoint(e.pointIndex,e.oldPoint),t.replaceRenderPoints(e.renderContext)}))},e}(i.HistoryItem);e.MoveConnectorPointHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MoveShapeHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.shapeKey=e,o.position=n,o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);this.oldPosition=e.position.clone(),t.moveShape(e,this.position)},e.prototype.undo=function(t){var e=t.model.findShape(this.shapeKey);t.moveShape(e,this.oldPosition)},e}(i.HistoryItem);e.MoveShapeHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RemoveFromContainerHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.itemKey=e.key,n}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.containerKey=e.container&&e.container.key,t.removeFromContainer(e)},e.prototype.undo=function(t){var e=t.model.findContainer(this.containerKey),n=t.model.findItem(this.itemKey);t.insertToContainer(n,e)},e}(i.HistoryItem);e.RemoveFromContainerHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ModelResizeHistoryItem=void 0;var i=n(5),r=n(86),a=n(2),s=function(t){function e(e){var n=t.call(this)||this;return n.offset=e,n}return o(e,t),e.prototype.redo=function(t){this.oldSize=t.model.size.clone(),this.backOffset=new r.Offsets(-this.offset.left,-this.offset.right,-this.offset.top,-this.offset.bottom);var e=Math.max(this.oldSize.width+this.offset.left+this.offset.right,t.model.pageWidth),n=Math.max(this.oldSize.height+this.offset.top+this.offset.bottom,t.model.pageHeight);t.changeModelSize(new a.Size(e,n),this.offset)},e.prototype.undo=function(t){t.changeModelSize(this.oldSize,this.backOffset)},e}(i.HistoryItem);e.ModelResizeHistoryItem=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.UpdatePositionsOnPageResizeHistoryItem=void 0;var i=n(6),r=n(14),a=n(5),s=function(t){function e(e){var n=t.call(this)||this;return n.offset=e,n}return o(e,t),e.prototype.redo=function(t){var e=this;t.model.iterateItems((function(n){n instanceof r.Shape&&t.moveShape(n,e.applyOffset(n.position,e.offset.x,e.offset.y)),n instanceof i.Connector&&t.changeConnectorPoints(n,(function(t){return t.updatePointsOnPageResize(e.offset.x,e.offset.y)}))}))},e.prototype.undo=function(t){var e=this;t.model.iterateItems((function(n){n instanceof r.Shape&&t.moveShape(n,e.applyOffset(n.position,-e.offset.x,-e.offset.y)),n instanceof i.Connector&&t.changeConnectorPoints(n,(function(t){return t.updatePointsOnPageResize(-e.offset.x,-e.offset.y)}))}))},e.prototype.applyOffset=function(t,e,n){return t.clone().offset(e,n)},e}(a.HistoryItem);e.UpdatePositionsOnPageResizeHistoryItem=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GraphInfo=void 0;var o=n(195),i=function(){function t(t,e){this.container=t,this.sourceGraph=e}return Object.defineProperty(t.prototype,"graph",{get:function(){return this._graph||(this._graph=this.getNodeInfoGraph())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return void 0!==this._level?this._level:this._level=this.getLevel()},enumerable:!1,configurable:!0}),t.prototype.getNodeInfoGraph=function(){return this.sourceGraph.cast(o.LayoutUtils.shapeToLayout)},t.prototype.getLevel=function(){var t=0;return this.container&&(t=this.getContainerLevel(this.container)),t},t.prototype.getContainerLevel=function(t){var e=1,n=t.container;return n&&(e+=this.getContainerLevel(n)),e},t}();e.GraphInfo=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LayoutUtils=void 0;var o=n(67),i=function(){function t(){}return t.shapeToLayout=function(t){var e=new o.Margin(0),n=t.rectangle;t.attachedConnectors.filter((function(t){return!t.beginItem||!t.endItem})).forEach((function(t){var o=t.rectangle;e.left=Math.max(e.left,n.x-o.x),e.right=Math.max(e.right,o.right-n.right),e.top=Math.max(e.top,n.y-o.y),e.bottom=Math.max(e.bottom,o.bottom-n.bottom)}));var i=new o.NodeInfo(t.key,e,t.size.clone());return i.connectionPoints=t.description.getConnectionPoints(),i},t}();e.LayoutUtils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CommandBase=void 0;var o=function(){function t(t){this.control=t}return t.prototype.execute=function(t){this.isPermissionsRequired&&this.permissionsProvider.lockPermissions();var e=this.getState();if(this.isPermissionsRequired&&this.permissionsProvider.unlockPermissions(),!e.enabled)return!1;this.control.beginUpdate();var n=!1;return n=this.isPermissionsRequired?this.executeWithPermissions(e,t):this.executeCore(e,t),this.control.endUpdate(),n&&this.updateControlState(),n},t.prototype.executeWithPermissions=function(t,e){var n=!1;return this.permissionsProvider.beginStorePermissions(),this.control.history.beginTransaction(),n=this.executeCore(t,e),this.permissionsProvider.isStoredPermissionsGranted()||(this.permissionsProvider.lockPermissions(),this.control.history.undoTransaction(),this.permissionsProvider.unlockPermissions(),n=!1),this.control.history.endTransaction(),this.permissionsProvider.endStorePermissions(),n},t.prototype.updateControlState=function(){this.lockInputPositionUpdating()||this.control.selection.inputPosition.reset(),this.lockUIUpdating()||this.control.barManager.updateItemsState()},Object.defineProperty(t.prototype,"permissionsProvider",{get:function(){return this.control&&this.control.permissionsProvider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPermissionsRequired",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.lockUIUpdating=function(){return!1},t.prototype.lockInputPositionUpdating=function(){return!1},t}();e.CommandBase=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleCommandState=void 0;var o=function(){function t(t,e,n,o,i){this.visible=!0,this.denyUpdateValue=!1,this.enabled=t,this.value=e,this.items=o,this.visible=i,this.defaultValue=n}return t}();e.SimpleCommandState=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.UndoCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t){return this.control.beginUpdateCanvas(),this.permissionsProvider.lockPermissions(),this.control.history.undo(),this.permissionsProvider.unlockPermissions(),this.control.endUpdateCanvas(),!0},e.prototype.isEnabled=function(){return t.prototype.isEnabled.call(this)&&this.control.history.canUndo()},e}(i.SimpleCommandBase);e.UndoCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RedoCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t){return this.control.beginUpdateCanvas(),this.permissionsProvider.lockPermissions(),this.control.history.redo(),this.permissionsProvider.unlockPermissions(),this.control.endUpdateCanvas(),!0},e.prototype.isEnabled=function(){return t.prototype.isEnabled.call(this)&&this.control.history.canRedo()},e}(i.SimpleCommandBase);e.RedoCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ImportCommand=void 0;var i=n(121),r=n(54),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){this.permissionsProvider.lockPermissions();var n=e["data"]?e["data"]:e,o=new i.Importer(this.control.shapeDescriptionManager,n);if(!0===e["keepExistingItems"])o.importItemsData(this.control.model),this.control.importItemsData();else{var r=o.import();this.control.importModel(r)}return this.permissionsProvider.unlockPermissions(),!0},e}(r.ExportImportCommandBase);e.ImportCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ProcessShapeDescription=void 0;var i=n(20),r=n(0),a=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Process},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(i.RectangleShapeDescription);e.ProcessShapeDescription=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DecisionShapeDescription=void 0;var i=n(122),r=n(0),a=n(2),s=n(7),c=function(t){function e(){return t.call(this,new a.Size(s.ShapeDefaultDimension,.75*s.ShapeDefaultDimension),!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Decision},enumerable:!1,configurable:!0}),e}(i.DiamondShapeDescription);e.DecisionShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ManualInputShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(8),c=n(7),u=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.ManualInput},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,s=n.bottom,c=n.height,u=i+c*e.slopeHeightRatio;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(o,u),new a.PathPrimitiveLineToCommand(r,i),new a.PathPrimitiveLineToCommand(r,s),new a.PathPrimitiveLineToCommand(o,s),new a.PathPrimitiveClosePathCommand],t.style)]},e.prototype.processConnectionPoint=function(t,n){var o=t.getConnectionPointSide(n);o===s.ConnectionPointSide.North&&(n.y+=e.slopeHeightRatio/2*t.size.height)},e.prototype.getTextRectangle=function(t){var n=t.size.height*e.slopeHeightRatio;return t.rectangle.clone().moveRectangle(c.ShapeTextPadding,n).resize(2*-c.ShapeTextPadding,-n-c.ShapeTextPadding).nonNegativeSize()},e.slopeHeightRatio=.1,e}(i.RectangleShapeDescription);e.ManualInputShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DataShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(8),c=n(7),u=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,s=n.bottom,c=n.width,u=n.height,l=Math.min(Math.max(0,u/Math.tan(e.slopeAngle)),c),p=o+l,h=r-l;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(p,i),new a.PathPrimitiveLineToCommand(r,i),new a.PathPrimitiveLineToCommand(h,s),new a.PathPrimitiveLineToCommand(o,s),new a.PathPrimitiveClosePathCommand],t.style)]},e.prototype.processConnectionPoint=function(t,n){var o=t.size.height/Math.tan(e.slopeAngle),i=t.getConnectionPointSide(n);i===s.ConnectionPointSide.East?n.x-=o/2:i===s.ConnectionPointSide.West&&(n.x+=o/2)},e.prototype.getTextRectangle=function(t){var n=Math.min(Math.max(0,t.size.height/Math.tan(e.slopeAngle)),t.size.width);return t.rectangle.clone().moveRectangle(n,c.ShapeTextPadding).resize(2*-n,2*-c.ShapeTextPadding)},e.slopeAngle=81*Math.PI/180,e}(i.RectangleShapeDescription);e.DataShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TerminatorShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(2),c=n(7),u=n(12),l=n(3),p=function(t){function e(){return t.call(this,new s.Size(c.ShapeDefaultDimension,.5*c.ShapeDefaultDimension),!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Terminator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,s=n.bottom,c=n.width,u=n.center.y,l=o+c*e.curveWidthRatio,p=o+c*(1-e.curveWidthRatio);return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(l,i),new a.PathPrimitiveLineToCommand(p,i),new a.PathPrimitiveQuadraticCurveToCommand(r,i,r,u),new a.PathPrimitiveQuadraticCurveToCommand(r,s,p,s),new a.PathPrimitiveLineToCommand(l,s),new a.PathPrimitiveQuadraticCurveToCommand(o,s,o,u),new a.PathPrimitiveQuadraticCurveToCommand(o,i,l,i),new a.PathPrimitiveClosePathCommand],t.style)]},e.prototype.getTextRectangle=function(t){var e=l.GeometryUtils.getMaxRectangleEnscribedInEllipse(t.size);return u.Rectangle.fromGeometry(t.position.clone().offset((t.size.width-e.width)/2,(t.size.height-e.height)/2),e)},e.prototype.getSizeByText=function(t,e){return l.GeometryUtils.getEllipseByEnscribedRectangle(t)},e.curveWidthRatio=.3,e}(i.RectangleShapeDescription);e.TerminatorShapeDescription=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PredefinedProcessShapeDescription=e.PredefinedProcessEdgeParameterName=void 0;var i=n(20),r=n(0),a=n(35),s=n(28),c=n(1),u=n(4);e.PredefinedProcessEdgeParameterName="e";var l=function(t){function n(){return t.call(this,void 0,!0)||this}return o(n,t),Object.defineProperty(n.prototype,"key",{get:function(){return r.ShapeTypes.PredefinedProcess},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(n){var o=n.rectangle,i=o.x,r=o.y,a=o.right,s=o.bottom,c=i+n.parameters.get(e.PredefinedProcessEdgeParameterName).value,l=a-n.parameters.get(e.PredefinedProcessEdgeParameterName).value,p=t.prototype.createShapePrimitives.call(this,n);return p.concat([new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(c,r),new u.PathPrimitiveLineToCommand(c,s),new u.PathPrimitiveMoveToCommand(l,r),new u.PathPrimitiveLineToCommand(l,s)],n.style)])},n.prototype.createParameters=function(t){t.add(new a.ShapeParameter(e.PredefinedProcessEdgeParameterName,.1*this.defaultSize.width))},n.prototype.normalizeParameters=function(t,o){this.changeParameterValue(o,e.PredefinedProcessEdgeParameterName,(function(e){return Math.max(n.minEdge,Math.min(.3*t.size.width,e.value))}))},n.prototype.modifyParameters=function(t,n,o,i){this.changeParameterValue(n,e.PredefinedProcessEdgeParameterName,(function(t){return t.value+o})),this.normalizeParameters(t,n)},n.prototype.getParameterPoints=function(t){return[new s.ShapeParameterPoint("c",new c.Point(t.normalizeX(t.position.x+t.parameters.get(e.PredefinedProcessEdgeParameterName).value),t.position.y))]},n.prototype.getTextRectangle=function(t){var n=t.rectangle,o=t.parameters.get(e.PredefinedProcessEdgeParameterName).value;return n.clone().resize(-2*o,0).clone().moveRectangle(o,0)},n.minEdge=72,n}(i.RectangleShapeDescription);e.PredefinedProcessShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowUpDownShapeDescription=void 0;var i=n(4),r=n(28),a=n(1),s=n(91),c=n(0),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.ArrowUpDown},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,r=e.right,a=e.bottom,c=e.width,u=e.center.x,l=(c-t.parameters.get(s.ArrowVerticalLineWidthParameterName).value)/2,p=t.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value,h=t.normalizeX(n+l),d=t.normalizeY(o+p),f=t.normalizeX(r-l),m=t.normalizeY(a-p);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(u,o),new i.PathPrimitiveLineToCommand(r,d),new i.PathPrimitiveLineToCommand(f,d),new i.PathPrimitiveLineToCommand(f,m),new i.PathPrimitiveLineToCommand(r,m),new i.PathPrimitiveLineToCommand(u,a),new i.PathPrimitiveLineToCommand(n,m),new i.PathPrimitiveLineToCommand(h,m),new i.PathPrimitiveLineToCommand(h,d),new i.PathPrimitiveLineToCommand(n,d),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.normalizeParameters=function(t,e){this.changeParameterValue(e,s.ArrowVerticalTriangleHeightParameterName,(function(e){return Math.max(0,Math.min(t.size.height/2-2*t.strokeWidth,e.value))})),this.changeParameterValue(e,s.ArrowVerticalLineWidthParameterName,(function(e){return Math.max(0,Math.min(t.size.width,e.value))}))},e.prototype.modifyParameters=function(t,e,n,o){this.changeParameterValue(e,s.ArrowVerticalTriangleHeightParameterName,(function(t){return t.value+o})),this.changeParameterValue(e,s.ArrowVerticalLineWidthParameterName,(function(t){return t.value-2*n})),this.normalizeParameters(t,e)},e.prototype.getParameterPoints=function(t){return[new r.ShapeParameterPoint("c",new a.Point(t.normalizeX(t.position.x+(t.size.width-t.parameters.get(s.ArrowVerticalLineWidthParameterName).value)/2),t.normalizeY(t.position.y+t.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value)))]},e}(s.ArrowVerticalShapeDescription);e.ArrowUpDownShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowRightShapeDescription=void 0;var i=n(4),r=n(92),a=n(28),s=n(1),c=n(0),u=n(8),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.ArrowRight},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,a=e.right,s=e.bottom,c=e.width,u=e.height,l=e.center.y,p=c-t.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value,h=(u-t.parameters.get(r.ArrowVerticalLineHeightParameterName).value)/2,d=t.normalizeX(n+p),f=t.normalizeY(o+h),m=t.normalizeY(s-h);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(n,f),new i.PathPrimitiveLineToCommand(d,f),new i.PathPrimitiveLineToCommand(d,o),new i.PathPrimitiveLineToCommand(a,l),new i.PathPrimitiveLineToCommand(d,s),new i.PathPrimitiveLineToCommand(d,m),new i.PathPrimitiveLineToCommand(n,m),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.modifyParameters=function(t,e,n,o){this.changeParameterValue(e,r.ArrowVerticalTriangleWidthParameterName,(function(t){return t.value-n})),this.changeParameterValue(e,r.ArrowVerticalLineHeightParameterName,(function(t){return t.value-2*o})),this.normalizeParameters(t,e)},e.prototype.getParameterPoints=function(t){return[new a.ShapeParameterPoint("c",new s.Point(t.normalizeX(t.position.x+t.size.width-t.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value),t.normalizeY(t.position.y+(t.size.height-t.parameters.get(r.ArrowVerticalLineHeightParameterName).value)/2)))]},e.prototype.processConnectionPoint=function(e,n){var o=e.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value;if(n.x>e.position.x+e.size.width-o){var i=e.size.height/2/o,a=(n.x-(e.position.x+e.size.width-o))*i,s=e.getConnectionPointSide(n);s===u.ConnectionPointSide.North?n.y+=a:s===u.ConnectionPointSide.South&&(n.y-=a)}else t.prototype.processConnectionPoint.call(this,e,n)},e}(r.ArrowHorizontalShapeDescription);e.ArrowRightShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowUpShapeDescription=void 0;var i=n(4),r=n(28),a=n(1),s=n(91),c=n(0),u=n(8),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.ArrowUp},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,r=e.right,a=e.bottom,c=e.width,u=e.center.x,l=(c-t.parameters.get(s.ArrowVerticalLineWidthParameterName).value)/2,p=t.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value,h=t.normalizeX(n+l),d=t.normalizeY(o+p),f=t.normalizeX(r-l);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(u,o),new i.PathPrimitiveLineToCommand(r,d),new i.PathPrimitiveLineToCommand(f,d),new i.PathPrimitiveLineToCommand(f,a),new i.PathPrimitiveLineToCommand(h,a),new i.PathPrimitiveLineToCommand(h,d),new i.PathPrimitiveLineToCommand(n,d),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.modifyParameters=function(t,e,n,o){this.changeParameterValue(e,s.ArrowVerticalTriangleHeightParameterName,(function(t){return t.value+o})),this.changeParameterValue(e,s.ArrowVerticalLineWidthParameterName,(function(t){return t.value-2*n})),this.normalizeParameters(t,e)},e.prototype.getParameterPoints=function(t){return[new r.ShapeParameterPoint("c",new a.Point(t.normalizeX(t.position.x+(t.size.width-t.parameters.get(s.ArrowVerticalLineWidthParameterName).value)/2),t.normalizeY(t.position.y+t.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value)))]},e.prototype.processConnectionPoint=function(e,n){var o=e.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value;if(n.y<e.position.y+o){var i=e.size.width/2/o,r=(e.position.y+o-n.y)*i,a=e.getConnectionPointSide(n);a===u.ConnectionPointSide.East?n.x-=r:a===u.ConnectionPointSide.West&&(n.x+=r)}else t.prototype.processConnectionPoint.call(this,e,n)},e}(s.ArrowVerticalShapeDescription);e.ArrowUpShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CrossShapeDescription=e.CrossVerticalWidthParameterName=e.CrossHorizontalWidthParameterName=void 0;var i=n(7),r=n(1),a=n(35),s=n(28),c=n(4),u=n(0);e.CrossHorizontalWidthParameterName="chw",e.CrossVerticalWidthParameterName="cvw";var l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n.prototype,"key",{get:function(){return u.ShapeTypes.Cross},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,a=n.bottom,s=n.width,u=n.height,l=(s-t.parameters.get(e.CrossHorizontalWidthParameterName).value)/2,p=(u-t.parameters.get(e.CrossVerticalWidthParameterName).value)/2,h=t.normalizeX(o+l),d=t.normalizeY(i+p),f=t.normalizeX(r-l),m=t.normalizeY(a-p);return[new c.PathPrimitive([new c.PathPrimitiveMoveToCommand(o,d),new c.PathPrimitiveLineToCommand(h,d),new c.PathPrimitiveLineToCommand(h,i),new c.PathPrimitiveLineToCommand(f,i),new c.PathPrimitiveLineToCommand(f,d),new c.PathPrimitiveLineToCommand(r,d),new c.PathPrimitiveLineToCommand(r,m),new c.PathPrimitiveLineToCommand(f,m),new c.PathPrimitiveLineToCommand(f,a),new c.PathPrimitiveLineToCommand(h,a),new c.PathPrimitiveLineToCommand(h,m),new c.PathPrimitiveLineToCommand(o,m),new c.PathPrimitiveClosePathCommand],t.style)]},n.prototype.createParameters=function(t){t.addRange([new a.ShapeParameter(e.CrossHorizontalWidthParameterName,.2*this.defaultSize.width),new a.ShapeParameter(e.CrossVerticalWidthParameterName,.2*this.defaultSize.height)])},n.prototype.normalizeParameters=function(t,n){this.changeParameterValue(n,e.CrossHorizontalWidthParameterName,(function(e){return Math.max(0,Math.min(t.size.width,e.value))})),this.changeParameterValue(n,e.CrossVerticalWidthParameterName,(function(e){return Math.max(0,Math.min(t.size.height,e.value))}))},n.prototype.modifyParameters=function(t,n,o,i){this.changeParameterValue(n,e.CrossHorizontalWidthParameterName,(function(t){return t.value-2*o})),this.changeParameterValue(n,e.CrossVerticalWidthParameterName,(function(t){return t.value-2*i})),this.normalizeParameters(t,n)},n.prototype.getParameterPoints=function(t){return[new s.ShapeParameterPoint("c",new r.Point(t.normalizeX(t.position.x+(t.size.width-t.parameters.get(e.CrossHorizontalWidthParameterName).value)/2),t.normalizeY(t.position.y+(t.size.height-t.parameters.get(e.CrossVerticalWidthParameterName).value)/2)))]},n.prototype.getTextRectangle=function(t){return t.rectangle.clone().inflate(-i.ShapeTextPadding,-i.ShapeTextPadding)},n.prototype.getSizeByText=function(t,e){return t.clone().offset(2*i.ShapeTextPadding,2*i.ShapeTextPadding)},n}(i.ShapeDescription);e.CrossShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.HeartShapeDescription=void 0;var i=n(7),r=n(4),a=n(0),s=n(45),c=n(8),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return a.ShapeTypes.Heart},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.createConnectionPoints=function(){return[new s.ConnectionPoint(.5,.15,c.ConnectionPointSide.North),new s.ConnectionPoint(1,.25,c.ConnectionPointSide.East),new s.ConnectionPoint(.5,1,c.ConnectionPointSide.South),new s.ConnectionPoint(0,.25,c.ConnectionPointSide.West)]},e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,i=e.right,a=e.bottom,s=e.width,c=e.height;return[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(i-.25*s,o),new r.PathPrimitiveCubicCurveToCommand(i-.15*s,o,i,o+.1*c,i,o+.25*c),new r.PathPrimitiveCubicCurveToCommand(i,o+.3*c,i-.02*s,o+.35*c,i-.05*s,o+.4*c),new r.PathPrimitiveLineToCommand(e.center.x,a),new r.PathPrimitiveLineToCommand(n+.05*s,o+.4*c),new r.PathPrimitiveCubicCurveToCommand(n+.02*s,o+.35*c,n,o+.3*c,n,o+.25*c),new r.PathPrimitiveCubicCurveToCommand(n,o+.1*c,n+.15*s,o,n+.25*s,o),new r.PathPrimitiveCubicCurveToCommand(n+.3*s,o,n+.45*s,o+.03*c,n+.5*s,o+.15*c),new r.PathPrimitiveCubicCurveToCommand(i-.45*s,o+.03*c,i-.3*s,o,i-.25*s,o),new r.PathPrimitiveClosePathCommand],t.style)]},e.prototype.getTextRectangle=function(t){return t.rectangle.clone().inflate(-i.ShapeTextPadding,-i.ShapeTextPadding)},e.prototype.getSizeByText=function(t,e){return e.size.clone().offset(2*i.ShapeTextPadding,2*i.ShapeTextPadding)},e}(i.ShapeDescription);e.HeartShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.OctagonShapeDescription=void 0;var i=n(4),r=n(0),a=n(93),s=n(3),c=n(12),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Octagon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angleCount",{get:function(){return 8},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,r=e.right,a=e.bottom,s=e.width,c=e.height,u=Math.PI-this.angle,l=s/(1+2*Math.cos(u)),p=c/(1+2*Math.cos(u)),h=n+(s-l)/2,d=h+l,f=o+(c-p)/2,m=f+p;return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(h,o),new i.PathPrimitiveLineToCommand(d,o),new i.PathPrimitiveLineToCommand(r,f),new i.PathPrimitiveLineToCommand(r,m),new i.PathPrimitiveLineToCommand(d,a),new i.PathPrimitiveLineToCommand(h,a),new i.PathPrimitiveLineToCommand(n,m),new i.PathPrimitiveLineToCommand(n,f),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.calculateHeight=function(t){return t},e.prototype.getTextRectangle=function(t){var e=s.GeometryUtils.getMaxRectangleEnscribedInEllipse(t.size);return c.Rectangle.fromGeometry(t.position.clone().offset((t.size.width-e.width)/2,(t.size.height-e.height)/2),e)},e.prototype.getSizeByText=function(t,e){return s.GeometryUtils.getEllipseByEnscribedRectangle(t)},e}(a.PolygonShapeDescription);e.OctagonShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StarShapeDescription=e.StarConvexParameterName=void 0;var i=n(4),r=n(0),a=n(124),s=n(35),c=n(28),u=n(1),l=n(8);e.StarConvexParameterName="sc";var p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n.prototype,"key",{get:function(){return r.ShapeTypes.Star},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,r=n.y,a=n.right,s=n.width,c=n.height,u=this.getActualBottom(r,n.bottom,s,c),l=n.center.x,p=r+(u-r)/2,h=c/s,d=Math.PI-this.angle,f=s/2*Math.tan(d/2)*h,m=r+f,g=(c-f)/Math.tan(d)/h,y=o+g,v=a-g,C=t.parameters.get(e.StarConvexParameterName).value,_=this.getInnerPointDistance(l,l,a,p,r,m);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(l,r),new i.PathPrimitiveLineToCommand(this.getInnerPointPos(l,l,a,C,_),this.getInnerPointPos(p,r,m,C,_)),new i.PathPrimitiveLineToCommand(a,m),new i.PathPrimitiveLineToCommand(this.getInnerPointPos(l,a,v,C,_),this.getInnerPointPos(p,m,u,C,_)),new i.PathPrimitiveLineToCommand(v,u),new i.PathPrimitiveLineToCommand(this.getInnerPointPos(l,v,y,C,_),this.getInnerPointPos(p,u,u,C,_)),new i.PathPrimitiveLineToCommand(y,u),new i.PathPrimitiveLineToCommand(this.getInnerPointPos(l,y,o,C,_),this.getInnerPointPos(p,u,m,C,_)),new i.PathPrimitiveLineToCommand(o,m),new i.PathPrimitiveLineToCommand(this.getInnerPointPos(l,o,l,C,_),this.getInnerPointPos(p,m,r,C,_)),new i.PathPrimitiveClosePathCommand],t.style)]},n.prototype.createParameters=function(t){t.addRange([new s.ShapeParameter(e.StarConvexParameterName,300)])},n.prototype.normalizeParameters=function(t,n){var o=t.rectangle,i=o.y,r=o.right,a=o.width,s=o.height,c=this.getActualBottom(i,o.bottom,a,s),u=o.center.x,l=i+(c-i)/2,p=s/a,h=Math.PI-this.angle,d=a/2*Math.tan(h/2)*p,f=i+d,m=this.getInnerPointDistance(u,u,r,l,i,f);this.changeParameterValue(n,e.StarConvexParameterName,(function(t){return Math.max(0,Math.min(m,t.value))}))},n.prototype.modifyParameters=function(t,n,o,i){var r=Math.sqrt(Math.pow(o,2)+Math.pow(i,2));(o<0||i>0)&&(r=-r),this.changeParameterValue(n,e.StarConvexParameterName,(function(t){return t.value+r})),this.normalizeParameters(t,n)},n.prototype.getParameterPoints=function(t){var n=t.rectangle,o=n.y,i=n.right,r=n.width,a=n.height,s=this.getActualBottom(o,n.bottom,r,a),l=n.center.x,p=o+(s-o)/2,h=a/r,d=Math.PI-this.angle,f=r/2*Math.tan(d/2)*h,m=o+f,g=t.parameters.get(e.StarConvexParameterName).value,y=this.getInnerPointDistance(l,l,i,p,o,m),v=this.getInnerPointPos(l,l,i,g,y),C=this.getInnerPointPos(p,o,m,g,y);return[new c.ShapeParameterPoint("c",new u.Point(v,C))]},n.prototype.processConnectionPoint=function(n,o){t.prototype.processConnectionPoint.call(this,n,o);var i=n.getConnectionPointSide(o);if(i===l.ConnectionPointSide.South){var r=n.rectangle,a=r.y,s=r.right,c=r.width,u=r.height,p=this.getActualBottom(a,r.bottom,c,u),h=r.center.x,d=a+(p-a)/2,f=u/c,m=Math.PI-this.angle,g=c/2*Math.tan(m/2)*f,y=a+g,v=n.parameters.get(e.StarConvexParameterName).value,C=this.getInnerPointDistance(h,h,s,d,a,y);o.y=this.getInnerPointPos(d,p,p,v,C)}},n.prototype.getInnerPointDistanceByAxis=function(t,e,n){var o=Math.min(e,n)+Math.abs(e-n)/2;return o-t},n.prototype.getInnerPointPos=function(t,e,n,o,i){var r=Math.min(1,o/i);return t+this.getInnerPointDistanceByAxis(t,e,n)*r},n.prototype.getInnerPointDistance=function(t,e,n,o,i,r){var a=this.getInnerPointDistanceByAxis(t,e,n),s=this.getInnerPointDistanceByAxis(o,i,r);return Math.sqrt(Math.pow(a,2)+Math.pow(s,2))},n.prototype.getActualBottom=function(e,n,o,i){var r=e+t.prototype.calculateHeight.call(this,o)*i/o;return r<n?r:n},n.prototype.calculateHeight=function(t){return t},n}(a.PentagonShapeDescription);e.StarShapeDescription=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowDownShapeDescription=void 0;var i=n(4),r=n(28),a=n(1),s=n(91),c=n(0),u=n(8),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.ArrowDown},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,r=e.right,a=e.bottom,c=e.width,u=e.height,l=e.center.x,p=(c-t.parameters.get(s.ArrowVerticalLineWidthParameterName).value)/2,h=u-t.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value,d=t.normalizeX(n+p),f=t.normalizeY(o+h),m=t.normalizeX(r-p);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(d,o),new i.PathPrimitiveLineToCommand(m,o),new i.PathPrimitiveLineToCommand(m,f),new i.PathPrimitiveLineToCommand(r,f),new i.PathPrimitiveLineToCommand(l,a),new i.PathPrimitiveLineToCommand(n,f),new i.PathPrimitiveLineToCommand(d,f),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.modifyParameters=function(t,e,n,o){this.changeParameterValue(e,s.ArrowVerticalTriangleHeightParameterName,(function(t){return t.value-o})),this.changeParameterValue(e,s.ArrowVerticalLineWidthParameterName,(function(t){return t.value-2*n})),this.normalizeParameters(t,e)},e.prototype.getParameterPoints=function(t){return[new r.ShapeParameterPoint("c",new a.Point(t.normalizeX(t.position.x+(t.size.width-t.parameters.get(s.ArrowVerticalLineWidthParameterName).value)/2),t.normalizeY(t.position.y+t.size.height-t.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value)))]},e.prototype.processConnectionPoint=function(e,n){var o=e.parameters.get(s.ArrowVerticalTriangleHeightParameterName).value;if(n.y>e.position.y+e.size.height-o){var i=e.size.width/2/o,r=(n.y-(e.position.y+e.size.height-o))*i,a=e.getConnectionPointSide(n);a===u.ConnectionPointSide.East?n.x-=r:a===u.ConnectionPointSide.West&&(n.x+=r)}else t.prototype.processConnectionPoint.call(this,e,n)},e}(s.ArrowVerticalShapeDescription);e.ArrowDownShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowLeftRightShapeDescription=void 0;var i=n(4),r=n(92),a=n(28),s=n(1),c=n(0),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.ArrowLeftRight},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,a=e.right,s=e.bottom,c=e.height,u=e.center.y,l=t.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value,p=(c-t.parameters.get(r.ArrowVerticalLineHeightParameterName).value)/2,h=t.normalizeX(n+l),d=t.normalizeY(o+p),f=t.normalizeX(a-l),m=t.normalizeY(s-p);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(n,u),new i.PathPrimitiveLineToCommand(h,o),new i.PathPrimitiveLineToCommand(h,d),new i.PathPrimitiveLineToCommand(f,d),new i.PathPrimitiveLineToCommand(f,o),new i.PathPrimitiveLineToCommand(a,u),new i.PathPrimitiveLineToCommand(f,s),new i.PathPrimitiveLineToCommand(f,m),new i.PathPrimitiveLineToCommand(h,m),new i.PathPrimitiveLineToCommand(h,s),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.normalizeParameters=function(t,e){this.changeParameterValue(e,r.ArrowVerticalTriangleWidthParameterName,(function(e){return Math.max(0,Math.min(t.size.width/2-2*t.strokeWidth,e.value))})),this.changeParameterValue(e,r.ArrowVerticalLineHeightParameterName,(function(e){return Math.max(0,Math.min(t.size.height,e.value))}))},e.prototype.modifyParameters=function(t,e,n,o){this.changeParameterValue(e,r.ArrowVerticalTriangleWidthParameterName,(function(t){return t.value+n})),this.changeParameterValue(e,r.ArrowVerticalLineHeightParameterName,(function(t){return t.value-2*o})),this.normalizeParameters(t,e)},e.prototype.getParameterPoints=function(t){return[new a.ShapeParameterPoint("c",new s.Point(t.normalizeX(t.position.x+t.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value),t.normalizeY(t.position.y+(t.size.height-t.parameters.get(r.ArrowVerticalLineHeightParameterName).value)/2)))]},e}(r.ArrowHorizontalShapeDescription);e.ArrowLeftRightShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ArrowLeftShapeDescription=void 0;var i=n(4),r=n(92),a=n(28),s=n(1),c=n(0),u=n(8),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.ArrowLeft},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,a=e.right,s=e.bottom,c=e.height,u=e.center.y,l=t.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value,p=(c-t.parameters.get(r.ArrowVerticalLineHeightParameterName).value)/2,h=t.normalizeX(n+l),d=t.normalizeY(o+p),f=t.normalizeY(s-p);return[new i.PathPrimitive([new i.PathPrimitiveMoveToCommand(n,u),new i.PathPrimitiveLineToCommand(h,o),new i.PathPrimitiveLineToCommand(h,d),new i.PathPrimitiveLineToCommand(a,d),new i.PathPrimitiveLineToCommand(a,f),new i.PathPrimitiveLineToCommand(h,f),new i.PathPrimitiveLineToCommand(h,s),new i.PathPrimitiveClosePathCommand],t.style)]},e.prototype.modifyParameters=function(t,e,n,o){this.changeParameterValue(e,r.ArrowVerticalTriangleWidthParameterName,(function(t){return t.value+n})),this.changeParameterValue(e,r.ArrowVerticalLineHeightParameterName,(function(t){return t.value-2*o})),this.normalizeParameters(t,e)},e.prototype.getParameterPoints=function(t){return[new a.ShapeParameterPoint("c",new s.Point(t.normalizeX(t.position.x+t.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value),t.normalizeY(t.position.y+(t.size.height-t.parameters.get(r.ArrowVerticalLineHeightParameterName).value)/2)))]},e.prototype.processConnectionPoint=function(e,n){var o=e.parameters.get(r.ArrowVerticalTriangleWidthParameterName).value;if(n.x<e.position.x+o){var i=e.size.height/2/o,a=(e.position.x+o-n.x)*i,s=e.getConnectionPointSide(n);s===u.ConnectionPointSide.North?n.y+=a:s===u.ConnectionPointSide.South&&(n.y-=a)}else t.prototype.processConnectionPoint.call(this,e,n)},e}(r.ArrowHorizontalShapeDescription);e.ArrowLeftShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MultipleDocumentsShapeDescription=void 0;var i=n(0),r=n(4),a=n(127),s=n(53),c=n(18),u=n(7),l=n(2),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return i.ShapeTypes.MultipleDocuments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t,n){var o=t.rectangle,i=t.rectangle,r=i.width,a=i.height,s=n?e.documentsOffsetRatioForToolbox:e.documentsOffsetRatio,u=Math.ceil(r*s),l=Math.ceil(a*s);o=o.clone().inflate(-u,-l).clone().moveRectangle(-u,-l);var p=o.clone().moveRectangle(u,l),h=p.clone().moveRectangle(u,l),d=c.RenderUtils.generateSvgElementId("clipRect"),f=[];return f.concat(this.createDocumentPrimitives(o,t.style,d+"1",p)).concat(this.createDocumentPrimitives(p,t.style,d+"2",h)).concat(this.createDocumentPrimitives(h,t.style))},e.prototype.createDocumentPrimitives=function(t,e,n,o){var i=t.x,c=t.y,u=t.right,l=t.bottom,p=t.width,h=t.height,d=t.center.x,f=h*a.DocumentShapeDescription.curveOffsetRatio,m=[];return m=m.concat([new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(i,c),new r.PathPrimitiveLineToCommand(u,c),new r.PathPrimitiveLineToCommand(u,l),new r.PathPrimitiveQuadraticCurveToCommand(u-.25*p,l-2*f,d,l-f),new r.PathPrimitiveQuadraticCurveToCommand(i+.25*p,l+f,i,l-f),new r.PathPrimitiveClosePathCommand],e,void 0,o&&n)]),o&&n&&(m=m.concat([new s.ClipPathPrimitive(n,[new r.PathPrimitive([new r.PathPrimitiveMoveToCommand(i-e.strokeWidth,c-e.strokeWidth),new r.PathPrimitiveLineToCommand(u+e.strokeWidth,c-e.strokeWidth),new r.PathPrimitiveLineToCommand(u+e.strokeWidth,o.y),new r.PathPrimitiveLineToCommand(o.x,o.y),new r.PathPrimitiveLineToCommand(o.x,l+e.strokeWidth),new r.PathPrimitiveLineToCommand(i-e.strokeWidth,l+e.strokeWidth),new r.PathPrimitiveClosePathCommand])])])),m},e.prototype.getTextRectangle=function(t){var n=t.rectangle,o=n.width*e.documentsOffsetRatio,i=n.height*e.documentsOffsetRatio;n=n.clone().inflate(-o,-i).clone().moveRectangle(-o,-i);var r=n.clone().moveRectangle(2*o+u.ShapeTextPadding,2*i+u.ShapeTextPadding);return r.clone().resize(-2*u.ShapeTextPadding,-n.height*a.DocumentShapeDescription.curveOffsetRatio-2*u.ShapeTextPadding)},e.prototype.getSizeByText=function(t,n){return new l.Size((t.width+2*u.ShapeTextPadding)/(1-2*e.documentsOffsetRatio),(t.height+2*u.ShapeTextPadding)/((1-a.DocumentShapeDescription.curveOffsetRatio)*(1-e.documentsOffsetRatio))).nonNegativeSize()},e.documentsOffsetRatio=.1,e.documentsOffsetRatioForToolbox=.16,e}(a.DocumentShapeDescription);e.MultipleDocumentsShapeDescription=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PreparationShapeDescription=void 0;var i=n(0),r=n(2),a=n(7),s=n(125),c=function(t){function e(){var e=t.call(this,!0)||this;return e.defaultSize=new r.Size(a.ShapeDefaultDimension,.75*a.ShapeDefaultDimension),e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return i.ShapeTypes.Preparation},enumerable:!1,configurable:!0}),e}(s.HexagonShapeDescription);e.PreparationShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.HardDiskShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(52),c=n(7),u=n(2),l=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.HardDisk},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,c=n.bottom,u=n.width,l=n.center.y,p=u*e.arcWidthRatio;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(r-p/2,i),new a.PathPrimitiveLineToCommand(o+p/2,i),new a.PathPrimitiveArcToCommand(p/2,(c-i)/2,0,!1,!1,o+p/2,c),new a.PathPrimitiveLineToCommand(r-p/2,c)],t.style),new s.EllipsePrimitive(r-p/2,l,p/2,(c-i)/2,t.style)]},e.prototype.getTextRectangle=function(t){var n=t.rectangle,o=n.width*e.arcWidthRatio*1.5;return n.clone().resize(-o-2*c.ShapeTextPadding,-2*c.ShapeTextPadding).moveRectangle(c.ShapeTextPadding,c.ShapeTextPadding).nonNegativeSize()},e.prototype.getSizeByText=function(t,n){return new u.Size((t.width+2*c.ShapeTextPadding)/(1-1.5*e.arcWidthRatio),n.size.height+c.ShapeTextPadding)},e.arcWidthRatio=.2,e}(i.RectangleShapeDescription);e.HardDiskShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DatabaseShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(52),c=function(t){function e(){var e=t.call(this,void 0,!0)||this;return e.defaultSize.width=e.defaultSize.height,e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Database},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,c=n.bottom,u=n.height,l=n.center.x,p=u*e.arcWidthRatio;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(r,i+p/2),new a.PathPrimitiveLineToCommand(r,c-p/2),new a.PathPrimitiveArcToCommand((r-o)/2,p/2,0,!1,!0,o,c-p/2),new a.PathPrimitiveLineToCommand(o,i+p/2)],t.style),new s.EllipsePrimitive(l,i+p/2,(r-o)/2,p/2,t.style)]},e.prototype.getTextRectangle=function(t){var n=t.rectangle,o=n.height*e.arcWidthRatio;return n.clone().resize(0,-o).clone().moveRectangle(0,o)},e.arcWidthRatio=.2,e}(i.RectangleShapeDescription);e.DatabaseShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.InternalStorageShapeDescription=e.InternalStorageVerticalEdgeParameterName=e.InternalStorageHorizontalEdgeParameterName=void 0;var i=n(20),r=n(0),a=n(35),s=n(28),c=n(1),u=n(4);e.InternalStorageHorizontalEdgeParameterName="he",e.InternalStorageVerticalEdgeParameterName="ve";var l=function(t){function n(){return t.call(this,void 0,!0)||this}return o(n,t),Object.defineProperty(n.prototype,"key",{get:function(){return r.ShapeTypes.InternalStorage},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),n.prototype.createShapePrimitives=function(n){var o=n.rectangle,i=o.x,r=o.y,a=o.right,s=o.bottom,c=i+n.parameters.get(e.InternalStorageHorizontalEdgeParameterName).value,l=r+n.parameters.get(e.InternalStorageVerticalEdgeParameterName).value,p=t.prototype.createShapePrimitives.call(this,n);return p.concat([new u.PathPrimitive([new u.PathPrimitiveMoveToCommand(c,r),new u.PathPrimitiveLineToCommand(c,s),new u.PathPrimitiveMoveToCommand(i,l),new u.PathPrimitiveLineToCommand(a,l)],n.style)])},n.prototype.createParameters=function(t){t.addRange([new a.ShapeParameter(e.InternalStorageHorizontalEdgeParameterName,.1*this.defaultSize.width),new a.ShapeParameter(e.InternalStorageVerticalEdgeParameterName,.1*this.defaultSize.width)])},n.prototype.normalizeParameters=function(t,o){this.changeParameterValue(o,e.InternalStorageHorizontalEdgeParameterName,(function(e){return Math.max(n.minEdge,Math.min(.3*t.size.width,e.value))})),this.changeParameterValue(o,e.InternalStorageVerticalEdgeParameterName,(function(e){return Math.max(n.minEdge,Math.min(.3*t.size.height,e.value))}))},n.prototype.modifyParameters=function(t,n,o,i){this.changeParameterValue(n,e.InternalStorageHorizontalEdgeParameterName,(function(t){return t.value+o})),this.changeParameterValue(n,e.InternalStorageVerticalEdgeParameterName,(function(t){return t.value+i})),this.normalizeParameters(t,n)},n.prototype.getParameterPoints=function(t){return[new s.ShapeParameterPoint("c",new c.Point(t.normalizeX(t.position.x+t.parameters.get(e.InternalStorageHorizontalEdgeParameterName).value),t.normalizeY(t.position.y+t.parameters.get(e.InternalStorageVerticalEdgeParameterName).value)))]},n.prototype.getTextRectangle=function(t){var n=t.rectangle,o=t.parameters.get(e.InternalStorageHorizontalEdgeParameterName).value;return n.clone().resize(-o,0).clone().moveRectangle(o,0)},n.minEdge=72,n}(i.RectangleShapeDescription);e.InternalStorageShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PaperTapeShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(8),c=n(7),u=n(2),l=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.PaperTape},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){return this.createDocumentPrimitives(t.rectangle,t.style)},e.prototype.createDocumentPrimitives=function(t,n){var o=t.x,i=t.y,r=t.right,s=t.bottom,c=t.width,u=t.height,l=t.center.x,p=u*e.curveOffsetRatio,h=[];return h.concat([new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(o,i),new a.PathPrimitiveQuadraticCurveToCommand(o+.25*c,i+2*p,l,i+p),new a.PathPrimitiveQuadraticCurveToCommand(r-.25*c,i-p,r,i+p),new a.PathPrimitiveLineToCommand(r,s),new a.PathPrimitiveQuadraticCurveToCommand(r-.25*c,s-2*p,l,s-p),new a.PathPrimitiveQuadraticCurveToCommand(o+.25*c,s+p,o,s-p),new a.PathPrimitiveClosePathCommand],n)])},e.prototype.processConnectionPoint=function(t,n){var o=t.getConnectionPointSide(n);o===s.ConnectionPointSide.North&&(n.y+=t.size.height*e.curveOffsetRatio),o===s.ConnectionPointSide.South&&(n.y-=t.size.height*e.curveOffsetRatio)},e.prototype.getTextRectangle=function(t){var n=t.rectangle;return n.clone().inflate(c.ShapeTextPadding,-n.height*e.curveOffsetRatio)},e.prototype.getSizeByText=function(t,n){return new u.Size(t.width+2*c.ShapeTextPadding,t.height/(1-2*e.curveOffsetRatio))},e.curveOffsetRatio=.1,e}(i.RectangleShapeDescription);e.PaperTapeShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ManualOperationShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(8),c=n(7),u=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.ManualOperation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=t.rectangle,i=o.x,r=o.y,s=o.right,c=o.bottom,u=o.width,l=o.height,p=Math.min(Math.max(0,l/Math.tan(e.slopeAngle)),u),h=n.center.x,d=Math.min(i+p,h),f=Math.max(s-p,h);return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(i,r),new a.PathPrimitiveLineToCommand(s,r),new a.PathPrimitiveLineToCommand(f,c),new a.PathPrimitiveLineToCommand(d,c),new a.PathPrimitiveClosePathCommand],t.style)]},e.prototype.processConnectionPoint=function(t,n){var o=t.size.height/Math.tan(e.slopeAngle),i=t.getConnectionPointSide(n);i===s.ConnectionPointSide.East?n.x-=o/2:i===s.ConnectionPointSide.West&&(n.x+=o/2)},e.prototype.getTextRectangle=function(t){var n=Math.min(Math.max(0,t.size.height/Math.tan(e.slopeAngle)),t.size.width);return t.rectangle.clone().moveRectangle(n,c.ShapeTextPadding).resize(2*-n,2*-c.ShapeTextPadding).nonNegativeSize()},e.slopeAngle=81*Math.PI/180,e}(i.RectangleShapeDescription);e.ManualOperationShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DelayShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(3),c=n(7),u=n(2),l=function(t){function e(){var e=t.call(this,void 0,!0)||this;return e.defaultSize.width=e.defaultSize.height,e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Delay},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,i=e.right,r=e.bottom,s=e.center.x;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(n,o),new a.PathPrimitiveLineToCommand(s,o),new a.PathPrimitiveArcToCommand((i-n)/2,(r-o)/2,0,!1,!0,s,r),new a.PathPrimitiveLineToCommand(n,r),new a.PathPrimitiveClosePathCommand],t.style)]},e.prototype.getTextRectangle=function(t){var e=s.GeometryUtils.getMaxRectangleEnscribedInEllipse(t.size);return t.rectangle.clone().moveRectangle(c.ShapeTextPadding,c.ShapeTextPadding).setSize({width:e.width/2+t.size.width/2-c.ShapeTextPadding,height:e.height/2+t.size.height/2-c.ShapeTextPadding}).nonNegativeSize()},e.prototype.getSizeByText=function(t,e){var n=s.GeometryUtils.getEllipseByEnscribedRectangle(t);return new u.Size(n.width/2+t.width/2+c.ShapeTextPadding,n.height/2+t.height/2+c.ShapeTextPadding)},e.arcWidthRatio=.2,e}(i.RectangleShapeDescription);e.DelayShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.StoredDataShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(7),c=n(2),u=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.StoredData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,s=n.bottom,c=n.width,u=c*e.arcWidthRatio;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(r,i),new a.PathPrimitiveLineToCommand(o+u/2,i),new a.PathPrimitiveArcToCommand(u/2,(s-i)/2,0,!1,!1,o+u/2,s),new a.PathPrimitiveLineToCommand(r,s),new a.PathPrimitiveArcToCommand(u/2,(s-i)/2,0,!1,!0,r,i)],t.style)]},e.prototype.getTextRectangle=function(t){var n=t.rectangle,o=n.width*e.arcWidthRatio/2;return n.clone().resize(-o-2*s.ShapeTextPadding,-2*s.ShapeTextPadding).moveRectangle(s.ShapeTextPadding,s.ShapeTextPadding).nonNegativeSize()},e.prototype.getSizeByText=function(t,n){return new c.Size((t.width+2*s.ShapeTextPadding)/(1-e.arcWidthRatio/2),t.height+2*s.ShapeTextPadding)},e.arcWidthRatio=.2,e}(i.RectangleShapeDescription);e.StoredDataShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MergeShapeDescription=void 0;var i=n(0),r=n(12),a=n(126),s=n(4),c=n(7),u=n(2),l=function(t){function e(){return t.call(this,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return i.ShapeTypes.Merge},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var e=t.rectangle,n=e.x,o=e.y,i=e.right,r=e.bottom;return[new s.PathPrimitive([new s.PathPrimitiveMoveToCommand(n,o),new s.PathPrimitiveLineToCommand(i,o),new s.PathPrimitiveLineToCommand(e.center.x,r),new s.PathPrimitiveClosePathCommand],t.style)]},e.prototype.calculateHeight=function(t){return.75*t},e.prototype.getTextRectangle=function(t){return r.Rectangle.fromGeometry(t.position.clone().offset(t.size.width/4,c.ShapeTextPadding),new u.Size(t.size.width/2,t.size.height/2-c.ShapeTextPadding))},e.prototype.getSizeByText=function(t,e){return new u.Size(2*t.width,2*(t.height+c.ShapeTextPadding))},e}(a.TriangleShapeDescription);e.MergeShapeDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DisplayShapeDescription=void 0;var i=n(20),r=n(0),a=n(4),s=n(7),c=function(t){function e(){return t.call(this,void 0,!0)||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.Display},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(t){var n=t.rectangle,o=n.x,i=n.y,r=n.right,s=n.bottom,c=n.width,u=n.center.y,l=c*e.arcWidthRatio;return[new a.PathPrimitive([new a.PathPrimitiveMoveToCommand(r-l/2,i),new a.PathPrimitiveLineToCommand(o+l/2,i),new a.PathPrimitiveLineToCommand(o,u),new a.PathPrimitiveLineToCommand(o+l/2,s),new a.PathPrimitiveLineToCommand(r-l/2,s),new a.PathPrimitiveArcToCommand(l/2,(s-i)/2,0,!1,!1,r-l/2,i)],t.style)]},e.prototype.getTextRectangle=function(t){var n=t.size.width*e.arcWidthRatio;return t.rectangle.clone().moveRectangle(n/2,s.ShapeTextPadding).resize(-n,2*-s.ShapeTextPadding).nonNegativeSize()},e.arcWidthRatio=.2,e}(i.RectangleShapeDescription);e.DisplayShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.OrShapeDescription=void 0;var i=n(0),r=n(2),a=n(7),s=n(68),c=n(4),u=function(t){function e(){var e=t.call(this,!0)||this;return e.defaultSize=new r.Size(.5*a.ShapeDefaultDimension,.5*a.ShapeDefaultDimension),e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return i.ShapeTypes.Or},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableText",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(e){var n=e.rectangle,o=n.x,i=n.y,r=n.right,a=n.bottom,s=n.center,u=s.x,l=s.y,p=[];return p.concat(t.prototype.createShapePrimitives.call(this,e)).concat([new c.PathPrimitive([new c.PathPrimitiveMoveToCommand(u,i),new c.PathPrimitiveLineToCommand(u,a),new c.PathPrimitiveMoveToCommand(o,l),new c.PathPrimitiveLineToCommand(r,l)],e.style)])},e}(s.EllipseShapeDescription);e.OrShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SummingJunctionShapeDescription=void 0;var i=n(0),r=n(2),a=n(7),s=n(68),c=n(4),u=function(t){function e(){var e=t.call(this,!0)||this;return e.defaultSize=new r.Size(.5*a.ShapeDefaultDimension,.5*a.ShapeDefaultDimension),e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return i.ShapeTypes.SummingJunction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableText",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.createShapePrimitives=function(e){var n=e.rectangle,o=n.width,i=n.height,r=n.center,a=r.x,s=r.y,u=o/2,l=i/2,p=Math.atan(l/u),h=1/Math.sqrt(1/Math.pow(u,2)+Math.pow(Math.tan(p),2)/Math.pow(l,2)),d=h*Math.tan(p),f=[];return f.concat(t.prototype.createShapePrimitives.call(this,e)).concat([new c.PathPrimitive([new c.PathPrimitiveMoveToCommand(a-h,s-d),new c.PathPrimitiveLineToCommand(a+h,s+d),new c.PathPrimitiveMoveToCommand(a-h,s+d),new c.PathPrimitiveLineToCommand(a+h,s-d)],e.style)])},e}(s.EllipseShapeDescription);e.SummingJunctionShapeDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SvgElementPrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r,a,s,c,u){var l=t.call(this,null,c,void 0,u)||this;return l.x=e,l.y=n,l.width=o,l.height=i,l.createContent=r,l.destroyContent=a,l.data=s,l}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"svg")},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"x",this.x),this.setUnitAttribute(e,"y",this.y),this.setUnitAttribute(e,"width",this.width),this.setUnitAttribute(e,"height",this.height),this.setPositionCorrectionAttribute(e),t.prototype.applyElementProperties.call(this,e,n)},e.prototype.createCustomContent=function(t){this.createContent&&this.createContent(t,this.data)},e.prototype.destroyCustomContent=function(t){this.destroyContent&&this.destroyContent(t)},e}(r.SvgPrimitive);e.SvgElementPrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.VerticalContainerDescription=void 0;var i=n(1),r=n(2),a=n(22),s=n(12),c=n(0),u=n(7),l=n(133),p=function(t){function e(){return t.call(this,new r.Size(2*u.ShapeDefaultDimension,1.5*u.ShapeDefaultDimension))||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.VerticalContainer},enumerable:!1,configurable:!0}),e.prototype.getExpandedSize=function(t){return new r.Size(t.size.width,t.expandedSize.height)},e.prototype.getCollapsedSize=function(t){return new r.Size(t.size.width,l.CONTAINER_HEADER_SIZE+2*t.strokeWidth)},e.prototype.allowResizeVertically=function(t){return t.expanded},e.prototype.createHeaderPrimitives=function(t,e){var n=t.rectangle,o=n.x,i=n.y,r=n.width,c=this.getHeaderSize(t,e),u=[];return u=u.concat([new a.RectanglePrimitive(o,i,r,c,t.style)]),e||(u=u.concat(this.createExpandButtonPrimitives(t,new s.Rectangle(o,i,c,c)))),u},e.prototype.getClientRectangle=function(t){var e=t.rectangle,n=this.getHeaderSize(t);return s.Rectangle.fromGeometry(new i.Point(e.x,e.y+n),new r.Size(e.width,e.height-n))},e.prototype.getTextRectangle=function(t){var e=t.rectangle,n=this.getHeaderSize(t);return s.Rectangle.fromGeometry(new i.Point(e.x+n,e.y),new r.Size(e.width-n,n))},e.prototype.getSizeByText=function(t,e){var n=this.getHeaderSize(e);return new r.Size(Math.max(e.size.width,t.width+n),e.size.height)},e.prototype.getHeaderSize=function(t,e){var n=t.rectangle;return e?n.height*l.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO:l.CONTAINER_HEADER_SIZE+2*t.strokeWidth},e}(l.ContainerDescription);e.VerticalContainerDescription=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.HorizontalContainerDescription=void 0;var i=n(7),r=n(12),a=n(2),s=n(1),c=n(0),u=n(133),l=n(22),p=n(58),h=function(t){function e(){return t.call(this,new a.Size(2*i.ShapeDefaultDimension,1.5*i.ShapeDefaultDimension))||this}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return c.ShapeTypes.HorizontalContainer},enumerable:!1,configurable:!0}),e.prototype.getExpandedSize=function(t){return new a.Size(t.expandedSize.width,t.size.height)},e.prototype.getCollapsedSize=function(t){return new a.Size(u.CONTAINER_HEADER_SIZE+2*t.strokeWidth,t.size.height)},e.prototype.allowResizeHorizontally=function(t){return t.expanded},e.prototype.createHeaderPrimitives=function(t,e){var n=t.rectangle,o=n.x,i=n.y,a=n.height,s=this.getHeaderSize(t,e),c=[];return c=c.concat([new l.RectanglePrimitive(o,i,s,a,t.style)]),e||(c=c.concat(this.createExpandButtonPrimitives(t,new r.Rectangle(o,i,s,s)))),c},e.prototype.getClientRectangle=function(t){var e=t.rectangle,n=this.getHeaderSize(t);return r.Rectangle.fromGeometry(new s.Point(e.x+n,e.y),new a.Size(e.width-n,e.height))},e.prototype.getTextRectangle=function(t){var e=t.rectangle,n=this.getHeaderSize(t);return r.Rectangle.fromGeometry(new s.Point(e.x,e.y+n),new a.Size(n,e.height-n)).nonNegativeSize()},e.prototype.getSizeByText=function(t,e){var n=this.getHeaderSize(e);return new a.Size(e.size.width,Math.max(e.size.height,Math.max(t.width+n,e.size.height)))},e.prototype.getTextEditRectangle=function(t){var e=this.getTextRectangle(t);return r.Rectangle.fromGeometry(new s.Point(e.x,e.y+e.height),new a.Size(e.height,e.width))},e.prototype.getTextAngle=function(){return p.TextAngle.Angle270deg},e.prototype.getHeaderSize=function(t,e){var n=t.rectangle;return e?n.height*u.CONTAINER_HEADER_TOOLBOX_SIZE_RATIO:u.CONTAINER_HEADER_SIZE+2*t.strokeWidth},e}(u.ContainerDescription);e.HorizontalContainerDescription=h},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CardWithImageOnTopDescription=void 0;var i=n(7),r=n(2),a=n(0),s=n(134),c=n(11),u=function(t){function e(){var e=t.call(this,new r.Size(.8*i.ShapeDefaultDimension,i.ShapeDefaultDimension))||this;return e.isTextAfterImage=!0,e.isHorizontal=!1,e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return a.ShapeTypes.CardWithImageOnTop},enumerable:!1,configurable:!0}),e.prototype.getImageSize=function(t,e,n){var o=t.width/2;c.UnitConverter.twipsToPixels(o)%2===1&&(o-=c.UnitConverter.pixelsToTwips(1));var i=Math.max(0,t.height-(e?0:2*this.getImageMargin(n)));return i=Math.min(o,i),new r.Size(i,i)},e.prototype.getImageSizeByTextBlockSize=function(t){return this.getImageSize(new r.Size(t.width,Number.MAX_VALUE),!0)},e}(s.CardBaseDescription);e.CardWithImageOnTopDescription=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RoundedRectanglePrimitive=void 0;var i=n(15),r=n(22),a=function(t){function e(e,n,o,i,r,a,s,c,u,l){void 0===r&&(r=0),void 0===a&&(a=0);var p=t.call(this,e,n,o,i,s,c,u,l)||this;return p.x=e,p.y=n,p.width=o,p.height=i,p.rx=r,p.ry=a,p}return o(e,t),e.prototype.createMainElement=function(){return document.createElementNS(i.svgNS,"rect")},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"rx",this.rx),this.setUnitAttribute(e,"ry",this.ry),t.prototype.applyElementProperties.call(this,e,n)},e}(r.RectanglePrimitive);e.RoundedRectanglePrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorShapeDescription=void 0;var i=n(0),r=n(2),a=n(7),s=n(68),c=function(t){function e(){var e=t.call(this,!1)||this;return e.defaultSize=new r.Size(.5*a.ShapeDefaultDimension,.5*a.ShapeDefaultDimension),e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return i.ShapeTypes.Connector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keepRatioOnAutoSize",{get:function(){return!0},enumerable:!1,configurable:!0}),e}(s.EllipseShapeDescription);e.ConnectorShapeDescription=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CardWithImageOnRightDescription=e.CardWithImageOnLeftDescription=void 0;var i=n(7),r=n(0),a=n(134),s=n(2),c=function(t){function e(){var e=t.call(this,new s.Size(1.5*i.ShapeDefaultDimension,.5*i.ShapeDefaultDimension))||this;return e.isHorizontal=!0,e}return o(e,t),e.prototype.getToolboxHeightToWidthRatio=function(t,e){return 26/46},e.prototype.getImageSize=function(t,e,n){var o=Math.min(t.height,t.width);return e||(o=Math.max(0,o-2*this.getImageMargin(n))),new s.Size(o,o)},e.prototype.getImageSizeByTextBlockSize=function(t){return this.getImageSize(new s.Size(Number.MAX_VALUE,t.height),!0)},e}(a.CardBaseDescription),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTextAfterImage=!0,e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.CardWithImageOnLeft},enumerable:!1,configurable:!0}),e}(c);e.CardWithImageOnLeftDescription=u;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTextAfterImage=!1,e}return o(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return r.ShapeTypes.CardWithImageOnRight},enumerable:!1,configurable:!0}),e}(c);e.CardWithImageOnRightDescription=l},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportCommand=void 0;var i=n(69),r=n(54),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=new i.Exporter,o=n.export(this.control.model);return e(o),!0},e}(r.ExportImportCommandBase);e.ExportCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleFontBoldCommand=void 0;var i=n(70),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"font-weight"},e.prototype.getStylePropertyValue=function(){return"bold"},e}(i.ToggleStyleTextPropertyCommand);e.ToggleFontBoldCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleFontItalicCommand=void 0;var i=n(70),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"font-style"},e.prototype.getStylePropertyValue=function(){return"italic"},e}(i.ToggleStyleTextPropertyCommand);e.ToggleFontItalicCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleFontUnderlineCommand=void 0;var i=n(70),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"text-decoration"},e.prototype.getStylePropertyValue=function(){return"underline"},e}(i.ToggleStyleTextPropertyCommand);e.ToggleFontUnderlineCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeFontNameCommand=void 0;var i=n(95),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"font-family"},e}(i.ChangeStyleTextPropertyCommand);e.ChangeFontNameCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeFontSizeCommand=void 0;var i=n(95),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"font-size"},e}(i.ChangeStyleTextPropertyCommand);e.ChangeFontSizeCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeFontColorCommand=void 0;var i=n(95),r=n(23),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.processParameter=function(t){return r.ColorUtils.stringToHash(t)},e.prototype.getStyleProperty=function(){return"fill"},e}(i.ChangeStyleTextPropertyCommand);e.ChangeFontColorCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeFillColorCommand=void 0;var i=n(71),r=n(23),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.processParameter=function(t){return r.ColorUtils.stringToHash(t)},e.prototype.getStyleProperty=function(){return"fill"},e}(i.ChangeStylePropertyCommand);e.ChangeFillColorCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStrokeColorCommand=void 0;var i=n(71),r=n(23),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.processParameter=function(t){return r.ColorUtils.stringToHash(t)},e.prototype.getStyleProperty=function(){return"stroke"},e}(i.ChangeStylePropertyCommand);e.ChangeStrokeColorCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TextRightAlignCommand=e.TextCenterAlignCommand=e.TextLeftAlignCommand=e.ChangeTextAlignCommand=void 0;var i=n(70),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"text-anchor"},e}(i.ToggleStyleTextPropertyCommand);e.ChangeTextAlignCommand=r;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStylePropertyValue=function(){return"start"},e}(r);e.TextLeftAlignCommand=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStylePropertyValue=function(){return"middle"},e}(r);e.TextCenterAlignCommand=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStylePropertyValue=function(){return"end"},e}(r);e.TextRightAlignCommand=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorEndLineEndingCommand=e.ChangeConnectorStartLineEndingCommand=void 0;var i=n(138),r=n(31),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPropertyName=function(){return"startLineEnding"},e.prototype.getPropertyDefaultValue=function(){return r.ConnectorLineEnding.None},e}(i.ChangeConnectorPropertyCommand);e.ChangeConnectorStartLineEndingCommand=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPropertyName=function(){return"endLineEnding"},e.prototype.getPropertyDefaultValue=function(){return r.ConnectorLineEnding.Arrow},e}(i.ChangeConnectorPropertyCommand);e.ChangeConnectorEndLineEndingCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorLineOptionCommand=void 0;var i=n(138),r=n(31),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPropertyName=function(){return"lineOption"},e.prototype.getPropertyDefaultValue=function(){return r.ConnectorLineOption.Straight},e}(i.ChangeConnectorPropertyCommand);e.ChangeConnectorLineOptionCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SelectAllCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.executeCore=function(t,e){var n=[];return this.control.model.iterateItems((function(t){return n.push(t.key)})),this.control.selection.set(n),!0},e}(i.SimpleCommandBase);e.SelectAllCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollIntoViewOnUndoHistoryItem=e.ScrollIntoViewOnRedoHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n){var o=t.call(this)||this;return o.view=e,o.rectangle=n,o.view=e,o.rectangle=n.clone(),o}return o(e,t),e.prototype.redo=function(t){this.view.scrollIntoView(this.rectangle)},e.prototype.undo=function(t){},e}(i.HistoryItem);e.ScrollIntoViewOnRedoHistoryItem=r;var a=function(t){function e(e,n){var o=t.call(this)||this;return o.view=e,o.rectangle=n,o.view=e,o.rectangle=n.clone(),o}return o(e,t),e.prototype.redo=function(t){},e.prototype.undo=function(t){this.view.scrollIntoView(this.rectangle)},e}(i.HistoryItem);e.ScrollIntoViewOnUndoHistoryItem=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tree=void 0;var o=n(36),i=function(){function t(t,e){var n=this;this.childToParent={},this.root=t,this.parentToChildren=e;var o=function(t){if(!Object.prototype.hasOwnProperty.call(e,t))return"continue";e[t].forEach((function(e){return n.childToParent[e.key]=t}))};for(var i in e)o(i)}return t.prototype.getChildren=function(t){return t&&this.parentToChildren[t.key]?this.parentToChildren[t.key]:[]},t.prototype.hasChildren=function(t){return this.parentToChildren[t.key]&&this.parentToChildren[t.key].length>0},t.prototype.iterate=function(t){this.iterateCore(this.root,0,t)},t.createSpanningTree=function(e){var n=t.findRoot(e),i=e.createIterator(o.ConnectionMode.Outgoing),r={};return i.skipEdge=function(t){return void 0===t.to||i.isNodeVisited(t.to)},i.onNode=function(t){return r[t.key]=[]},i.onEdge=function(t){var n=e.getNode(t.to);n&&r[t.from].push(n)},i.iterate(n),new t(e.getNode(n),r)},t.prototype.iterateCore=function(t,e,n){var o=this;n(t,e),this.getChildren(t).forEach((function(t){return o.iterateCore(t,e+1,n)}))},t.findRoot=function(t){return t.nodes.reduce((function(e,n){var o=t.getAdjacentEdges(n),i=o.filter((function(t){return t.to===n})).length,r=o.filter((function(t){return t.from===n})).length;return(void 0===e.candidate||0===i&&e.inc>0||0!==e.inc&&e.out-e.inc<r-i)&&(e.candidate=n,e.inc=i,e.out=r),e}),{inc:-1,out:-1,candidate:void 0}).candidate},t}();e.Tree=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeSnapToGridCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=void 0===e?!this.control.settings.snapToGrid:!!e;return this.control.settings.snapToGrid!==n&&(this.control.settings.snapToGrid=n,!0)},e.prototype.getValue=function(){return this.control.settings.snapToGrid},e}(i.SimpleCommandBase);e.ChangeSnapToGridCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeGridSizeItemsCommand=e.ChangeGridSizeCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.getModelUnit(this.control.settings.gridSize)},e.prototype.executeCore=function(t,e){return this.control.settings.gridSize=this.getModelUnitTwipsValue(e),!0},e.prototype.getItems=function(){var t=this;return this.control.settings.gridSizeItems.map((function(e){return{value:t.getModelUnit(e),text:t.getViewUnitText(e)}}))},e}(i.SimpleCommandBase);e.ChangeGridSizeCommand=r;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){var t=this;return this.control.settings.gridSizeItems.map((function(e){return t.getModelUnit(e)}))},e.prototype.executeCore=function(t,e){var n=this;return this.control.settings.gridSizeItems=e.map((function(t){return n.getModelUnitTwipsValue(t)})),!0},e}(i.SimpleCommandBase);e.ChangeGridSizeItemsCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePageLandscapeCommand=void 0;var i=n(73),r=n(255),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.model.pageLandscape},e.prototype.createHistoryItems=function(t){return[new r.ChangePageLandscapeHistoryItem(t)]},e}(i.ChangePagePropertyCommand);e.ChangePageLandscapeCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePageLandscapeHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return o(e,t),e.prototype.redo=function(t){this.oldValue=t.model.pageLandscape,t.changePageLandscape(this.value)},e.prototype.undo=function(t){t.changePageLandscape(this.oldValue)},e}(i.HistoryItem);e.ChangePageLandscapeHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePageSizeItemsCommand=e.ChangePageSizeCommand=void 0;var i=n(73),r=n(2),a=n(257),s=n(10),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.getModelUnitSize(this.control.model.pageSize)},e.prototype.createHistoryItems=function(t){return[new a.ChangePageSizeHistoryItem(new r.Size(this.getModelUnitTwipsValue(t.width),this.getModelUnitTwipsValue(t.height)))]},e.prototype.getItems=function(){var t=this;return this.control.settings.pageSizeItems.map((function(e){return{value:t.getModelUnitSize(e.size),text:e.text.replace("{width}",t.getViewUnitText(e.size.width)).replace("{height}",t.getViewUnitText(e.size.height))}}))},e.prototype.getModelUnitSize=function(t){return new r.Size(this.getModelUnit(t.width),this.getModelUnit(t.height))},e}(i.ChangePagePropertyCommand);e.ChangePageSizeCommand=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){return!0},e.prototype.getValue=function(){var t=this;return this.control.settings.pageSizeItems.map((function(e){return{size:new r.Size(t.getModelUnit(e.width),t.getModelUnit(e.height)),text:e.text}}))},e.prototype.executeCore=function(t,e){var n=this;return this.control.settings.pageSizeItems=e.map((function(t){return{size:new r.Size(n.getModelUnitTwipsValue(t.width),n.getModelUnitTwipsValue(t.height)),text:t.text}})),!0},e}(s.SimpleCommandBase);e.ChangePageSizeItemsCommand=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePageSizeHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.size=e,n}return o(e,t),e.prototype.redo=function(t){this.oldSize=t.model.pageSize,t.changePageSize(this.size)},e.prototype.undo=function(t){t.changePageSize(this.oldSize)},e}(i.HistoryItem);e.ChangePageSizeHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportPngCommand=void 0;var i=n(97),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getExtension=function(){return"png"},e.prototype.getExportFunc=function(){return this.exporter.exportPng},e}(i.ExportImageCommand);e.ExportPngCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__awaiter||function(t,e,n,o){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o["throw"](t))}catch(e){r(e)}}function c(t){t.done?n(t.value):i(t.value).then(a,s)}c((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return c([t,e])}}function c(r){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,o&&(i=2&r[0]?o["return"]:r[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(s){r=[6,s],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasExportManager=void 0;var a=n(11),s=n(19),c=n(18),u=n(42),l=n(15),p=n(99),h=n(23),d=1,f=function(t){function e(e,n){var o=t.call(this,1,new p.ExportDOMManipulator(n))||this;return o.itemsContainer=e,o}return o(e,t),e.prototype.getSvgImage=function(t,e,n,o){var i=l.RenderHelper.createSvgElement(void 0,!0),r=t.clone().applyConverter(a.UnitConverter.twipsToPixelsF).clone().applyConverter(Math.ceil);c.RenderUtils.updateSvgElementSize(i,r.width,r.height,!0),i.style.backgroundColor=h.ColorUtils.colorToHash(e),this.createTextFloodFilter(void 0,i,e);var u=!n&&!s.Browser.IE&&this.getExportCssRules();if(u){var p=document.createElementNS(l.svgNS,"style");p.innerHTML=u,i.appendChild(p)}if(o){var d=document.createElementNS(l.svgNS,"rect");d.setAttributeNS(null,"x","0"),d.setAttributeNS(null,"y","0"),d.setAttributeNS(null,"height",r.height.toString()),d.setAttributeNS(null,"width",r.width.toString()),d.setAttributeNS(null,"fill",i.style.backgroundColor),i.appendChild(d)}for(var f=0;f<this.itemsContainer.childNodes.length;f++){var m=this.itemsContainer.childNodes[f].cloneNode(!0);u||this.inlineStyle(m,this.itemsContainer.childNodes[f]),i.appendChild(m)}return i},e.prototype.getSvgImageUrl=function(t,e,n){var o=this.getSvgImage(t,e,n,!1);return this.getSvgBase64String(o)},e.prototype.getSvgString=function(t){return(new XMLSerializer).serializeToString(t)},e.prototype.getSvgBase64String=function(t){var n=this.getSvgString(t);return e.base64Start+this.getBase64EncodeUnicode(n)},e.prototype.getBase64EncodeUnicode=function(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt("0x"+e,16))})))},e.prototype.getExportCssRules=function(){for(var t=0;t<document.styleSheets.length;t++){var e=this.getRules(document.styleSheets[t]);if(e){for(var n="",o=0;o<e.length;o++){var i=e[o],r=this.isCSSStyleRule(i)?i.selectorText:null;r&&this.checkSelector(r)&&(n+=i.cssText+"\n")}if(n.length>0)return"\n"+n}}},e.prototype.checkSelector=function(t){for(var n=0;n<e.exportStyleRules.length;n++)if(0===t.indexOf(e.exportStyleRules[n]))return!0;return!1},e.prototype.getRules=function(t){try{return this.isCSSStyleSheet(t)?t.rules||t.cssRules:null}catch(e){}},e.prototype.isCSSStyleSheet=function(t){return void 0!==t.rules},e.prototype.isCSSStyleRule=function(t){return void 0!==t.selectorText},e.prototype.inlineStyle=function(t,n){for(var o=0;o<t.childNodes.length;o++){var i=t.childNodes[o];if(i.tagName)if("g"===i.tagName)this.inlineStyle(i,n.childNodes[o]);else if(i.style){var r=window.getComputedStyle(n.childNodes[o]);if(void 0!==r)for(var a=0;a<e.exportStyleAttributes.length;a++){var s=e.exportStyleAttributes[a];i.style.setProperty(s,r.getPropertyValue(s))}this.inlineStyle(i,n.childNodes[o])}}},e.prototype.exportSvgImage=function(t,e,n){n(this.getSvgImageUrl(t,e,!0))},e.prototype.exportBinaryImage=function(t,e,n,o){var i=this.getAbsoluteSize(t).clone().applyConverter(Math.ceil),r=document.createElement("canvas");r.width=i.width,r.height=i.height;var a=r.getContext("2d");if(a.fillStyle=h.ColorUtils.colorToHash(e),a.fillRect(0,0,i.width,i.height),s.Browser.IE&&"object"===typeof canvg)this.exportBinaryImageCanvgAsync(t,e,r,a,n).then((function(t){return o(t)}));else if(s.Browser.IE&&"function"===typeof canvg)this.exportBinaryImageCanvgOld(t,e,r,a,n,o);else{var c=new Image;c.width=i.width,c.height=i.height,c.setAttribute("crossOrigin","anonymous"),c.onload=function(){a.drawImage(c,0,0),o(r.toDataURL(n,d))},c.src=this.getSvgImageUrl(t,e,!0)}},e.prototype.exportBinaryImageCanvgOld=function(t,e,n,o,i,r){var a=this.getSvgImage(t,e,!0,!1),s=this.getSvgString(a);o["drawSvg"](s,0,0,null,null,{renderCallback:function(){r(n.toDataURL(i,d))}})},e.prototype.exportBinaryImageCanvgAsync=function(t,e,n,o,a){return i(this,void 0,void 0,(function(){var i,s,c;return r(this,(function(r){switch(r.label){case 0:return i=this.getSvgImage(t,e,!0,!0),s=this.getSvgString(i),c=canvg.Canvg.fromString(o,s),[4,c.render()];case 1:return r.sent(),[2,n.toDataURL(a,d)]}}))}))},e.prototype.exportPngImage=function(t,e,n){this.exportBinaryImage(t,e,"image/png",n)},e.prototype.exportJpgImage=function(t,e,n){this.exportBinaryImage(t,e,"image/jpeg",n)},e.prototype.notifyModelChanged=function(t){},e.prototype.notifyPageColorChanged=function(t){},e.prototype.notifyPageSizeChanged=function(t,e){},e.base64Start="data:image/svg+xml;base64,",e.exportStyleRules=[".dxdi-canvas .shape ",".dxdi-canvas .connector ",".dxdi-canvas text",".dxdi-canvas.export"],e.exportStyleAttributes=["fill","stroke","stroke-width","stroke-linejoin","font-family","font-size","font-weight","font-style","text-decoration","text-anchor"],e}(u.CanvasManagerBase);e.CanvasExportManager=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportSvgCommand=void 0;var i=n(97),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getExtension=function(){return"svg"},e.prototype.getExportFunc=function(){return this.exporter.exportSvg},e}(i.ExportImageCommand);e.ExportSvgCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ExportJpgCommand=void 0;var i=n(97),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getExtension=function(){return"jpg"},e.prototype.getExportFunc=function(){return this.exporter.exportJpg},e}(i.ExportImageCommand);e.ExportJpgCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CopySelectionCommand=void 0;var i=n(69),r=n(100),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){return t.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty(!0)},e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.executeCore=function(t){var e=new i.Exporter,n=e.exportItems(this.control.selection.getSelectedItems(!0,!0));return this.setClipboardData(n),!0},e}(r.ClipboardCommand);e.CopySelectionCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CutSelectionCommand=void 0;var i=n(69),r=n(9),a=n(100),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.control.selection.getSelectedItems();return t.prototype.isEnabled.call(this)&&e.length&&(e.length>1||this.permissionsProvider.canDeleteItems(e))},e.prototype.executeCore=function(t){var e=new i.Exporter,n=this.control.selection.getSelectedItems(!0,!0),o=e.exportItems(n);return this.permissionsProvider.beginDeleteItems(n),this.setClipboardData(o),r.ModelUtils.deleteSelection(this.control.history,this.control.model,this.control.selection),this.permissionsProvider.endDeleteItems(),!0},Object.defineProperty(e.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),e}(a.ClipboardCommand);e.CutSelectionCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PasteSelectionCommand=void 0;var i=n(143),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getShapeNewPosition=function(t){return i.PasteSelectionCommandBase.getShapeNewPosition(this.control.model,t)},e.prototype.changeConnectorPoints=function(t){i.PasteSelectionCommandBase.changeConnectorPoints(this.control.model,t)},e}(i.PasteSelectionCommandBase);e.PasteSelectionCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ImportShapeHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.shape=e,n}return o(e,t),e.prototype.redo=function(t){this.shapeKey=this.shape.key,t.insertShape(this.shape)},e.prototype.undo=function(t){t.removeShape(t.model.findShape(this.shapeKey))},e}(i.HistoryItem);e.ImportShapeHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ImportConnectorHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.connector=e,n}return o(e,t),e.prototype.redo=function(t){this.connectorKey=this.connector.key,t.insertConnector(this.connector)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.removeConnector(e)},e}(i.HistoryItem);e.ImportConnectorHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ImportBPMNCommand=void 0;var i=n(268),r=n(9),a=n(51),s=n(1),c=n(6),u=n(61),l=n(48),p=n(76),h=n(21),d=n(54),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=new i.BPMNImporter(e),o=n.import();return this.updateModel(o),!0},e.prototype.updateModel=function(t){var e=this,n={},o=[],i=[];this.control.history.beginTransaction(),t.items.forEach((function(t){var i=new a.AddShapeHistoryItem(e.getShapeDescription(t.type),new s.Point(0,0),t.text,t.key);e.control.history.addAndRedo(i),n[t.key]=i.shapeKey;var r=e.control.model.findShape(i.shapeKey);o.push(r)})),t.edges.forEach((function(t){var o=e.control.model.findShape(n[t.from]),r=e.control.model.findShape(n[t.to]),a=new u.AddConnectorHistoryItem([o.getConnectionPointPosition(0),r.getConnectionPointPosition(0)]);e.control.history.addAndRedo(a);var s=e.control.model.findConnector(a.connectorKey);e.control.history.addAndRedo(new l.AddConnectionHistoryItem(s,o,0,c.ConnectorPosition.Begin)),e.control.history.addAndRedo(new l.AddConnectionHistoryItem(s,r,0,c.ConnectorPosition.End)),i.push(s)}));var d=new h.LayoutSettings,f=r.ModelUtils.getGraphInfoByItems(this.control.model,o,i);f.forEach((function(t){var n=new p.SugiyamaLayoutBuilder(d,t.graph).build(),a=r.ModelUtils.getNonGraphItems(e.control.model,t.container,n.nodeToLayout,o,i);r.ModelUtils.applyLayout(e.control.history,e.control.model,void 0,t.graph,n,a,d,e.control.settings.snapToGrid,e.control.settings.gridSize,!1)})),r.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.endTransaction()},e.prototype.getShapeDescription=function(t){return this.control.shapeDescriptionManager.get(t)},e}(d.ExportImportCommandBase);e.ImportBPMNCommand=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.BPMNNode=e.BPMNImporter=void 0;var i=n(66),r=n(0),a=n(36),s=n(94),c=function(){function t(t){this.doc=s.ImportUtils.createDocument(t),this.graph=new i.Graph([],[])}return t.prototype.import=function(){for(var t=void 0,e=0;t=this.doc.children[e];e++)"DEFINITIONS"===t.nodeName.toUpperCase()&&this.onDefinitionsElement(t);return this.validate(),this.graph},t.prototype.validate=function(){var t={};this.graph.nodes.forEach((function(e){return t[e]=!0}));for(var e=0,n=void 0;n=this.graph.edges[e];e++)t[n.from]&&t[n.to]||(this.graph.edges.splice(e,1),e--)},t.prototype.onDefinitionsElement=function(t){this.dataSourceKey=t.getAttribute("id");for(var e=void 0,n=0;e=t.children[n];n++)"PROCESS"===e.nodeName.toUpperCase()&&this.onProcessElement(e)},t.prototype.onProcessElement=function(t){for(var e=void 0,n=0;e=t.children[n];n++)switch(e.nodeName.toUpperCase()){case"STARTEVENT":this.onStartEventElement(e);break;case"SEQUENCEFLOW":this.onSequenceFlowElement(e);break;case"SCRIPTTASK":this.onScriptTaskElement(e);break;case"USERTASK":this.onUserTaskElement(e);break;case"SERVICETASK":this.onServiceTaskElement(e);break;case"SENDTASK":this.onSendTaskElement(e);break;case"EXCLUSIVEGATEWAY":this.onExclusiveGateway(e);break;case"ENDEVENT":this.onEndEventGateway(e);break}},t.prototype.onStartEventElement=function(t){var e=this.createNode(t);e.type=r.ShapeTypes.Ellipse,e.text=t.getAttribute("name"),this.graph.addNode(e)},t.prototype.onSequenceFlowElement=function(t){var e=t.getAttribute("sourceRef"),n=t.getAttribute("targetRef"),o=this.createEdge(t,e,n);t.hasAttribute("name")&&(o.text=t.getAttribute("name")),this.graph.addEdge(o)},t.prototype.onScriptTaskElement=function(t){var e=this.createNode(t);e.text=t.getAttribute("name"),this.graph.addNode(e)},t.prototype.onUserTaskElement=function(t){var e=this.createNode(t);e.text=t.getAttribute("name"),this.graph.addNode(e)},t.prototype.onServiceTaskElement=function(t){var e=this.createNode(t);e.text=t.getAttribute("name"),this.graph.addNode(e)},t.prototype.onSendTaskElement=function(t){var e=this.createNode(t);e.text=t.getAttribute("name"),this.graph.addNode(e)},t.prototype.onExclusiveGateway=function(t){var e=this.createNode(t);e.text=t.getAttribute("name"),e.type=r.ShapeTypes.Decision,this.graph.addNode(e)},t.prototype.onEndEventGateway=function(t){var e=this.createNode(t);e.text=t.getAttribute("name"),e.type=r.ShapeTypes.Ellipse,this.graph.addNode(e)},t.prototype.createNode=function(t){return new u(this.dataSourceKey,t.getAttribute("id"))},t.prototype.createEdge=function(t,e,n){return new l(this.dataSourceKey,t.getAttribute("id"),e,n)},t}();e.BPMNImporter=c;var u=function(){function t(t,e){this.sourceKey=t,this.key=e,this.type=r.ShapeTypes.Rectangle}return t}();e.BPMNNode=u;var l=function(t){function e(e,n,o,i){var r=t.call(this,n,o,i)||this;return r.sourceKey=e,r}return o(e,t),e}(a.Edge)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CycleRemover=void 0;var o=n(66),i=n(36),r=n(89),a=function(){function t(){}return t.removeCycles=function(t){var e=this.getFeedbackSet(t);return this.reverseEdges(t,e)},t.getFeedbackSet=function(t){var e=this,n={},o=this.getNonTrivialStronglyConnectedComponents(t);while(o.length)o.forEach((function(t){var o=e.getMaxCyclicEdges(t);o.forEach((function(t){return delete n[t.reverse().getHashKey()]})),o.forEach((function(t){return n[t.getHashKey()]=!0}))})),o=this.getNonTrivialStronglyConnectedComponents(this.reverseEdges(t,n).graph);return n},t.getMaxCyclicEdges=function(t){var e={},n={},o={},a=[],s=[],c=t.createIterator(i.ConnectionMode.Outgoing);c.visitEachEdgeOnce=!1,c.onNode=function(t){n[t.key]=!0},c.skipNode=function(t){if(n[t.key]){for(var i=[],r=0;r<a.length;r++){var c=a[r];if(void 0===o[c.key]&&(o[c.key]=0),o[c.key]++,i.push(c),c.from===t.key)break}s.push(i)}return n[t.key]||e[t.key]},c.skipEdge=function(t){return!1},c.onEdge=function(t){a.splice(0,0,t)},c.onAfterEdge=function(t){a.splice(0,1)},c.onAllEdges=function(t){e[t.key]=!0,n[t.key]=!1},c.iterate(t.nodes[0]);var u=new r.HashSet([],(function(t){return t.key}));return s.forEach((function(t){u.tryPush(t.reduce((function(t,e){return o[e.key]>o[t.key]?e:t}),t[0]))})),u.list()},t.reverseEdges=function(t,e){var n=new r.HashSet([],(function(t){return t.getHashKey()})),i={},a={};return t.edges.forEach((function(t){e[t.getHashKey()]&&(t=t.reverse(),i[t.key]=!0),n.tryPush(t)||(a[t.key]=!0,delete i[t.key])})),{graph:new o.Graph(t.nodes.map((function(e){return t.getNode(e)})),n.list()),reversedEdges:i,removedEdges:a}},t.getNonTrivialStronglyConnectedComponents=function(t){return this.getStronglyConnectedComponents(t).filter((function(t){return t.edges.length}))},t.getStronglyConnectedComponents=function(t){for(var e=this,n=[],o=0,r={},a={},s={},c=[],u={},l=0;l<t.nodes.length;l++){var p=t.nodes[l],h=t.createIterator(i.ConnectionMode.Outgoing);h.visitEachEdgeOnce=!1,h.visitEachNodeOnce=!1,h.onNode=function(t){u[t.key]=!0,n.push(t),s[t.key]=!0,a[t.key]=o,r[t.key]=o,o++},h.skipNode=function(t){return u[t.key]},h.skipEdge=function(t){var e=u[t.to];return e&&s[t.to]&&(a[t.from]=Math.min(a[t.from],r[t.to])),e},h.onAfterEdge=function(t){a[t.from]=Math.min(a[t.from],a[t.to])},h.onAllEdges=function(o,i){i&&a[o.key]===r[o.key]&&c.push(e.getStronglyConnectedComponent(t,o,n,s))},h.iterate(p)}return c},t.getStronglyConnectedComponent=function(t,e,n,r){var a,s={},c=[],u=[];do{a=n.pop(),s[a.key]||c.push(a),s[a.key]=!0,r[a.key]=!1}while(a!==e);return c.forEach((function(e){var n=t.getAdjacentEdges(e.key,i.ConnectionMode.Outgoing);u=u.concat(n.filter((function(t){return!s[t.key]&&s[t.to]}))),n.forEach((function(t){return s[t.key]=!0}))})),new o.Graph(c,u)},t}();e.CycleRemover=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.SendToBackCommand=void 0;var i=n(101),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.control.selection.getSelectedItems();return t.prototype.isEnabled.call(this)&&e.length>0&&this.needSendToBack(e)},e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.control.selection.getSelectedItems();return o.forEach((function(t){var e=n.control.model.getIntersectItemsMinZIndex(t)-1;n.control.history.addAndRedo(new i.ChangeZindexHistoryItem(t,e))})),this.control.history.endTransaction(),!0},e.prototype.needSendToBack=function(t){for(var e=this,n=function(n){var i=o.control.model.getIntersectItemsMinZIndex(t[n]);if(i<t[n].zIndex)return{value:!0};if(i===t[n].zIndex){var r=!1,a=o.control.model.getIntersectItems(t[n]).filter((function(e){return e.zIndex===t[n].zIndex}));return a.forEach((function(o){e.control.model.getItemIndex(o)<e.control.model.getItemIndex(t[n])&&(r=!0)})),{value:r}}},o=this,i=0;i<t.length;i++){var r=n(i);if("object"===typeof r)return r.value}return!1},e}(r.SimpleCommandBase);e.SendToBackCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.BringToFrontCommand=void 0;var i=n(101),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.control.selection.getSelectedItems();return t.prototype.isEnabled.call(this)&&e.length>0&&this.needBringToFront(e)},e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.control.selection.getSelectedItems();return o.forEach((function(t){var e=n.control.model.getIntersectItemsMaxZIndex(t)+1;n.control.history.addAndRedo(new i.ChangeZindexHistoryItem(t,e))})),this.control.history.endTransaction(),!0},e.prototype.needBringToFront=function(t){for(var e=this,n=function(n){var i=o.control.model.getIntersectItemsMaxZIndex(t[n]);if(i>t[n].zIndex)return{value:!0};if(i===t[n].zIndex){var r=!1,a=o.control.model.getIntersectItems(t[n]).filter((function(e){return e.zIndex===t[n].zIndex}));return a.forEach((function(o){e.control.model.getItemIndex(o)>e.control.model.getItemIndex(t[n])&&(r=!0)})),{value:r}}},o=this,i=0;i<t.length;i++){var r=n(i);if("object"===typeof r)return r.value}return!1},e}(r.SimpleCommandBase);e.BringToFrontCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MoveStepDownCommand=e.MoveDownCommand=e.MoveStepUpCommand=e.MoveUpCommand=e.MoveStepRightCommand=e.MoveRightCommand=e.MoveStepLeftCommand=e.MoveLeftCommand=e.MoveCommand=void 0;var i=n(1),r=n(9),a=n(11),s=n(10),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){return t.prototype.isEnabled.call(this)&&!this.control.selection.isEmpty()},e.prototype.executeCore=function(t,e){var n=this;this.control.history.beginTransaction();var o=this.control.selection;o.getSelectedShapes().forEach((function(t){var e=n.getPosition(t.position);r.ModelUtils.setShapePosition(n.control.history,n.control.model,t,e),r.ModelUtils.updateShapeAttachedConnectors(n.control.history,n.control.model,t)}));var i=r.ModelUtils.createSelectedItems(o);return o.getSelectedConnectors().forEach((function(t){if(r.ModelUtils.canMoveConnector(i,t))for(var e=t.beginItem?1:0,o=t.endItem?t.points.length-2:t.points.length-1,a=e;a<=o;a++){var s=n.getPosition(t.points[a]);r.ModelUtils.moveConnectorPoint(n.control.history,t,a,s)}})),r.ModelUtils.tryUpdateModelSize(this.control.history,this.control.model),this.control.history.endTransaction(),!0},e}(s.SimpleCommandBase);e.MoveCommand=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return t.clone().offset(-a.UnitConverter.pixelsToTwips(1),0)},e}(c);e.MoveLeftCommand=u;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return this.control.settings.snapToGrid?new i.Point(r.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,t.x-(this.control.settings.gridSize/2+2),!0),t.y):t.clone().offset(-this.control.settings.gridSize,0)},e}(c);e.MoveStepLeftCommand=l;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return t.clone().offset(a.UnitConverter.pixelsToTwips(1),0)},e}(c);e.MoveRightCommand=p;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return this.control.settings.snapToGrid?new i.Point(r.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,t.x+(this.control.settings.gridSize/2+2),!0),t.y):t.clone().offset(this.control.settings.gridSize,0)},e}(c);e.MoveStepRightCommand=h;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return t.clone().offset(0,-a.UnitConverter.pixelsToTwips(1))},e}(c);e.MoveUpCommand=d;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return this.control.settings.snapToGrid?new i.Point(t.x,r.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,t.y-(this.control.settings.gridSize/2+2),!1)):t.clone().offset(0,-this.control.settings.gridSize)},e}(c);e.MoveStepUpCommand=f;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return t.clone().offset(0,a.UnitConverter.pixelsToTwips(1))},e}(c);e.MoveDownCommand=m;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getPosition=function(t){return this.control.settings.snapToGrid?new i.Point(t.x,r.ModelUtils.getSnappedPos(this.control.model,this.control.settings.gridSize,t.y+(this.control.settings.gridSize/2+2),!1)):t.clone().offset(0,this.control.settings.gridSize)},e}(c);e.MoveStepDownCommand=g},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleAutoZoomCommand=e.ToggleAutoZoomToWidthCommand=e.ToggleAutoZoomToContentCommand=e.SwitchAutoZoomCommand=e.FitToWidthCommand=e.FitToScreenCommand=e.ChangeZoomLevelItemsCommand=e.ChangeZoomLevelTo200Command=e.ChangeZoomLevelTo150Command=e.ChangeZoomLevelTo125Command=e.ChangeZoomLevelTo100Command=e.ChangeZoomLevelTo75Command=e.ChangeZoomLevelTo50Command=e.ChangeZoomLevelTo25Command=e.ChangeZoomLevelInPercentageCommand=e.ChangeZoomLevelCommand=void 0;var i=n(10),r=n(27),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.view.getZoom()},e.prototype.executeCore=function(t,e){return this.control.settings.zoomLevel=e,this.control.settings.autoZoom=r.AutoZoomMode.Disabled,this.control.updateLayout(!0),!0},e.prototype.getItems=function(){return this.control.settings.zoomLevelItems.map((function(t){return{value:t,text:100*t+"%"}}))},e}(i.SimpleCommandBase);e.ChangeZoomLevelCommand=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(e,n){return t.prototype.executeCore.call(this,e,n/100)},e.prototype.getValue=function(){return 100*this.control.view.getZoom()},e}(a);e.ChangeZoomLevelInPercentageCommand=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.view.getZoom()===this.exactValue},e.prototype.executeCore=function(e,n){return t.prototype.executeCore.call(this,e,this.exactValue),!0},e.prototype.getItems=function(){},e}(a),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=.25,e}return o(e,t),e}(c);e.ChangeZoomLevelTo25Command=u;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=.5,e}return o(e,t),e}(c);e.ChangeZoomLevelTo50Command=l;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=.75,e}return o(e,t),e}(c);e.ChangeZoomLevelTo75Command=p;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=1,e}return o(e,t),e}(c);e.ChangeZoomLevelTo100Command=h;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=1.25,e}return o(e,t),e}(c);e.ChangeZoomLevelTo125Command=d;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=1.5,e}return o(e,t),e}(c);e.ChangeZoomLevelTo150Command=f;var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exactValue=2,e}return o(e,t),e}(c);e.ChangeZoomLevelTo200Command=m;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.zoomLevelItems},e.prototype.executeCore=function(t,e){return this.control.settings.zoomLevelItems=e,!0},e}(i.SimpleCommandBase);e.ChangeZoomLevelItemsCommand=g;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){return t.prototype.isEnabled.call(this)&&!!this.control.render},e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.executeCore=function(t){var e=this.getZoomLevel();return this.control.settings.zoomLevel=e,this.control.settings.autoZoom=r.AutoZoomMode.Disabled,this.control.updateLayout(!0),!0},e}(i.SimpleCommandBase),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getZoomLevel=function(){return this.control.render.view.getActualAutoZoomLevel(r.AutoZoomMode.FitContent)},e}(y);e.FitToScreenCommand=v;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getZoomLevel=function(){return this.control.render.view.getActualAutoZoomLevel(r.AutoZoomMode.FitToWidth)},e}(y);e.FitToWidthCommand=C;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.autoZoom},e.prototype.executeCore=function(t,e){return e=parseInt(e),this.control.settings.autoZoom!==e&&(e===r.AutoZoomMode.Disabled&&(this.control.settings.zoomLevel=this.control.view.getZoom()),this.control.settings.autoZoom=e,this.control.updateLayout(!0),!0)},e}(i.SimpleCommandBase);e.SwitchAutoZoomCommand=_;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.settings.autoZoom===r.AutoZoomMode.FitContent},e.prototype.executeCore=function(e,n){return t.prototype.executeCore.call(this,e,r.AutoZoomMode.FitContent)},e}(_);e.ToggleAutoZoomToContentCommand=P;var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.settings.autoZoom===r.AutoZoomMode.FitToWidth},e.prototype.executeCore=function(e,n){return t.prototype.executeCore.call(this,e,r.AutoZoomMode.FitToWidth)},e}(_);e.ToggleAutoZoomToWidthCommand=S;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){return t.prototype.isEnabled.call(this)&&!!this.control.render},e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.autoZoom},e.prototype.executeCore=function(t,e){var n;return n=void 0===e?this.control.settings.autoZoom===r.AutoZoomMode.Disabled?r.AutoZoomMode.FitContent:r.AutoZoomMode.Disabled:e?r.AutoZoomMode.FitContent:r.AutoZoomMode.Disabled,this.control.settings.autoZoom!==n&&(n||(this.control.settings.zoomLevel=this.control.view.getZoom()),this.control.settings.autoZoom=n,this.control.updateLayout(!0),!0)},e}(i.SimpleCommandBase);e.ToggleAutoZoomCommand=b},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.BindDocumentCommand=void 0;var i=n(102),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.executeCore=function(t,e){if(!e||!Array.isArray(e.nodeDataSource))throw Error("Format exception");return this.performImportData(e),this.control.updateLayout(!0),!0},e.prototype.performImportData=function(t){var e=this.control.createDocumentDataSource(t.nodeDataSource,t.edgeDataSource,t.dataParameters,t.nodeDataImporter,t.edgeDataImporter);this.control.beginUpdateCanvas(),this.permissionsProvider.lockPermissions();var n=new i.DataLayoutParameters(this.control.settings,t.layoutParameters);e.createModelItems(this.control.history,this.control.model,this.control.shapeDescriptionManager,this.control.selection,n,this.control.settings.snapToGrid,this.control.settings.gridSize,this.control.measurer),this.permissionsProvider.unlockPermissions(),this.control.endUpdateCanvas()},e}(r.SimpleCommandBase);e.BindDocumentCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.UnbindDocumentCommand=void 0;var i=n(9),r=n(10),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.executeCore=function(t){return this.permissionsProvider.lockPermissions(),this.control.deleteDocumentDataSource(),i.ModelUtils.deleteAllItems(this.control.history,this.control.model,this.control.selection),this.control.history.clear(),this.permissionsProvider.unlockPermissions(),!0},e}(r.SimpleCommandBase);e.UnbindDocumentCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.LockCommand=void 0;var i=n(147),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getLockState=function(){return!0},e}(i.ChangeLockedCommand);e.LockCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.UnLockCommand=void 0;var i=n(147),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getLockState=function(){return!1},e}(i.ChangeLockedCommand);e.UnLockCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CloneDownCommand=e.CloneUpCommand=e.CloneRightCommand=e.CloneLeftCommand=e.CloneCommand=void 0;var i=n(32),r=n(9),a=n(10),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.control.selection.getSelectedItems();return t.prototype.isEnabled.call(this)&&e.length&&(e.length>1||this.permissionsProvider.canAddItems(e))},e.prototype.executeCore=function(t,e){var n=i.DiagramModel.getRectangle(this.control.selection.getSelectedItems());return r.ModelUtils.cloneSelectionToOffset(this.control.history,this.control.model,void 0,this.control.selection,this.getOffsetX(n),this.getOffsetY(n)),!0},Object.defineProperty(e.prototype,"isPermissionsRequired",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.getOffsetX=function(t){return 0},e.prototype.getOffsetY=function(t){return 0},e}(a.SimpleCommandBase);e.CloneCommand=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getOffsetX=function(t){return-t.width},e}(s);e.CloneLeftCommand=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getOffsetX=function(t){return t.width},e}(s);e.CloneRightCommand=u;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getOffsetY=function(t){return-t.height},e}(s);e.CloneUpCommand=l;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getOffsetY=function(t){return t.height},e}(s);e.CloneDownCommand=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeViewUnitsCommand=e.ChangeUnitsCommand=void 0;var i=n(73),r=n(280),a=n(10),s=n(34),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.model.units},e.prototype.createHistoryItems=function(t){return[new r.ChangeUnitsHistoryItem(t)]},e.prototype.getItems=function(){return Object.keys(s.DiagramLocalizationService.unitItems).map((function(t){return{value:parseInt(t),text:s.DiagramLocalizationService.unitItems[t]}}))},e}(i.ChangePagePropertyCommand);e.ChangeUnitsCommand=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.viewUnits},e.prototype.executeCore=function(t,e){return this.control.settings.viewUnits=e,!0},e.prototype.getItems=function(){return Object.keys(s.DiagramLocalizationService.unitItems).map((function(t){return{value:parseInt(t),text:s.DiagramLocalizationService.unitItems[t]}}))},e}(a.SimpleCommandBase);e.ChangeViewUnitsCommand=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeUnitsHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.units=e,n}return o(e,t),e.prototype.redo=function(t){this.oldUnits=t.model.units,t.model.units=this.units},e.prototype.undo=function(t){t.model.units=this.oldUnits},e}(i.HistoryItem);e.ChangeUnitsHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePageColorCommand=void 0;var i=n(73),r=n(282),a=n(32),s=n(23),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return s.ColorUtils.colorToHash(this.control.model.pageColor)},e.prototype.getDefaultValue=function(){return s.ColorUtils.colorToHash(a.DiagramModel.defaultPageColor)},e.prototype.createHistoryItems=function(t){return[new r.ChangePageColorHistoryItem(s.ColorUtils.fromString(t))]},e}(i.ChangePagePropertyCommand);e.ChangePageColorCommand=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePageColorHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.value=e,n}return o(e,t),e.prototype.redo=function(t){this.oldValue=t.model.pageColor,t.changePageColor(this.value)},e.prototype.undo=function(t){t.changePageColor(this.oldValue)},e}(i.HistoryItem);e.ChangePageColorHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeShowGridCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.executeCore=function(t,e){var n=void 0===e?!this.control.settings.showGrid:!!e;return this.control.settings.showGrid!==n&&(this.control.settings.showGrid=n,!0)},e.prototype.getValue=function(){return this.control.settings.showGrid},e}(i.SimpleCommandBase);e.ChangeShowGridCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleFullscreenCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.fullscreen},e.prototype.executeCore=function(t,e){var n="boolean"===typeof e?e:!t.value;return this.control.settings.fullscreen!==n&&(this.control.settings.fullscreen=!t.value,this.control.notifyToggleFullscreen(this.control.settings.fullscreen)),!0},e}(i.SimpleCommandBase);e.ToggleFullscreenCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleSimpleViewCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.simpleView},e.prototype.executeCore=function(t,e){return"boolean"===typeof e?this.control.settings.simpleView=e:void 0===e&&(this.control.settings.simpleView=!t.value),this.control.updateLayout(!0),!0},e}(i.SimpleCommandBase);e.ToggleSimpleViewCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleReadOnlyCommand=void 0;var i=n(10),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabledInReadOnlyMode=function(){return!0},e.prototype.getValue=function(){return this.control.settings.readOnly},e.prototype.executeCore=function(t,e){return"boolean"===typeof e?this.control.settings.readOnly=e:void 0===e&&(this.control.settings.readOnly=!t.value),!0},e}(i.SimpleCommandBase);e.ToggleReadOnlyCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.EditShapeImageCommand=void 0;var i=n(103),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.getSelectedShape();return t.prototype.isEnabled.call(this)&&!e.image.isEmpty},e}(i.EditShapeImageCommandBase);e.EditShapeImageCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PasteSelectionInPositionCommand=void 0;var i=n(143),r=n(14),a=n(6),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.calculateSelectionOffset=function(t,e){var n=t.reduce((function(t,e){return{x:Math.min(t.x,e instanceof r.Shape?e.position.x:e instanceof a.Connector?e.getMinX():Number.MAX_VALUE),y:Math.min(t.y,e instanceof r.Shape?e.position.y:e instanceof a.Connector?e.getMinY():Number.MAX_VALUE)}}),{x:Number.MAX_VALUE,y:Number.MAX_VALUE}),o=this.control.render.getModelPointByEventPoint(e.x,e.y);this.offsetX=o.x-n.x,this.offsetY=o.y-n.y},e.prototype.getShapeNewPosition=function(t){var e=t.clone().offset(this.offsetX,this.offsetY);return i.PasteSelectionCommandBase.getShapeNewPosition(this.control.model,e)},e.prototype.changeConnectorPoints=function(t){var e=this;t.points.forEach((function(t){t.x+=e.offsetX,t.y+=e.offsetY})),i.PasteSelectionCommandBase.changeConnectorPoints(this.control.model,t)},e}(i.PasteSelectionCommandBase);e.PasteSelectionInPositionCommand=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ImportXMLCommand=void 0;var i=n(290),r=n(54),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.executeCore=function(t,e){var n=new i.XmlImporter(this.control.shapeDescriptionManager,e),o=n.import();return this.control.importModel(o),!0},e}(r.ExportImportCommandBase);e.ImportXMLCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.XmlImporter=void 0;var i=n(6),r=n(14),a=n(135),s=n(0),c=n(90),u=n(2),l=n(1),p=n(94),h=n(23),d=n(11),f=function(t){function e(e,n){var o=t.call(this,e)||this;return o.doc=p.ImportUtils.createDocument(n),o}return o(e,t),e.prototype.getObject=function(){return this.doc},e.prototype.getPageObject=function(t){var e=this.doc.querySelectorAll("[ItemKind='DiagramRoot']");return e&&e[0]},e.prototype.getShapeObjects=function(t){var e=[];return this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramShape']").forEach((function(t){e.push(t)})),this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramContainer']").forEach((function(t){e.push(t)})),e},e.prototype.getConnectorObjects=function(t){var e=[];return this.doc.querySelectorAll("[ItemKind='DiagramRoot'] > Children > [ItemKind='DiagramConnector']").forEach((function(t){e.push(t)})),e},e.prototype.importPageSettings=function(t,e){if(e){var n=e.getAttribute("PageSize"),o=this.getSize(n);o&&(t.size=o.clone(),t.pageSize=o.clone())}},e.prototype.importShape=function(t){var e=t.getAttribute("Position"),n=this.getPoint(e),o=t.getAttribute("Shape"),i=this.getShapeType(o),a=this.shapeDescriptionManager.get(i),s=new r.Shape(a||c.ShapeDescriptionManager.default,n);s.key=this.getItemKey(t);var u=t.getAttribute("Size"),l=this.getSize(u);l&&(s.size=l);var p=t.getAttribute("Content");if("string"===typeof p)s.text=p;else{var h=t.getAttribute("Header");"string"===typeof h&&(s.text=h)}return this.importStyle(t,s),s},e.prototype.importShapeChildren=function(t,e){var n=[];t.setAttribute("dxDiagram",""),this.doc.querySelectorAll("[dxDiagram] > Children > [ItemKind='DiagramShape']").forEach((function(t){n.push(t)})),this.doc.querySelectorAll("[dxDiagram] > Children > [ItemKind='DiagramContainer']").forEach((function(t){n.push(t)})),t.removeAttribute("dxDiagram");var o=[];if(!n)return o;for(var i=0;i<n.length;i++){var r=n[i],a=this.importShape(r);a.key=e.key+","+a.key;var s=e.clientRectangle;a.position=a.position.clone().offset(s.x,s.y),e["childKeys"]||(e["childKeys"]=[]),e["childKeys"].push(a.key),o.push(a),o=o.concat(this.importShapeChildren(r,a))}return o},e.prototype.importConnector=function(t){var e=this,n=[],o=t.getAttribute("BeginPoint"),r=this.getPoint(o);r&&n.push(r);var a=t.getAttribute("Points");a.split(" ").forEach((function(t){var o=e.getPoint(t);o&&n.push(o)}));var s=t.getAttribute("EndPoint"),c=this.getPoint(s);c&&n.push(c);var u=new i.Connector(n);u.key=this.getItemKey(t);var l=t.getAttribute("EndItemPointIndex"),p=parseInt(l);u.endConnectionPointIndex=isNaN(p)?-1:p;var h=t.getAttribute("BeginItemPointIndex"),d=parseInt(h);u.beginConnectionPointIndex=isNaN(d)?-1:d;var f=t.getAttribute("EndItem");void 0!==f&&this.assert(f,"string");var m=t.getAttribute("BeginItem");void 0!==m&&this.assert(m,"string"),u["endItemKey"]=f,u["beginItemKey"]=m;var g=t.getAttribute("Content");return"string"===typeof g&&u.setText(g),this.importStyle(t,u),u},e.prototype.importStyle=function(t,e){var n=t.getAttribute("Background");"string"===typeof n&&(e.style["fill"]=this.getColor(n));var o=t.getAttribute("Stroke");"string"===typeof o&&(e.style["stroke"]=this.getColor(o));var i=t.getAttribute("Foreground");"string"===typeof i&&(e.styleText["fill"]=this.getColor(i));var r=t.getAttribute("FontFamily");"string"===typeof r&&(e.styleText["font-family"]=r);var a=t.getAttribute("FontSize");"string"===typeof a&&(e.styleText["font-size"]=a);var s=t.getAttribute("FontWeight");"Bold"===s&&(e.styleText["font-weight"]="bold");var c=t.getAttribute("FontStyle");"Italic"===c&&(e.styleText["font-style"]="italic");var u=t.getAttribute("TextDecorations");"Underline"===u&&(e.styleText["text-decoration"]="underline");var l=t.getAttribute("TextAlignment");"Left"===l?e.styleText["text-anchor"]="start":"Right"===l?e.styleText["text-anchor"]="end":"Center"===l&&(e.styleText["text-anchor"]="middle")},e.prototype.getShapeType=function(t){return e.shapeTypes[t]?e.shapeTypes[t]:t&&t.toLowerCase().indexOf("container")>-1?s.ShapeTypes.VerticalContainer:s.ShapeTypes.Rectangle},e.prototype.getItemKey=function(t){return(parseInt(t.tagName.replace("Item",""))-1).toString()},e.prototype.getNumbers=function(t){var e=t.split(",");return e&&e.length?e.map((function(t){return+t})):[]},e.prototype.getSize=function(t){if(t){var e=this.getNumbers(t);if(e.length>=2)return this.assert(e[0],"number"),this.assert(e[1],"number"),new u.Size(d.UnitConverter.pixelsToTwips(e[0]),d.UnitConverter.pixelsToTwips(e[1]))}},e.prototype.getPoint=function(t){if(t){var e=this.getNumbers(t);if(e.length>=2)return this.assert(e[0],"number"),this.assert(e[1],"number"),new l.Point(d.UnitConverter.pixelsToTwips(e[0]),d.UnitConverter.pixelsToTwips(e[1]))}},e.prototype.getColor=function(t){t="#"===t.charAt(0)?t.substr(1):t;var e=parseInt(t,16);return isNaN(e)?void 0:h.ColorUtils.colorToHash(e)},e.shapeTypes={"BasicShapes.Rectangle":s.ShapeTypes.Rectangle,"BasicShapes.Ellipse":s.ShapeTypes.Ellipse,"BasicShapes.Triangle":s.ShapeTypes.Triangle,"BasicShapes.Pentagon":s.ShapeTypes.Pentagon,"BasicShapes.Hexagon":s.ShapeTypes.Hexagon,"BasicShapes.Octagon":s.ShapeTypes.Octagon,"BasicShapes.Diamond":s.ShapeTypes.Diamond,"BasicShapes.Cross":s.ShapeTypes.Cross,"BasicShapes.Star5":s.ShapeTypes.Star,"BasicFlowchartShapes.StartEnd":s.ShapeTypes.Terminator,"BasicFlowchartShapes.Data":s.ShapeTypes.Data,"BasicFlowchartShapes.Database":s.ShapeTypes.Database,"BasicFlowchartShapes.ExternalData":s.ShapeTypes.StoredData,"BasicFlowchartShapes.Process":s.ShapeTypes.Process,"BasicFlowchartShapes.Decision":s.ShapeTypes.Decision,"BasicFlowchartShapes.Subprocess":s.ShapeTypes.PredefinedProcess,"BasicFlowchartShapes.Document":s.ShapeTypes.Document,"BasicFlowchartShapes.Custom1":s.ShapeTypes.ManualInput,"BasicFlowchartShapes.Custom2":s.ShapeTypes.ManualOperation,"ArrowShapes.SimpleArrow":s.ShapeTypes.ArrowLeft,"ArrowShapes.SimpleDoubleArrow":s.ShapeTypes.ArrowLeftRight},e}(a.ImporterBase);e.XmlImporter=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.InsertShapeImageCommand=void 0;var i=n(103),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.getSelectedShape();return t.prototype.isEnabled.call(this)&&e.image.isEmpty},e}(i.EditShapeImageCommandBase);e.InsertShapeImageCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteShapeImageCommand=void 0;var i=n(103),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.isEnabled=function(){var e=this.getSelectedShape();return t.prototype.isEnabled.call(this)&&!e.image.isEmpty},e.prototype.executeCore=function(e,n){return t.prototype.executeCore.call(this,e,void 0)},e}(i.EditShapeImageCommandBase);e.DeleteShapeImageCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStrokeStyleCommand=void 0;var i=n(71),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"stroke-dasharray"},e}(i.ChangeStylePropertyCommand);e.ChangeStrokeStyleCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeStrokeWidthCommand=void 0;var i=n(71),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getStyleProperty=function(){return"stroke-width"},e}(i.ChangeStylePropertyCommand);e.ChangeStrokeWidthCommand=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutTreeVerticalBottomToTopCommand=void 0;var i=n(21),r=n(139),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var e=t.prototype.createLayoutSettings.call(this);return e.direction=i.LogicalDirectionKind.Backward,e},e}(r.AutoLayoutTreeVerticalCommand);e.AutoLayoutTreeVerticalBottomToTopCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutTreeHorizontalRightToLeftCommand=void 0;var i=n(21),r=n(145),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var e=t.prototype.createLayoutSettings.call(this);return e.direction=i.LogicalDirectionKind.Backward,e},e}(r.AutoLayoutTreeHorizontalCommand);e.AutoLayoutTreeHorizontalRightToLeftCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutLayeredVerticalBottomToTopCommand=void 0;var i=n(21),r=n(146),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var e=t.prototype.createLayoutSettings.call(this);return e.direction=i.LogicalDirectionKind.Backward,e},e}(r.AutoLayoutLayeredVerticalCommand);e.AutoLayoutLayeredVerticalBottomToTopCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AutoLayoutLayeredHorizontalRightToLeftCommand=void 0;var i=n(21),r=n(144),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createLayoutSettings=function(){var e=t.prototype.createLayoutSettings.call(this);return e.direction=i.LogicalDirectionKind.Backward,e},e}(r.AutoLayoutLayeredHorizontalCommand);e.AutoLayoutLayeredHorizontalRightToLeftCommand=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorRoutingModeCommand=void 0;var i=n(10),r=n(27),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getValue=function(){return this.control.settings.connectorRoutingMode},e.prototype.executeCore=function(t,e){var n=void 0!==e?e:r.ConnectorRoutingMode.None;return this.control.settings.connectorRoutingMode=n,!0},e}(i.SimpleCommandBase);e.ChangeConnectorRoutingModeCommand=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramControl=void 0;var o=n(301),i=n(80),r=n(302),a=n(32),s=n(331),c=n(334),u=n(335),l=n(336),p=n(90),h=n(344),d=n(27),f=n(16),m=n(349),g=n(9),y=n(350),v=n(3),C=n(1),_=n(353),P=n(46),S=n(354),b=n(368),x=n(75),w=n(6),I=n(102),T=n(379),O=n(18),E=function(){function t(){this.processDataChangesNeeded=!1,this.reloadContentNeeded=!1,this.reloadContentParameters=new T.ReloadContentParameters,this.reloadContentByExternalChangesParameters=new T.ReloadContentParameters,this.settings=new d.DiagramSettings,this.shapeDescriptionManager=new p.ShapeDescriptionManager,this.shapeDescriptionManager.onShapeDecriptionChanged.add(this),this.model=new a.DiagramModel,this.selection=new s.Selection(this.model),this.onNativeAction=new v.EventDispatcher,this.apiController=new _.ApiController(this.onNativeAction,this.selection,this.model),this.permissionsProvider=new S.PermissionsProvider(this.apiController),this.permissionsProvider.onRequestOperation.add(this),this.routingModel=new b.ConnectorRoutingModel,this.modelManipulator=new o.ModelManipulator(this.model,this.routingModel,this.permissionsProvider),this.modelManipulator.onModelChanged.add(this.permissionsProvider),this.history=new c.History(this.modelManipulator),this.barManager=new u.BarManager(this),this.view=new m.ViewController(this.settings,this.barManager),this.commandManager=new i.CommandManager(this),this.eventManager=new r.EventManager(this),this.settings.onReadOnlyChanged.add(this.eventManager.mouseHandler),this.settings.onReadOnlyChanged.add(this.eventManager.visualizersManager),this.selection.onChanged.add(this.barManager),this.selection.onChanged.add(this.apiController),this.selection.onChanged.add(this.permissionsProvider),this.modelManipulator.commitItemsCreateChanges(),this.history.onChanged.add(this),this.toolboxManager=new y.ToolboxManager(this.shapeDescriptionManager),this.settings.onConnectorRoutingModeChanged.add(this.routingModel),P.ImageCache.instance.onReadyStateChanged.add(this)}return Object.defineProperty(t.prototype,"operationSettings",{get:function(){return this.permissionsProvider.operationSettings},enumerable:!1,configurable:!0}),t.prototype.cleanMarkup=function(t){t=t||function(t){O.RenderUtils.removeElement(t)},this.toolboxManager.clean(t),this.render&&(this.settings.onZoomChanged.remove(this.render.view),this.settings.onViewChanged.remove(this.render.page),this.settings.onViewChanged.remove(this.render.view),this.settings.onReadOnlyChanged.remove(this.render),this.settings.onReadOnlyChanged.remove(this.render.selection),this.eventManager.onTextInputOperation.remove(this.render.input),this.eventManager.onTextInputOperation.remove(this.render.items),this.eventManager.onTextInputOperation.remove(this.render.selection),this.eventManager.onMouseOperation.remove(this.render.items),this.eventManager.onMouseOperation.remove(this.render.selection),this.eventManager.onMouseOperation.remove(this.render.view),this.eventManager.onMouseOperation.remove(this.render),this.eventManager.onVisualizersUpdate.remove(this.render.selection),this.modelManipulator.onModelSizeChanged.remove(this.render.view),this.modelManipulator.onModelSizeChanged.remove(this.render.page),this.modelManipulator.onModelChanged.remove(this.render.items),this.modelManipulator.onModelChanged.remove(this.render.page),this.modelManipulator.onModelChanged.remove(this.render.selection),this.selection.onChanged.remove(this.render.selection),this.selection.onChanged.remove(this.render.items),this.render.clean(t),this.render=void 0)},t.prototype.createDocument=function(t,e){this.measurer||this.initMeasurer(t),this.render?this.render.replaceParent(t,e):(this.render=new l.RenderManager(t,this.eventManager,this.measurer,{pageColor:this.model.pageColor,modelSize:this.model.size,pageLandscape:this.model.pageLandscape,pageSize:this.model.pageSize,simpleView:this.settings.simpleView,readOnly:this.settings.readOnly,gridSize:this.settings.gridSize,gridVisible:this.settings.showGrid,zoomLevel:this.settings.zoomLevel,autoZoom:this.settings.autoZoom,rectangle:this.model.getRectangle(!0)},e),this.settings.onZoomChanged.add(this.render.view),this.settings.onViewChanged.add(this.render.page),this.settings.onViewChanged.add(this.render.view),this.settings.onReadOnlyChanged.add(this.render),this.settings.onReadOnlyChanged.add(this.render.selection),this.eventManager.onTextInputOperation.add(this.render.input),this.eventManager.onTextInputOperation.add(this.render.items),this.eventManager.onTextInputOperation.add(this.render.selection),this.eventManager.onTextInputOperation.add(this),this.eventManager.onMouseOperation.add(this.render.items),this.eventManager.onMouseOperation.add(this.render.selection),this.eventManager.onMouseOperation.add(this.render.view),this.eventManager.onMouseOperation.add(this.render),this.eventManager.onVisualizersUpdate.add(this.render.selection),this.modelManipulator.onModelSizeChanged.add(this.render.view),this.modelManipulator.onModelSizeChanged.add(this.render.page),this.modelManipulator.onModelChanged.add(this.render.items),this.modelManipulator.onModelChanged.add(this.render.page),this.modelManipulator.onModelChanged.add(this.render.selection),this.selection.onChanged.add(this.render.selection),this.selection.onChanged.add(this.render.items),this.render.update(!1),this.render.onNewModel(this.model.items),this.modelManipulator.commitItemsCreateChanges(),this.view.initialize(this.render.view),this.selection.raiseSelectionChanged())},t.prototype.createToolbox=function(t,e,n,o){var i=this.toolboxManager.create(t,this.settings.readOnly,!0,e,n,this.getToolboxAllowedShapeTypes.bind(this),o);this.settings.onReadOnlyChanged.add(i),i.onDragOperation.add(this),i.onDragOperation.add(this.apiController),this.eventManager.registerToolbox(i)},t.prototype.createContextToolbox=function(t,e,n,o,i){this.contextToolbox&&this.cleanContextToolbox(t),this.contextToolbox=this.toolboxManager.create(t,this.settings.readOnly,!1,e,n,this.getToolboxAllowedShapeTypes.bind(this),o),this.contextToolbox.onClickOperation.add(this),this.contextToolboxOnClick=i},t.prototype.getToolboxAllowedShapeTypes=function(t){var e=this,n=[];return this.permissionsProvider.beginUpdateUI(),t.forEach((function(t){e.permissionsProvider.canAddShapeFromToolbox(t)&&n.push(t)})),this.permissionsProvider.endUpdateUI(),n},t.prototype.cleanContextToolbox=function(t){this.contextToolbox&&(this.toolboxManager.clean(void 0,this.contextToolbox),this.contextToolbox=void 0)},t.prototype.refreshToolbox=function(t){this.permissionsProvider.clearCache(f.DiagramModelOperation.AddShapeFromToolbox),this.toolboxManager.refresh(t)},t.prototype.applyToolboxFilter=function(t,e){return this.toolboxManager.applyFilter(t,e)},t.prototype.notifyToolboxClick=function(t){this.contextToolboxOnClick&&this.contextToolboxOnClick(t)},t.prototype.initMeasurer=function(t){this.measurer=new x.TextMeasurer(t)},t.prototype.updateLayout=function(t){void 0===t&&(t=!1),this.render&&this.render.update(!t)},t.prototype.captureFocus=function(){this.render&&this.render.input.captureFocus()},t.prototype.isFocused=function(){return!this.render||this.render.input.isFocused()},t.prototype.registerBar=function(t){this.barManager.registerBar(t)},t.prototype.updateBarItemsState=function(t,e){this.barManager.updateBarItemsState(t,e)},t.prototype.getCommand=function(t){return this.commandManager.getCommand(t)},t.prototype.getNativeItemByKey=function(t){var e=this.model.findItem(t);return e&&this.apiController.createNativeItem(e)},t.prototype.getNativeItemByDataKey=function(t){var e=this.model.findItemByDataKey(t);return e&&this.apiController.createNativeItem(e)},t.prototype.setInitialStyleProperties=function(t){this.selection.inputPosition.setInitialStyleProperties(t)},t.prototype.setInitialTextStyleProperties=function(t){this.selection.inputPosition.setInitialTextStyleProperties(t)},t.prototype.setInitialConnectorProperties=function(t){this.selection.inputPosition.setInitialConnectorProperties(t)},t.prototype.addCustomShapes=function(t){var e=this;t.forEach((function(t){t.apiController=e.apiController,t.defaultWidth&&(t.defaultWidth=g.ModelUtils.getTwipsValue(e.model.units,t.defaultWidth)),t.defaultHeight&&(t.defaultHeight=g.ModelUtils.getTwipsValue(e.model.units,t.defaultHeight)),t.minWidth&&(t.minWidth=g.ModelUtils.getTwipsValue(e.model.units,t.minWidth)),t.minHeight&&(t.minHeight=g.ModelUtils.getTwipsValue(e.model.units,t.minHeight)),t.maxWidth&&(t.maxWidth=g.ModelUtils.getTwipsValue(e.model.units,t.maxWidth)),t.maxHeight&&(t.maxHeight=g.ModelUtils.getTwipsValue(e.model.units,t.maxHeight)),e.shapeDescriptionManager.registerCustomShape(t)}))},t.prototype.removeCustomShapes=function(t){var e=this;t.forEach((function(t){e.shapeDescriptionManager.unregisterCustomShape(t)}))},t.prototype.importModel=function(t){this.model=t,this.model.initializeKeyCounter(),this.apiController.model=t,this.onImportData()},t.prototype.importItemsData=function(){this.model.iterateItems((function(t){t instanceof w.Connector&&t.invalidateRenderPoints()})),this.onImportData()},t.prototype.onImportData=function(){this.render&&(this.render.clear(),this.render.onNewModel(this.model.items)),this.permissionsProvider.clearCache(),this.selection.initialize(this.model),this.modelManipulator.initialize(this.model,this.routingModel),this.history.clear(),this.eventManager.initialize(),this.modelManipulator.commitPageChanges(),this.modelManipulator.commitItemsCreateChanges(),this.processChanges()},t.prototype.createDocumentDataSource=function(t,e,n,o,r){var a=this;return this.documentDataSource=new h.DocumentDataSource(this,t,e,n,o,r,(function(t){t?a.lockedReadOnly=a.settings.readOnly:t=a.lockedReadOnly,a.commandManager.getCommand(i.DiagramCommand.ToggleReadOnly).execute(t)})),this.apiController.setDataSource(this.documentDataSource),this.documentDataSource},t.prototype.deleteDocumentDataSource=function(){this.apiController.setDataSource(null),delete this.documentDataSource},t.prototype.applyShapeSizeSettings=function(t){this.settings.applyShapeSizeSettings(t,this.model.units)},t.prototype.applyOperationSettings=function(t){this.permissionsProvider.operationSettings.applySettings(t)},t.prototype.beginUpdateCanvas=function(){this.render&&(this.render.items.beginUpdate(),this.render.selection.beginUpdate())},t.prototype.endUpdateCanvas=function(){this.render&&(this.render.items.endUpdate(),this.render.selection.endUpdate())},t.prototype.beginUpdate=function(){this.barManager.beginUpdate(),this.apiController.beginUpdate(),this.eventManager.beginUpdate()},t.prototype.endUpdate=function(){this.barManager.endUpdate(),this.apiController.endUpdate(),this.eventManager.endUpdate()},t.prototype.notifyEdgeInserted=function(t,e,n){this.onEdgeInserted&&this.onEdgeInserted(t,e,n)},t.prototype.notifyEdgeUpdated=function(t,e,n,o){this.onEdgeUpdated&&this.onEdgeUpdated(t,e,n,o)},t.prototype.notifyEdgeRemoved=function(t,e,n,o){this.onEdgeUpdated&&this.onEdgeRemoved(t,e,n,o)},t.prototype.notifyNodeInserted=function(t,e,n){this.onNodeInserted&&this.onNodeInserted(t,e,n)},t.prototype.notifyNodeUpdated=function(t,e,n,o){this.onNodeUpdated&&this.onNodeUpdated(t,e,n,o)},t.prototype.notifyNodeRemoved=function(t,e,n,o){this.onNodeRemoved&&this.onNodeRemoved(t,e,n,o)},t.prototype.notifyDataChangesProcessed=function(){this.processReloadContent(),this.processDataChanges()},t.prototype.processDataChanges=function(){this.documentDataSource.isChangesLocked()||(this.processDataChangesNeeded&&(this.documentDataSource.updateItemsByModel(this.model),this.processDataChangesNeeded=!1),this.raiseOnChanged())},t.prototype.processChanges=function(){this.settings.readOnly||(this.documentDataSource?(this.processDataChangesNeeded=!0,this.processDataChanges()):this.raiseOnChanged())},t.prototype.processReloadContent=function(){this.reloadContentNeeded&&(this.reloadContentParameters.empty||this.reloadContentCore(this.reloadContentParameters,!1),this.reloadContentByExternalChangesParameters.empty||this.reloadContentCore(this.reloadContentByExternalChangesParameters,!0),this.reloadContentNeeded=!1)},t.prototype.reloadContent=function(t,e,n,o){if(this.documentDataSource){this.documentDataSource.isChangesLocked()&&(this.reloadContentNeeded=!0);var i=!0===o||void 0===o&&!this.reloadContentNeeded,r=i?this.reloadContentByExternalChangesParameters:this.reloadContentParameters;r.add(t,e,n),this.documentDataSource.isChangesLocked()||(this.reloadContentCore(r,i),this.barManager.updateItemsState())}},t.prototype.reloadContentCore=function(t,e){var n=this,o=t.getData&&t.getData(),i=this.documentDataSource.refetchData(o&&o.nodeDataSource,o&&o.edgeDataSource);this.beginUpdateCanvas(),this.permissionsProvider.lockPermissions(),this.documentDataSource.updateModelItems(this.history,this.model,this.shapeDescriptionManager,this.selection,new I.DataLayoutParameters(this.settings,t.layoutParameters),e,t.dataKeys,(function(t){n.modelManipulator.commitItemUpdateChanges(t)}),i,this.settings.snapToGrid,this.settings.gridSize,this.measurer),this.permissionsProvider.unlockPermissions(),this.endUpdateCanvas(),t.clear()},t.prototype.notifyHistoryChanged=function(){this.processChanges()},t.prototype.raiseOnChanged=function(){this.onChanged&&this.onChanged()},t.prototype.notifyToolboxDragStart=function(){this.onToolboxDragStart&&this.onToolboxDragStart()},t.prototype.notifyToolboxDragEnd=function(){this.onToolboxDragEnd&&this.onToolboxDragEnd()},t.prototype.notifyTextInputStart=function(t,e,n,o){this.onTextInputStart&&this.onTextInputStart()},t.prototype.notifyTextInputEnd=function(t){this.onTextInputEnd&&this.onTextInputEnd()},t.prototype.notifyTextInputPermissionsCheck=function(t,e){},t.prototype.notifyToggleFullscreen=function(t){this.onToggleFullscreen&&this.onToggleFullscreen(t)},t.prototype.getPastePosition=function(){return this.contextMenuPosition},t.prototype.notifyShowContextMenu=function(t,e){if(this.onShowContextMenu&&this.render){var n=void 0,o=this.selection.getSelectedItems(!0);if(o.length>0){var i=a.DiagramModel.getRectangle(this.selection.getSelectedItems(!0)),r=this.render.getEventPointByModelPoint(i.createPosition()),s=this.render.view.getAbsoluteSize(i.createSize());n={x:r.x,y:r.y,width:s.width,height:s.height}}if(t)this.contextMenuPosition=new C.Point(t.x,t.y),this.onShowContextMenu(t.x,t.y,n);else if(e){var c=this.render.getEventPointByModelPoint(e);this.contextMenuPosition=c.clone(),this.onShowContextMenu(c.x,c.y,n)}}},t.prototype.notifyHideContextMenu=function(){this.onHideContextMenu&&this.render&&this.onHideContextMenu()},t.prototype.notifyShowContextToolbox=function(t,e,n,o,i){if(this.onShowContextToolbox&&this.render){var r=this.render.getEventPointByModelPoint(t);this.onShowContextToolbox(r.x,r.y,n,o,i)}},t.prototype.notifyHideContextToolbox=function(){this.onHideContextToolbox&&this.render&&this.onHideContextToolbox()},t.prototype.notifyShapeDescriptionChanged=function(t){this.modelManipulator.updateShapeDescription(t)},t.prototype.notifyImageCacheReadyStateChanged=function(t){this.barManager.updateItemsState()},t.prototype.notifyRequestOperation=function(t,e){this.onRequestOperation&&this.onRequestOperation(t,e)},t}();e.DiagramControl=E},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModelManipulator=void 0;var o=n(86),i=n(2),r=n(56),a=n(46),s=n(132),c=n(16),u=n(3),l=n(6),p=n(98),h=function(){function t(t,e,n){this.onModelChanged=new u.EventDispatcher,this.onModelSizeChanged=new u.EventDispatcher,this.initializeCore(t,e),this.permissionsProvider=n,this.imageLoader=new s.ImageLoader(this.updateShapeImage.bind(this))}return t.prototype.initialize=function(t,e){this.initializeCore(t,e),this.model.loadAllImages(this.imageLoader),this.updateModelSize()},t.prototype.initializeCore=function(t,e){this.model=t,this.routingModel=e,this.routingModel.initialize(t)},t.prototype.commitPageChanges=function(){this.raisePageSizeChanged(this.model.pageSize.clone(),this.model.pageLandscape),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageColorChanged(this.model.pageColor),this.raiseModelRectangleChanged(u.GeometryUtils.getCommonRectangle(this.model.items.map((function(t){return t.rectangle}))))},t.prototype.commitItemsCreateChanges=function(){r.Diagnostics.timer("new model: model changes"),this.commitItemsChangesCore(p.ItemChangeType.Create,this.model.items),r.Diagnostics.endTimer()},t.prototype.commitItemUpdateChanges=function(t){this.commitItemsChangesCore(p.ItemChangeType.UpdateStructure,[t])},t.prototype.commitItemsChangesCore=function(t,e){var n=[];e.forEach((function(e){n.push(new p.ItemChange(e,t))})),n.length&&this.raiseModelChanged(n)},t.prototype.insertToContainer=function(t,e){if(t.container&&e&&t.container.key!==e.key)throw Error("To insert an item to a container it's necessary to remove it from the current container.");e&&(e.children.push(t),t.container=e,this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Update)]))},t.prototype.removeFromContainer=function(t){if(t.container){var e=t.container.children.indexOf(t);t.container.children.splice(e,1),t.container=void 0,this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Update)])}},t.prototype.changeStyle=function(t,e,n){this.changeStyleCore(t,t.style,e,n)},t.prototype.changeStyleText=function(t,e,n){this.changeStyleCore(t,t.styleText,e,n)},t.prototype.changeStyleCore=function(t,e,n,o){void 0!==o?e[n]=o:delete e[n],this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties)])},t.prototype.changeZIndex=function(t,e){t.zIndex=e,this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Update)])},t.prototype.changeLocked=function(t,e){t.locked=e,this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateClassName)])},t.prototype.changeCustomData=function(t,e){t.customData=u.ObjectUtils.cloneObject(e),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateStructure)])},t.prototype.addShape=function(t,e){if(t.attachedConnectors.length)throw Error("A creating shape should not contain existing connectors.");return t.key=void 0!==e?e:this.model.getNextKey(),this.insertShape(t)},t.prototype.insertShape=function(t){this.model.pushItem(t);var e=this.permissionsProvider.canAddItems([t]);return this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Create,e)]),this.model.loadAllImages(this.imageLoader),t},t.prototype.resizeShape=function(t,e,n){t.position=e,t.size=n;var o=this.permissionsProvider.isStoredPermissionsGranted(),i=this.getInteractingItem(t,c.DiagramModelOperation.ResizeShape);if(i){var r=i.size.clone(),a=t.size.clone();a.equals(r)||(o=this.permissionsProvider.canResizeShapes([{shape:t,size:a,oldSize:r}]))}var s=this.getInteractingItem(t,c.DiagramModelOperation.MoveShape);if(s){var u=s.position.clone(),l=t.position.clone();l.equals(u)||(o=this.permissionsProvider.canMoveShapes([{shape:t,position:l,oldPosition:u}]))}this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,o)])},t.prototype.moveShape=function(t,e){t.position=e;var n=this.permissionsProvider.isStoredPermissionsGranted(),o=this.getInteractingItem(t,c.DiagramModelOperation.AddShape);o&&(n=this.permissionsProvider.canAddItems([t]));var i=this.getInteractingItem(t,c.DiagramModelOperation.MoveShape);if(i){var r=i.position.clone(),a=t.position.clone();a.equals(r)||(n=this.permissionsProvider.canMoveShapes([{shape:t,position:a,oldPosition:r}]))}this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,n)])},t.prototype.changeShapeParameters=function(t,e){t.parameters.forEach((function(t){var n=e.get(t.key);n&&(t.value=n.value)})),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties)])},t.prototype.changeShapeText=function(t,e){t.text=e,this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateStructure)])},t.prototype.changeShapeImage=function(t,e){t.image=e;var n=a.ImageCache.instance.createUnloadedInfoByShapeImageInfo(e);this.imageLoader.load(n),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateStructure)])},t.prototype.changeShapeExpanded=function(t,e){t.expanded=e,t.toggleExpandedSize(),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateStructure)])},t.prototype.deleteShape=function(t){if(t.attachedConnectors.length)throw Error("A removing shape should not contain existing connectors.");this.removeShape(t)},t.prototype.removeShape=function(t){this.model.removeItem(t);var e=this.permissionsProvider.canDeleteItems([t]);this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Remove,e)])},t.prototype.updateShapeImage=function(t){if(t.imageUrl){var e=this.model.findShapesByImageUrl(t.imageUrl);e.forEach((function(e){t.base64?e.image.loadBase64Content(t.base64):e.image.setUnableToLoadFlag()})),this.commitItemsChangesCore(p.ItemChangeType.UpdateStructure,e)}},t.prototype.updateShapeDescription=function(t){var e=this.model.findShapesByDescription(t);this.commitItemsChangesCore(p.ItemChangeType.UpdateProperties,e)},t.prototype.addConnector=function(t,e){if(t.beginItem||t.endItem)throw Error("Creating connector should not contain begin/end items");return t.key=void 0!==e?e:this.model.getNextKey(),this.insertConnector(t)},t.prototype.insertConnector=function(t){this.model.pushItem(t),t.routingStrategy=this.routingModel.createStrategy(t.properties.lineOption),t.invalidateRenderPoints();var e=this.permissionsProvider.canAddItems([t]);return this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Create,e)]),t},t.prototype.deleteConnector=function(t){if(t.beginItem||t.endItem)throw Error("Creating connector should not contain begin/end items");this.removeConnector(t)},t.prototype.removeConnector=function(t){this.model.removeItem(t);var e=this.permissionsProvider.canDeleteItems([t]);this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.Remove,e)])},t.prototype.addDeleteConnectorPoint=function(t,e){var n=this.getConnectorInteractingPoints(t);e(t),this.addDeleteConnectorPointCore(t,n)},t.prototype.moveConnectorPoint=function(t,e,n){n(t),this.moveConnectorPointCore(t,e)},t.prototype.changeConnectorPoints=function(t,e){var n=this;e(t),t.points.forEach((function(e,o){return n.moveConnectorPointCore(t,o)}))},t.prototype.moveConnectorPointCore=function(t,e){var n=this.getInteractingItem(t),o=this.permissionsProvider.isStoredPermissionsGranted();if(n){var i=0<e&&e<t.points.length-1;if(i=i||0===e&&!t.beginItem,i=i||e===t.points.length-1&&!t.endItem,i){var r=n.points.map((function(t){return t.clone()})),a=t.points.map((function(t){return t.clone()}));u.GeometryUtils.arePointsEqual(r,a)||(o=this.permissionsProvider.canChangeConnectorPoints(t,r,a))}}this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,o)])},t.prototype.getConnectorInteractingPoints=function(t){var e=this.getInteractingItem(t);return e?e.points.map((function(t){return t.clone()})):t.points.map((function(t){return t.clone()}))},t.prototype.addDeleteConnectorPointCore=function(t,e){var n=this.permissionsProvider.isStoredPermissionsGranted(),o=t.points.map((function(t){return t.clone()}));u.GeometryUtils.arePointsEqual(e,o)||(n=this.permissionsProvider.canChangeConnectorPoints(t,e,o)),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,n)])},t.prototype.addConnection=function(t,e,n,o){var i=t.getExtremeItem(o),r=t.getExtremeConnectionPointIndex(o);if(i!==e||r!==n){if(i)throw Error("Connector is already connected");e.attachedConnectors.push(t),o===l.ConnectorPosition.Begin?(t.beginItem=e,t.beginConnectionPointIndex=n):(t.endItem=e,t.endConnectionPointIndex=n),t.invalidateRenderPoints();var a=this.permissionsProvider.canChangeConnection(t,e,void 0,o,n);this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,a)])}},t.prototype.setConnectionPointIndex=function(t,e,n){if(!t.getExtremeItem(n))throw Error("Connection should be connected");n===l.ConnectorPosition.Begin?t.beginConnectionPointIndex=e:t.endConnectionPointIndex=e,t.invalidateRenderPoints();var o=t.getExtremeItem(n),i=this.permissionsProvider.canChangeConnection(t,o,o,n,e);this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,i)])},t.prototype.deleteConnection=function(t,e){var n=t.getExtremeItem(e);if(n){n.attachedConnectors.splice(n.attachedConnectors.indexOf(t),1),e===l.ConnectorPosition.Begin?(t.beginItem=null,t.beginConnectionPointIndex=-1):(t.endItem=null,t.endConnectionPointIndex=-1),t.invalidateRenderPoints();var o=this.permissionsProvider.canChangeConnection(t,void 0,n,e,-1);this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties,o)])}},t.prototype.changeConnectorProperty=function(t,e,n){t.properties[e]=n,this.routingModel&&"lineOption"===e&&(t.routingStrategy=this.routingModel.createStrategy(t.properties.lineOption)),t.invalidateRenderPoints(),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties)])},t.prototype.changeConnectorText=function(t,e,n){t.setText(e,n),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateStructure)])},t.prototype.changeConnectorTextPosition=function(t,e,n){var o=t.getText(e);t.setText(null,e),t.setText(o,n),this.raiseModelChanged([new p.ItemChange(t,p.ItemChangeType.UpdateProperties)])},t.prototype.changeModelSize=function(t,e){this.model.size.width=t.width,this.model.size.height=t.height,this.raiseModelSizeChanged(this.model.size.clone(),e),(e.left||e.top)&&(this.model.snapStartPoint=this.model.snapStartPoint.clone().offset(e.left,e.top),this.raiseSnapPointChange(this.model.snapStartPoint))},t.prototype.changePageSize=function(t){this.model.pageSize.equals(t)||(this.model.pageSize=t,this.model.size=new i.Size(this.model.pageWidth,this.model.pageHeight),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageSizeChanged(this.model.pageSize,this.model.pageLandscape))},t.prototype.changePageLandscape=function(t){this.model.pageLandscape!==t&&(this.model.pageLandscape=t,this.model.pageSize.width!==this.model.pageSize.height&&(this.model.size=new i.Size(this.model.pageWidth,this.model.pageHeight),this.raiseModelSizeChanged(this.model.size.clone()),this.raisePageSizeChanged(this.model.pageSize,this.model.pageLandscape)))},t.prototype.changePageColor=function(t){this.model.pageColor!==t&&(this.model.pageColor=t,this.raisePageColorChanged(t))},t.prototype.getModelSizeUpdateOffset=function(){var t=this.model.getRectangle(!1),e=this.model.getRectangle(!0);e.equals(t)||this.raiseModelRectangleChanged(e);var n=-Math.floor(e.x/this.model.pageWidth),i=-Math.floor(e.y/this.model.pageHeight),r=-Math.floor((this.model.size.width-e.right)/this.model.pageWidth),a=-Math.floor((this.model.size.height-e.bottom)/this.model.pageHeight);return new o.Offsets(n*this.model.pageWidth,r*this.model.pageWidth,i*this.model.pageHeight,a*this.model.pageHeight)},t.prototype.updateModelSize=function(){var t=this.getModelSizeUpdateOffset();if(!t.isEmpty()){var e=Math.max(this.model.size.width+t.left+t.right,this.model.pageWidth),n=Math.max(this.model.size.height+t.top+t.bottom,this.model.pageHeight);this.model.size=new i.Size(e,n)}},t.prototype.raiseModelChanged=function(t){this.onModelChanged.raise1((function(e){return e.notifyModelChanged(t)}))},t.prototype.raisePageColorChanged=function(t){this.onModelChanged.raise1((function(e){return e.notifyPageColorChanged(t)}))},t.prototype.raisePageSizeChanged=function(t,e){this.onModelChanged.raise1((function(n){return n.notifyPageSizeChanged(t,e)}))},t.prototype.raiseModelSizeChanged=function(t,e){this.onModelSizeChanged.raise1((function(n){return n.notifyModelSizeChanged(t,e)}))},t.prototype.raiseModelRectangleChanged=function(t){this.onModelSizeChanged.raise1((function(e){return e.notifyModelRectangleChanged(t)}))},t.prototype.raiseSnapPointChange=function(t){this.onModelSizeChanged.raise1((function(e){return e.notifySnapPointPositionChanged(t)}))},t.prototype.getInteractingItem=function(t,e){return this.permissionsProvider.getInteractingItem(t,e)},t}();e.ModelManipulator=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventManager=void 0;var o=n(303),i=n(3),r=n(322),a=n(157),s=n(323),c=n(158),u=n(329),l=n(330),p=n(19),h=n(17),d=function(){function t(t){this.onMouseOperation=new i.EventDispatcher,this.onTextInputOperation=new i.EventDispatcher,this.toolboxes=[],this.control=t,this.visualizersManager=p.Browser.TouchUI?new u.VisualizerTouchManager(t.selection,t.model,this,t.settings):new c.VisualizerManager(t.selection,t.model,this,t.settings),this.onMouseOperation.add(this.visualizersManager),this.contextMenuHandler=p.Browser.TouchUI?new s.ContextMenuTouchHandler(t.selection):new a.ContextMenuHandler,this.contextMenuHandler.onVisibilityChanged.add(t),this.onMouseOperation.add(this.contextMenuHandler),this.onTextInputOperation.add(this.contextMenuHandler),this.contextToolboxHandler=new l.ContextToolboxHandler,this.contextToolboxHandler.onVisibilityChanged.add(t),this.contextToolboxHandler.onVisibilityChanged.add(this.contextMenuHandler),this.mouseHandler=new o.MouseHandler(t.history,t.selection,t.model,this,t.settings.readOnly,t.view,this.visualizersManager,this.contextToolboxHandler,t.shapeDescriptionManager,t.settings,t.permissionsProvider),this.textInputHandler=new r.TextInputHandler(t),this.visualizersManager.onVisualizersUpdate.add(this.mouseHandler)}return Object.defineProperty(t.prototype,"onVisualizersUpdate",{get:function(){return this.visualizersManager.onVisualizersUpdate},enumerable:!1,configurable:!0}),t.prototype.registerToolbox=function(t){this.toolboxes.push(t)},t.prototype.initialize=function(){this.visualizersManager.initialize(this.control.model),this.mouseHandler.initialize(this.control.model)},t.prototype.beginUpdate=function(t){this.contextMenuHandler.beginUpdate(),this.visualizersManager.beginUpdate()},t.prototype.endUpdate=function(){this.contextMenuHandler.endUpdate(),this.visualizersManager.endUpdate()},t.prototype.onMouseDown=function(t){this.mouseHandler.onMouseDown(t),this.contextMenuHandler.onMouseDown(t),this.visualizersManager.onMouseDown(t),this.contextToolboxHandler.onMouseDown(t)},t.prototype.onMouseMove=function(t){this.processDragging(t),this.mouseHandler.onMouseMove(t)},t.prototype.onMouseUp=function(t){this.contextToolboxHandler.onMouseUp(t),this.mouseHandler.onMouseUp(t),this.contextMenuHandler.onMouseUp(t),this.visualizersManager.onMouseUp(t),this.processDragging(t)},t.prototype.onMouseEnter=function(t){this.visualizersManager.onMouseEnter(t)},t.prototype.onMouseLeave=function(t){this.visualizersManager.onMouseLeave(t)},t.prototype.onDblClick=function(t){this.mouseHandler.onMouseDblClick(t),this.textInputHandler.onDblClick(t),this.control.apiController.notifyDblClick(t)},t.prototype.onClick=function(t){this.mouseHandler.onMouseClick(t),this.control.apiController.notifyClick(t)},t.prototype.onContextMenu=function(t){this.contextMenuHandler.onContextMenu(t)},t.prototype.onLongTouch=function(t){this.mouseHandler.onLongTouch(t),this.contextMenuHandler.onLongTouch(t)},t.prototype.onBlur=function(t){this.contextMenuHandler.onBlur(t),this.contextToolboxHandler.onBlur(t),this.visualizersManager.onBlur(t)},t.prototype.onFocus=function(t){this.contextMenuHandler.onFocus(t),this.contextToolboxHandler.onFocus(t),this.visualizersManager.onFocus(t)},t.prototype.onKeyDown=function(t){var e=t.getShortcutCode();this.onShortcut(e)?(this.visualizersManager.updateConnectionPoints(),this.contextMenuHandler.onShortcut(t),this.contextToolboxHandler.onShortcut(t),t.preventDefault=!0):this.isShortcutForFocusInput(e)&&(t.preventDefault=!0),this.contextMenuHandler.onKeyDown(t),this.contextToolboxHandler.onKeyDown(t),this.mouseHandler.onKeyDown(t)},t.prototype.onKeyUp=function(t){this.mouseHandler.onKeyUp(t)},t.prototype.onTextInputBlur=function(t){this.textInputHandler.onBlur(t),this.contextMenuHandler.onTextInputBlur(t)},t.prototype.onTextInputFocus=function(t){this.textInputHandler.onFocus(t),this.contextMenuHandler.onTextInputFocus(t)},t.prototype.onTextInputKeyDown=function(t){this.textInputHandler.onKeyDown(t)},t.prototype.onShortcut=function(t){return!!this.control.commandManager.processShortcut(t)||(!!this.mouseHandler.onShortcut(t)||void 0)},t.prototype.isShortcutForFocusInput=function(t){return t===h.KeyCode.Delete||t===(h.KeyCode.Delete|h.ModifierKey.Ctrl)||t===(h.KeyCode.Delete|h.ModifierKey.Meta)||t===h.KeyCode.Backspace||t===(h.KeyCode.Backspace|h.ModifierKey.Ctrl)||t===(h.KeyCode.Backspace|h.ModifierKey.Shift)||t===(h.KeyCode.Backspace|h.ModifierKey.Meta)||t===h.KeyCode.Home||t===h.KeyCode.End||t===h.KeyCode.Up||t===(h.KeyCode.Up|h.ModifierKey.Ctrl)||t===(h.KeyCode.Up|h.ModifierKey.Meta)||t===h.KeyCode.Down||t===(h.KeyCode.Down|h.ModifierKey.Ctrl)||t===(h.KeyCode.Down|h.ModifierKey.Meta)||t===h.KeyCode.Left||t===(h.KeyCode.Left|h.ModifierKey.Ctrl)||t===(h.KeyCode.Left|h.ModifierKey.Meta)||t===h.KeyCode.Right||t===(h.KeyCode.Right|h.ModifierKey.Ctrl)||t===(h.KeyCode.Right|h.ModifierKey.Meta)},t.prototype.onPaste=function(t){!this.textInputHandler.isTextInputActive()&&this.control.commandManager.processPaste(t.clipboardData)&&(this.visualizersManager.updateConnectionPoints(),t.preventDefault=!0)},t.prototype.onMouseWheel=function(t){this.mouseHandler.onWheel(t)&&(t.preventDefault=!0)},t.prototype.isFocused=function(){return this.control.isFocused()},t.prototype.processDragging=function(t){var e=this.getDraggingEvent();e&&!this.draggingEvent?(this.draggingEvent=e,this.mouseHandler.onDragStart(this.draggingEvent),this.control.captureFocus()):!e&&this.draggingEvent&&(delete this.draggingEvent,this.mouseHandler.onDragEnd(t))},t.prototype.getDraggingEvent=function(){return this.toolboxes.filter((function(t){return t.draggingObject})).map((function(t){return t.draggingObject.evt}))[0]},t.prototype.onDocumentDragStart=function(t){this.control.beginUpdate(),this.control.captureFocus(),this.onMouseOperation.raise("notifyDragStart",t)},t.prototype.onDocumentDragEnd=function(t){this.onMouseOperation.raise("notifyDragEnd",t),this.control.endUpdate(),this.control.barManager.updateItemsState()},t.prototype.onDocumentDragScrollStart=function(){this.onMouseOperation.raise1((function(t){return t.notifyDragScrollStart()}))},t.prototype.onDocumentDragScrollEnd=function(){this.onMouseOperation.raise1((function(t){return t.notifyDragScrollEnd()}))},t.prototype.onDocumentClick=function(t){this.control.beginUpdate(),this.control.endUpdate(),this.control.barManager.updateItemsState()},t.prototype.raiseTextInputStart=function(t,e,n,o){this.onTextInputOperation.raise("notifyTextInputStart",t,e,n,o)},t.prototype.raiseTextInputEnd=function(t){this.onTextInputOperation.raise("notifyTextInputEnd",t)},t.prototype.raiseTextInputPermissionsCheck=function(t,e){this.onTextInputOperation.raise("notifyTextInputPermissionsCheck",t,e)},t.prototype.canFinishTextEditing=function(){return this.textInputHandler.canFinishTextEditing()},t}();e.EventManager=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandler=void 0;var o=n(149),i=n(1),r=n(17),a=n(9),s=n(77),c=n(319),u=n(155),l=n(320),p=n(19),h=function(){function t(t,e,n,o,i,r,a,s,c,u,l){this.history=t,this.selection=e,this.model=n,this.eventManager=o,this.readOnly=i,this.view=r,this.visualizerManager=a,this.contextToolboxHandler=s,this.shapeDescriptionManager=c,this.settings=u,this.permissionsProvider=l,this.finishStateLock=0,this.initialize(n)}return t.prototype.initialize=function(t){this.model=t,this.initializeDefaultState()},t.prototype.initializeDefaultState=function(){this.defaultState=this.readOnly?p.Browser.TouchUI?new c.MouseHandlerDefaultReadOnlyTouchState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings):new u.MouseHandlerDefaultReadOnlyState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings):p.Browser.TouchUI?new l.MouseHandlerDefaultTouchState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings):new o.MouseHandlerDefaultState(this,this.history,this.selection,this.model,this.view,this.visualizerManager,this.shapeDescriptionManager,this.settings),this.switchToDefaultState()},t.prototype.onMouseDown=function(t){this.mouseDownEvent=t,this.state.onMouseDown(t)},t.prototype.onMouseMove=function(t){this.state.onMouseMove(t)},t.prototype.onMouseUp=function(t){this.state.onMouseUp(t)},t.prototype.onMouseDblClick=function(t){this.state.onMouseDblClick(t)},t.prototype.onMouseClick=function(t){this.state.onMouseClick(t)},t.prototype.onLongTouch=function(t){if(t.touches&&!(t.touches.length>1)){var e=t.source.key;void 0===e?this.selection.clear():this.selection.hasKey(e)?this.selection.remove(e):this.selection.add(e)}},t.prototype.onShortcut=function(t){return this.state.onShortcut(t)},t.prototype.onWheel=function(t){return this.state.onMouseWheel(t)},t.prototype.onDragStart=function(t){this.state.onDragStart(t)},t.prototype.onDragEnd=function(t){this.state.onDragEnd(t)},t.prototype.onKeyDown=function(t){this.state.onKeyDown(t)},t.prototype.onKeyUp=function(t){this.state.onKeyUp(t)},t.prototype.showContextToolbox=function(t,e,n,o,i,r){this.contextToolboxHandler.showContextToolbox(t,e,n,o,i,r)},t.prototype.hideContextToolbox=function(t){this.contextToolboxHandler.hideContextToolbox(t)},t.prototype.getSnappedPos=function(t,e,n){return!this.settings.snapToGrid||t.modifiers&r.ModifierKey.Ctrl?e:a.ModelUtils.getSnappedPos(this.model,this.settings.gridSize,e,n)},t.prototype.getSnappedPoint=function(t,e,n){var o=this.getSnappedPos(t,e.x,!0),r=this.getSnappedPos(t,e.y,!1);return void 0===n||Math.pow(e.x-o,2)+Math.pow(e.y-r,2)<Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)?new i.Point(o,r):n},t.prototype.tryUpdateModelSize=function(t){this.lockPermissions(),a.ModelUtils.tryUpdateModelSize(this.history,this.model,t),this.unlockPermissions()},t.prototype.raiseDragStart=function(t){this.eventManager.onDocumentDragStart(t)},t.prototype.raiseDragEnd=function(t){this.eventManager.onDocumentDragEnd(t)},t.prototype.raiseDragScrollStart=function(){this.eventManager.onDocumentDragScrollStart()},t.prototype.raiseDragScrollEnd=function(){this.eventManager.onDocumentDragScrollEnd()},t.prototype.raiseClick=function(t){this.eventManager.onDocumentClick(t)},t.prototype.beginStorePermissions=function(){this.permissionsProvider.beginStorePermissions()},t.prototype.endStorePermissions=function(){this.permissionsProvider.endStorePermissions()},t.prototype.isStoredPermissionsGranted=function(){return this.permissionsProvider.isStoredPermissionsGranted()},t.prototype.lockPermissions=function(){this.permissionsProvider.lockPermissions()},t.prototype.unlockPermissions=function(){this.permissionsProvider.unlockPermissions()},t.prototype.canPerformChangeConnection=function(t,e){var n=!0;return t?n=this.permissionsProvider.canChangeConnection(t,e.item,e.oldItem,e.position,e.connectionPointIndex):e.item&&(n=this.permissionsProvider.canChangeConnection(void 0,e.item,e.oldItem,e.position,e.connectionPointIndex)),n},t.prototype.canPerformChangeConnectionOnUpdateUI=function(t,e){this.permissionsProvider.beginUpdateUI();var n=this.canPerformChangeConnection(t,e);return this.permissionsProvider.endUpdateUI(),n},t.prototype.canFinishTextEditing=function(){return this.eventManager.canFinishTextEditing()},t.prototype.switchToDefaultState=function(){this.switchState(this.defaultState)},t.prototype.switchToMoveClonedShapeState=function(t){this.switchState(new s.MouseHandlerMoveClonedDiagramItemState(this,this.history,this.model,this.selection,this.visualizerManager,t))},t.prototype.switchState=function(t){this.newState=t,this.state&&!this.finishStateLock&&(this.finishStateLock++,this.state.finish(),this.finishStateLock--),this.newState&&(this.state=this.newState,this.state.start(),this.newState=void 0)},t.prototype.addInteractingItem=function(t,e){this.permissionsProvider.addInteractingItem(t,e)},t.prototype.clearInteractingItems=function(){this.permissionsProvider.clearInteractingItems()},t.prototype.notifyReadOnlyChanged=function(t){this.readOnly=t,this.initializeDefaultState()},t.prototype.notifySelectionRectShow=function(t){},t.prototype.notifySelectionRectHide=function(){},t.prototype.notifyResizeInfoShow=function(t,e){},t.prototype.notifyResizeInfoHide=function(){},t.prototype.notifyConnectionPointsShow=function(t,e,n,o){this.state.onConnectionPointsShow(t,e)},t.prototype.notifyConnectionPointsHide=function(){},t.prototype.notifyConnectionTargetShow=function(t,e){this.state.onConnectionTargetShow(t,e)},t.prototype.notifyConnectionTargetHide=function(){},t.prototype.notifyContainerTargetShow=function(t,e){},t.prototype.notifyContainerTargetHide=function(){},t.prototype.notifyExtensionLinesShow=function(t){},t.prototype.notifyExtensionLinesHide=function(){},t}();e.MouseHandler=h},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveConnectorPointState=void 0;var i=n(150),r=n(6),a=n(9),s=n(1),c=n(31),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.onMouseDown=function(e){this.connector=this.model.findConnector(e.source.key),this.pointIndex=parseInt(e.source.value),0===this.pointIndex?this.pointPosition=r.ConnectorPosition.Begin:this.pointIndex===this.connector.points.length-1&&(this.pointPosition=r.ConnectorPosition.End),this.handler.addInteractingItem(this.connector),t.prototype.onMouseDown.call(this,e)},e.prototype.onApplyChanges=function(e){this.connector.properties.lineOption===c.ConnectorLineOption.Orthogonal&&0!==this.pointIndex&&this.pointIndex!==this.connector.points.length-1||t.prototype.onApplyChanges.call(this,e)},e.prototype.onFinishWithChanges=function(){t.prototype.onFinishWithChanges.call(this),a.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector)},e.prototype.getSnappedPoint=function(t,e){var n=this.connector.points,o=this.pointIndex;if(0<o&&o<n.length-1){var i=(n[o+1].y-n[o-1].y)/(n[o+1].x-n[o-1].x),r=e.x,a=n[o+1].y-(n[o+1].x-r)*i;return this.handler.getSnappedPoint(t,e,new s.Point(r,a))}return this.handler.getSnappedPoint(t,e)},e}(i.MouseHandlerMoveConnectorPointStateBase);e.MouseHandlerMoveConnectorPointState=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerResizeShapeState=void 0;var i=n(2),r=n(1),a=n(13),s=n(17),c=n(33),u=n(32),l=n(9),p=n(7),h=n(16),d=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n)||this;return s.model=o,s.selection=i,s.visualizerManager=r,s.settings=a,s.startScrollLeft=0,s.startScrollTop=0,s.rotation=0,s}return o(e,t),e.prototype.finish=function(){this.visualizerManager.resetResizeInfo(),this.visualizerManager.resetExtensionLines(),t.prototype.finish.call(this)},e.prototype.onMouseDown=function(e){var n=this,o=parseInt(e.source.value);this.resizeEventSource=o,this.startPoint=e.modelPoint,this.lockH=o===a.ResizeEventSource.ResizeBox_S||o===a.ResizeEventSource.ResizeBox_N,this.lockV=o===a.ResizeEventSource.ResizeBox_E||o===a.ResizeEventSource.ResizeBox_W,this.sideH=o===a.ResizeEventSource.ResizeBox_E||o===a.ResizeEventSource.ResizeBox_NE||o===a.ResizeEventSource.ResizeBox_SE,this.sideV=o===a.ResizeEventSource.ResizeBox_SE||o===a.ResizeEventSource.ResizeBox_S||o===a.ResizeEventSource.ResizeBox_SW,this.shapes=this.selection.getSelectedShapes(),0!==this.shapes.length?(this.shapes.forEach((function(t){n.handler.addInteractingItem(t,h.DiagramModelOperation.ResizeShape),n.handler.addInteractingItem(t,h.DiagramModelOperation.MoveShape)})),this.connectors=this.selection.getSelectedConnectors(),this.startRectangle=u.DiagramModel.getRectangle(this.shapes),this.startShapeSizes=this.shapes.map((function(t){return t.size.clone()})),this.startShapePositions=this.shapes.map((function(t){return t.position.clone()})),this.startConnectorPoints=this.connectors.map((function(t){return t.points.map((function(t){return t.clone()}))})),t.prototype.onMouseDown.call(this,e)):this.handler.switchToDefaultState()},e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e);var n=this.selection.getSelectedShapes();this.visualizerManager.setExtensionLines(n)},e.prototype.onApplyChanges=function(t){var e=this,n=u.DiagramModel.getRectangle(this.shapes),o=1===this.shapes.length?this.shapes[0].getMinWidth(this.settings.shapeMinWidth):p.ShapeMinDimension,a=1===this.shapes.length?this.shapes[0].getMinHeight(this.settings.shapeMinHeight):p.ShapeMinDimension,c=1===this.shapes.length?this.shapes[0].getMaxWidth(this.settings.shapeMaxWidth):void 0,h=1===this.shapes.length?this.shapes[0].getMaxHeight(this.settings.shapeMaxHeight):void 0,d=this.getSize(t,n.createPosition(),this.startRectangle.createSize(),o,a,c,h,!!(t.modifiers&s.ModifierKey.Shift)),f=this.getPosition(t,d,this.startRectangle.createSize(),this.startRectangle.createPosition()),m=d.width/this.startRectangle.width,g=d.height/this.startRectangle.height;this.shapes.forEach((function(t,n){var o=e.startShapeSizes[n].width*(t.allowResizeHorizontally?m:1);o=e.getNormalizedSize(o,t.getMinWidth(e.settings.shapeMinWidth),t.getMaxWidth(e.settings.shapeMaxWidth));var a=e.startShapeSizes[n].height*(t.allowResizeVertically?g:1);a=e.getNormalizedSize(a,t.getMinHeight(e.settings.shapeMinHeight),t.getMaxHeight(e.settings.shapeMaxHeight));var s=t.allowResizeHorizontally?f.x+(e.startShapePositions[n].x-e.startRectangle.x)*m:e.startShapePositions[n].x,c=t.allowResizeVertically?f.y+(e.startShapePositions[n].y-e.startRectangle.y)*g:e.startShapePositions[n].y;l.ModelUtils.setShapeSize(e.history,e.model,t,new r.Point(s,c),new i.Size(o,a))})),this.connectors.forEach((function(t,n){for(var o=t.beginItem?1:0,i=t.endItem?t.points.length-2:t.points.length-1,a=o;a<=i;a++){var s=new r.Point(f.x+(e.startConnectorPoints[n][a].x-e.startRectangle.x)*m,f.y+(e.startConnectorPoints[n][a].y-e.startRectangle.y)*g);l.ModelUtils.moveConnectorPoint(e.history,t,a,s)}}));var y=this.selection.getSelectedShapes(!1,!0);y.forEach((function(t){l.ModelUtils.updateShapeAttachedConnectors(e.history,e.model,t)})),this.tryUpdateModelSize(),this.visualizerManager.setResizeInfo(this.shapes)},e.prototype.tryUpdateModelSize=function(){var t=this;this.handler.tryUpdateModelSize((function(e,n){t.startShapePositions.forEach((function(t){t.x+=e,t.y+=n})),t.startConnectorPoints.forEach((function(t){t.forEach((function(t){t.x+=e,t.y+=n}))})),t.startRectangle.x+=e,t.startRectangle.y+=n,t.startPoint.x+=e,t.startPoint.y+=n}))},e.prototype.getDraggingElementKeys=function(){return this.shapes.map((function(t){return t.key}))},e.prototype.getNormalizedSize=function(t,e,n){return void 0!==e&&(t=Math.max(t,e)),void 0!==n&&(t=Math.min(t,n)),t},e.prototype.getSize=function(t,e,n,o,r,a,s,c){var u,l,p=t.modelPoint.x-(this.startScrollLeft-t.scrollX)-this.startPoint.x,h=t.modelPoint.y-(this.startScrollTop-t.scrollY)-this.startPoint.y,d=p*Math.cos(this.rotation)- -h*Math.sin(this.rotation),f=-(p*Math.sin(this.rotation)+-h*Math.cos(this.rotation));return f=!this.sideV&&f>0?Math.min(n.height+1,f):f,d=!this.sideH&&d>0?Math.min(n.width+1,d):d,this.lockH||this.lockV||!c?(d=this.lockH?0:d,f=this.lockV?0:f,u=this.getNormalizedSize(this.sideH?n.width+d:n.width-d,o,a),l=this.getNormalizedSize(this.sideV?n.height+f:n.height-f,r,s)):Math.abs(d)>Math.abs(f)?(u=this.getNormalizedSize(this.sideH?n.width+d:n.width-d,o,a),l=n.height*(u/n.width)):(l=this.getNormalizedSize(this.sideV?n.height+f:n.height-f,r,s),u=n.width*(l/n.height)),this.lockH||(u=this.handler.getSnappedPos(t,e.x+u,!0)-e.x),this.lockV||(l=this.handler.getSnappedPos(t,e.y+l,!1)-e.y),new i.Size(u,l)},e.prototype.getPosition=function(t,e,n,o){var i=o.x,s=o.y;if(this.resizeEventSource===a.ResizeEventSource.ResizeBox_N||this.resizeEventSource===a.ResizeEventSource.ResizeBox_NE||this.resizeEventSource===a.ResizeEventSource.ResizeBox_NW){s+=n.height-e.height;var c=this.handler.getSnappedPos(t,s,!1);e.height+=s-c,s=c}if(this.resizeEventSource===a.ResizeEventSource.ResizeBox_W||this.resizeEventSource===a.ResizeEventSource.ResizeBox_NW||this.resizeEventSource===a.ResizeEventSource.ResizeBox_SW){i+=n.width-e.width;var u=this.handler.getSnappedPos(t,i,!0);e.width+=i-u,i=u}return new r.Point(i,s)},e}(c.MouseHandlerDraggingState);e.MouseHandlerResizeShapeState=d},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveConnectorSideState=void 0;var i=n(33),r=n(9),a=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i.model=o,i}return o(e,t),e.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.connectorKey=e.source.key,this.pointIndex=parseInt(e.source.value)+1,t.prototype.onMouseDown.call(this,e)},e.prototype.onApplyChanges=function(t){var e=this.getSnappedPoint(t,t.modelPoint),n=this.model.findConnector(this.connectorKey);this.pointCreated?r.ModelUtils.moveConnectorPoint(this.history,n,this.pointIndex,e):(this.handler.addInteractingItem(n),r.ModelUtils.addConnectorCustomPoint(this.history,n,this.pointIndex,e),this.pointCreated=!0),this.handler.tryUpdateModelSize()},e.prototype.onFinishWithChanges=function(){r.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.model.findConnector(this.connectorKey))},e.prototype.getDraggingElementKeys=function(){return[this.connectorKey]},e}(i.MouseHandlerDraggingState);e.MouseHandlerMoveConnectorSideState=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDragParameterPointState=void 0;var i=n(33),r=n(115),a=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i.model=o,i.startScrollLeft=0,i.startScrollTop=0,i}return o(e,t),e.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.shape=this.model.findShape(e.source.key),this.parameterPointKey=e.source.value,this.startParameters=this.shape.parameters.clone(),t.prototype.onMouseDown.call(this,e)},e.prototype.onApplyChanges=function(t){var e=this.handler.getSnappedPos(t,t.modelPoint.x-this.startPoint.x,!0),n=this.handler.getSnappedPos(t,t.modelPoint.y-this.startPoint.y,!1),o=this.startParameters.clone();this.shape.description.modifyParameters(this.shape,o,e,n),this.history.addAndRedo(new r.ChangeShapeParametersHistoryItem(this.shape.key,o))},e.prototype.getDraggingElementKeys=function(){return[this.shape.key]},e}(i.MouseHandlerDraggingState);e.MouseHandlerDragParameterPointState=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerCreateConnectorState=void 0;var i=n(6),r=n(48),a=n(61),s=n(8),c=n(150),u=n(63),l=n(51),p=n(9),h=n(62),d=n(116),f=function(t){function e(e,n,o,i,r,a,s){var c=t.call(this,e,n,o,i)||this;return c.shapeDescriptionManager=r,c.selection=a,c.connectionPointIndex=s,c}return o(e,t),e.prototype.onMouseDown=function(e){void 0===this.connectionPointIndex&&(this.connectionPointIndex=parseInt(e.source.value)),this.connectedItem=this.model.findItem(e.source.key),this.pointIndex=1,this.pointPosition=i.ConnectorPosition.End,t.prototype.onMouseDown.call(this,e)},e.prototype.onMouseUp=function(e){this.connector&&!this.connector.endItem&&this.createNewShapeAtConnectorEnd(e),t.prototype.onMouseUp.call(this,e)},e.prototype.onApplyChanges=function(e){var n=this.getSnappedPoint(e,e.modelPoint);if(this.connector)t.prototype.onApplyChanges.call(this,e);else{var o=new a.AddConnectorHistoryItem([this.connectedItem.getConnectionPointPosition(this.connectionPointIndex,n),n]);this.history.addAndRedo(o),this.connector=this.model.findConnector(o.connectorKey),this.handler.addInteractingItem(this.connector),this.history.addAndRedo(new r.AddConnectionHistoryItem(this.connector,this.connectedItem,this.connectionPointIndex,i.ConnectorPosition.Begin)),p.ModelUtils.updateNewConnectorProperties(this.history,this.selection,this.connector.key)}},e.prototype.checkStoredPermissionsOnFinish=function(){this.connector&&this.connector.endItem&&t.prototype.checkStoredPermissionsOnFinish.call(this)},e.prototype.onFinishWithChanges=function(){t.prototype.onFinishWithChanges.call(this),this.history.addAndRedo(new u.SetSelectionHistoryItem(this.selection,[this.connector.key]))},e.prototype.createNewShapeAtConnectorEnd=function(t){var e=this,n=this.connector&&this.connector.beginItem;if(n){var o=this.getNewShapeSide(this.connector),a=this.getSnappedPoint(t,t.modelPoint),s=this.shapeDescriptionManager.getCategoryByDescription(n.description),c=function(n){var i=n.clone();i.position=a.clone();var r=e.getNewShapePosition(i,o);return e.handler.getSnappedPoint(t,r)};this.handler.showContextToolbox(a,c,o,s,(function(n){if(n){e.handler.beginStorePermissions(),e.history.beginTransaction();var s=new l.AddShapeHistoryItem(e.shapeDescriptionManager.get(n),a);e.history.addAndRedo(s);var c=e.model.findShape(s.shapeKey),h=e.targetItem&&e.model.findNearestContainer(e.targetItem.key);h&&p.ModelUtils.insertToContainer(e.history,e.model,c,h);var d=e.getNewShapePosition(c,o);p.ModelUtils.setShapePosition(e.history,e.model,c,e.getSnappedPoint(t,d)),p.ModelUtils.updateNewShapeProperties(e.history,e.selection,c.key),e.history.addAndRedo(new r.AddConnectionHistoryItem(e.connector,c,c.getConnectionPointIndexForSide(o),i.ConnectorPosition.End)),p.ModelUtils.updateShapeAttachedConnectors(e.history,e.model,c),e.handler.isStoredPermissionsGranted()?(e.handler.tryUpdateModelSize(),e.history.addAndRedo(new u.SetSelectionHistoryItem(e.selection,[c.key]))):(e.handler.lockPermissions(),e.history.undoTransaction(),e.handler.unlockPermissions(),e.checkNewConnectorPermissions()),e.history.endTransaction(),e.handler.endStorePermissions(),e.handler.hideContextToolbox(!0)}}),(function(){e.checkNewConnectorPermissions()}))}},e.prototype.checkNewConnectorPermissions=function(){this.connector&&!this.handler.canPerformChangeConnection(this.connector,{position:i.ConnectorPosition.End,connectionPointIndex:-1})&&(this.handler.lockPermissions(),this.history.beginTransaction(),this.history.addAndRedo(new u.SetSelectionHistoryItem(this.selection,[])),this.connector.beginItem&&this.history.addAndRedo(new h.DeleteConnectionHistoryItem(this.connector,i.ConnectorPosition.Begin)),this.connector.endItem&&this.history.addAndRedo(new h.DeleteConnectionHistoryItem(this.connector,i.ConnectorPosition.End)),this.history.addAndRedo(new d.DeleteConnectorHistoryItem(this.connector.key)),this.history.endTransaction(),this.handler.unlockPermissions())},e.prototype.getNewShapePosition=function(t,e){switch(e){case s.ConnectionPointSide.North:return t.position.clone().offset(-t.size.width/2,0);case s.ConnectionPointSide.South:return t.position.clone().offset(-t.size.width/2,-t.size.height);case s.ConnectionPointSide.East:return t.position.clone().offset(-t.size.width,-t.size.height/2);case s.ConnectionPointSide.West:return t.position.clone().offset(0,-t.size.height/2)}},e.prototype.getNewShapeSide=function(t){var n=t.getRenderPoints();return e.getNewShapeSideByConnectorPoints(n[n.length-1],n[n.length-2])},e.prototype.getSourceItem=function(){return this.connectedItem},e.getNewShapeSideByConnectorPoints=function(t,e){return t.x===e.x?t.y>e.y?s.ConnectionPointSide.North:s.ConnectionPointSide.South:t.x>e.x?t.y===e.y?s.ConnectionPointSide.West:t.y>e.y?Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?s.ConnectionPointSide.West:s.ConnectionPointSide.North:Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?s.ConnectionPointSide.West:s.ConnectionPointSide.South:t.y===e.y?s.ConnectionPointSide.East:t.y>e.y?Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?s.ConnectionPointSide.East:s.ConnectionPointSide.North:Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?s.ConnectionPointSide.East:s.ConnectionPointSide.South},e}(c.MouseHandlerMoveConnectorPointStateBase);e.MouseHandlerCreateConnectorState=f},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveConnectorOrthogonalSideState=void 0;var i=n(1),r=n(6),a=n(8),s=n(9),c=n(33),u=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i.model=o,i}return o(e,t),e.prototype.onMouseDown=function(e){this.startPoint=e.modelPoint,this.connector=this.model.findConnector(e.source.key),this.handler.addInteractingItem(this.connector);var n=e.source.value.split("_"),o=parseInt(n[0]),i=parseInt(n[1]),r=this.connector.getRenderPoints(!0);this.renderPoint1=r[o].clone(),this.renderPoint2=r[i].clone(),this.isVerticalOrientation=this.renderPoint1.x===this.renderPoint2.x,-1!==this.renderPoint1.pointIndex?(this.pointIndex1=this.renderPoint1.pointIndex,0===this.pointIndex1?(this.pointIndex1++,this.correctEdgePoint(this.renderPoint1,this.renderPoint2,this.connector.beginItem,this.connector.beginConnectionPointIndex)):this.point1=this.connector.points[this.pointIndex1].clone()):this.pointIndex1=this.findPointIndex(r,o,!1)+1,-1!==this.renderPoint2.pointIndex?(this.pointIndex2=this.renderPoint2.pointIndex,this.pointIndex2===this.connector.points.length-1?this.correctEdgePoint(this.renderPoint2,this.renderPoint1,this.connector.endItem,this.connector.endConnectionPointIndex):this.point2=this.connector.points[this.pointIndex2].clone()):this.pointIndex2=this.findPointIndex(r,i,!0),t.prototype.onMouseDown.call(this,e)},e.prototype.onApplyChanges=function(t){var e=this;if(!this.pointCreated){var n=void 0,o=void 0;void 0===this.point1&&(this.point1=new i.Point(this.renderPoint1.x,this.renderPoint1.y),s.ModelUtils.addConnectorCustomPoint(this.history,this.connector,this.pointIndex1,this.point1),n=this.point1.clone(),this.pointIndex2++),void 0===this.point2&&(this.point2=new i.Point(this.renderPoint2.x,this.renderPoint2.y),s.ModelUtils.addConnectorCustomPoint(this.history,this.connector,this.pointIndex2,this.point2),o=this.point2.clone()),s.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector,[n,o],(function(t){t<e.pointIndex1&&e.pointIndex1--,t<e.pointIndex2&&e.pointIndex2--})),this.pointCreated=!0}var r=this.getSnappedPoint(t,t.modelPoint);this.isVerticalOrientation?(this.point1.x=r.x,this.point2.x=r.x):(this.point1.y=r.y,this.point2.y=r.y),s.ModelUtils.moveConnectorPoint(this.history,this.connector,this.pointIndex1,this.point1.clone()),s.ModelUtils.moveConnectorPoint(this.history,this.connector,this.pointIndex2,this.point2.clone()),this.handler.tryUpdateModelSize()},e.prototype.onFinishWithChanges=function(){s.ModelUtils.removeUnnecessaryConnectorPoints(this.history,this.connector)},e.prototype.findPointIndex=function(t,e,n){var o;while(o=t[e]){if(-1!==o.pointIndex)return o.pointIndex;e+=n?1:-1}},e.prototype.correctEdgePoint=function(t,e,n,o){var i=0;if(n){var s=n.getConnectionPointSideByIndex(o),c=n.rectangle;switch(i=r.Connector.minOffset,s){case a.ConnectionPointSide.South:i+=c.bottom-t.y;break;case a.ConnectionPointSide.North:i+=t.y-c.y;break;case a.ConnectionPointSide.East:i+=c.right-t.x;break;case a.ConnectionPointSide.West:i+=t.x-c.x;break}}this.isVerticalOrientation?t.y>e.y?t.y-=Math.min(i,t.y-e.y):t.y+=Math.min(i,e.y-t.y):t.x>e.x?t.x-=Math.min(i,t.x-e.x):t.x+=Math.min(i,e.x-t.x)},e.prototype.getDraggingElementKeys=function(){return[this.connector.key]},e}(c.MouseHandlerDraggingState);e.MouseHandlerMoveConnectorOrthogonalSideState=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerToolboxDraggingState=e.MouseHandlerBeforeToolboxDraggingState=void 0;var i=n(13),r=n(1),a=n(51),s=n(63),c=n(33),u=n(117),l=n(9),p=n(38),h=n(17),d=n(16),f=500,m=300,g=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e)||this;return s.history=n,s.model=o,s.selection=i,s.visualizerManager=r,s.shapeDescriptionManager=a,s.isModelEmpty=0===o.items.length,s}return o(e,t),e.prototype.cancelChanges=function(){this.tryRemoveTimer()},e.prototype.onDragStart=function(t){this.dragging=t},e.prototype.onDragEnd=function(t){this.cancelChanges(),this.handler.switchToDefaultState()},e.prototype.onMouseMove=function(t){var e=this;t.source.type>i.MouseEventElementType.Background?(this.tryRemoveTimer(),this.switchToDraggingState(t,!1)):t.source.type!==i.MouseEventElementType.Background||this.isModelEmpty?void 0!==this.nonPageAreaTimer&&this.tryRemoveTimer():(this.savedEvt=t,void 0===this.nonPageAreaTimer&&(this.nonPageAreaTimer=setTimeout((function(){return e.switchToDraggingState(e.savedEvt,!0)}),f)))},e.prototype.switchToDraggingState=function(t,e){this.handler.switchState(new y(this.handler,this.history,this.model,this.selection,this.visualizerManager,this.shapeDescriptionManager,e)),this.handler.state.onDragStart(this.dragging),this.handler.state.onMouseMove(t)},e.prototype.tryRemoveTimer=function(){void 0!==this.nonPageAreaTimer&&(clearTimeout(this.nonPageAreaTimer),delete this.nonPageAreaTimer)},e.prototype.finish=function(){this.tryRemoveTimer()},e}(p.MouseHandlerCancellableState);e.MouseHandlerBeforeToolboxDraggingState=g;var y=function(t){function e(e,n,o,i,r,a,s){var c=t.call(this,e,n)||this;return c.model=o,c.selection=i,c.visualizerManager=r,c.shapeDescriptionManager=a,s||(c.updatePageSizeTimer=setTimeout((function(){c.handler.tryUpdateModelSize(),delete c.updatePageSizeTimer}),m)),c}return o(e,t),e.prototype.onMouseMove=function(e){t.prototype.onMouseMove.call(this,e);var n=this.model.findShape(this.shapeKey);if(n){this.visualizerManager.setExtensionLines([n]);var o=l.ModelUtils.findContainerByEventKey(this.model,this.selection,e.source.key);o&&this.allowInsertToContainer(e,n,o)?this.visualizerManager.setContainerTarget(o,e.source.type):this.visualizerManager.resetContainerTarget()}},e.prototype.getDraggingElementKeys=function(){return void 0===this.shapeKey?[]:[this.shapeKey]},e.prototype.onApplyChanges=function(t){var e=this;if(t.source.type===i.MouseEventElementType.Undefined){if(this.dragging.onCaptured(!1),void 0!==this.shapeKey&&!this.deleteHistoryItem){var n=this.model.findShape(this.shapeKey);l.ModelUtils.detachConnectors(this.history,n),l.ModelUtils.removeFromContainer(this.history,this.model,n),this.deleteHistoryItem=new u.DeleteShapeHistoryItem(this.shapeKey),this.history.addAndRedo(this.deleteHistoryItem)}}else{if(this.dragging.onCaptured(!0),void 0===this.shapeKey){this.startPoint=t.modelPoint,this.shapeKey=this.insertToolboxItem(t);var o=this.model.findShape(this.shapeKey);o&&this.handler.addInteractingItem(o,d.DiagramModelOperation.AddShape)}this.deleteHistoryItem&&(this.history.undoTransactionTo(this.deleteHistoryItem),delete this.deleteHistoryItem);var r=this.getPosition(t,this.startShapePosition);n=this.model.findShape(this.shapeKey);l.ModelUtils.setShapePosition(this.history,this.model,n,r),l.ModelUtils.updateMovingShapeConnections(this.history,n,this.connectorsWithoutBeginItemInfo,this.connectorsWithoutEndItemInfo,(function(){e.visualizerManager.resetConnectionTarget(),e.visualizerManager.resetConnectionPoints()}),(function(t,n){e.visualizerManager.setConnectionTarget(t,i.MouseEventElementType.Shape),e.visualizerManager.setConnectionPoints(t,i.MouseEventElementType.Shape,n,!0)}),(function(t){return e.handler.addInteractingItem(t)})),l.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,n);var a=l.ModelUtils.findContainerByEventKey(this.model,this.selection,t.source.key);n&&a&&this.allowInsertToContainer(t,n,a)?l.ModelUtils.insertToContainer(this.history,this.model,n,a):l.ModelUtils.removeFromContainer(this.history,this.model,n),void 0===this.updatePageSizeTimer&&this.handler.tryUpdateModelSize((function(t,n){e.connectorsWithoutBeginItemInfo.forEach((function(e){e.point.x+=t,e.point.y+=n})),e.connectorsWithoutEndItemInfo.forEach((function(e){e.point.x+=t,e.point.y+=n}))}))}},e.prototype.onFinishWithChanges=function(){this.deleteHistoryItem||this.history.addAndRedo(new s.SetSelectionHistoryItem(this.selection,[this.shapeKey]))},e.prototype.onDragStart=function(t){this.dragging=t,this.connectorsWithoutBeginItemInfo=l.ModelUtils.getConnectorsWithoutBeginItemInfo(this.model),this.connectorsWithoutEndItemInfo=l.ModelUtils.getConnectorsWithoutEndItemInfo(this.model)},e.prototype.onDragEnd=function(t){void 0!==this.shapeKey&&t.source.type===i.MouseEventElementType.Undefined&&this.cancelChanges(),this.handler.switchToDefaultState()},e.prototype.finish=function(){this.visualizerManager.resetExtensionLines(),this.visualizerManager.resetContainerTarget(),this.visualizerManager.resetConnectionTarget(),this.visualizerManager.resetConnectionPoints(),this.dragging.onFinishDragging(),t.prototype.finish.call(this)},e.prototype.insertToolboxItem=function(t){var e=this.shapeDescriptionManager.get(this.dragging.data);this.startShapePosition=this.getSnappedPoint(t,new r.Point(t.modelPoint.x-e.defaultSize.width/2,t.modelPoint.y-e.defaultSize.height/2));var n=new a.AddShapeHistoryItem(e,this.startShapePosition);return this.history.addAndRedo(n),l.ModelUtils.updateNewShapeProperties(this.history,this.selection,n.shapeKey),n.shapeKey},e.prototype.allowInsertToContainer=function(t,e,n){return!(t.modifiers&h.ModifierKey.Ctrl||t.modifiers&h.ModifierKey.Shift)&&(n&&n.expanded&&l.ModelUtils.canInsertToContainer(this.model,e,n))},e.prototype.getPosition=function(t,e){return this.getSnappedPoint(t,new r.Point(e.x+t.modelPoint.x-this.startPoint.x,e.y+t.modelPoint.y-this.startPoint.y))},e}(c.MouseHandlerDraggingState);e.MouseHandlerToolboxDraggingState=y},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveConnectorTextState=void 0;var i=n(33),r=n(312),a=n(64),s=function(t){function e(e,n,o){var i=t.call(this,e,n)||this;return i.model=o,i}return o(e,t),e.prototype.onMouseDown=function(e){this.connector=this.model.findConnector(e.source.key),this.position=parseFloat(e.source.value),this.text=this.connector.getText(this.position),this.savedText="",t.prototype.onMouseDown.call(this,e)},e.prototype.onApplyChanges=function(t){var e=this.connector.getTextPositionByPoint(t.modelPoint);if(e!==this.position){var n=this.connector.getText(e);""!==n&&n!==this.text&&(this.history.addAndRedo(new a.ChangeConnectorTextHistoryItem(this.connector,e,"")),this.savedText=n),this.history.addAndRedo(new r.ChangeConnectorTextPositionHistoryItem(this.connector,this.position,e)),""!==this.savedText&&this.savedText!==n&&(this.history.addAndRedo(new a.ChangeConnectorTextHistoryItem(this.connector,this.position,this.savedText)),this.savedText=""),this.position=e}},e.prototype.getDraggingElementKeys=function(){return[this.connector.key]},e}(i.MouseHandlerDraggingState);e.MouseHandlerMoveConnectorTextState=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorTextPositionHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connectorKey=e.key,i.position=n,i.newPosition=o,i}return o(e,t),e.prototype.redo=function(t){var e=t.model.findConnector(this.connectorKey);t.changeConnectorTextPosition(e,this.position,this.newPosition)},e.prototype.undo=function(t){var e=t.model.findConnector(this.connectorKey);t.changeConnectorTextPosition(e,this.newPosition,this.position)},e}(i.HistoryItem);e.ChangeConnectorTextPositionHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerToggleShapeExpandedState=void 0;var i=n(38),r=n(314),a=n(9),s=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.history=n,r.model=o,r.selection=i,r}return o(e,t),e.prototype.onMouseUp=function(t){var e=this.model.findShape(t.source.key);e&&!e.isLocked&&(this.history.beginTransaction(),this.history.addAndRedo(new r.ToggleShapeExpandedHistoryItem(e)),a.ModelUtils.updateShapeAttachedConnectors(this.history,this.model,e),a.ModelUtils.updateContainerConnectorsAttachedPoints(this.history,this.model,e),a.ModelUtils.updateSelection(this.history,this.selection),this.handler.tryUpdateModelSize(),this.history.endTransaction(),this.handler.raiseClick([e.key])),this.handler.switchToDefaultState()},e}(i.MouseHandlerStateBase);e.MouseHandlerToggleShapeExpandedState=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ToggleShapeExpandedHistoryItem=void 0;var i=n(5),r=function(t){function e(e){var n=t.call(this)||this;return n.shapeKey=e.key,n.expanded=e.expanded,n}return o(e,t),e.prototype.redo=function(t){var e=t.model.findShape(this.shapeKey);t.changeShapeExpanded(e,!this.expanded)},e.prototype.undo=function(t){var e=t.model.findShape(this.shapeKey);t.changeShapeExpanded(e,this.expanded)},e}(i.HistoryItem);e.ToggleShapeExpandedHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerSelectionState=void 0;var i=n(13),r=n(12),a=n(38),s=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.selection=n,i.visualizerManager=o,i}return o(e,t),e.prototype.finish=function(){this.handler.raiseDragEnd([]),this.visualizerManager.resetSelectionRectangle(),t.prototype.finish.call(this)},e.prototype.cancelChanges=function(){},e.prototype.onMouseDown=function(t){this.startPoint=t.modelPoint,this.handler.raiseDragStart([])},e.prototype.onMouseMove=function(t){t.button!==i.MouseButton.Left?this.handler.switchToDefaultState():(this.rectangle=r.Rectangle.fromPoints(this.startPoint,t.modelPoint),this.visualizerManager.setSelectionRectangle(this.rectangle))},e.prototype.onMouseUp=function(t){void 0!==this.rectangle?this.selection.selectRect(this.rectangle):this.selection.set([]),this.rectangle=void 0,this.handler.switchToDefaultState()},e}(a.MouseHandlerCancellableState);e.MouseHandlerSelectionState=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerZoomOnWheelState=void 0;var i=n(38),r=n(13),a=n(17),s=n(27),c=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.settings=n,i.view=o,i}return o(e,t),e.prototype.onMouseWheel=function(t){return this.trySwitchToDefault(t)?this.handler.state.onMouseWheel(t):(this.settings.zoomLevel=this.view.getNextStepZoom(t.deltaY<0),t.source.type===r.MouseEventElementType.Background?this.view.resetScroll():(this.view.scrollTo(t.modelPoint,t.offsetPoint),this.view.normalize()),t.preventDefault=!0,!0)},e.prototype.onMouseUp=function(t){this.handler.switchToDefaultState(),this.handler.state.onMouseUp(t)},e.prototype.onMouseDown=function(t){this.handler.switchToDefaultState(),this.handler.state.onMouseDown(t)},e.prototype.onMouseMove=function(t){this.trySwitchToDefault(t)&&this.handler.state.onMouseMove(t)},e.prototype.trySwitchToDefault=function(t){if(!(t.modifiers&a.ModifierKey.Ctrl))return this.handler.switchToDefaultState(),!0},e.prototype.start=function(){t.prototype.start.call(this),this.settings.zoomLevel=this.view.getZoom(),this.settings.autoZoom=s.AutoZoomMode.Disabled},e}(i.MouseHandlerStateBase);e.MouseHandlerZoomOnWheelState=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerMoveConnectorState=void 0;var i=n(153),r=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o,i,r)||this;return a.model=o,a.selection=i,a.visualizerManager=r,a}return o(e,t),e.prototype.validateDraggingShapes=function(){return!0},e.prototype.validateDraggingConnectors=function(){var t=this;if(!this.draggingConnectors.length)return!1;if(!this.draggingShapes.length)return!this.draggingConnectors.some((function(e){return!e.shouldOffset(t.selectedItems)}));var e=this.draggingConnectors[this.draggingConnectorsIndexByKey[this.handler.mouseDownEvent.source.key]];return e.shouldOffset(this.selectedItems)},e}(i.MouseHandlerMoveShapeState);e.MouseHandlerMoveConnectorState=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorPointsHistoryItem=void 0;var i=n(5),r=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connectorKey=e,i.newPoints=n,i.newRenderContext=o,i}return o(e,t),e.prototype.redo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);this.oldRenderContext=n.createRenderPointsContext(),this.oldPoints=n.points.map((function(t){return t.clone()})),t.changeConnectorPoints(n,(function(t){return t.changePoints(e.newPoints,e.newRenderContext)}))},e.prototype.undo=function(t){var e=this,n=t.model.findConnector(this.connectorKey);t.changeConnectorPoints(n,(function(t){return t.changePoints(e.oldPoints,e.oldRenderContext)}))},e}(i.HistoryItem);e.ChangeConnectorPointsHistoryItem=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDefaultReadOnlyTouchState=void 0;var i=n(155),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.canDragObjectOnMouseDown=function(t){return!1},e.prototype.canExpandContainerOnMouseDown=function(t){return!1},e.prototype.canClearSelectionOnMouseDown=function(){return!0},e.prototype.processOnMouseMoveAfterLimit=function(t){this.startScrolling(t)},e.prototype.canSelectOnMouseUp=function(t){return!this.inSelection(t)},e.prototype.canClearSelectionOnMouseUp=function(){return!1},e}(i.MouseHandlerDefaultReadOnlyState);e.MouseHandlerDefaultReadOnlyTouchState=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerDefaultTouchState=void 0;var i=n(149),r=n(321),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.updateConnectionsOnMouseMove=function(t){},e.prototype.canDragObjectOnMouseDown=function(t){return this.inSelection(t)},e.prototype.canExpandContainerOnMouseDown=function(t){return!0},e.prototype.canClearSelectionOnMouseDown=function(){return!0},e.prototype.processOnMouseMoveAfterLimit=function(t){t.touches.length>1?this.startZooming(t):this.startScrolling(t)},e.prototype.startZooming=function(t){this.handler.switchState(new r.MouseHandlerZoomOnPinchState(this.handler,this.selection,this.settings,this.view))},e.prototype.canSelectOnMouseUp=function(t){return!this.inSelection(t)},e.prototype.canClearSelectionOnMouseUp=function(){return!1},e}(i.MouseHandlerDefaultState);e.MouseHandlerDefaultTouchState=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MouseHandlerZoomOnPinchState=void 0;var i=n(27),r=n(3),a=n(1),s=n(152),c=1,u=function(t){function e(e,n,o,i){var r=t.call(this,e,i,n)||this;return r.selection=n,r.settings=o,r.view=i,r}return o(e,t),e.prototype.onMouseDown=function(e){t.prototype.onMouseDown.call(this,e),e.touches.length>1&&(this.startDistance=this.getTouchDistance(e),this.startZoomLevel=this.settings.zoomLevel,this.prevDistance=this.startDistance)},e.prototype.onMouseMove=function(e){if(e.touches.length>1){var n=this.getTouchDistance(e);Math.abs(this.prevDistance-n)>c&&(this.settings.zoomLevel=this.startZoomLevel*(n/this.startDistance),this.view.scrollTo(this.getMiddleLayoutPoint(e),this.getMiddleAbsPoint(e)),this.view.normalize(),this.prevDistance=n)}t.prototype.onMouseMove.call(this,e)},e.prototype.onMouseUp=function(t){0===t.touches.length&&setTimeout(function(){this.handler.switchToDefaultState()}.bind(this),1)},e.prototype.start=function(){t.prototype.start.call(this),this.settings.zoomLevel=this.view.getZoom(),this.settings.autoZoom=i.AutoZoomMode.Disabled},e.prototype.getTouchDistance=function(t){var e=new a.Point(t.touches[0].offsetPoint.x,t.touches[0].offsetPoint.y),n=new a.Point(t.touches[1].offsetPoint.x,t.touches[1].offsetPoint.y);return r.GeometryUtils.getDistance(e,n)},e.prototype.getPointByEvent=function(t){return this.getMiddleAbsPoint(t)},e.prototype.getMiddleAbsPoint=function(t){return t.touches.length>1?e.getMiddlePointByEvent(t,(function(t){return t.offsetPoint})):t.offsetPoint},e.prototype.getMiddleLayoutPoint=function(t){return t.touches.length>1?e.getMiddlePointByEvent(t,(function(t){return t.modelPoint})):t.modelPoint},e.getMiddlePointByEvent=function(t,e){if(t.touches.length>1)return new a.Point((e(t.touches[0]).x+e(t.touches[1]).x)/2,(e(t.touches[0]).y+e(t.touches[1]).y)/2)},e}(s.MouseHandlerScrollingState);e.MouseHandlerZoomOnPinchState=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextInputHandler=void 0;var o=n(156),i=n(13),r=n(17),a=n(14),s=n(6),c=n(64),u=function(){function t(t){this.control=t}return t.prototype.startTextInput=function(t,e){if(!t.isLocked&&t.enableText&&t.allowEditText&&!this.control.settings.readOnly&&this.canFinishTextEditing()){this.control.beginUpdate(),this.textInputItem=t;var n=!0;if(this.textInputItem instanceof a.Shape){var o=this.textInputItem.textEditRectangle;n=this.control.permissionsProvider.canChangeShapeText(this.textInputItem),n&&this.control.eventManager.raiseTextInputStart(this.textInputItem,this.textInputItem.text,o.createPosition(),o.createSize())}else this.textInputItem instanceof s.Connector&&(this.textInputPosition=e,n=this.control.permissionsProvider.canChangeConnectorText(this.textInputItem,this.textInputPosition),n&&this.control.eventManager.raiseTextInputStart(this.textInputItem,this.textInputItem.getText(this.textInputPosition),this.textInputItem.getTextPoint(this.textInputPosition)));n||(delete this.textInputItem,this.control.endUpdate())}},t.prototype.endTextInput=function(){var t=this.textInputItem;delete this.textInputItem,this.control.eventManager.raiseTextInputEnd(t),this.control.endUpdate(),this.control.barManager.updateItemsState()},t.prototype.raiseTextInputPermissionsCheck=function(t){this.control.eventManager.raiseTextInputPermissionsCheck(this.textInputItem,t)},t.prototype.applyTextInput=function(t){if(this.canFinishTextEditing(t)){var e=this.textInputItem,n=this.textInputPosition;this.endTextInput(),e instanceof a.Shape?e.text!==t&&this.control.history.addAndRedo(new o.ChangeShapeTextHistoryItem(e,t)):e instanceof s.Connector&&e.getText(n)!==t&&this.control.history.addAndRedo(new c.ChangeConnectorTextHistoryItem(e,n,t))}},t.prototype.canFinishTextEditing=function(t){var e=!0;if(this.isTextInputActive()){var n=t||this.getTextInputElementValue();this.textInputItem instanceof a.Shape?e=this.control.permissionsProvider.canApplyShapeTextChange(this.textInputItem,n):this.textInputItem instanceof s.Connector&&(e=this.control.permissionsProvider.canApplyConnectorTextChange(this.textInputItem,this.textInputPosition,n)),this.raiseTextInputPermissionsCheck(e)}return e},t.prototype.getTextInputElementValue=function(){return this.control.render?this.control.render.input.getTextInputElementValue():""},t.prototype.cancelTextInput=function(){this.raiseTextInputPermissionsCheck(!0),this.endTextInput()},t.prototype.isTextInputActive=function(){return void 0!==this.textInputItem},t.prototype.processDblClick=function(t){if(t.source.type===i.MouseEventElementType.Shape){var e=this.control.model.findShape(t.source.key);this.startTextInput(e)}else if(t.source.type===i.MouseEventElementType.Connector){var n=this.control.model.findConnector(t.source.key),o=n.getTextPositionByPoint(t.modelPoint);this.startTextInput(n,o)}else if(t.source.type===i.MouseEventElementType.ConnectorText){n=this.control.model.findConnector(t.source.key),o=parseFloat(t.source.value);this.startTextInput(n,o)}},t.prototype.onDblClick=function(t){this.processDblClick(t)},t.prototype.onKeyDown=function(t){this.isTextInputActive()&&(13===t.keyCode&&t.modifiers&r.ModifierKey.Ctrl&&(t.preventDefault=!0,this.applyTextInput(t.inputText)),27===t.keyCode&&this.cancelTextInput())},t.prototype.onBlur=function(t){this.isTextInputActive()&&this.applyTextInput(t.inputText)},t.prototype.onFocus=function(t){},t}();e.TextInputHandler=u},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenuTouchHandler=void 0;var i=n(13),r=n(32),a=n(157),s=1,c=function(t){function e(e){var n=t.call(this)||this;return n.selection=e,n.contextToolboxVisible=!1,n.selection.onChanged.add(n),n}return o(e,t),e.prototype.onMouseDown=function(t){void 0===t.source.key&&this.hideContextMenu()},e.prototype.onMouseUp=function(t){},e.prototype.onFocus=function(t){var e=this;setTimeout((function(){e.showContextMenuAtSelection()}),1)},e.prototype.onBlur=function(t){var e=this;setTimeout((function(){e.hideContextMenu()}),1)},e.prototype.onTextInputFocus=function(t){var e=this;setTimeout((function(){e.hideContextMenu()}),1)},e.prototype.onTextInputBlur=function(t){var e=this;setTimeout((function(){e.showContextMenuAtSelection()}),1)},e.prototype.onLongTouch=function(t){t.source.type===i.MouseEventElementType.Document&&this.showContextMenuAtEmptySelection(t.modelPoint)},e.prototype.onKeyDown=function(t){},e.prototype.onShortcut=function(t){},e.prototype.getSelectedItems=function(){return this.selection.getSelectedItems(!0)},e.prototype.showContextMenuAtSelection=function(){if(!this.contextToolboxVisible){var t=this.getSelectedItems();0!==t.length&&this.showContextMenu(void 0,r.DiagramModel.getRectangle(t).createPosition())}},e.prototype.showContextMenuAtEmptySelection=function(t){if(!this.contextToolboxVisible){var e=this.getSelectedItems();0===e.length&&this.showContextMenu(void 0,t)}},e.prototype.notifyDragStart=function(t){this.hideContextMenu()},e.prototype.notifyDragEnd=function(t){this.showContextMenuAtSelection()},e.prototype.notifySelectionChanged=function(t){this.isUpdateLocked()?this.registerOccurredEvent(s):this.raiseSelectionChanged()},e.prototype.raiseSelectionChanged=function(){var t=this.getSelectedItems();0!==t.length?this.showContextMenuAtSelection():this.hideContextMenu()},e.prototype.onUpdateUnlocked=function(t){t&s&&this.raiseSelectionChanged()},e.prototype.notifyShowContextToolbox=function(t,e,n,o,i){this.contextToolboxVisible=!0,this.hideContextMenu()},e.prototype.notifyHideContextToolbox=function(){this.contextToolboxVisible=!1,this.showContextMenuAtSelection()},e}(a.ContextMenuHandler);e.ContextMenuTouchHandler=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionTargetVisualizer=e.ConnectionTargetInfo=void 0;var i=n(159),r=function(){function t(t,e){this.rect=t,this.strokeWidth=e,this.allowed=!0}return t}();e.ConnectionTargetInfo=r;var a=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.raiseShow=function(){var t=this,e=new r(this.targetRect,this.targetStrokeWidth);this.dispatcher.raise1((function(n){return n.notifyConnectionTargetShow(t.key,e)}))},e.prototype.raiseHide=function(){this.dispatcher.raise1((function(t){return t.notifyConnectionTargetHide()}))},e}(i.TargetVisualizerBase);e.ConnectionTargetVisualizer=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerTargetVisualizer=e.ContainerTargetInfo=void 0;var i=n(159),r=function(){function t(t,e){this.rect=t,this.strokeWidth=e}return t}();e.ContainerTargetInfo=r;var a=function(t){function e(e){return t.call(this,e)||this}return o(e,t),e.prototype.raiseShow=function(){var t=this,e=new r(this.targetRect,this.targetStrokeWidth);this.dispatcher.raise1((function(n){return n.notifyContainerTargetShow(t.key,e)}))},e.prototype.raiseHide=function(){this.dispatcher.raise1((function(t){return t.notifyContainerTargetHide()}))},e}(i.TargetVisualizerBase);e.ContainerTargetVisualizer=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionPointsVisualizer=e.ConnectionPointInfo=void 0;var o=function(){function t(t,e){this.point=t,this.side=e,this.allowed=!0}return t}();e.ConnectionPointInfo=o;var i=function(){function t(t){this.dispatcher=t}return t.prototype.getKey=function(){return this.key},t.prototype.setPoints=function(t,e,n,o){this.key===t&&this.pointIndex===n||(this.key=t,this.points=e,this.pointIndex=n,this.outsideRectangle=o,this.raiseShow())},t.prototype.setPointIndex=function(t){0<=t&&t<this.points.length&&this.pointIndex!==t&&(this.pointIndex=t,this.raiseShow())},t.prototype.update=function(){this.raiseShow()},t.prototype.reset=function(){"-1"!==this.key&&(this.key="-1",this.points=[],this.pointIndex=-1,this.outsideRectangle=void 0,this.raiseHide())},t.prototype.raiseShow=function(){var t=this;this.dispatcher.raise1((function(e){return e.notifyConnectionPointsShow(t.key,t.points,t.pointIndex,t.outsideRectangle)}))},t.prototype.raiseHide=function(){this.dispatcher.raise1((function(t){return t.notifyConnectionPointsHide()}))},t}();e.ConnectionPointsVisualizer=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeInfoVisualizer=void 0;var o=function(){function t(t){this.dispatcher=t}return t.prototype.set=function(t,e){this.point=t,this.text=e,this.raiseShow()},t.prototype.reset=function(){void 0!==this.point&&(this.point=void 0,this.text=void 0,this.raiseHide())},t.prototype.raiseShow=function(){var t=this;this.dispatcher.raise1((function(e){return e.notifyResizeInfoShow(t.point,t.text)}))},t.prototype.raiseHide=function(){this.dispatcher.raise1((function(t){return t.notifyResizeInfoHide()}))},t}();e.ResizeInfoVisualizer=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRectVisualizer=void 0;var o=function(){function t(t){this.dispatcher=t}return t.prototype.setRectangle=function(t){this.rect=t,this.raiseShow()},t.prototype.reset=function(){this.rect=void 0,this.raiseHide()},t.prototype.raiseShow=function(){var t=this;this.dispatcher.raise1((function(e){return e.notifySelectionRectShow(t.rect)}))},t.prototype.raiseHide=function(){this.dispatcher.raise1((function(t){return t.notifySelectionRectHide()}))},t}();e.SelectionRectVisualizer=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.VisualizerTouchManager=void 0;var i=n(158),r=n(13),a=1,s=function(t){function e(e,n,o,i,r){void 0===r&&(r=i.readOnly);var a=t.call(this,e,n,o,i,r)||this;return e.onChanged.add(a),a}return o(e,t),e.prototype.onBlur=function(t){var e=this;setTimeout((function(){e.hideConnections()}),1)},e.prototype.onFocus=function(t){var e=this;setTimeout((function(){e.showConnections()}),1)},e.prototype.hideConnections=function(){this.readOnly||this.resetConnectionPoints()},e.prototype.showConnections=function(){if(!this.readOnly&&this.needShowConnections()){var t=this.selection.getSelectedShapes();1===t.length&&this.setConnectionPoints(t[0],r.MouseEventElementType.ShapeConnectionPoint,-1,!t[0].allowResizeHorizontally&&!t[0].allowResizeVertically||t[0].isLocked)}},e.prototype.needShowConnections=function(){var t=this.selection.getSelectedItems(),e=this.selection.getSelectedShapes();return 1===t.length&&1===e.length},e.prototype.notifySelectionChanged=function(t){this.isUpdateLocked()?this.registerOccurredEvent(a):this.raiseSelectionChanged()},e.prototype.raiseSelectionChanged=function(){this.needShowConnections()?this.showConnections():this.hideConnections()},e.prototype.onUpdateUnlocked=function(t){t&a&&this.raiseSelectionChanged()},e.prototype.notifyDragStart=function(t){this.hideConnections()},e.prototype.notifyDragEnd=function(t){this.showConnections()},e}(i.VisualizerManager);e.VisualizerTouchManager=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContextToolboxHandler=void 0;var o=n(13),i=n(3),r=n(17),a=n(19),s=function(){function t(){this.contextToolboxVisible=!1,this.onVisibilityChanged=new i.EventDispatcher}return t.prototype.onMouseDown=function(t){t.source.type!==o.MouseEventElementType.Undefined&&this.hideContextToolbox()},t.prototype.onMouseUp=function(t){t.source.type===o.MouseEventElementType.Undefined&&a.Browser.TouchUI||this.hideContextToolbox()},t.prototype.onFocus=function(t){},t.prototype.onBlur=function(t){},t.prototype.onKeyDown=function(t){t.keyCode===r.KeyCode.Esc&&this.hideContextToolbox()},t.prototype.onShortcut=function(t){this.hideContextToolbox()},t.prototype.showContextToolbox=function(t,e,n,o,i,r){this.onVisibilityChanged.raise1((function(r){return r.notifyShowContextToolbox(t,e,n,o,i)})),this.contextToolboxVisible=!0,this.contextToolboxCancelCallback=r},t.prototype.hideContextToolbox=function(t){this.contextToolboxVisible&&(this.onVisibilityChanged.raise1((function(t){return t.notifyHideContextToolbox()})),this.contextToolboxCancelCallback&&(t||this.contextToolboxCancelCallback(),this.contextToolboxCancelCallback=void 0),this.contextToolboxVisible=!1)},t}();e.ContextToolboxHandler=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Selection=void 0;var o=n(3),i=n(332),r=n(14),a=n(6),s=n(44),c=function(){function t(t){this.onChanged=new o.EventDispatcher,this.inputPosition=new i.InputPosition(this),this.onChanged.add(this.inputPosition),this.initialize(t)}return t.prototype.initialize=function(t){this.model=t,this.keys=[],this.inputPosition.initialize()},t.prototype.add=function(t){this.keys.indexOf(t)<0&&(this.keys.push(t),this.raiseSelectionChanged())},t.prototype.remove=function(t){this.keys.indexOf(t)>=0&&(this.keys.splice(this.keys.indexOf(t),1),this.raiseSelectionChanged())},t.prototype.clear=function(){this.keys.length>0&&(this.keys=[],this.raiseSelectionChanged())},t.prototype.set=function(t,e){!e&&s.Data.ArrayEqual(t,this.keys)||(this.keys=t,this.raiseSelectionChanged())},t.prototype.getKeys=function(){return this.keys},t.prototype.getKey=function(t){return this.keys[t]},t.prototype.getSelectedItemsInsideContainers=function(t){var e=this,n=t.slice();return t.forEach((function(t){if(t instanceof r.Shape){var o=e.getSelectedItemsInsideContainers(e.model.getChildren(t));o.forEach((function(t){-1!==n.indexOf(t)||e.hasKey(t.key)||n.push(t)}))}})),n},t.prototype.getSelectedItemsCore=function(t){var e=this;return this.keys.map((function(t){return e.model.findItem(t)})).filter((function(e){return e&&(t||!e.isLocked)}))},t.prototype.getSelectedItems=function(t,e){return e?this.getSelectedItemsInsideContainers(this.getSelectedItemsCore(t)):this.getSelectedItemsCore(t)},t.prototype.getSelectedShapes=function(t,e){var n=this;if(e){var o=this.getSelectedItemsCore(t);return this.getSelectedItemsInsideContainers(o).map((function(t){return t instanceof r.Shape?t:void 0})).filter((function(t){return t}))}return this.keys.map((function(t){return n.model.findShape(t)})).filter((function(e){return e&&(t||!e.isLocked)}))},t.prototype.getSelectedConnectors=function(t,e){var n=this;if(e){var o=this.keys.map((function(t){return n.model.findItem(t)}));return this.getSelectedItemsInsideContainers(o).map((function(t){return t instanceof a.Connector?t:void 0})).filter((function(t){return t}))}return this.keys.map((function(t){return n.model.findConnector(t)})).filter((function(e){return e&&(t||!e.isLocked)}))},t.prototype.hasKey=function(t){return this.keys.indexOf(t)>=0},t.prototype.isEmpty=function(t){return!this.getSelectedItems(t).length},t.prototype.selectRect=function(t){var e=[];this.model.iterateItems((function(n){n.intersectedByRect(t)&&e.push(n.key)})),this.set(e)},t.prototype.raiseSelectionChanged=function(){this.onChanged.raise("notifySelectionChanged",this)},t}();e.Selection=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InputPosition=void 0;var o=n(333),i=n(44),r=function(){function t(t){this.selection=t,this.initialProperties=new o.InputPositionProperties(this.selection),this.defaultProperties=new o.InputPositionProperties(this.selection,this.initialProperties),this.currentProperties=new o.InputPositionProperties(this.selection,this.defaultProperties)}return t.prototype.initialize=function(){this.reset(),this.defaultProperties.reset()},t.prototype.reset=function(){this.currentProperties.reset()},t.prototype.getDefaultConnectorProperties=function(){return this.defaultProperties.getConnectorProperties()},t.prototype.getDefaultConnectorPropertyValue=function(t){return this.defaultProperties.getConnectorPropertyValue(t)},t.prototype.getCurrentConnectorPropertyValue=function(t){return this.currentProperties.getConnectorPropertyValue(t)},t.prototype.setConnectorPropertyValue=function(t,e){this.currentProperties.setConnectorPropertyValue(t,e),this.selection.isEmpty(!0)&&this.defaultProperties.setConnectorPropertyValue(t,e)},t.prototype.setInitialConnectorProperties=function(t){for(var e in this.defaultProperties.reset(),this.currentProperties.reset(),t)Object.prototype.hasOwnProperty.call(t,e)&&this.initialProperties.setConnectorPropertyValue(e,t[e])},t.prototype.getDefaultStyle=function(){return this.defaultProperties.getStyle()},t.prototype.getDefaultStylePropertyValue=function(t){return this.defaultProperties.getStylePropertyValue(t)},t.prototype.getDefaultTextStyle=function(){return this.defaultProperties.getTextStyle()},t.prototype.getDefaultTextStylePropertyValue=function(t){return this.defaultProperties.getTextStylePropertyValue(t)},t.prototype.getCurrentStylePropertyValue=function(t){return this.currentProperties.getStylePropertyValue(t)},t.prototype.getCurrentTextStylePropertyValue=function(t){return this.currentProperties.getTextStylePropertyValue(t)},t.prototype.setStylePropertyValue=function(t,e){this.currentProperties.setStylePropertyValue(t,e),this.selection.isEmpty(!0)&&this.defaultProperties.setStylePropertyValue(t,e)},t.prototype.setTextStylePropertyValue=function(t,e){this.currentProperties.setTextStylePropertyValue(t,e),this.selection.isEmpty(!0)&&this.defaultProperties.setTextStylePropertyValue(t,e)},t.prototype.setInitialStyleProperties=function(t){this.defaultProperties.reset(),this.currentProperties.reset();var e="string"===typeof t?i.Data.cssTextToObject(t):t;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.initialProperties.setStylePropertyValue(n,e[n])},t.prototype.setInitialTextStyleProperties=function(t){this.defaultProperties.reset(),this.currentProperties.reset();var e="string"===typeof t?i.Data.cssTextToObject(t):t;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.initialProperties.setTextStylePropertyValue(n,e[n])},t.prototype.notifySelectionChanged=function(t){this.reset()},t}();e.InputPosition=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InputPositionProperties=void 0;var o=n(31),i=n(29),r=function(){function t(t,e){this.selection=t,this.baseProperties=e,this.selection=t}return t.prototype.reset=function(){this.connectorProperties=null,this.style=null,this.textStyle=null},t.prototype.getConnectorProperties=function(){return this.connectorProperties||(this.connectorProperties=this.baseProperties?this.baseProperties.getConnectorProperties().clone():new o.ConnectorProperties,this.updateConnectorProperties(this.connectorProperties)),this.connectorProperties},t.prototype.getConnectorPropertyValue=function(t){return this.getConnectorProperties()[t]},t.prototype.setConnectorPropertyValue=function(t,e){this.getConnectorProperties()[t]=e},t.prototype.getStyle=function(){return this.style||(this.style=this.baseProperties?this.baseProperties.getStyle().clone():new i.Style,this.updateStyle(this.style,"style")),this.style},t.prototype.getStylePropertyValue=function(t){return this.getStyle()[t]},t.prototype.setStylePropertyValue=function(t,e){this.getStyle()[t]=e},t.prototype.getTextStyle=function(){return this.textStyle||(this.textStyle=this.baseProperties?this.baseProperties.getTextStyle().clone():new i.TextStyle,this.updateStyle(this.textStyle,"styleText")),this.textStyle},t.prototype.getTextStylePropertyValue=function(t){return this.getTextStyle()[t]},t.prototype.setTextStylePropertyValue=function(t,e){this.getTextStyle()[t]=e},t.prototype.updateConnectorProperties=function(t){var e=this,n=this.selection.getSelectedConnectors(!0);t.forEach((function(o){e.updatePropertyValue(t,n,(function(t){return t["properties"]}),o)}))},t.prototype.updateStyle=function(t,e){var n=this,o=this.selection.getSelectedItems(!0);t.forEach((function(i){n.updatePropertyValue(t,o,(function(t){return t[e]}),i)}))},t.prototype.updatePropertyValue=function(t,e,n,o){var i,r=!1;e.forEach((function(t){var e=n(t),a=e[o];if(void 0===i&&void 0!==a)i=a,r=!0;else if(r&&i!==a)return void(i=void 0)})),r&&(t[o]=i)},t}();e.InputPositionProperties=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.History=void 0;var o=n(5),i=n(3),r=function(){function t(t){this.historyItems=[],this.currentIndex=-1,this.incrementalId=-1,this.transactionLevel=-1,this.unmodifiedIndex=-1,this.currTransactionId=0,this.onChanged=new i.EventDispatcher,this.modelManipulator=t}return t.prototype.isModified=function(){if(this.unmodifiedIndex===this.currentIndex)return!1;for(var t=Math.min(this.unmodifiedIndex,this.currentIndex),e=Math.max(this.unmodifiedIndex,this.currentIndex),n=t+1;n<=e;n++)if(this.historyItems[n].changeModified())return!0;return!1},t.prototype.undo=function(){this.canUndo()&&(this.historyItems[this.currentIndex].undo(this.modelManipulator),this.currentIndex--,this.raiseChanged())},t.prototype.redo=function(){this.canRedo()&&(this.startDataSyncItem&&(this.startDataSyncItem.undo(this.modelManipulator),this.startDataSyncItem=void 0),this.currentIndex++,this.historyItems[this.currentIndex].redo(this.modelManipulator),this.raiseChanged())},t.prototype.canUndo=function(){return this.currentIndex>=0},t.prototype.canRedo=function(){return this.currentIndex<this.historyItems.length-1},t.prototype.beginTransaction=function(){this.transactionLevel++,0===this.transactionLevel&&(this.transaction=new o.CompositionHistoryItem);var t=this.currTransactionId++;return t},t.prototype.endTransaction=function(t){if(!(--this.transactionLevel>=0)){var e=this.transaction.historyItems.length;if(e>0){var n=e>1?this.transaction:this.transaction.historyItems.pop();t?this.addDataSyncItem(n):this.addInternal(n)}e>0&&!t&&this.raiseChanged(),delete this.transaction}},t.prototype.addAndRedo=function(t){this.add(t),t.redo(this.modelManipulator),this.raiseChanged()},t.prototype.add=function(t){this.transactionLevel>=0?this.transaction.add(t):this.addInternal(t)},t.prototype.addInternal=function(t){this.currentIndex<this.historyItems.length-1&&(this.historyItems.splice(this.currentIndex+1),this.unmodifiedIndex=Math.min(this.unmodifiedIndex,this.currentIndex)),this.historyItems.push(t),this.currentIndex++,this.deleteOldItems()},t.prototype.addDataSyncItem=function(t){var e=this.historyItems[this.currentIndex];if(e){var n=void 0;e instanceof o.CompositionHistoryItem?n=e:(this.historyItems.splice(this.currentIndex,1),n=new o.CompositionHistoryItem,this.historyItems.push(n),n.historyItems.push(e)),n.dataSyncItems.push(t)}else this.historyItems.length&&(this.startDataSyncItem=t)},t.prototype.deleteOldItems=function(){var e=this.historyItems.length-t.MAX_HISTORY_ITEM_COUNT;e>0&&this.currentIndex>e&&(this.historyItems.splice(0,e),this.currentIndex-=e)},t.prototype.getNextId=function(){return this.incrementalId++,this.incrementalId},t.prototype.clear=function(){this.currentIndex=-1,this.unmodifiedIndex=-1,this.incrementalId=-1,this.historyItems=[],delete this.transaction,this.transactionLevel=-1},t.prototype.resetModified=function(){this.unmodifiedIndex=this.currentIndex},t.prototype.getCurrentItemId=function(){if(-1===this.currentIndex)return-1;var t=this.historyItems[this.currentIndex];return-1===t.uniqueId&&(t.uniqueId=this.getNextId()),t.uniqueId},t.prototype.undoTransaction=function(){var t=this.transaction.historyItems;while(t.length)t.pop().undo(this.modelManipulator)},t.prototype.undoTransactionTo=function(t){var e=this.transaction.historyItems;while(e.length){var n=e.pop();if(n.undo(this.modelManipulator),n===t)return}},t.prototype.raiseChanged=function(){-1===this.transactionLevel&&this.onChanged.raise("notifyHistoryChanged")},t.MAX_HISTORY_ITEM_COUNT=100,t}();e.History=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.BarManager=void 0;var i=n(78),r=function(t){function e(e){var n=t.call(this)||this;return n.bars=[],n.control=e,n}return o(e,t),e.prototype.registerBar=function(t){this.bars.push(t),t.onChanged.add(this),this.updateBarItemsState(t)},e.prototype.updateItemsState=function(t){if(!this.isUpdateLocked())for(var e=0,n=void 0;n=this.bars[e];e++)this.updateBarItemsState(n,t)},e.prototype.updateBarItemsState=function(t,e){if(!this.isUpdateLocked()){if(this.control.permissionsProvider.beginUpdateUI(),t.isVisible()){var n=void 0;if(e){var o=t.getCommandKeys().reduce((function(t,e){return t[e]=!0,t}),{});n=e.filter((function(t){return o[t]}))}else n=t.getCommandKeys();for(var i=n.length,r=0;r<i;r++)this.updateBarItem(t,n[r])}this.control.permissionsProvider.endUpdateUI()}},e.prototype.updateBarItem=function(t,e){var n=this.control.commandManager.getCommand(e);if(n){var o=n.getState();if(t.setItemVisible(e,o.visible),o.visible&&(t.setItemEnabled(e,o.enabled),!o.denyUpdateValue)){var i=this.getItemValue(o.value);o.items&&t.setItemSubItems(e,o.items),t.setItemValue(e,i,this.getDefaultItemValue(o.defaultValue))}}},e.prototype.setEnabled=function(t){for(var e=0,n=void 0;n=this.bars[e];e++)n.setEnabled(t)},e.prototype.notifyBarCommandExecuted=function(t,e){var n=this.control.commandManager.getCommand(t).execute(e);n||this.updateItemsState([t])},e.prototype.notifyBarUpdateRequested=function(){this.updateItemsState()},e.prototype.notifySelectionChanged=function(t){this.updateItemsState()},e.prototype.onUpdateUnlocked=function(t){},e.prototype.getItemValue=function(t){return t},e.prototype.getDefaultItemValue=function(t){return t},e}(i.BatchUpdatableObject);e.BarManager=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RenderManager=e.DBL_CLICK_TIMEOUT=e.LONG_TOUCH_TIMEOUT=void 0;var o=n(13),i=n(79),r=n(26),a=n(1),s=n(17),c=n(19),u=n(18),l=n(104),p=n(74),h=n(337),d=n(27),f=n(338),m=n(339),g=n(341),y=n(161),v=n(343),C=n(75),_=n(15),P=n(99),S="dxdi-read-only";e.LONG_TOUCH_TIMEOUT=500,e.DBL_CLICK_TIMEOUT=500;var b=function(){function t(t,e,n,o,i){this.moveLocked=!1,this.lockMouseMoveTimer=-1,this.lastClickElement=void 0,this.longTouchTimer=void 0,this.dblTouchTimer=void 0;var r=_.RenderHelper.createMainElement(t),a=_.RenderHelper.createSvgElement(r);this.scroll=i||new h.NativeScrollView(t),this.measurer=n,this.dom=new P.DOMManipulator(this.measurer),this.view=new g.CanvasViewManager(this.scroll,a,o.modelSize,o.zoomLevel,o.autoZoom,o.simpleView,o.rectangle,this.dom),this.input=new f.InputManager(r,this.view,e,this.measurer,o.zoomLevel),this.items=new p.CanvasItemsManager(this.view.canvasElement,o.zoomLevel,this.dom),this.page=new m.CanvasPageManager(this.view.pageElement,o,this.dom),this.selection=new y.CanvasSelectionManager(this.view.canvasElement,o.zoomLevel,o.readOnly,this.dom),this.view.onViewChanged.add(this.page),this.view.onViewChanged.add(this.items),this.view.onViewChanged.add(this.selection),this.view.onViewChanged.add(this.input),this.autoScroll=new v.AutoScrollController(this.scroll,a,this.view,this.dom),this.attachEvents(a),this.mainElement=r,this.svgElement=a,this.events=e}return t.prototype.clean=function(t){this.killLockMouseMoveTimer(),this.detachEvents(this.svgElement),this.scroll.detachEvents(),this.input.detachEvents(),this.dom.cancelAnimation(),t&&t(this.mainElement)},t.prototype.replaceParent=function(t,e){this.mainElement&&this.mainElement.parentNode!==t&&t.appendChild(this.mainElement),e&&e!==this.scroll&&(this.scroll&&this.scroll.detachEvents(),this.scroll=e),this.measurer instanceof C.TextMeasurer&&this.measurer.replaceParent(t)},t.prototype.update=function(t){this.view.adjust({horizontal:!t,vertical:!t}),this.page.redraw()},t.prototype.onNewModel=function(t){this.measurer.onNewModel(t,this.dom)},t.prototype.clear=function(){this.items.clear(),this.selection.clear()},t.prototype.attachEvents=function(t){this.onMouseDownHandler=this.onMouseDown.bind(this),this.onMouseEnterHandler=this.onMouseEnter.bind(this),this.onMouseLeaveHandler=this.onMouseLeave.bind(this),this.onMouseWheelHandler=this.onMouseWheel.bind(this),this.onMouseDblClickHandler=this.onMouseDblClick.bind(this),this.onContextMenuHandler=this.onContextMenu.bind(this),this.onMouseMoveHandler=this.onMouseMove.bind(this),this.onMouseUpHandler=this.onMouseUp.bind(this),this.onWindowResizelHandler=this.onWindowResize.bind(this),this.onOrientationChangeHandler=this.onOrientationChange.bind(this),this.onMouseClickHandler=this.onMouseClick.bind(this),_.RenderHelper.addEventListener(t,l.TouchUtils.touchMouseDownEventName,this.onMouseDownHandler),_.RenderHelper.addEventListener(t,"mouseenter",this.onMouseEnterHandler),_.RenderHelper.addEventListener(t,"mouseleave",this.onMouseLeaveHandler),_.RenderHelper.addEventListener(t,"wheel",this.onMouseWheelHandler),_.RenderHelper.addEventListener(t,"dblclick",this.onMouseDblClickHandler),_.RenderHelper.addEventListener(t,"click",this.onMouseClickHandler),_.RenderHelper.addEventListener(t,"contextmenu",this.onContextMenuHandler),_.RenderHelper.addEventListener(document,l.TouchUtils.touchMouseMoveEventName,this.onMouseMoveHandler),_.RenderHelper.addEventListener(document,l.TouchUtils.touchMouseUpEventName,this.onMouseUpHandler),_.RenderHelper.addEventListener(window,"resize",this.onWindowResizelHandler),_.RenderHelper.addEventListener(window,"orientationchange",this.onOrientationChangeHandler),this.input.mouseWheelHandler=this.onMouseWheelHandler},t.prototype.detachEvents=function(t){_.RenderHelper.removeEventListener(t,l.TouchUtils.touchMouseDownEventName,this.onMouseDownHandler),_.RenderHelper.removeEventListener(t,"mouseenter",this.onMouseEnterHandler),_.RenderHelper.removeEventListener(t,"mouseleave",this.onMouseLeaveHandler),_.RenderHelper.removeEventListener(t,"wheel",this.onMouseWheelHandler),_.RenderHelper.removeEventListener(t,"dblclick",this.onMouseDblClickHandler),_.RenderHelper.removeEventListener(t,"contextmenu",this.onContextMenuHandler),_.RenderHelper.removeEventListener(t,"click",this.onMouseClickHandler),_.RenderHelper.removeEventListener(document,l.TouchUtils.touchMouseMoveEventName,this.onMouseMoveHandler),_.RenderHelper.removeEventListener(document,l.TouchUtils.touchMouseUpEventName,this.onMouseUpHandler),_.RenderHelper.removeEventListener(window,"resize",this.onWindowResizelHandler),_.RenderHelper.removeEventListener(window,"orientationchange",this.onOrientationChangeHandler)},t.prototype.onMouseDown=function(t){var e=this;this.lockMouseMove(),this.input.lockFocus(),this.autoScroll.onMouseDown(t),u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return e.events.onMouseDown(t)})),this.events.canFinishTextEditing()&&this.input.captureFocus(),c.Browser.TouchUI&&this.processTouchDown(t);var n=i.EvtUtils.getEventSource(t),o=n&&n.tagName;return(c.Browser.TouchUI||"img"===o.toLowerCase()||"image"===o.toLowerCase())&&i.EvtUtils.preventEventAndBubble(t),!1},t.prototype.onMouseMove=function(t){var e=this;this.moveLocked||(this.autoScroll.onMouseMove(t,(function(){return e.onMouseMoveCore(t)})),this.onMouseMoveCore(t),c.Browser.IE&&this.lockMouseMove(),c.Browser.TouchUI&&this.processTouchMove(t))},t.prototype.onMouseMoveCore=function(t){var e=this;u.raiseEvent(t,this.createDiagramMouseEvent(t,c.Browser.TouchUI),(function(t){return e.events.onMouseMove(t)}))},t.prototype.onMouseUp=function(t){var e=this;this.lockMouseMove();var n=this.createDiagramMouseEvent(t);u.raiseEvent(t,n,(function(t){return e.events.onMouseUp(t)})),this.autoScroll.onMouseUp(t),n.source.type!==o.MouseEventElementType.Undefined&&this.input.captureFocus(),c.Browser.TouchUI&&this.processTouchUp(t)},t.prototype.onMouseEnter=function(t){var e=this;this.autoScroll.onMouseEnter(t),u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return e.events.onMouseEnter(t)}))},t.prototype.onMouseLeave=function(t){var e=this;u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return e.events.onMouseLeave(t)}))},t.prototype.onMouseDblClick=function(t){var e=this;u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return e.events.onDblClick(t)}))},t.prototype.onMouseClick=function(t){var e=this;u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return e.events.onClick(t)}))},t.prototype.onContextMenu=function(t){var e=this;return u.raiseEvent(t,this.createDiagramContextMenuEvent(t),(function(t){return e.events.onContextMenu(t)})),this.input.captureFocus(),i.EvtUtils.preventEventAndBubble(t)},t.prototype.processTouchDown=function(t){var n=this;this.touchDownPoint=this.getTouchPointFromEvent(t),this.resetLongTouch(),this.longTouchTimer=setTimeout((function(){u.raiseEvent(t,n.createDiagramMouseEvent(t),(function(t){return n.events.onLongTouch(t)})),n.resetLongTouch(),n.resetDblClick()}),e.LONG_TOUCH_TIMEOUT)},t.prototype.processTouchMove=function(e){var n=this.getTouchPointFromEvent(e);this.touchDownPoint&&n&&(Math.abs(this.touchDownPoint.x-n.x)>t.touchPositionLimit||Math.abs(this.touchDownPoint.y-n.y)>t.touchPositionLimit)&&(this.resetLongTouch(),this.resetDblClick())},t.prototype.getTouchPointFromEvent=function(t){var e,n=t["touches"];return n&&n.length>0&&(e=new a.Point(n[0].clientX,n[0].clientY)),e},t.prototype.processTouchUp=function(t){var n=this;if(void 0!==this.longTouchTimer){u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return n.events.onClick(t)}));var o=i.EvtUtils.getEventSource(t);void 0!==this.dblTouchTimer&&this.lastClickElement===o?(u.raiseEvent(t,this.createDiagramMouseEvent(t),(function(t){return n.events.onDblClick(t)})),this.resetDblClick()):(this.resetDblClick(),this.dblTouchTimer=setTimeout((function(){return n.dblTouchTimer=void 0}),e.DBL_CLICK_TIMEOUT)),this.lastClickElement=o}this.resetLongTouch(),this.touchDownPoint=void 0},t.prototype.resetLongTouch=function(){void 0!==this.longTouchTimer&&clearTimeout(this.longTouchTimer),this.longTouchTimer=void 0},t.prototype.resetDblClick=function(){void 0!==this.dblTouchTimer&&clearTimeout(this.dblTouchTimer),this.dblTouchTimer=void 0},t.prototype.onOrientationChange=function(){var t=this;setTimeout((function(){return t.onWindowResize()}),100)},t.prototype.onWindowResize=function(){var t={horizontal:!1,vertical:!1};if(this.view.autoZoom!==d.AutoZoomMode.Disabled)t.horizontal=!0,t.vertical=!0;else{var e=this.view.checkFitToCanvas(),n=this.view.checkFitToCanvas(this.scroll.getSize());t={horizontal:e.horizontal!==n.horizontal||n.horizontal,vertical:e.vertical!==n.vertical||n.vertical}}this.view.adjust(t)},t.prototype.onMouseWheel=function(t){var e=this;u.raiseEvent(t,this.createDiagramWheelEvent(t),(function(t){return e.events.onMouseWheel(t)}))},t.prototype.notifyModelSizeChanged=function(t,e){this.view.notifyModelSizeChanged(t,e)},t.prototype.notifyModelRectangleChanged=function(t){this.view.notifyModelRectangleChanged(t)},t.prototype.notifyReadOnlyChanged=function(t){r.DomUtils.toggleClassName(this.mainElement,S,t)},t.prototype.notifyDragStart=function(t){},t.prototype.notifyDragEnd=function(t){},t.prototype.notifyDragScrollStart=function(){this.autoScroll.onDragScrollStart()},t.prototype.notifyDragScrollEnd=function(){this.autoScroll.onDragScrollEnd()},t.prototype.createDiagramMouseEvent=function(t,e){var n=s.KeyUtils.getKeyModifiers(t),i=x(t)?o.MouseButton.Left:o.MouseButton.Right,r=this.getOffsetPointByEvent(t),a=this.getModelPoint(r),c=this.getEventSource(t,e),u=this.createDiagramMouseEventTouches(t);return new o.DiagramMouseEvent(n,i,r,a,c,u)},t.prototype.createDiagramMouseEventTouches=function(t){var e=[];if(t["touches"])for(var n=0;n<t["touches"].length;n++){var i=t["touches"][n].clientX,r=t["touches"][n].clientY,a=this.getOffsetPointByEventPoint(i,r),s=this.getModelPoint(a);e.push(new o.DiagramMouseEventTouch(a,s))}return e},t.prototype.createDiagramContextMenuEvent=function(t){var e=s.KeyUtils.getKeyModifiers(t),n=new a.Point(t.pageX,t.pageY),i=this.getOffsetPointByEvent(t),r=this.getModelPoint(i);return new o.DiagramContextMenuEvent(e,n,r)},t.prototype.createDiagramWheelEvent=function(t){var e=s.KeyUtils.getKeyModifiers(t),n=this.getOffsetPointByEvent(t),i=this.view.getModelPoint(n),r=this.getEventSource(t),a=t.deltaX||t["originalEvent"]&&t["originalEvent"].deltaX,c=t.deltaY||t["originalEvent"]&&t["originalEvent"].deltaY;return new o.DiagramWheelEvent(e,a,c,n,i,r)},t.prototype.getEventSource=function(t,e){var n=e?i.EvtUtils.getEventSourceByPosition(t):i.EvtUtils.getEventSource(t);while(n&&!this.isDocumentContainer(n)){var r=u.RenderUtils.getElementEventData(n);if(void 0!==r)return r;if(this.input.isTextInputElement(n))return new o.MouseEventSource(o.MouseEventElementType.Document);n=n.parentNode}var a=new o.MouseEventSource(o.MouseEventElementType.Undefined);return n&&this.isDocumentContainer(n)&&(a.type=o.MouseEventElementType.Background),a},t.prototype.isDocumentContainer=function(t){return r.DomUtils.hasClassName(t,"dxdi-control")},t.prototype.lockMouseMove=function(){var t=this;this.moveLocked=!0,this.lockMouseMoveTimer=setTimeout((function(){t.moveLocked=!1,t.lockMouseMoveTimer=-1}),10)},t.prototype.killLockMouseMoveTimer=function(){-1!==this.lockMouseMoveTimer&&(clearTimeout(this.lockMouseMoveTimer),this.lockMouseMoveTimer=-1)},t.prototype.getModelPoint=function(t){return this.view.getModelPoint(t)},t.prototype.getOffsetPointByEvent=function(t){var e=i.EvtUtils.getEventX(t),n=i.EvtUtils.getEventY(t);return this.getOffsetPointByEventPoint(e,n)},t.prototype.getOffsetPointByEventPoint=function(t,e){var n=this.scroll.getScrollContainer(),o=r.DomUtils.getAbsolutePositionX(n),i=r.DomUtils.getAbsolutePositionY(n);return new a.Point(t-o,e-i)},t.prototype.getModelPointByEventPoint=function(t,e){var n=this.getOffsetPointByEventPoint(t,e);return this.view.getModelPoint(n)},t.prototype.getEventPointByModelPoint=function(t){var e=this.view.getAbsolutePoint(t),n=this.scroll.getScrollContainer();return new a.Point(r.DomUtils.getAbsolutePositionX(n)+e.x,r.DomUtils.getAbsolutePositionY(n)+e.y)},t.touchPositionLimit=4,t}();function x(t){return c.Browser.MSTouchUI?2!==t.button:i.EvtUtils.isLeftButtonPressed(t)}e.RenderManager=b},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NativeScrollView=void 0;var o=n(3),i=n(2),r=n(1),a=n(26),s=n(15),c=function(){function t(t){this.onScroll=new o.EventDispatcher,this.scrollBarWidth=a.DomUtils.getVerticalScrollBarWidth(),this.mainElement=t,this.attachEvents()}return t.prototype.attachEvents=function(){var t=this;this.onScrollHandler=function(){return t.onScroll.raise1((function(e){return e.notifyScrollChanged((function(){return t.getScroll()}))}))},s.RenderHelper.addEventListener(this.mainElement,"scroll",this.onScrollHandler)},t.prototype.detachEvents=function(){s.RenderHelper.removeEventListener(this.mainElement,"scroll",this.onScrollHandler)},t.prototype.getScrollContainer=function(){return this.mainElement},t.prototype.setScroll=function(t,e){var n=this;this.mainElement.style.overflow="scroll",this.mainElement.scrollLeft=t,this.mainElement.scrollTop=e,this.mainElement.style.overflow="",this.onScroll.raise1((function(t){return t.notifyScrollChanged((function(){return n.getScroll()}))}))},t.prototype.offsetScroll=function(t,e){var n=this;t&&(this.mainElement.scrollLeft+=t),e&&(this.mainElement.scrollTop+=e),this.onScroll.raise1((function(t){return t.notifyScrollChanged((function(){return n.getScroll()}))}))},t.prototype.getScroll=function(){return new r.Point(this.mainElement.scrollLeft,this.mainElement.scrollTop)},t.prototype.getSize=function(){var t=this.mainElement.getBoundingClientRect();return new i.Size(Math.floor(t.width),Math.floor(t.height))},t.prototype.getScrollBarWidth=function(){return this.scrollBarWidth},t}();e.NativeScrollView=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InputManager=void 0;var o=n(17),i=n(26),r=n(18),a=n(13),s=n(14),c=n(6),u=n(79),l=n(43),p=n(19),h=n(11),d=n(15),f=n(59),m="dxdi-text-input",g=function(){function t(t,e,n,o,i){this.mainElement=t,this.layoutPointResolver=e,this.eventManager=n,this.textMeasurer=o,this.actualZoom=i,this.focused=!1,this.focusLocked=!1,this.createInputElements(this.mainElement)}return t.prototype.detachEvents=function(){this.detachInputElementEvents(),this.detachTextInputElementEvents()},t.prototype.isFocused=function(){return this.focused},t.prototype.captureFocus=function(t,e){var n=t||this.inputElement;n.focus({preventScroll:!0}),e&&n.select&&n.select()},t.prototype.setClipboardData=function(t){this.clipboardInputElement.value=t,this.clipboardInputElement.focus({preventScroll:!0}),this.clipboardInputElement.select(),document.execCommand("copy"),this.captureFocus()},t.prototype.getClipboardData=function(t){var e=this;navigator&&navigator["clipboard"]?navigator["clipboard"].readText().then((function(n){t(n),e.captureFocus()})).catch((function(){t(""),e.captureFocus()})):p.Browser.IE&&(this.clipboardInputElement.value="",this.clipboardInputElement.focus({preventScroll:!0}),this.clipboardInputElement.select(),document.execCommand("Paste"),t(this.clipboardInputElement.value),this.captureFocus())},t.prototype.isPasteSupportedByBrowser=function(){return p.Browser.IE||p.Browser.WebKitFamily&&navigator&&void 0!==navigator["clipboard"]},t.prototype.createInputElements=function(t){this.createFocusInputElement(t),this.createTextInputElement(t),this.createClipboardInputElement(t),this.attachInputElementEvents()},t.prototype.setInputElementFocusHandlerMode=function(){this.textInputElementContainer.setAttribute("class","dxdi-text-input-container"),this.captureFocus()},t.prototype.setInputElementTextInputMode=function(t,e,n,o,i,r){this.textInputElementContainer.setAttribute("class","dxdi-text-input-container "+i),this.textInputElement.value=t,this.setTextInputElementBounds(e,n,r),this.setTextInputElementStyle(o),this.updateTextInputPadding(),this.captureFocus(this.textInputElement,!0)},t.prototype.setTextInputElementBounds=function(t,e,n){this.savedTextInputPosition=t,this.savedTextInputSize=e,this.savedTextInputAngle=n;var o=this.layoutPointResolver.getAbsolutePoint(t,!0);this.textInputElementContainer.style.left=o.x+"px",this.textInputElementContainer.style.top=o.y+"px",this.textInputElementContainer.style.width=e&&e.width+"px"||"0px",this.textInputElementContainer.style.height=e&&e.height+"px"||"0px";var i=[];this.textInputElementContainer.style.transform="",1!==this.actualZoom&&i.push("scale("+this.actualZoom+")"),n&&i.push("rotate("+n+"deg)"),this.textInputElementContainer.style.transform=i.join(" "),this.textInputElement.style.width=e&&e.width+"px"||"",this.textInputElement.style.height=e&&e.height+"px"||"auto"},t.prototype.setTextInputElementStyle=function(t){this.savedTextInputStyle=t,r.RenderUtils.applyStyleToElement(t,this.textInputElement)},t.prototype.createFocusInputElement=function(t){this.inputElement=document.createElement("textarea"),this.inputElement.readOnly=p.Browser.TouchUI,this.inputElement.setAttribute("class","dxdi-focus-input"),t.appendChild(this.inputElement)},t.prototype.attachInputElementEvents=function(){this.onInputBlurHandler=this.onInputBlur.bind(this),this.onInputFocusHandler=this.onInputFocus.bind(this),this.onInputKeyDownHandler=this.onInputKeyDown.bind(this),this.onInputKeyPressHandler=this.onInputKeyPress.bind(this),this.onInputKeyUpHandler=this.onInputKeyUp.bind(this),this.onPasteHandler=this.onPaste.bind(this),d.RenderHelper.addEventListener(this.inputElement,"blur",this.onInputBlurHandler),d.RenderHelper.addEventListener(this.inputElement,"focus",this.onInputFocusHandler),d.RenderHelper.addEventListener(this.inputElement,"keydown",this.onInputKeyDownHandler),d.RenderHelper.addEventListener(this.inputElement,"keypress",this.onInputKeyPressHandler),d.RenderHelper.addEventListener(this.inputElement,"keyup",this.onInputKeyUpHandler),d.RenderHelper.addEventListener(this.inputElement,"paste",this.onPasteHandler)},t.prototype.detachInputElementEvents=function(){d.RenderHelper.removeEventListener(this.inputElement,"blur",this.onInputBlurHandler),d.RenderHelper.removeEventListener(this.inputElement,"focus",this.onInputFocusHandler),d.RenderHelper.removeEventListener(this.inputElement,"keydown",this.onInputKeyDownHandler),d.RenderHelper.removeEventListener(this.inputElement,"keypress",this.onInputKeyPressHandler),d.RenderHelper.removeEventListener(this.inputElement,"keyup",this.onInputKeyUpHandler),d.RenderHelper.removeEventListener(this.inputElement,"paste",this.onPasteHandler)},t.prototype.createTextInputElement=function(t){this.textInputElementContainer=document.createElement("div"),this.textInputElementContainer.setAttribute("class","dxdi-text-input-container"),t.appendChild(this.textInputElementContainer),this.textInputElement=document.createElement("textarea"),this.textInputElement.setAttribute("class",m),this.attachTextInputElementEvents(),this.textInputElementContainer.appendChild(this.textInputElement)},t.prototype.attachTextInputElementEvents=function(){this.onTextInputBlurHandler=this.onTextInputBlur.bind(this),this.onTextInputFocusHandler=this.onTextInputFocus.bind(this),this.onTextInputKeyDownHandler=this.onTextInputKeyDown.bind(this),this.onTextInputMouseWheelHandler=this.onTextInputMouseWheel.bind(this),this.onTextInputMouseUpHandler=this.onTextInputMouseUp.bind(this),this.onTextInputKeyUpHandler=this.onTextInputKeyUp.bind(this),this.onTextInputChangeHandler=this.onTextInputChange.bind(this),d.RenderHelper.addEventListener(this.textInputElement,"mousewheel",this.onTextInputMouseWheelHandler),d.RenderHelper.addEventListener(this.textInputElement,"mouseup",this.onTextInputMouseUpHandler),d.RenderHelper.addEventListener(this.textInputElement,"blur",this.onTextInputBlurHandler),d.RenderHelper.addEventListener(this.textInputElement,"focus",this.onTextInputFocusHandler),d.RenderHelper.addEventListener(this.textInputElement,"keydown",this.onTextInputKeyDownHandler),d.RenderHelper.addEventListener(this.textInputElement,"keyup",this.onTextInputKeyUpHandler),d.RenderHelper.addEventListener(this.textInputElement,"change",this.onTextInputChangeHandler)},t.prototype.detachTextInputElementEvents=function(){d.RenderHelper.removeEventListener(this.textInputElement,"mousewheel",this.onTextInputMouseWheelHandler),d.RenderHelper.removeEventListener(this.textInputElement,"mouseup",this.onTextInputMouseUpHandler),d.RenderHelper.removeEventListener(this.textInputElement,"blur",this.onTextInputBlurHandler),d.RenderHelper.removeEventListener(this.textInputElement,"focus",this.onTextInputFocusHandler),d.RenderHelper.removeEventListener(this.textInputElement,"keydown",this.onTextInputKeyDownHandler),d.RenderHelper.removeEventListener(this.textInputElement,"keyup",this.onTextInputKeyUpHandler),d.RenderHelper.removeEventListener(this.textInputElement,"change",this.onTextInputChangeHandler)},t.prototype.createClipboardInputElement=function(t){this.clipboardInputElement=document.createElement("textarea"),this.clipboardInputElement.setAttribute("class","dxdi-clipboard-input"),t.appendChild(this.clipboardInputElement)},t.prototype.blurControl=function(){this.focusLocked||(this.focused=!1,i.DomUtils.removeClassName(this.mainElement,"focused"))},t.prototype.focusControl=function(){this.focused=!0,this.focusLocked=!1,i.DomUtils.addClassName(this.mainElement,"focused")},t.prototype.updateTextInputPadding=function(){var t=this.textInputElement.value;if(this.savedTextInputSize){n=this.textMeasurer.measureWords(t,this.savedTextInputStyle,l.TextOwner.Shape),o=f.getTextHeight(t,this.savedTextInputSize.width,n,!0);var e=Math.max(0,.5*(this.savedTextInputSize.height-o));this.textInputElement.style.paddingTop=Math.ceil(e)+"px",this.textInputElement.style.height=Math.floor(this.savedTextInputSize.height)+"px"}else{var n=this.textMeasurer.measureWords(" ",this.savedTextInputStyle,l.TextOwner.Connector),o=f.getLineHeight(n)*((f.textToParagraphs(t).length||1)+1);this.textInputElement.style.height=Math.ceil(o)+"px"}},t.prototype.onInputBlur=function(t){var e=this;this.blurControl(),r.raiseEvent(t,this.getDiagramFocusEvent(t),(function(t){return e.eventManager.onBlur(t)}))},t.prototype.onInputFocus=function(t){var e=this;this.focusControl(),r.raiseEvent(t,this.getDiagramFocusEvent(t),(function(t){return e.eventManager.onFocus(t)}))},t.prototype.onInputKeyDown=function(t){var e=this;r.raiseEvent(t,this.getDiagramKeyboardEvent(t),(function(t){return e.eventManager.onKeyDown(t)}))},t.prototype.onInputKeyPress=function(t){t.preventDefault&&t.preventDefault()},t.prototype.onInputKeyUp=function(t){var e=this;r.raiseEvent(t,this.getDiagramKeyboardEvent(t),(function(t){return e.eventManager.onKeyUp(t)}))},t.prototype.onTextInputBlur=function(t){var e=this;if(this.eventManager.canFinishTextEditing())this.blurControl(),r.raiseEvent(t,this.getDiagramFocusEvent(t),(function(t){return e.eventManager.onTextInputBlur(t)}));else{var n=u.EvtUtils.getEventSource(t);document.activeElement!==n&&n.focus()}},t.prototype.onTextInputFocus=function(t){var e=this;this.focusControl(),r.raiseEvent(t,this.getDiagramFocusEvent(t),(function(t){return e.eventManager.onTextInputFocus(t)}))},t.prototype.onTextInputKeyDown=function(t){var e=this;r.raiseEvent(t,this.getDiagramKeyboardEvent(t),(function(t){return e.eventManager.onTextInputKeyDown(t)}))},t.prototype.onTextInputKeyUp=function(t){this.updateTextInputPadding()},t.prototype.onTextInputChange=function(t){this.updateTextInputPadding()},t.prototype.onPaste=function(t){var e=this;r.raiseEvent(t,this.getDiagramClipboardEvent(t),(function(t){return e.eventManager.onPaste(t)}))},t.prototype.onTextInputMouseWheel=function(t){this.mouseWheelHandler&&this.mouseWheelHandler(t)},t.prototype.onTextInputMouseUp=function(t){t.stopPropagation&&t.stopPropagation(),u.EvtUtils.cancelBubble(t)},t.prototype.getDiagramKeyboardEvent=function(t){return new a.DiagramKeyboardEvent(o.KeyUtils.getKeyModifiers(t),o.KeyUtils.getEventKeyCode(t),this.textInputElement.value)},t.prototype.getTextInputElementValue=function(){return this.textInputElement.value},t.prototype.getDiagramFocusEvent=function(t){return new a.DiagramFocusEvent(t.target.value)},t.prototype.getDiagramClipboardEvent=function(t){var e,n=t.clipboardData||t["originalEvent"]&&t["originalEvent"].clipboardData;return e=void 0!==n?n.getData("text/plain"):window["clipboardData"].getData("Text"),new a.DiagramClipboardEvent(e)},t.prototype.isTextInputElement=function(t){return"string"===typeof t.className&&t.className.indexOf(m)>-1},t.prototype.lockFocus=function(){var t=this;this.focusLocked=!0,setTimeout((function(){return t.focusLocked=!1}),10)},t.prototype.notifyViewAdjusted=function(t){},t.prototype.notifyActualZoomChanged=function(t){this.actualZoom=t,this.savedTextInputPosition&&this.savedTextInputSize&&this.setTextInputElementBounds(this.savedTextInputPosition,this.savedTextInputSize,this.savedTextInputAngle)},t.prototype.notifyTextInputStart=function(t,e,n,o){var i,r="";t instanceof s.Shape?(r="shape-text",i=t.textAngle):t instanceof c.Connector&&(r="connector-text"),o=o&&o.clone().applyConverter(h.UnitConverter.twipsToPixels),this.setInputElementTextInputMode(e,n,o,t.styleText,r,i)},t.prototype.notifyTextInputEnd=function(t){this.setInputElementFocusHandlerMode()},t.prototype.notifyTextInputPermissionsCheck=function(t,e){},t}();e.InputManager=g},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasPageManager=void 0;var i=n(29),r=n(22),a=n(4),s=n(340),c=n(53),u=n(42),l=n(2),p=n(1),h=n(18),d=n(23),f=n(11),m=2,g=function(t){function e(e,n,o){var i=t.call(this,n.zoomLevel,o)||this;return i.snapPoint=new p.Point(0,0),i.gridPatternId=h.RenderUtils.generateSvgElementId("gridPattern"),i.pagesGridPatternId=h.RenderUtils.generateSvgElementId("pagesGridPattern"),i.pagesGridClipId=h.RenderUtils.generateSvgElementId("pagesGridClip"),i.pageColor=n.pageColor,i.modelSize=n.modelSize,i.simpleView=n.simpleView,i.gridSize=n.gridSize,i.gridVisible=n.gridVisible,i.pageSize=n.pageLandscape?new l.Size(n.pageSize.height,n.pageSize.width):n.pageSize,i.canvasViewOffset=new p.Point(0,0),i.initContainers(e),i}return o(e,t),e.prototype.initContainers=function(t){this.backgroundContainer=t},e.prototype.redraw=function(){this.redrawPage(this.pageColor),this.redrawGrid()},e.prototype.redrawPage=function(t){var e=new i.Style;e["fill"]=d.ColorUtils.colorToHash(t),this.getOrCreateElement("page-bg",new r.RectanglePrimitive(0,0,"100%","100%",e,"page"),this.backgroundContainer),this.createTextFloodFilter("page-bg-textflood-filter",this.backgroundContainer,t)},e.prototype.redrawGrid=function(){this.updateGridElements(),this.updatePagesGridElements()},e.prototype.getGridRectElement=function(t){return void 0===this.gridRectElement&&(this.gridRectElement=this.createPrimitiveElement(t,this.backgroundContainer)),this.gridRectElement},e.prototype.getGridPatternElement=function(t){return void 0===this.gridPatternElement&&(this.gridPatternElement=this.createPrimitiveElement(t,this.backgroundContainer)),this.gridPatternElement},e.prototype.updateGridElements=function(){var t=this,e=new r.RectanglePrimitive("0","0","100%","100%",null,"grid",null,(function(e){e.style.setProperty("fill",h.RenderUtils.getUrlPathById(t.gridPatternId))})),n=this.getGridRectElement(e);if(this.gridVisible){n.style.display="",this.changePrimitiveElement(e,n);for(var o=f.UnitConverter.twipsToPixelsF(this.gridSize)*this.actualZoom,i=[0,1,2,3,4].map((function(t){return Math.round(o*t)})),c=[new a.PathPrimitiveMoveToCommand(i[4].toString(),"0"),new a.PathPrimitiveLineToCommand(i[4].toString(),i[4].toString()),new a.PathPrimitiveLineToCommand("0",i[4].toString())],u=[],l=1;l<=3;l++)u.push(new a.PathPrimitiveMoveToCommand(i[l].toString(),"0")),u.push(new a.PathPrimitiveLineToCommand(i[l].toString(),i[4].toString()));for(l=1;l<=3;l++)u.push(new a.PathPrimitiveMoveToCommand("0",i[l].toString())),u.push(new a.PathPrimitiveLineToCommand(i[4].toString(),i[l].toString()));var d=4*o,m=this.simpleView?this.canvasViewOffset:p.Point.zero(),g=new s.PatternPrimitive(this.gridPatternId,[this.createGridPathPrimitive(c,"grid-outer-line"),this.createGridPathPrimitive(u,"grid-inner-line")],this.createGridPatternPrimitivePosition(m.x,this.snapPoint.x,d),this.createGridPatternPrimitivePosition(m.y,this.snapPoint.y,d),d.toString(),d.toString());this.changePrimitiveElement(g,this.getGridPatternElement(g))}else n.style.display="none"},e.prototype.createGridPatternPrimitivePosition=function(t,e,n){return(((t+e*this.actualZoom)%n-n)%n).toString()},e.prototype.createGridPathPrimitive=function(t,e){return new a.PathPrimitive(t,i.StrokeStyle.default1pxNegativeOffsetInstance,e)},e.prototype.getPagesGridRectElement=function(t){return this.getOrCreateElement("grid-pages-rect",t,this.backgroundContainer)},e.prototype.getPagesGridClipPathElement=function(t){return void 0===this.pagesGridClipPathElement&&(this.pagesGridClipPathElement=this.createPrimitiveElement(t,this.backgroundContainer)),this.pagesGridClipPathElement},e.prototype.getPagesGridPatternElement=function(t){return void 0===this.pagesGridPatternElement&&(this.pagesGridPatternElement=this.createPrimitiveElement(t,this.backgroundContainer)),this.pagesGridPatternElement},e.prototype.updatePagesGridElements=function(){var t=this,e=this.getAbsoluteSize(this.pageSize),n=new r.RectanglePrimitive("0","0","100%","100%",null,"grid-page",this.pagesGridClipId,(function(e){e.style.setProperty("fill",h.RenderUtils.getUrlPathById(t.pagesGridPatternId)),e.style.setProperty("display",t.simpleView?"none":"")}));if(this.getPagesGridRectElement(n),!this.simpleView){var o=this.modelSize.clone().multiply(this.actualZoom,this.actualZoom),i=[new a.PathPrimitiveMoveToCommand((e.width-m/2).toString(),"0"),new a.PathPrimitiveLineToCommand((e.width-m/2).toString(),(e.height-m/2).toString()),new a.PathPrimitiveLineToCommand("0",(e.height-m/2).toString())],u=new s.PatternPrimitive(this.pagesGridPatternId,[new a.PathPrimitive(i,null,"pages-grid-line")],0,0,e.width.toString(),e.height.toString());this.changePrimitiveElement(u,this.getPagesGridPatternElement(u));var l=new c.ClipPathPrimitive(this.pagesGridClipId,[new r.RectanglePrimitive(0,0,(f.UnitConverter.twipsToPixelsF(o.width)-2*m).toString(),(f.UnitConverter.twipsToPixelsF(o.height)-2*m).toString())]);this.changePrimitiveElement(l,this.getPagesGridClipPathElement(l))}},e.prototype.notifyModelSizeChanged=function(t,e){this.modelSize=t.clone(),this.redraw()},e.prototype.notifyModelRectangleChanged=function(t){},e.prototype.notifySnapPointPositionChanged=function(t){this.snapPoint=t.clone().applyConverter(f.UnitConverter.twipsToPixelsF),this.redrawGrid()},e.prototype.notifyPageColorChanged=function(t){this.pageColor=t,this.redrawPage(this.pageColor)},e.prototype.notifyModelChanged=function(t){},e.prototype.notifyPageSizeChanged=function(t,e){this.pageSize=e?new l.Size(t.height,t.width):t.clone(),this.redraw()},e.prototype.notifyActualZoomChanged=function(t){this.actualZoom=t,this.redraw()},e.prototype.notifyViewAdjusted=function(t){this.canvasViewOffset.equals(t)||(this.canvasViewOffset=t,this.simpleView&&this.redraw())},e.prototype.notifyViewChanged=function(t){this.simpleView=t,this.redraw()},e.prototype.notifyGridChanged=function(t,e){this.gridVisible=t,this.gridSize=e,this.redraw()},e}(u.CanvasManagerBase);e.CanvasPageManager=g},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.PatternPrimitive=void 0;var i=n(15),r=n(25),a=function(t){function e(e,n,o,i,r,a,s){var c=t.call(this,s)||this;return c.id=e,c.x=o,c.y=i,c.width=r,c.height=a,c.children=n,c}return o(e,t),e.prototype.createMainElement=function(){var t=document.createElementNS(i.svgNS,"pattern");return t.setAttribute("patternUnits","userSpaceOnUse"),t.setAttribute("id",this.id),t},e.prototype.applyElementProperties=function(e,n){this.setUnitAttribute(e,"x",this.x),this.setUnitAttribute(e,"y",this.y),this.setUnitAttribute(e,"width",this.width),this.setUnitAttribute(e,"height",this.height),this.setPositionCorrectionAttribute(e),t.prototype.applyElementProperties.call(this,e,n)},e}(r.SvgPrimitive);e.PatternPrimitive=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasViewManager=e.CROP_OFFSET=e.CANVAS_SCROLL_PADDING=e.CANVAS_MIN_PADDING=void 0;var i=n(42),r=n(27),a=n(3),s=n(86),c=n(2),u=n(1),l=n(37),p=n(53),h=n(22),d=n(18),f=n(342),m=n(29),g=n(26),y=n(11);e.CANVAS_MIN_PADDING=8,e.CANVAS_SCROLL_PADDING=18,e.CROP_OFFSET=40;var v="dxdi-drag-scroll",C="dxdi-drag-item",_=function(t){function n(e,n,o,i,r,c,l,p){var h=t.call(this,i,p)||this;return h.svgElement=n,h.paddings=new s.Offsets(0,0,0,0),h.scroll=new u.Point(0,0),h.crop=s.Offsets.empty(),h.lockAutoZoom=!1,h.autoScrollLocker=0,h.pageClipPathId=d.RenderUtils.generateSvgElementId("page-clip"),h.pageShadowId=d.RenderUtils.generateSvgElementId("page-shadow"),h.onViewChanged=new a.EventDispatcher,e.onScroll.add(h),o=o.clone().applyConverter(y.UnitConverter.twipsToPixelsF),h.scrollView=e,h.modelSize=o,h.simpleView=c,h.fixedZoomLevel=i,h.autoZoom=r,h.crop=h.rectangleToCrop(l,o),h.updateElements(o.clone().multiply(i,i),u.Point.zero(),c),h.getOrCreateElement("shadow",new f.ShadowFilterPrimitive(h.pageShadowId),h.svgElement),h.containerSize=e.getSize(),h}return o(n,t),n.prototype.adjust=function(t){var e;t||(t={vertical:!1,horizontal:!1},e=s.Offsets.empty()),this.containerSize=this.scrollView.getSize(),this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,this.simpleView,this.crop,t,this.containerSize,e),this.tryNormalizePaddings()},n.prototype.notifyModelSizeChanged=function(t,e){t=t.clone().applyConverter(y.UnitConverter.twipsToPixelsF);var n={horizontal:!e,vertical:!e};this.adjustCore(t,this.fixedZoomLevel,this.autoZoom,this.simpleView,this.crop,n,this.containerSize,e&&e.clone().applyConverter(y.UnitConverter.twipsToPixelsF)),this.modelSize=t},n.prototype.notifyModelRectangleChanged=function(t){var e=this.rectangleToCrop(t,this.modelSize);this.crop&&this.crop.equals(e)||(this.simpleView&&this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,this.simpleView,e,{horizontal:!1,vertical:!1},this.containerSize,s.Offsets.empty()),this.crop=e)},n.prototype.notifySnapPointPositionChanged=function(t){},n.prototype.notifyZoomChanged=function(t,e){this.adjustCore(this.modelSize,t,e,this.simpleView,this.crop,{horizontal:!1,vertical:!1},this.containerSize),this.fixedZoomLevel=t,this.autoZoom=e},n.prototype.notifyViewChanged=function(t){this.adjustCore(this.modelSize,this.fixedZoomLevel,this.autoZoom,t,this.crop,{vertical:!0,horizontal:!0},this.containerSize),this.simpleView=t},n.prototype.notifyGridChanged=function(t,e){},n.prototype.notifyDragStart=function(t){this.lockAutoZoom=!0,g.DomUtils.addClassName(this.svgElement,C)},n.prototype.notifyDragEnd=function(t){this.lockAutoZoom=!1,g.DomUtils.removeClassName(this.svgElement,C),this.autoZoom&&this.adjust({horizontal:!0,vertical:!0})},n.prototype.notifyDragScrollStart=function(){g.DomUtils.addClassName(this.svgElement,v)},n.prototype.notifyDragScrollEnd=function(){g.DomUtils.removeClassName(this.svgElement,v)},n.prototype.notifyScrollChanged=function(t){this.scroll=t()},n.prototype.checkFitToCanvas=function(t){t=t||this.containerSize;var n=this.scrollView.getScrollBarWidth();t=t.clone().offset(2*-e.CANVAS_MIN_PADDING,2*-e.CANVAS_MIN_PADDING).nonNegativeSize();var o=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).clone().multiply(this.actualZoom,this.actualZoom),i=this.checkScrollBars(t,n,o,s.Offsets.empty());return t=t.clone().offset(i.vertical?-n:0,i.horizontal?-n:0).nonNegativeSize(),{vertical:t.height>=o.height,horizontal:t.width>=o.width}},n.prototype.rectangleToCrop=function(t,e){var n=t.clone().applyConverter(y.UnitConverter.twipsToPixelsF);return new s.Offsets(this.correctCrop(n.x),this.correctCrop(e.width-n.right),this.correctCrop(n.y),this.correctCrop(e.height-n.bottom))},n.prototype.correctCrop=function(t){return e.CROP_OFFSET*Math.floor(t/e.CROP_OFFSET)},n.prototype.setActualZoom=function(t){this.actualZoom!==t&&(this.actualZoom=t,this.onViewChanged.raise1((function(e){return e.notifyActualZoomChanged(t)})))},n.prototype.getActualAutoZoomLevel=function(t){if(t===r.AutoZoomMode.Disabled)return this.actualZoom;var e=this.containerSize,n=this.scrollView.getScrollBarWidth(),o=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop);return this.getActualAutoZoom(e,n,o,t)},n.prototype.getActualZoom=function(t,e,n,o,i){return this.lockAutoZoom?this.actualZoom:i===r.AutoZoomMode.Disabled?o:this.getActualAutoZoom(t,e,n,i)},n.prototype.getActualAutoZoom=function(t,n,o,i){return i===r.AutoZoomMode.FitContent?Math.min((t.width-2*e.CANVAS_MIN_PADDING)/o.width,(t.height-2*e.CANVAS_MIN_PADDING)/o.height,1):Math.min((t.width-2*e.CANVAS_MIN_PADDING-n)/o.width,1)},n.prototype.tryNormalizePaddings=function(){var t=this.scrollView.getScrollBarWidth(),e=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).clone().multiply(this.actualZoom,this.actualZoom),n=new u.Point(this.paddings.left,this.paddings.top),o=new c.Size(this.paddings.right,this.paddings.bottom),i=this.getTailSpace(n,this.scroll,e,this.containerSize,t);i.equals(o)||this.applyChanges(new s.Offsets(n.x,i.width,n.y,i.height),e,this.simpleView,this.crop.clone().multiply(this.actualZoom))},n.prototype.scrollBy=function(t){var e,n,o,i=this.scroll,r=this.containerSize,a=this.scrollView.getScrollBarWidth(),l=this.getActualModelSizeWithoutZoom(this.modelSize,this.simpleView,this.crop).clone().multiply(this.actualZoom,this.actualZoom),p=this.checkScrollBars(r,a,l,this.paddings),h=new u.Point(this.paddings.left,this.paddings.top),d=new c.Size(this.paddings.right,this.paddings.bottom);return e=this.changeScrollByOffset(h,i,d,l,t,r,p),i=e.scroll,t=e.offset,n=this.changeTranslateByOffset(h,d,t,p),h=n.translate,t=n.offset,o=this.cropHiddenHead(h,i),h=o.translate,i=o.scroll,d=this.getTailSpace(h,i,l,r,a),this.applyChanges(new s.Offsets(h.x,d.width,h.y,d.height),l,this.simpleView,this.crop.clone().multiply(this.actualZoom),i),t},n.prototype.changeScrollByOffset=function(t,e,n,o,i,r,a){var s=e.clone(),c=i.clone();return i.x&&a.horizontal&&(s.x-=c.x=-this.getScrollDeltaByOffset(i.x,e.x,t.x+o.width+n.width,r.width,a.vertical)),i.y&&a.vertical&&(s.y-=c.y=-this.getScrollDeltaByOffset(i.y,e.y,t.y+o.height+n.height,r.height,a.horizontal)),{scroll:s,offset:c}},n.prototype.changeTranslateByOffset=function(t,e,n,o){var i=t.clone(),r=n.clone();return n.x&&!o.horizontal&&(i.x+=r.x=this.getTranslateDeltaByOffset(n.x,i.x,e.width)),n.y&&!o.vertical&&(i.y+=r.y=this.getTranslateDeltaByOffset(n.y,i.y,e.height)),{translate:i,offset:r}},n.prototype.getScrollDeltaByOffset=function(t,e,n,o,i){if(t>0)return-Math.min(e,t);var r=n-(o-(i?this.scrollView.getScrollBarWidth():0));return Math.min(r-e,-t)},n.prototype.getTranslateDeltaByOffset=function(t,n,o){return t?t<0?-Math.min(n-e.CANVAS_MIN_PADDING,-t):Math.min(o-e.CANVAS_MIN_PADDING,t):0},n.prototype.getActualModelSizeWithoutZoom=function(t,e,n){return e&&n?t.clone().offset(-n.horizontal,-n.vertical).nonNegativeSize():t},n.prototype.setScrollTo=function(t,n){var o=this.containerSize,i=this.getVisibileAreaAbsShift(),r=t.clone().applyConverter(y.UnitConverter.twipsToPixelsF).clone().multiply(this.actualZoom,this.actualZoom).clone().offset(i.x,i.y),a=this.scroll;n?(a.x+=r.x-n.x,a.y+=r.y-n.y):(r.x<0&&(a.x+=r.x-e.CANVAS_MIN_PADDING),r.y<0&&(a.y+=r.y-e.CANVAS_MIN_PADDING),r.x>o.width&&(a.x+=r.x-o.width+e.CANVAS_MIN_PADDING),r.y>o.height&&(a.y+=r.y-o.height+e.CANVAS_MIN_PADDING)),this.setScroll(a)},n.prototype.scrollIntoView=function(t){t=t.clone().applyConverter(y.UnitConverter.twipsToPixelsF).multiply(this.actualZoom,this.actualZoom).moveRectangle(this.paddings.left,this.paddings.top);var n=this.scroll,o=this.containerSize;if(!(t.x>=n.x&&t.y>=n.y&&t.right<=n.x+o.width&&t.bottom<=n.y+o.height)){var i=n.clone();t.x<n.x?i.x=t.x-e.CANVAS_SCROLL_PADDING:t.right>n.x+o.width&&(i.x=Math.min(t.x-e.CANVAS_SCROLL_PADDING,t.right+e.CANVAS_SCROLL_PADDING-o.width)),t.y<n.y?i.y=t.y-e.CANVAS_SCROLL_PADDING:i.y=Math.min(t.y-e.CANVAS_SCROLL_PADDING,t.bottom+e.CANVAS_SCROLL_PADDING-o.height),this.setScroll(i)}},n.prototype.setScroll=function(t){var e=this,n=this.modelSize.clone().multiply(this.actualZoom,this.actualZoom);t.x=Math.max(0,Math.min(t.x,n.width+this.paddings.horizontal-this.containerSize.width)),t.y=Math.max(0,Math.min(t.y,n.height+this.paddings.vertical-this.containerSize.height)),this.dom.changeByFunc(null,(function(){e.scrollView.setScroll(t.x,t.y)})),this.scroll=t.clone()},n.prototype.updateElements=function(t,e,n){this.updatePageElement(t,e,n),this.updateCanvasElement(e)},n.prototype.updateCanvasElement=function(t){this.canvasElement=this.getOrCreateElement("dxdi-main",new l.GroupPrimitive([],"dxdi-main",null,null,(function(e){e.setAttribute("transform","translate("+Math.round(t.x)+", "+Math.round(t.y)+")")})),this.svgElement)},n.prototype.updatePageElement=function(t,e,n){n||this.getOrCreateElement("pageShadowRect",new h.RectanglePrimitive(e.x.toString(),e.y.toString(),t.width.toString(),t.height.toString(),new m.EmptyStyle({filter:d.RenderUtils.getUrlPathById(this.pageShadowId)}),"dxdi-page-shadow"),this.svgElement),this.pageElement=this.getOrCreateElement("page",new l.GroupPrimitive([],"dxdi-page",null,n?"":this.pageClipPathId,(function(t){t.setAttribute("transform","translate("+(n?0:Math.round(e.x))+", "+(n?0:Math.round(e.y))+")")})),this.svgElement),this.getOrCreateElement("pageClip",this.createPageClipPathPrimitive(t),this.svgElement)},n.prototype.createPageClipPathPrimitive=function(t){var e=[];return e.push(new h.RectanglePrimitive(0,0,t.width.toString(),t.height.toString())),new p.ClipPathPrimitive(this.pageClipPathId,e)},n.prototype.adjustCore=function(t,e,n,o,i,r,a,c){var u=this.getActualModelSizeWithoutZoom(t,o,i);if(this.lockAutoZoom||!n&&c&&this.modelSize)this.resizeView(u,this.actualZoom,a,o,i,c);else{var l=this.scrollView.getScrollBarWidth(),p=this.getActualZoom(a,l,u,e,n);!n||p!==this.actualZoom||r.horizontal&&r.vertical?(this.resetView(u,p,a,o,i,r),this.setActualZoom(p)):this.resizeView(u,p,a,o,i,c||s.Offsets.empty())}},n.prototype.resetView=function(t,n,o,i,r,a){var c=t.clone().multiply(n,n),u=s.Offsets.fromNumber(e.CANVAS_MIN_PADDING);a=a||{horizontal:!0,vertical:!0},!a.horizontal&&this.paddings&&(u.left=this.paddings.left,u.right=this.paddings.right),!a.vertical&&this.paddings&&(u.top=this.paddings.top,u.bottom=this.paddings.bottom);var l=this.checkScrollBars(o,this.scrollView.getScrollBarWidth(),c,u),p=this.scrollView.getScrollBarWidth(),h=a.horizontal||a.vertical?this.scroll:void 0;if(a.horizontal){var d=Math.max((o.width-(l.vertical?p:0)-c.width)/2,e.CANVAS_MIN_PADDING);u.left=d,u.right=d,h.x=0}if(a.vertical){var f=Math.max((o.height-(l.horizontal?p:0)-c.height)/2,e.CANVAS_MIN_PADDING);u.top=f,u.bottom=f,h.y=0}this.applyChanges(u,c,i,r.clone().multiply(n),h)},n.prototype.resizeView=function(t,e,n,o,i,r){var a,c,l=this.actualZoom,p=this.simpleView&&this.crop?this.crop.clone().multiply(l):s.Offsets.empty(),h=t.clone().multiply(e,e);r=r.clone().multiply(e);var d=o&&i?i.clone().multiply(e):s.Offsets.empty(),f=new u.Point(this.paddings.left,this.paddings.top),m=this.scroll;a=this.applyOffset(f,m,p,d,r),f=a.translate,m=a.scroll,c=this.cropHiddenHead(f,m),f=c.translate,m=c.scroll;var g=this.getTailSpace(f,m,h,n,this.scrollView.getScrollBarWidth()),y=new s.Offsets(f.x,g.width,f.y,g.height);this.applyChanges(y,h,o,d,m)},n.prototype.applyChanges=function(t,e,n,o,i){var r=this,a=new u.Point(t.left,t.top);n&&o&&(a=a.clone().offset(-o.left,-o.top)),this.updateElements(e,a,n),this.setSvgSize(e.width+t.horizontal,e.height+t.vertical),this.onViewChanged.raise1((function(t){return t.notifyViewAdjusted(new u.Point(a.x,a.y))})),i&&(this.lockAutoScroll(),i&&this.dom.changeByFunc(this.scrollView,(function(t){t.setScroll(i.x,i.y),r.unlockAutoScroll()})),this.scroll=i),this.paddings=t},n.prototype.isAutoScrollLocked=function(){return 0!==this.autoScrollLocker},n.prototype.lockAutoScroll=function(){this.autoScrollLocker++},n.prototype.unlockAutoScroll=function(){this.autoScrollLocker--},n.prototype.applyOffset=function(t,n,o,i,r){var a=t.clone(),s=n.clone(),c=this.getActualOffset(o,i,r);return c.left&&(a.x=Math.max(e.CANVAS_MIN_PADDING,a.x-c.left),s.x+=c.left-(t.x-a.x)),c.top&&(a.y=Math.max(e.CANVAS_MIN_PADDING,a.y-c.top),s.y+=c.top-(t.y-a.y)),{translate:a,scroll:s}},n.prototype.cropHiddenHead=function(t,n){var o=n.clone(),i=t.clone();if(o.x&&i.x>e.CANVAS_MIN_PADDING){var r=i.x-Math.max(e.CANVAS_MIN_PADDING,i.x-o.x);i.x-=r,o.x-=r}if(o.y&&i.y>e.CANVAS_MIN_PADDING){r=i.y-Math.max(e.CANVAS_MIN_PADDING,i.y-o.y);i.y-=r,o.y-=r}return{translate:i,scroll:o}},n.prototype.getTailSpace=function(t,n,o,i,r){var a=t.clone(),u=n.clone(),l=Math.max(i.width+u.x-(a.x+o.width),e.CANVAS_MIN_PADDING),p=Math.max(i.height+u.y-(a.y+o.height),e.CANVAS_MIN_PADDING),h=this.checkScrollBars(i,r,o,new s.Offsets(a.x,l,a.y,p));return h.vertical&&(l=Math.max(e.CANVAS_MIN_PADDING,l-r)),h.horizontal&&(p=Math.max(e.CANVAS_MIN_PADDING,p-r)),new c.Size(l,p)},n.prototype.getActualOffset=function(t,e,n){return new s.Offsets(-(e.left-t.left)+n.left,-(e.right-t.right)+n.right,-(e.top-t.top)+n.top,-(e.bottom-t.bottom)+n.bottom)},n.prototype.checkScrollBars=function(t,e,n,o){var i=t.width<n.width+o.horizontal,r=t.height<n.height+o.vertical;return i&&!r&&(r=t.height-e<n.height+o.vertical),r&&!i&&(i=t.width-e<n.width+o.horizontal),{horizontal:i,vertical:r}},n.prototype.setSvgSize=function(t,e){t===this.lastWidth&&e===this.lastHeight||(this.dom.changeByFunc(this.svgElement,(function(n){return d.RenderUtils.updateSvgElementSize(n,t,e)})),this.lastWidth=t,this.lastHeight=e)},n.prototype.getVisibileAreaAbsShift=function(t){var e=this.scroll,n=this.paddings.clone(),o=this.simpleView,i=o&&this.crop?this.crop.left*this.actualZoom:0,r=o&&this.crop?this.crop.top*this.actualZoom:0;return new u.Point(n.left-i-(t?0:e.x),n.top-r-(t?0:e.y))},n.prototype.getModelPoint=function(t,e){var n=this.getVisibileAreaAbsShift(),o=t.clone().offset(-n.x,-n.y).multiply(1/this.actualZoom,1/this.actualZoom);if(e){var i=this.containerSize;if(t.x<0||t.y<0||t.x>i.width||t.y>i.height)return null;if(o.x<0||o.y<0)return null;if(o.x>this.modelSize.width||o.y>this.modelSize.height)return null}return o.clone().applyConverter(y.UnitConverter.pixelsToTwips)},n.prototype.getAbsolutePoint=function(t,e,n){var o=this.getVisibileAreaAbsShift(e),i=t.clone().multiply(this.actualZoom,this.actualZoom).clone().applyConverter(y.UnitConverter.twipsToPixelsF).clone().offset(o.x,o.y);if(n){if(i.x<0||i.y<0)return null;var r=this.containerSize;if(i.x>r.width||i.y>r.height)return null}return i},n}(i.CanvasManagerBase);e.CanvasViewManager=_},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowFilterPrimitive=void 0;var i=n(109),r=n(15),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.createChildElements=function(t){var e=document.createElementNS(r.svgNS,"feGaussianBlur");e.setAttribute("in","SourceGraphic"),e.setAttribute("stdDeviation","4.6"),t.appendChild(e);var n=document.createElementNS(r.svgNS,"feOffset");n.setAttribute("dx","0"),n.setAttribute("dy","0"),t.appendChild(n);var o=document.createElementNS(r.svgNS,"feMerge");t.appendChild(o);var i=document.createElementNS(r.svgNS,"feMergeNode");o.appendChild(i);var a=document.createElementNS(r.svgNS,"feMergeNode");a.setAttribute("in","SourceGraphic"),o.appendChild(a)},e}(i.FilterPrimitive);e.ShadowFilterPrimitive=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AutoScrollController=void 0;var o=n(79),i=n(15),r=n(26),a=n(2),s=40,c=5,u=5,l=50,p=function(){function t(t,e,n,o){this.scroll=t,this.svgElement=e,this.view=n,this.dom=o,this.leftButtonPressed=!1,this.scrollDragging=!1,this.scrollTimer=-1,this.scrollBarWidth=r.DomUtils.getVerticalScrollBarWidth()}return t.prototype.onMouseMove=function(t,e){this.clearScrollTimer(),o.EvtUtils.isLeftButtonPressed(t)||(this.leftButtonPressed=!1),this.canAutoScroll()&&this.changeScrollPosition(t,e,!1)},t.prototype.onMouseDown=function(t){this.leftButtonPressed=!!o.EvtUtils.isLeftButtonPressed(t)},t.prototype.onMouseUp=function(t){this.clearScrollTimer(),this.leftButtonPressed=!1},t.prototype.onMouseEnter=function(t){var e=this;o.EvtUtils.isLeftButtonPressed(t)&&setTimeout((function(){e.leftButtonPressed=!0}),500)},t.prototype.onDragScrollStart=function(){this.scrollDragging=!0},t.prototype.onDragScrollEnd=function(){this.scrollDragging=!1},t.prototype.canAutoScroll=function(){return this.leftButtonPressed&&!this.scrollDragging},t.prototype.changeScrollPosition=function(t,e,n){var o=this,i=!1;if(!this.view.isAutoScrollLocked()){var c=this.scroll.getScrollContainer(),u=t.pageX-r.DomUtils.getAbsolutePositionX(c),p=t.pageY-r.DomUtils.getAbsolutePositionY(c),h=this.scroll.getSize(),d=new a.Size(parseFloat(this.svgElement.style.width),parseFloat(this.svgElement.style.height)),f=h.width;h.width<d.width&&(f-=this.scrollBarWidth);var m=h.height;h.height<d.height&&(m-=this.scrollBarWidth),u<=s?(this.dom.changeByFunc(null,(function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(-o.getScrollingOffset(u),0)})),i=!0):f-s<=u&&(this.dom.changeByFunc(null,(function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(o.getScrollingOffset(f-u),0)})),i=!0),p<=s?(this.dom.changeByFunc(null,(function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(0,-o.getScrollingOffset(p))})),i=!0):m-s<=p&&(this.dom.changeByFunc(null,(function(){o.view.isAutoScrollLocked()||o.scroll.offsetScroll(0,o.getScrollingOffset(m-p))})),i=!0)}(i||this.view.isAutoScrollLocked())&&(this.scrollTimer=window.setTimeout((function(){return o.changeScrollPosition(t,e,i)}),l)),n&&e()},t.prototype.clearScrollTimer=function(){this.scrollTimer>-1&&(window.clearTimeout(this.scrollTimer),this.scrollTimer=-1)},t.prototype.getScrollingOffset=function(t){var e=Math.pow((s-t)/c,2);return Math.round(Math.min(e,u))},t.createMainElement=function(t){var e=document.createElement("div");return e.setAttribute("class","dxdi-control"),t.appendChild(e),e},t.createSvgElement=function(t,e){void 0===e&&(e=!1);var n=document.createElementNS(i.svgNS,"svg");return n.className.baseVal="dxdi-canvas"+(e?" export":""),t.appendChild(n),n},t}();e.AutoScrollController=p},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DocumentDataSource=void 0;var i=n(0),r=n(14),a=n(6),s=n(345),c=n(9),u=n(44),l=n(3),p=n(81),h=function(t){function e(e,n,o,i,r,a,s){var c=t.call(this,"Document",n,o,i,r,a)||this;return c.changesListener=e,c.updateLockCount=0,c.changesLockChanged=s,c}return o(e,t),e.prototype.updateItemsByModel=function(t){var e=this;this.beginChangesNotification(),this.deleteNodes(t),this.deleteEdges(t),t.items.forEach((function(n){n instanceof r.Shape&&e.updateNode(t,n),n instanceof a.Connector&&e.updateEdge(t,n)})),this.endChangesNotification()},e.prototype.isItemObjectModified=function(t,e,n){var o=n.setLocked&&e.locked!==t.locked||n.setZIndex&&e.zIndex!==t.zIndex||n.setCustomData&&!l.ObjectUtils.compareObjects(e.customData,t.customData);if(!o&&n.setStyle){var i=t.style.getDefaultInstance();t.style.forEach((function(n){t.style[n]!==i[n]&&t.style[n]!==(e.style&&e.style[n])&&(o=!0)}))}if(!o&&n.setStyleText){var r=t.styleText.getDefaultInstance();t.styleText.forEach((function(n){t.styleText[n]!==r[n]&&t.styleText[n]!==(e.styleText&&e.styleText[n])&&(o=!0)}))}return o},e.prototype.setDataObjectKeyRelatedProperty=function(t,e,n,o){(o||void 0===this.autoGeneratedDataKeys[n])&&t(e,n)},e.prototype.updateItemObjectProperties=function(t,e,n){if(n.setCustomData&&(t.customData=l.ObjectUtils.cloneObject(e.customData),t.dataObj&&void 0!==t.customData&&n.setCustomData(t.dataObj,e.customData)),n.setLocked&&(t.locked=e.locked,t.dataObj&&void 0!==t.locked&&n.setLocked(t.dataObj,e.locked)),n.setStyle){var o=e.style.toObject();t.style=o,t.dataObj&&void 0!==t.style&&n.setStyle(t.dataObj,u.Data.objectToCssText(o))}if(n.setStyleText){var i=e.styleText.toObject();t.styleText=i,t.dataObj&&void 0!==t.styleText&&n.setStyleText(t.dataObj,u.Data.objectToCssText(i))}n.setZIndex&&(t.zIndex=e.zIndex,t.dataObj&&void 0!==t.zIndex&&n.setZIndex(t.dataObj,e.zIndex))},e.prototype.deleteItems=function(t,e,n,o){var i=t.slice();i.forEach((function(t){if(void 0!==t.key&&null!==t.key&&!e(t.key)){var i=n(t),r=i.indexOf(t.dataObj);i.splice(r,1),o(t,r>-1)}}))},e.prototype.updateNode=function(t,e){var n=this,o=this.findNode(e.dataKey);if(o)this.isNodeObjectModified(e,o,t.units)?(this.updateNodeObjectProperties(e,o,t.units),this.updateNodeObjectConnectedProperties(e,o),this.beginChangesNotification(),this.changesListener.notifyNodeUpdated.call(this.changesListener,this.nodeDataImporter.getKey(o.dataObj||o.key),o.dataObj,(function(t,e){n.endChangesNotification()}),(function(t){n.endChangesNotification()}))):this.updateNodeObjectConnectedProperties(e,o,this.changesListener);else{var i={};o=this.addNodeInternal(i,e.description.key,e.text),this.nodeDataSource.push(o.dataObj),this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setKey,i,o.key,this.addInternalKeyOnInsert),this.updateNodeObjectProperties(e,o,t.units),this.updateNodeObjectConnectedProperties(e,o),this.updateNodeObjectKey(e,o,o.dataObj),this.beginChangesNotification(),this.changesListener.notifyNodeInserted.call(this.changesListener,o.dataObj,(function(t){n.updateNodeObjectKey(e,o,t),n.endChangesNotification()}),(function(t){n.endChangesNotification()}))}},e.prototype.isNodeObjectModified=function(t,e,n){return this.isItemObjectModified(t,e,this.nodeDataImporter)||e.type!==t.description.key&&!(void 0===e.type&&t.description.key===i.ShapeTypes.Rectangle)||!this.compareStrings(e.text,t.text)||this.nodeDataImporter.setImage&&e.image!==t.image.actualUrl||this.nodeDataImporter.setLeft&&e.left!==c.ModelUtils.getlUnitValue(n,t.position.x)||this.nodeDataImporter.setTop&&e.top!==c.ModelUtils.getlUnitValue(n,t.position.y)||this.nodeDataImporter.setWidth&&e.width!==c.ModelUtils.getlUnitValue(n,t.size.width)||this.nodeDataImporter.setHeight&&e.height!==c.ModelUtils.getlUnitValue(n,t.size.height)},e.prototype.updateNodeObjectProperties=function(t,e,n){if(this.updateItemObjectProperties(e,t,this.nodeDataImporter),this.nodeDataImporter.setType&&(e.type=t.description.key,this.nodeDataImporter.setType(e.dataObj,t.description.key)),this.nodeDataImporter.setText&&(e.text=t.text,this.nodeDataImporter.setText(e.dataObj,t.text)),this.nodeDataImporter.setImage&&(e.image=t.image.actualUrl,this.nodeDataImporter.setImage(e.dataObj,t.image.actualUrl)),this.nodeDataImporter.setLeft){var o=c.ModelUtils.getlUnitValue(n,t.position.x);e.left=o,this.nodeDataImporter.setLeft(e.dataObj,o)}if(this.nodeDataImporter.setTop){var i=c.ModelUtils.getlUnitValue(n,t.position.y);e.top=i,this.nodeDataImporter.setTop(e.dataObj,i)}if(this.nodeDataImporter.setWidth){var r=c.ModelUtils.getlUnitValue(n,t.size.width);e.width=r,this.nodeDataImporter.setWidth(e.dataObj,r)}if(this.nodeDataImporter.setHeight){var a=c.ModelUtils.getlUnitValue(n,t.size.height);e.height=a,this.nodeDataImporter.setHeight(e.dataObj,a)}},e.prototype.updateNodeObjectConnectedProperties=function(t,e,n){if(this.useNodeParentId&&void 0!==this.nodeDataImporter.setParentKey){var o=this.getParentItemKey(t),i=this.findNode(o);this.updateNodeObjectParentKey(e,i,n)}if(this.useNodeContainerId&&void 0!==this.nodeDataImporter.setContainerKey){var r=this.getContainerShapeKey(t),a=this.findNode(r);this.updateNodeObjectContainerKey(e,a,n)}if(this.useNodeItems&&void 0!==this.nodeDataImporter.setItems){o=this.getParentItemKey(t),i=this.findNode(o);this.updateNodeObjectItems(e,i,n)}if(this.useNodeChildren&&void 0!==this.nodeDataImporter.setChildren){r=this.getContainerShapeKey(t),a=this.findNode(r);this.updateNodeObjectChildren(e,a,n)}},e.prototype.updateNodeObjectParentKey=function(t,e,n){var o=this,i=this.nodeDataImporter.getParentKey(t.dataObj),r=e?this.nodeDataImporter.getKey(e.dataObj):void 0;i===r||this.isRootParentKey(i)&&this.isRootParentKey(r)||(this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setParentKey,t.dataObj,r,!1),n&&(this.beginChangesNotification(),n.notifyNodeUpdated.call(n,this.nodeDataImporter.getKey(t.dataObj)||t.key,t.dataObj,(function(t,e){o.endChangesNotification()}),(function(t){o.endChangesNotification()}))))},e.prototype.updateNodeObjectContainerKey=function(t,e,n){var o=this,i=this.nodeDataImporter.getContainerKey(t.dataObj),r=e?this.nodeDataImporter.getKey(e.dataObj):void 0;i===r||this.isRootParentKey(i)&&this.isRootParentKey(r)||(this.setDataObjectKeyRelatedProperty(this.nodeDataImporter.setContainerKey,t.dataObj,r,!1),n&&(this.beginChangesNotification(),n.notifyNodeUpdated.call(n,this.nodeDataImporter.getKey(t.dataObj)||t.key,t.dataObj,(function(t,e){o.endChangesNotification()}),(function(t){o.endChangesNotification()}))))},e.prototype.isRootParentKey=function(t){return void 0===t||null===t||!this.findNode(t)},e.prototype.updateNodeObjectItems=function(t,e,n){var o=this;if((e&&t.parentDataObj!==e.dataObj||!e&&t.parentDataObj)&&(!e||!this.checkNodeCyrcleItems(t.dataObj,e.dataObj))){var i=t.parentDataObj?this.nodeDataImporter.getItems(t.parentDataObj):this.nodeDataSource,r=i.indexOf(t.dataObj);i.splice(r,1);var a=e?this.nodeDataImporter.getItems(e.dataObj):this.nodeDataSource;a?a.push(t.dataObj):this.nodeDataImporter.setItems(e.dataObj,[t.dataObj]),t.parentDataObj=e&&e.dataObj,n&&(this.beginChangesNotification(),n.notifyNodeUpdated.call(n,this.nodeDataImporter.getKey(t.dataObj)||t.key,t.dataObj,(function(t,e){o.endChangesNotification()}),(function(t){o.endChangesNotification()})))}},e.prototype.updateNodeObjectChildren=function(t,e,n){var o=this;if(e&&t.containerDataObj!==e.dataObj||!e&&t.containerDataObj){var i=t.containerDataObj?this.nodeDataImporter.getChildren(t.containerDataObj):this.nodeDataSource,r=i.indexOf(t.dataObj);i.splice(r,1);var a=e?this.nodeDataImporter.getChildren(e.dataObj):this.nodeDataSource;a?a.push(t.dataObj):this.nodeDataImporter.setChildren(e.dataObj,[t.dataObj]),t.containerDataObj=e&&e.dataObj,n&&(this.beginChangesNotification(),n.notifyNodeUpdated.call(n,this.nodeDataImporter.getKey(t.dataObj)||t.key,t.dataObj,(function(t,e){o.endChangesNotification()}),(function(t){o.endChangesNotification()})))}},e.prototype.checkNodeCyrcleItems=function(t,e){var n=this,o=!1,i=this.nodeDataImporter.getItems(t);return i&&i.forEach((function(t){o=o||t===e||n.checkNodeCyrcleItems(t,e)})),o},e.prototype.updateNodeObjectKey=function(t,e,n){var o=this.nodeDataImporter.getKey(n),i=!1;if(void 0!==o&&null!==o&&o!==e.key&&(delete this.autoGeneratedDataKeys[e.key],e.key=o,i=!0),t.dataKey=e.key,e.dataObj!==n){var r=this.getNodeArray(e),a=r.indexOf(e.dataObj);r.splice(a,1,n),e.dataObj=n}i&&this.updateNodeKeyRelatedObjects(t,e)},e.prototype.updateNodeKeyRelatedObjects=function(t,e){var n=this;if(this.useNodeParentId&&void 0!==this.nodeDataImporter.setParentKey){var o=this.getChildItems(t);o.forEach((function(t){var o=n.findNode(t.dataKey);o&&n.updateNodeObjectParentKey(o,e,n.changesListener)}))}this.useNodeContainerId&&void 0!==this.nodeDataImporter.setContainerKey&&t.children.forEach((function(t){var o=n.findNode(t.dataKey);o&&n.updateNodeObjectContainerKey(o,e,n.changesListener)})),this.useEdgesArray()&&t.attachedConnectors.forEach((function(o){var i=n.findEdge(o.dataKey);i&&(t===o.beginItem&&n.updateEdgeObjectFromProperty(e,i,n.changesListener),t===o.endItem&&n.updateEdgeObjectToProperty(e,i,n.changesListener))}))},e.prototype.deleteNodes=function(t){var e=this;this.deleteItems(this.nodes,(function(e){return t.findShapeByDataKey(e)}),(function(t){return e.getNodeArray(t)}),(function(t,n){var o=t.dataObj&&e.nodeDataImporter.getKey(t.dataObj)||t.key,i=e.findNode(o);i&&e.nodes.splice(e.nodes.indexOf(i),1),n&&(e.beginChangesNotification(),e.changesListener.notifyNodeRemoved.call(e.changesListener,o,t.dataObj,(function(t,n){e.endChangesNotification()}),(function(t){e.endChangesNotification()})))}))},e.prototype.getParentItem=function(t){for(var e=0;e<t.attachedConnectors.length;e++)if(t.attachedConnectors[e].endItem===t)return t.attachedConnectors[e].beginItem},e.prototype.getParentItemKey=function(t){var e=this.getParentItem(t);return e&&e.dataKey},e.prototype.getNodeArray=function(t){var e;return this.useNodeItems&&t.parentDataObj?e=this.nodeDataImporter.getItems(t.parentDataObj):t.containerDataObj&&(e=this.nodeDataImporter.getChildren(t.containerDataObj)),e||this.nodeDataSource},e.prototype.getContainerShapeKey=function(t){return t.container&&t.container.dataKey},e.prototype.getChildItems=function(t){for(var e=[],n=0;n<t.attachedConnectors.length;n++)t.attachedConnectors[n].beginItem===t&&t.attachedConnectors[n].endItem&&e.push(t.attachedConnectors[n].endItem);return e},e.prototype.updateEdge=function(t,e){var n=this,o=e.beginItem?e.beginItem.dataKey:void 0,i=e.endItem?e.endItem.dataKey:void 0,r=this.findEdge(e.dataKey);if(r)this.isEdgeObjectModified(e,r,t.units)&&(this.updateEdgeObjectProperties(e,r,t.units),r.dataObj&&(this.beginChangesNotification(),this.changesListener.notifyEdgeUpdated.call(this.changesListener,this.edgeDataImporter.getKey(r.dataObj)||r.key,r.dataObj,(function(t,e){n.endChangesNotification()}),(function(t){n.endChangesNotification()}))));else{var a=this.useEdgesArray()&&this.canUpdateEdgeDataSource?{}:void 0;r=this.addEdgeInternal(a,o,i),a&&(this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setKey,a,r.key,this.addInternalKeyOnInsert),this.edgeDataSource.push(r.dataObj)),this.updateEdgeObjectProperties(e,r,t.units),this.updateEdgeObjectKey(e,r,r.dataObj),a&&(this.beginChangesNotification(),this.changesListener.notifyEdgeInserted.call(this.changesListener,r.dataObj,(function(t){n.updateEdgeObjectKey(e,r,t),n.endChangesNotification()}),(function(t){n.endChangesNotification()})))}},e.prototype.isEdgeObjectModified=function(t,e,n){return this.isItemObjectModified(t,e,this.edgeDataImporter)||e.from!==(t.beginItem?t.beginItem.dataKey:void 0)||e.to!==(t.endItem?t.endItem.dataKey:void 0)||this.edgeDataImporter.setFromPointIndex&&e.fromPointIndex!==t.beginConnectionPointIndex||this.edgeDataImporter.setToPointIndex&&e.toPointIndex!==t.endConnectionPointIndex||this.edgeDataImporter.setPoints&&(!e.points||!p.ListUtils.equalsByReference(e.points.map((function(t){return t.x})),t.points.map((function(t){return c.ModelUtils.getlUnitValue(n,t.x)})))||!p.ListUtils.equalsByReference(e.points.map((function(t){return t.y})),t.points.map((function(t){return c.ModelUtils.getlUnitValue(n,t.y)}))))||this.edgeDataImporter.setText&&!this.compareTexts(e,t)||this.edgeDataImporter.setLineOption&&e.lineOption!==t.properties.lineOption||this.edgeDataImporter.setStartLineEnding&&e.startLineEnding!==t.properties.startLineEnding||this.edgeDataImporter.setEndLineEnding&&e.endLineEnding!==t.properties.endLineEnding},e.prototype.updateEdgeObjectFromProperty=function(t,e,n){var o=this;if(e.from=t&&t.key,e.dataObj){var i=t&&t.dataObj&&this.nodeDataImporter.getKey(t.dataObj);this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setFrom,e.dataObj,i,!1),n&&(this.beginChangesNotification(),n.notifyEdgeUpdated.call(n,this.nodeDataImporter.getKey(e.dataObj)||e.key,e.dataObj,(function(t,e){o.endChangesNotification()}),(function(t){o.endChangesNotification()})))}},e.prototype.updateEdgeObjectToProperty=function(t,e,n){var o=this;if(e.to=t&&t.key,e.dataObj){var i=t&&t.dataObj&&this.nodeDataImporter.getKey(t.dataObj);this.setDataObjectKeyRelatedProperty(this.edgeDataImporter.setTo,e.dataObj,i,!1),n&&(this.beginChangesNotification(),n.notifyEdgeUpdated.call(n,this.nodeDataImporter.getKey(e.dataObj)||e.key,e.dataObj,(function(t,e){o.endChangesNotification()}),(function(t){o.endChangesNotification()})))}},e.prototype.updateEdgeObjectProperties=function(t,e,n){if(this.updateItemObjectProperties(e,t,this.edgeDataImporter),this.edgeDataImporter.setFrom){var o=this.findNode(t.beginItem&&t.beginItem.dataKey);this.updateEdgeObjectFromProperty(o,e)}if(this.edgeDataImporter.setTo){var i=this.findNode(t.endItem&&t.endItem.dataKey);this.updateEdgeObjectToProperty(i,e)}if(this.edgeDataImporter.setFromPointIndex&&(e.fromPointIndex=t.beginConnectionPointIndex,e.dataObj&&this.edgeDataImporter.setFromPointIndex(e.dataObj,t.beginConnectionPointIndex)),this.edgeDataImporter.setToPointIndex&&(e.toPointIndex=t.endConnectionPointIndex,e.dataObj&&this.edgeDataImporter.setToPointIndex(e.dataObj,t.endConnectionPointIndex)),this.edgeDataImporter.setPoints){var r=t.points.map((function(t){return{x:c.ModelUtils.getlUnitValue(n,t.x),y:c.ModelUtils.getlUnitValue(n,t.y)}}));e.points=r,e.dataObj&&this.edgeDataImporter.setPoints(e.dataObj,r)}if(this.edgeDataImporter.setText){var a=void 0;1===t.getTextCount()&&t.getText()&&(a=t.getText());var s={};if(t.texts.forEach((function(t){s[t.position]=t.value})),e.texts=s,e.dataObj){var u="";a?u=a:s&&Object.keys(s).length&&(u=s),this.edgeDataImporter.setText(e.dataObj,u)}}this.edgeDataImporter.setLineOption&&(e.lineOption=t.properties.lineOption,e.dataObj&&this.edgeDataImporter.setLineOption(e.dataObj,t.properties.lineOption)),this.edgeDataImporter.setStartLineEnding&&(e.startLineEnding=t.properties.startLineEnding,e.dataObj&&this.edgeDataImporter.setStartLineEnding(e.dataObj,t.properties.startLineEnding)),this.edgeDataImporter.setEndLineEnding&&(e.endLineEnding=t.properties.endLineEnding,e.dataObj&&this.edgeDataImporter.setEndLineEnding(e.dataObj,t.properties.endLineEnding))},e.prototype.updateEdgeObjectKey=function(t,e,n){var o=n&&this.edgeDataImporter.getKey(n);if(void 0!==o&&null!==o&&o!==e.key&&(delete this.autoGeneratedDataKeys[e.key],e.key=o),t.dataKey=e.key,e.dataObj!==n){var i=this.edgeDataSource,r=i.indexOf(e.dataObj);i.splice(r,1,n),e.dataObj=n}},e.prototype.deleteEdges=function(t){var e=this;this.deleteItems(this.edges,(function(e){return t.findConnectorByDataKey(e)}),(function(t){return e.edgeDataSource}),(function(t,n){var o=t.dataObj&&e.edgeDataImporter.getKey(t.dataObj)||t.key,i=e.findEdge(o);i&&e.edges.splice(e.edges.indexOf(i),1),n&&(e.beginChangesNotification(),e.changesListener.notifyEdgeRemoved.call(e.changesListener,o,t.dataObj,(function(t,n){e.endChangesNotification()}),(function(t){e.endChangesNotification()})))}))},e.prototype.beginChangesNotification=function(){this.isChangesLocked()||this.changesLockChanged&&this.changesLockChanged(!0),this.updateLockCount++},e.prototype.endChangesNotification=function(t){var e=this;this.updateLockCount--,this.isChangesLocked()||(this.changesLockChanged&&this.changesLockChanged(!1),t||setTimeout((function(){return e.changesListener.notifyDataChangesProcessed()}),1))},e.prototype.isChangesLocked=function(){return this.updateLockCount>0},e}(s.DataSource);e.DocumentDataSource=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataSource=void 0;var o=n(11),i=n(1),r=n(2),a=n(48),s=n(61),c=n(51),u=n(62),l=n(118),p=n(87),h=n(64),d=n(346),f=n(119),m=n(148),g=n(156),y=n(101),v=n(88),C=n(65),_=n(6),P=n(9),S=n(0),b=n(43),x=n(3),w=n(23),I=n(44),T=n(111),O=n(59),E=n(347),M=n(348),D=function(){function t(t,e,n,o,i,r){if(this.key=t,this.nodes=[],this.edges=[],this.autoGeneratedDataKeys={},this.addInternalKeyOnInsert=!1,this.useNodeParentId=!1,this.useNodeContainerId=!1,this.useNodeChildren=!1,this.useNodeItems=!1,this.canUseAutoSize=!1,this.canUpdateEdgeDataSource=!1,this.containers=null,void 0===t||null===t)throw new Error("DataSource key must be specified");this.key=t.toString(),this.loadParameters(o||{}),this.nodeDataImporter=this.createNodeDataImporter(i),this.edgeDataImporter=this.createEdgeDataImporter(r),this.nodeDataSource=e||[],this.edgeDataSource=n||[],this.canUpdateEdgeDataSource=!!n,this.fetchData()}return t.prototype.loadParameters=function(t){this.addInternalKeyOnInsert=!!t.addInternalKeyOnInsert},t.prototype.isAutoGeneratedKey=function(t){return t&&!!this.autoGeneratedDataKeys[t]},t.prototype.createNodeDataImporter=function(t){var e=new E.DataSourceNodeDataImporter;return t&&this.assignNodeDataImporterProperties(t,e),e},t.prototype.createEdgeDataImporter=function(t){var e=new E.DataSourceEdgeDataImporter;return t&&this.assignEdgeDataImporterProperties(t,e),e},t.prototype.assignItemDataImporterProperties=function(t,e){t.getKey&&(e.getKey=t.getKey),t.setKey&&(e.setKey=t.setKey),t.getCustomData&&(e.getCustomData=t.getCustomData),t.setCustomData&&(e.setCustomData=t.setCustomData),t.getLocked&&(e.getLocked=t.getLocked),t.setLocked&&(e.setLocked=t.setLocked),t.getStyle&&(e.getStyle=t.getStyle),t.setStyle&&(e.setStyle=t.setStyle),t.getStyleText&&(e.getStyleText=t.getStyleText),t.setStyleText&&(e.setStyleText=t.setStyleText),t.getZIndex&&(e.getZIndex=t.getZIndex),t.setZIndex&&(e.setZIndex=t.setZIndex)},t.prototype.assignNodeDataImporterProperties=function(t,e){this.assignItemDataImporterProperties(t,e),t.getType&&(e.getType=t.getType),t.setType&&(e.setType=t.setType),t.getImage&&(e.getImage=t.getImage),t.setImage&&(e.setImage=t.setImage),t.getText&&(e.getText=t.getText),t.setText&&(e.setText=t.setText),t.getLeft&&(e.getLeft=t.getLeft),t.setLeft&&(e.setLeft=t.setLeft),t.getTop&&(e.getTop=t.getTop),t.setTop&&(e.setTop=t.setTop),t.getWidth&&(e.getWidth=t.getWidth),t.setWidth&&(e.setWidth=t.setWidth),t.getHeight&&(e.getHeight=t.getHeight),t.setHeight&&(e.setHeight=t.setHeight),t.getChildren&&(e.getChildren=t.getChildren),t.setChildren&&(e.setChildren=t.setChildren),t.getParentKey&&(e.getParentKey=t.getParentKey),t.setParentKey&&(e.setParentKey=t.setParentKey),t.getItems&&(e.getItems=t.getItems),t.setItems&&(e.setItems=t.setItems),t.getContainerKey&&(e.getContainerKey=t.getContainerKey),t.setContainerKey&&(e.setContainerKey=t.setContainerKey)},t.prototype.assignEdgeDataImporterProperties=function(t,e){this.assignItemDataImporterProperties(t,e),t.getFrom&&(e.getFrom=t.getFrom),t.setFrom&&(e.setFrom=t.setFrom),t.getFromPointIndex&&(e.getFromPointIndex=t.getFromPointIndex),t.setFromPointIndex&&(e.setFromPointIndex=t.setFromPointIndex),t.getTo&&(e.getTo=t.getTo),t.setTo&&(e.setTo=t.setTo),t.getToPointIndex&&(e.getToPointIndex=t.getToPointIndex),t.setToPointIndex&&(e.setToPointIndex=t.setToPointIndex),t.getPoints&&(e.getPoints=t.getPoints),t.setPoints&&(e.setPoints=t.setPoints),t.getText&&(e.getText=t.getText),t.setText&&(e.setText=t.setText),t.getLineOption&&(e.getLineOption=t.getLineOption),t.setLineOption&&(e.setLineOption=t.setLineOption),t.getStartLineEnding&&(e.getStartLineEnding=t.getStartLineEnding),t.setStartLineEnding&&(e.setStartLineEnding=t.setStartLineEnding),t.getEndLineEnding&&(e.getEndLineEnding=t.getEndLineEnding),t.setEndLineEnding&&(e.setEndLineEnding=t.setEndLineEnding)},t.prototype.fetchData=function(){var t=this;if(this.nodes=[],this.edges=[],this.autoGeneratedDataKeys={},this.useNodeParentId=void 0!==this.nodeDataImporter.getParentKey,this.useNodeContainerId=void 0!==this.nodeDataImporter.getContainerKey,this.useNodeItems=void 0!==this.nodeDataImporter.getItems,this.useNodeChildren=void 0!==this.nodeDataImporter.getChildren,this.canUseAutoSize=void 0===this.nodeDataImporter.getWidth&&void 0!==this.nodeDataImporter.getText,this.useEdgesArray()&&this.useNodeParentId)throw new Error("You cannot use edges array and parentKey simultaneously.");if(this.useEdgesArray()&&this.useNodeItems)throw new Error("You cannot use edges array and items array simultaneously.");if(this.useNodeParentId&&this.useNodeItems)throw new Error("You cannot use parentKey and items array simultaneously.");if(this.useNodeContainerId&&this.useNodeChildren)throw new Error("You cannot use containerKey and children array simultaneously.");this.nodeDataSource.forEach((function(e){t.addNode(e)})),this.useEdgesArray()?this.edgeDataSource.forEach((function(e){t.addEdge(e)})):this.nodes.forEach((function(e){t.addNodeEdgesByParentId(e)}))},t.prototype.isContainer=function(t){var e=this;return!this.containers&&this.useNodeContainerId&&(this.containers=this.nodeDataSource.map((function(t){return e.nodeDataImporter.getContainerKey(t)})).filter((function(t){return void 0!==t&&null!==t})).reduce((function(t,e){return t[e]=!0,t}),{})),this.containers&&this.containers[t]},t.prototype.refetchData=function(t,e){var n=this;this.nodeDataSource=t||this.nodeDataSource,this.edgeDataSource=e||this.edgeDataSource;var o=this.nodes.slice(),i=this.edges.slice();this.fetchData();var r=this.getItemChanges(o,this.nodes,(function(t,e){return t.key===e.key||t.dataObj===e.dataObj})),a=this.getItemChanges(i,this.edges,(function(t,e){return n.useNodeParentId||n.useNodeItems?t.key===e.key||t.from===e.from&&t.to===e.to:t.key===e.key||t.dataObj===e.dataObj}));return{nodes:r,edges:a}},t.prototype.getItemChanges=function(t,e,n){var o=this,i=t.filter((function(t){return o.containsItem(e,t,n)})),r=e.filter((function(e){return o.containsItem(t,e,n)})),a=t.filter((function(t){return!o.containsItem(e,t,n)})),s=e.filter((function(e){return!o.containsItem(t,e,n)}));return{remained:i.map((function(t){return t.key})),remainedNew:r.map((function(t){return t.key})),removed:a.map((function(t){return t.key})),added:s.map((function(t){return t.key}))}},t.prototype.containsItem=function(t,e,n){var o=!1;return t.forEach((function(t){!o&&n(t,e)&&(o=!0)})),o},t.prototype.useEdgesArray=function(){return Array.isArray(this.edgeDataSource)&&(this.edgeDataSource.length||!(this.useNodeParentId||this.useNodeItems))},t.prototype.addNode=function(t,e,n,o){var i=this,r=this.nodeDataImporter.getChildren&&this.nodeDataImporter.getChildren(t),a=r&&Array.isArray(r)&&r.length,s=a||this.isContainer(this.nodeDataImporter.getKey(t)),c=this.nodeDataImporter.getType&&this.nodeDataImporter.getType(t)||s&&S.ShapeTypes.VerticalContainer||S.ShapeTypes.Rectangle,u=this.nodeDataImporter.getText&&(this.nodeDataImporter.getText(t)||""),l=this.addNodeInternal(t,c,u,e,n,o);if(this.assignNodeProperties(l,t),a&&r.forEach((function(e){i.addNode(e,void 0,l.key,t)})),this.useNodeItems){var p=this.nodeDataImporter.getItems(t);Array.isArray(p)&&p.length&&p.forEach((function(e){var r=i.addNode(e,t,n,o);i.addEdgeInternal(void 0,l.key,r.key)}))}return l},t.prototype.addNodeEdgesByParentId=function(t){if(this.useNodeParentId){var e=this.nodeDataImporter.getParentKey(t.dataObj);if(void 0!==e&&null!==e){var n=this.findNode(e);n&&this.addEdgeInternal(void 0,this.getNodeKey(t.dataObj,this.nodeDataImporter.getParentKey),this.getNodeKey(t.dataObj,this.nodeDataImporter.getKey))}}},t.prototype.addNodeInternal=function(t,e,n,o,i,r){var a=this.nodeDataImporter.getKey(t),s=void 0!==a&&null!==a?a:P.ModelUtils.getGuidItemKey(),c=new M.DataSourceNodeItem(this.key,s,t,e,n,o,i,r);return this.nodes.push(c),void 0!==a&&null!==a||(a=s,this.autoGeneratedDataKeys[s]=!0),c},t.prototype.addEdge=function(t){var e=this.addEdgeInternal(t,this.getNodeKey(t,this.edgeDataImporter.getFrom),this.getNodeKey(t,this.edgeDataImporter.getTo));return this.assignEdgeProperties(e,t),e},t.prototype.addEdgeInternal=function(t,e,n){var o=t&&this.edgeDataImporter.getKey(t),i=void 0!==o&&null!==o?o:P.ModelUtils.getGuidItemKey(),r=new M.DataSourceEdgeItem(this.key,i,t,e,n);return this.edges.push(r),void 0!==o&&null!==o||(o=i,this.autoGeneratedDataKeys[i]=!0),r},t.prototype.assignItemProperties=function(t,e,n){if(n.getCustomData&&(t.customData=x.ObjectUtils.cloneObject(n.getCustomData(e))),n.getLocked&&(t.locked=n.getLocked(e)),n.getStyle){var o=n.getStyle(e);t.style="string"===typeof o?I.Data.cssTextToObject(o):o}if(n.getStyleText){o=n.getStyleText(e);t.styleText="string"===typeof o?I.Data.cssTextToObject(o):o}n.getZIndex&&(t.zIndex=n.getZIndex(e))},t.prototype.assignNodeProperties=function(t,e){this.assignItemProperties(t,e,this.nodeDataImporter),this.nodeDataImporter.getImage&&(t.image=this.nodeDataImporter.getImage(e)),this.nodeDataImporter.getLeft&&(t.left=this.nodeDataImporter.getLeft(e)),this.nodeDataImporter.getTop&&(t.top=this.nodeDataImporter.getTop(e)),this.nodeDataImporter.getWidth&&(t.width=this.nodeDataImporter.getWidth(e)),this.nodeDataImporter.getHeight&&(t.height=this.nodeDataImporter.getHeight(e)),this.nodeDataImporter.getContainerKey&&(t.containerKey=this.nodeDataImporter.getContainerKey(e))},t.prototype.assignEdgeProperties=function(t,e){if(this.assignItemProperties(t,e,this.edgeDataImporter),this.edgeDataImporter.getFromPointIndex&&(t.fromPointIndex=this.edgeDataImporter.getFromPointIndex(e)),this.edgeDataImporter.getToPointIndex&&(t.toPointIndex=this.edgeDataImporter.getToPointIndex(e)),this.edgeDataImporter.getPoints&&(t.points=this.edgeDataImporter.getPoints(e)),this.edgeDataImporter.getText){var n=this.edgeDataImporter.getText(e);if(t.texts={},"object"===typeof n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var i=parseFloat(o),r=n[o];isNaN(i)||"string"!==typeof r||""===r||(i=Math.min(1,Math.max(0,i)),t.texts[i]=r)}}else"string"===typeof n&&""!==n&&(t.texts[_.CONNECTOR_DEFAULT_TEXT_POSITION]=n)}this.edgeDataImporter.getLineOption&&(t.lineOption=this.edgeDataImporter.getLineOption(e)),this.edgeDataImporter.getStartLineEnding&&(t.startLineEnding=this.edgeDataImporter.getStartLineEnding(e)),this.edgeDataImporter.getEndLineEnding&&(t.endLineEnding=this.edgeDataImporter.getEndLineEnding(e))},t.prototype.findNode=function(t){return this.nodes.filter((function(e){return void 0!==t&&e.key===t}))[0]},t.prototype.findEdge=function(t){return this.edges.filter((function(e){return void 0!==t&&e.key===t}))[0]},t.prototype.getNodeKey=function(t,e){return e(t)},t.prototype.createModelItems=function(t,e,n,o,r,a,s,c){var u=this;this.beginChangesNotification(),t.clear(),t.beginTransaction(),P.ModelUtils.deleteAllItems(t,e,o),e.initializeKeyCounter();var l=2e3,p=0,h=0,d={},f=[],m=[];this.nodes.forEach((function(m){var g=new i.Point(h++*l,p*l),y=u.createShapeByNode(t,e,o,n,m,g,r,a,s,c);void 0!==m.key&&(d[m.key]=y.key),h>4&&(h=0,p++),f.push(y)})),this.nodes.forEach((function(n){if(void 0!==n.containerKey&&null!==n.containerKey){var o=d[n.key],i=e.findShape(o),r=d[n.containerKey],a=e.findShape(r);a&&P.ModelUtils.insertToContainer(t,e,i,a)}})),this.edges.forEach((function(n){var i=e.findShape(d[n.to]),r=e.findShape(d[n.from]),a=u.createConnectorByEdge(t,e,o,n,r,i);a&&(m.push(a),P.ModelUtils.updateConnectorContainer(t,e,a))})),r.needAutoLayout&&this.applyLayout(t,e,f,m,r,a,s),P.ModelUtils.tryUpdateModelSize(t,e),t.endTransaction(!0),this.endChangesNotification(!0)},t.prototype.updateModelItems=function(t,e,n,o,r,a,s,c,u,l,p,h){var d=this;this.beginChangesNotification(),t.beginTransaction();var f=[],m=[],g=[],y=u.nodes.removed.map((function(t){return e.findShapeByDataKey(t)})).filter((function(t){return t}));y.forEach((function(t){t.attachedConnectors.forEach((function(e){e.beginItem&&e.beginItem!==t&&m.push(e.beginItem),e.endItem&&e.endItem!==t&&m.push(e.endItem)}))})),P.ModelUtils.deleteItems(t,e,o,y,!0);var v=u.edges.removed.map((function(t){return e.findConnectorByDataKey(t)})).filter((function(t){return t}));v.forEach((function(t){t.beginItem&&m.push(t.beginItem),t.endItem&&m.push(t.endItem)})),P.ModelUtils.deleteItems(t,e,o,v,!0);var C=s||[];C.forEach((function(a){if(-1!==u.nodes.remained.indexOf(a)){var s=d.findNode(a);if(s){var c=e.findShapeByDataKey(a);c?(d.changeShapeByDataItem(t,e,c,s,c.position),d.changeItemByDataItem(t,c,s)):c=d.createShapeByNode(t,e,o,n,s,new i.Point(0,0),r,l,p,h),d.updateShapeContainer(t,e,c,s),m.push(c),f.push(c)}}})),u.nodes.remained.forEach((function(t,n){var o=e.findShapeByDataKey(t);o&&(o.dataKey=u.nodes.remainedNew[n])}));var _=s||[];_.forEach((function(n){if(-1!==u.edges.remained.indexOf(n)){var i=d.findEdge(n);if(i){var r=e.findShapeByDataKey(i.from),a=e.findShapeByDataKey(i.to),s=e.findConnectorByDataKey(n);s?(d.changeConnectorPointsByDataItem(t,e,s,r,a,i),d.changeConnectorByDataItem(t,e,s,r,a,i),d.changeItemByDataItem(t,s,i)):s=d.createConnectorByEdge(t,e,o,i,r,a),P.ModelUtils.updateConnectorContainer(t,e,s),g.push(s),f.push(s)}}})),u.edges.remained.forEach((function(t,n){var o=e.findConnectorByDataKey(t);o&&(o.dataKey=u.edges.remainedNew[n])})),f.length&&c&&f.forEach((function(t){t.hasTemplate&&c(t)})),u.nodes.added.forEach((function(a){var s=d.findNode(a),c=d.createShapeByNode(t,e,o,n,s,new i.Point(0,0),r,l,p,h);d.updateShapeContainer(t,e,c,s),m.push(c)})),u.edges.added.forEach((function(n){var i=d.findEdge(n),r=e.findShapeByDataKey(i.from),a=e.findShapeByDataKey(i.to),s=d.createConnectorByEdge(t,e,o,i,r,a);s&&(P.ModelUtils.updateConnectorContainer(t,e,s),g.push(s))})),r.needAutoLayout&&(m.length||g.length)&&this.applyLayout(t,e,m,g,r,l,p),P.ModelUtils.tryUpdateModelSize(t,e),t.endTransaction(!a),this.endChangesNotification(!0)},t.prototype.applyShapeAutoSize=function(t,e,n,i,a,s){if(i.description.enableText){var c=i.textRectangle.createSize(),u=i.size,p=c.width-u.width,h=c.height-u.height,d=i.getMaxWidth(n.shapeMaxWidth),f=i.getMaxHeight(n.shapeMaxHeight),m=function(t,e){return"number"===typeof t?o.UnitConverter.twipsToPixelsF(t+(e?p:h)):void 0},g=O.getOptimalTextRectangle(i.text,i.styleText,b.TextOwner.Shape,e,c.clone().applyConverter(o.UnitConverter.twipsToPixelsF),i.description.keepRatioOnAutoSize,m(i.getMinWidth(n.shapeMinWidth),!0),m(d,!0),m(i.getMinHeight(n.shapeMinHeight),!1),m(f,!1)).clone().applyConverter(o.UnitConverter.pixelsToTwips);if(!g.equals(c)){var y=i.description.getSizeByText(g,i);a&&s&&(y=new r.Size(Math.min(s*Math.ceil(y.width/s),d||Number.MAX_VALUE),Math.min(s*Math.ceil(y.height/s),f||Number.MAX_VALUE))),t.addAndRedo(new l.ResizeShapeHistoryItem(i.key,i.position,y))}}},t.prototype.applyLayout=function(t,e,n,o,i,r,a){var s=P.ModelUtils.getGraphInfoByItems(e,n,o);s.forEach((function(s){var c=i.getLayoutBuilder(s.graph).build(),u=P.ModelUtils.getNonGraphItems(e,s.container,c.nodeToLayout,n,o);P.ModelUtils.applyLayout(t,e,s.container,s.graph,c,u,i.layoutSettings,r,a,i.skipPointIndices)}))},t.prototype.changeItemByDataItem=function(t,e,n){if(void 0===n.customData||x.ObjectUtils.compareObjects(n.customData,e.customData)||t.addAndRedo(new d.ChangeCustomDataHistoryItem(e,n.customData)),void 0!==n.zIndex&&n.zIndex!==e.zIndex&&t.addAndRedo(new y.ChangeZindexHistoryItem(e,n.zIndex)),void 0!==n.style)for(var o in n.style)if(Object.prototype.hasOwnProperty.call(n.style,o)){var i=T.isColorProperty(o)?w.ColorUtils.stringToHash(n.style[o]):n.style[o];i!==e.style[o]&&t.addAndRedo(new v.ChangeStyleHistoryItem(e.key,o,i))}if(void 0!==n.styleText)for(var o in n.styleText)if(Object.prototype.hasOwnProperty.call(n.styleText,o)){i=T.isColorProperty(o)?w.ColorUtils.stringToHash(n.styleText[o]):n.styleText[o];i!==e.styleText[o]&&t.addAndRedo(new C.ChangeStyleTextHistoryItem(e.key,o,i))}void 0!==n.locked&&n.locked!==e.locked&&t.addAndRedo(new f.ChangeLockedHistoryItem(e,n.locked))},t.prototype.createShapeByNode=function(t,e,n,o,i,r,a,s,u,l){var p=new c.AddShapeHistoryItem(o.get(i.type),r,"",i.key);t.addAndRedo(p);var h=e.findShape(p.shapeKey);return P.ModelUtils.updateNewShapeProperties(t,n,p.shapeKey),this.changeShapeByDataItem(t,e,h,i,r),this.changeItemByDataItem(t,h,i),l&&this.canUseAutoSize&&a.autoSizeEnabled&&this.applyShapeAutoSize(t,l,a.sizeSettings,h,s,u),h},t.prototype.changeShapeByDataItem=function(t,e,n,o,i){void 0!==o.left&&(i.x=P.ModelUtils.getTwipsValue(e.units,o.left)),void 0!==o.top&&(i.y=P.ModelUtils.getTwipsValue(e.units,o.top)),P.ModelUtils.setShapePosition(t,e,n,i);var r=n.size.clone();void 0!==o.width&&(r.width=P.ModelUtils.getTwipsValue(e.units,o.width)),void 0!==o.height&&(r.height=P.ModelUtils.getTwipsValue(e.units,o.height)),P.ModelUtils.setShapeSize(t,e,n,i,r),void 0!==o.text&&o.text!==n.text&&t.addAndRedo(new g.ChangeShapeTextHistoryItem(n,o.text)),void 0!==o.image&&o.image!==n.image.actualUrl&&t.addAndRedo(new m.ChangeShapeImageHistoryItem(n,o.image))},t.prototype.updateShapeContainer=function(t,e,n,o){var i=void 0!==o.containerKey?e.findShapeByDataKey(o.containerKey):void 0;i!==n.container&&(i?P.ModelUtils.insertToContainer(t,e,n,i):P.ModelUtils.removeFromContainer(t,e,n))},t.prototype.getConnectorPointsByEdge=function(t,e,n,o){var r=[];return Array.isArray(e.points)&&e.points.length>1?r=e.points.map((function(e){if(void 0!==e.x&&void 0!==e.y)return new i.Point(P.ModelUtils.getTwipsValue(t.units,e.x),P.ModelUtils.getTwipsValue(t.units,e.y))})).filter((function(t){return t})):(n&&r.push(n.position.clone()),o&&r.push(o.position.clone())),r},t.prototype.createConnectorByEdge=function(t,e,n,o,i,r){var a,c=o.key,u=this.getConnectorPointsByEdge(e,o,i,r);if(u.length>1){var l=new s.AddConnectorHistoryItem(u,c);t.addAndRedo(l),a=e.findConnector(l.connectorKey),P.ModelUtils.updateNewConnectorProperties(t,n,l.connectorKey),this.changeConnectorByDataItem(t,e,a,i,r,o),this.changeItemByDataItem(t,a,o)}return a},t.prototype.changeConnectorByDataItem=function(t,e,n,o,i,r){var s=void 0!==r.fromPointIndex?r.fromPointIndex:n.beginConnectionPointIndex;n.beginItem===o&&n.beginConnectionPointIndex===s||(n.beginItem&&t.addAndRedo(new u.DeleteConnectionHistoryItem(n,_.ConnectorPosition.Begin)),o&&t.addAndRedo(new a.AddConnectionHistoryItem(n,o,s,_.ConnectorPosition.Begin)));var c=void 0!==r.toPointIndex?r.toPointIndex:n.endConnectionPointIndex;if(n.endItem===i&&n.endConnectionPointIndex===c||(n.endItem&&t.addAndRedo(new u.DeleteConnectionHistoryItem(n,_.ConnectorPosition.End)),i&&t.addAndRedo(new a.AddConnectionHistoryItem(n,i,c,_.ConnectorPosition.End))),P.ModelUtils.updateConnectorAttachedPoints(t,e,n),void 0!==r.texts&&!this.compareTexts(r,n))for(var l in n.texts.forEach((function(e){t.addAndRedo(new h.ChangeConnectorTextHistoryItem(n,e.position,void 0))})),r.texts)if(Object.prototype.hasOwnProperty.call(r.texts,l)){var d=parseFloat(l);t.addAndRedo(new h.ChangeConnectorTextHistoryItem(n,d,r.texts[l]))}void 0!==r.lineOption&&r.lineOption!==n.properties.lineOption&&t.addAndRedo(new p.ChangeConnectorPropertyHistoryItem(n.key,"lineOption",r.lineOption)),void 0!==r.startLineEnding&&r.startLineEnding!==n.properties.startLineEnding&&t.addAndRedo(new p.ChangeConnectorPropertyHistoryItem(n.key,"startLineEnding",r.startLineEnding)),void 0!==r.endLineEnding&&r.endLineEnding!==n.properties.endLineEnding&&t.addAndRedo(new p.ChangeConnectorPropertyHistoryItem(n.key,"endLineEnding",r.endLineEnding))},t.prototype.changeConnectorPointsByDataItem=function(t,e,n,o,i,r){var a=this.getConnectorPointsByEdge(e,r,o,i);a.length<=1||a.join(",")!==n.points.join(",")&&(P.ModelUtils.deleteConnectorPoints(t,n),a.forEach((function(e,o){return P.ModelUtils.addConnectorPoint(t,n,o,e)})))},t.prototype.compareTexts=function(t,e){var n=t.texts||{},o=Object.keys(n).length===e.getTextCount();if(o)for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=parseFloat(i);this.compareStrings(e.getText(r),n[i])||(o=!1)}return o},t.prototype.compareStrings=function(t,e){return"string"===typeof t&&"string"===typeof e?t===e:this.isEmptyString(t)&&this.isEmptyString(e)},t.prototype.isEmptyString=function(t){return""===t||null===t||void 0===t},t}();e.DataSource=D},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeCustomDataHistoryItem=void 0;var i=n(5),r=n(3),a=function(t){function e(e,n){var o=t.call(this)||this;return o.itemKey=e.key,o.customData=r.ObjectUtils.cloneObject(n),o}return o(e,t),e.prototype.redo=function(t){var e=t.model.findItem(this.itemKey);this.oldCustomData=r.ObjectUtils.cloneObject(e.customData),t.changeCustomData(e,this.customData)},e.prototype.undo=function(t){var e=t.model.findItem(this.itemKey);t.changeCustomData(e,this.oldCustomData)},e}(i.HistoryItem);e.ChangeCustomDataHistoryItem=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DataSourceEdgeDataImporter=e.DataSourceNodeDataImporter=e.DataSourceItemDataImporter=void 0;var i=function(){function t(){this.getKey=function(t){return t["id"]},this.setKey=function(t,e){t["id"]=e},this.getCustomData=void 0,this.setCustomData=void 0,this.getLocked=void 0,this.setLocked=void 0,this.getStyle=void 0,this.setStyle=void 0,this.getStyleText=void 0,this.setStyleText=void 0,this.getZIndex=void 0,this.setZIndex=void 0}return t}();e.DataSourceItemDataImporter=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getType=void 0,e.setType=void 0,e.getText=void 0,e.setText=void 0,e.getImage=void 0,e.setImage=void 0,e.getLeft=void 0,e.setLeft=void 0,e.getTop=void 0,e.setTop=void 0,e.getWidth=void 0,e.setWidth=void 0,e.getHeight=void 0,e.setHeight=void 0,e.getChildren=void 0,e.setChildren=void 0,e.getParentKey=void 0,e.setParentKey=void 0,e.getItems=void 0,e.setItems=void 0,e.getContainerKey=void 0,e.setContainerKey=void 0,e}return o(e,t),e}(i);e.DataSourceNodeDataImporter=r;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.getFrom=function(t){return t["from"]},e.setFrom=function(t,e){t["from"]=e},e.getFromPointIndex=void 0,e.setFromPointIndex=void 0,e.getTo=function(t){return t["to"]},e.setTo=function(t,e){t["to"]=e},e.getToPointIndex=void 0,e.setToPointIndex=void 0,e.getPoints=void 0,e.setPoints=void 0,e.getText=void 0,e.setText=void 0,e.getLineOption=void 0,e.setLineOption=void 0,e.getStartLineEnding=void 0,e.setStartLineEnding=void 0,e.getEndLineEnding=void 0,e.setEndLineEnding=void 0,e}return o(e,t),e}(i);e.DataSourceEdgeDataImporter=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DataSourceEdgeItem=e.DataSourceNodeItem=e.DataSourceItem=void 0;var i=n(6),r=function(){function t(t,e,n){this.sourceKey=t,this.key=e,this.dataObj=n}return t}();e.DataSourceItem=r;var a=function(t){function e(e,n,o,i,r,a,s,c){var u=t.call(this,e,n,o)||this;return u.type=i,u.text=r,u.parentDataObj=a,u.containerKey=s,u.containerDataObj=c,u}return o(e,t),e}(r);e.DataSourceNodeItem=a;var s=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;return a.sourceKey=e,a.from=i,a.to=r,a}return o(e,t),Object.defineProperty(e.prototype,"text",{get:function(){return this.texts&&this.texts[i.CONNECTOR_DEFAULT_TEXT_POSITION]},enumerable:!1,configurable:!0}),e}(r);e.DataSourceEdgeItem=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewController=void 0;var o=n(80),i=Math.log(.05),r=Math.log(3),a=40,s=p(1),c=[o.DiagramCommand.ZoomLevel,o.DiagramCommand.ZoomLevelInPercentage,o.DiagramCommand.Zoom100,o.DiagramCommand.Zoom125,o.DiagramCommand.Zoom200,o.DiagramCommand.Zoom25,o.DiagramCommand.Zoom50,o.DiagramCommand.Zoom75],u=[o.DiagramCommand.SwitchAutoZoom,o.DiagramCommand.ToggleAutoZoom,o.DiagramCommand.AutoZoomToContent,o.DiagramCommand.AutoZoomToWidth],l=function(){function t(t,e){this.settings=t,this.bars=e,t.onZoomChanged.add(this),this.autoZoom=t.autoZoom}return t.prototype.initialize=function(t){this.view=t,this.view.onViewChanged.add(this)},t.prototype.scrollTo=function(t,e){this.view&&this.view.setScrollTo(t,e)},t.prototype.scrollBy=function(t){return!this.view||0===t.x&&0===t.y?t:this.view.scrollBy(t)},t.prototype.scrollIntoView=function(t){this.view&&this.view.scrollIntoView(t)},t.prototype.normalize=function(){this.view.tryNormalizePaddings()},t.prototype.getNextStepZoom=function(t){var e=this.getNearestCurrentZoomStep(),n=t?1:-1,o=Math.min(a-1,Math.max(0,e+n));if(o!==s){var c=i+(r-i)*o/(a-1);return Math.exp(c)}return 1},t.prototype.getNearestCurrentZoomStep=function(){var t=this.getZoom();return p(t)},t.prototype.getZoom=function(){return this.view?this.view.actualZoom:this.settings.zoomLevel},t.prototype.resetScroll=function(){this.view.adjust({horizontal:!0,vertical:!0})},t.prototype.notifyViewAdjusted=function(t){},t.prototype.notifyActualZoomChanged=function(t){this.bars.updateItemsState(c)},t.prototype.notifyZoomChanged=function(t,e){this.autoZoom!==e&&(this.autoZoom=e,this.bars.updateItemsState(u))},t}();function p(t){var e=Math.log(t);return Math.round((e-i)*(a-1)/(r-i))}e.ViewController=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToolboxManager=void 0;var o=n(351),i=n(352),r=n(75),a=n(40),s=function(){function t(t){this.shapeDescriptionManager=t,this.toolboxes=[],this.measurers={}}return t.prototype.create=function(t,e,n,r,a,s,c){var u=Array.isArray(a)?a:this.shapeDescriptionManager.getTypesByCategory(a),l=r?new o.TextToolbox(t,e,n,this.shapeDescriptionManager,u,s):new i.IconToolbox(t,e,n,this.shapeDescriptionManager,u,s,c,this.getOrCreateMeasurer(t));return l.render(),this.toolboxes.push(l),l},t.prototype.clean=function(t,e){if(e)e.clean(t),this.toolboxes.splice(this.toolboxes.indexOf(e),1);else{for(var n=0;n<this.toolboxes.length;n++)this.toolboxes[n].clean(t);this.toolboxes=[]}},t.prototype.refresh=function(t){this.toolboxes.forEach((function(e,n){(!t||Array.isArray(t)&&t.indexOf(n)>-1||n===t)&&e.render()}))},t.prototype.applyFilter=function(t,e){var n=this;return this.toolboxes.reduce((function(o,i,r){return(!e||Array.isArray(e)&&e.indexOf(r)>-1||r===e)&&i.render((function(e){return n.searchFilter(e,t,r)}))&&o.push(r),o}),[])},t.prototype.searchFilter=function(t,e,n,o){if(!e||o&&-1===o.indexOf(n))return!0;e=e.toLowerCase();var i=this.shapeDescriptionManager.get(t);return i.getTitle().toLowerCase().indexOf(e)>-1||i.getDefaultText().toLowerCase().indexOf(e)>-1},t.prototype.getOrCreateMeasurer=function(t){var e=t.getAttribute("data-dxdiMeasurerID");return e&&this.measurers[e]||(e=a.MathUtils.generateGuid(),this.measurers[e]=new r.TextMeasurer(t),t.setAttribute("data-dxdiMeasurerID",e)),this.measurers[e]},t}();e.ToolboxManager=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TextToolbox=void 0;var i=n(162),r=function(t){function e(e,n,o,i,r,a){return t.call(this,e,n,o,i,r,a)||this}return o(e,t),e.prototype.createElements=function(t,e){var n=this;e.forEach((function(e){var o=n.shapeDescriptionManager.get(e),i=document.createElement("div");i.setAttribute("class","toolbox-text-item"),i.setAttribute("data-tb-type",e),i.innerHTML=o.getDefaultText()||o.getTitle(),t.appendChild(i)}))},e.prototype.createDraggingElement=function(t){var e=document.createElement("DIV");e.setAttribute("class","dxdi-toolbox-drag-text-item");var n=this.shapeDescriptionManager.get(t.evt.data);return e.innerHTML=n.getDefaultText()||n.getTitle(),document.body.appendChild(e),e},e}(i.Toolbox);e.TextToolbox=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.IconToolbox=void 0;var i=n(162),r=n(15),a=n(14),s=n(11),c=n(1),u=n(123),l=n(29),p=n(128),h=n(22),d=32,f=26,m="T",g=function(t){function e(e,n,o,i,r,a,s,c){var u=t.call(this,e,n,o,i,r,a)||this;return u.options=s,u.measurer=c,u}return o(e,t),e.prototype.createElements=function(t,e){var n=document.createElementNS(r.svgNS,"svg");n.className.baseVal="dxdi-canvas",t.appendChild(n),this.drawShapeIcons(n,e,this.options.toolboxWidth||n.getBoundingClientRect().width)},e.prototype.drawShapeIcons=function(t,e,n){var o=this,i=l.DEFAULT_STROKE_WIDTH,r=n-2*i,a=this.options.shapeIconSize;!a&&this.options.shapeIconSpacing&&this.options.shapeIconCountInRow&&(a=Math.floor((r-(this.options.shapeIconCountInRow-1)*this.options.shapeIconSpacing)/this.options.shapeIconCountInRow)),a||(a=d),a=Math.max(a,this.options.shapeIconSpacing/2);var c=a,u=this.options.shapeIconCountInRow;if(!u){u=1;while(c<r)c+=this.options.shapeIconSpacing+a,c<r&&u++}var p=u>1?(r-a*u)/(u-1):0,h=i,m=i,g=s.UnitConverter.pixelsToTwips(a);e.forEach((function(e,n){n>0&&n%u===0&&(h=i,m+=a+p);var r=o.shapeDescriptionManager.get(e),c=o.createShape(r,h,m,a<f);o.updateShapeIconBounds(c,a);var l=o.drawShape(t,c);o.drawSelector(l,s.UnitConverter.pixelsToTwips(h),s.UnitConverter.pixelsToTwips(m),g),h+=a+p})),t.style.height=m+a+i+"px",t.style.width=n+"px"},e.prototype.drawShape=function(t,e){var n=this,o=e.description.createPrimitives(e,!0),i=document.createElementNS(r.svgNS,"g");if(i.setAttribute("data-tb-type",e.description.key.toString()),i.setAttribute("class","toolbox-item"),i.setAttribute("title",e.description.getTitle()),this.options.shapeIconAttributes)for(var a in this.options.shapeIconAttributes)Object.prototype.hasOwnProperty.call(this.options.shapeIconAttributes,a)&&i.setAttribute(a,this.options.shapeIconAttributes[a]);return t.appendChild(i),o.forEach((function(t){var e=t.createElement();i.appendChild(e),t.applyElementProperties(e,n.measurer)})),i},e.prototype.drawSelector=function(t,e,n,o){var i=new h.RectanglePrimitive(e,n,o,o,void 0,"selector"),r=i.createElement();i.applyElementProperties(r,this.measurer),t.appendChild(r)},e.prototype.createShape=function(t,e,n,o){var i=s.UnitConverter.pixelsToTwips(e),r=s.UnitConverter.pixelsToTwips(n),u=new a.Shape(t,new c.Point(i,r),!0);return this.needResetShapeText(t)?u.text="":o&&(u.text=m),u},e.prototype.needResetShapeText=function(t){return!(t instanceof u.TextShapeDescription)&&!(t instanceof p.CustomShapeDescription&&t.baseDescription instanceof u.TextShapeDescription)},e.prototype.updateShapeIconBounds=function(t,e){var n=s.UnitConverter.pixelsToTwips(e);if(t.size.height=t.size.width*t.getToolboxHeightToWidthRatio(),t.size.width>t.size.height){var o=t.size.height/t.size.width;t.size.width=n,t.size.height=n*o,t.position.y=t.position.y+(n-t.size.height)/2,t.parameters.forEach((function(e){e.value=e.value*n/t.description.defaultSize.width}))}else if(t.size.width<t.size.height){o=t.size.width/t.size.height;t.size.height=n,t.size.width=n*o,t.position.x=t.position.x+(n-t.size.width)/2,t.parameters.forEach((function(e){e.value=e.value*n/t.description.defaultSize.height}))}else t.size.width=n,t.size.height=n,t.parameters.forEach((function(e){e.value=e.value*n/t.description.defaultSize.width}))},e.prototype.createDraggingElement=function(t){var e=document.createElement("DIV");e.setAttribute("class","dxdi-toolbox-drag-item"),document.body.appendChild(e);var n=document.createElementNS(r.svgNS,"svg");n.className.baseVal="dxdi-canvas",e.appendChild(n);var o=this.shapeDescriptionManager.get(t.evt.data),i=this.createShape(o,l.DEFAULT_STROKE_WIDTH,l.DEFAULT_STROKE_WIDTH);return this.drawShape(n,i),e.style.width=s.UnitConverter.twipsToPixels(i.size.width)+2*l.DEFAULT_STROKE_WIDTH+"px",e.style.height=s.UnitConverter.twipsToPixels(i.size.height)+2*l.DEFAULT_STROKE_WIDTH+"px",e},e}(i.Toolbox);e.IconToolbox=g},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ApiController=void 0;var i,r=n(78),a=n(13),s=n(9),c=n(105),u=function(t){function e(e,n,o){var i=t.call(this)||this;return i.events=e,i.model=o,i.selection=n,i}return o(e,t),e.prototype.notifySelectionChanged=function(t){this.isUpdateLocked()?this.registerOccurredEvent(i.SelectionChanged):this.raiseSelectionChanged()},e.prototype.notifyToolboxDragStart=function(){this.events.raise("notifyToolboxItemDragStart")},e.prototype.notifyToolboxDragEnd=function(){this.events.raise("notifyToolboxItemDragEnd")},e.prototype.notifyClick=function(t){var e=this;this.tryRaiseUserAction(t,(function(t){return e.events.raise("notifyItemClick",t)}))},e.prototype.notifyDblClick=function(t){var e=this;this.tryRaiseUserAction(t,(function(t){return e.events.raise("notifyItemDblClick",t)}))},e.prototype.createNativeItem=function(t){return t&&this.cleanupNativeItem(t.toNative(this.model.units))},e.prototype.createNativeShape=function(t){return this.createNativeItem(t)},e.prototype.createNativeConnector=function(t){return this.createNativeItem(t)},e.prototype.convertUnit=function(t){return s.ModelUtils.getlUnitValue(this.model.units,t)},e.prototype.convertPoint=function(t){return new c.Point(this.convertUnit(t.x),this.convertUnit(t.y))},e.prototype.convertSize=function(t){return new c.Size(this.convertUnit(t.width),this.convertUnit(t.height))},e.prototype.cleanupNativeItem=function(t){var e=this.dataSource;return e&&(e.isAutoGeneratedKey(t.fromKey)&&(t.fromKey=void 0),e.isAutoGeneratedKey(t.key)&&(t.key=void 0),e.isAutoGeneratedKey(t.toKey)&&(t.toKey=void 0)),t},e.prototype.setDataSource=function(t){this.dataSource=t},e.prototype.tryRaiseUserAction=function(t,e){var n=this;if(this.isUserAction(t)){var o=this.model.findItem(t.source.key);o&&this.events.raise1((function(t){return e(n.createNativeItem(o))}))}},e.prototype.isUserAction=function(t){return t.source&&(t.source.type===a.MouseEventElementType.Shape||t.source.type===a.MouseEventElementType.ShapeExpandButton||t.source.type===a.MouseEventElementType.ShapeParameterBox||t.source.type===a.MouseEventElementType.ShapeResizeBox||t.source.type===a.MouseEventElementType.ShapeConnectionPoint||t.source.type===a.MouseEventElementType.Connector||t.source.type===a.MouseEventElementType.ConnectorPoint||t.source.type===a.MouseEventElementType.ConnectorSide||t.source.type===a.MouseEventElementType.ConnectorOrthogonalSide||t.source.type===a.MouseEventElementType.ConnectorText)},e.prototype.onUpdateUnlocked=function(t){t&i.SelectionChanged&&this.raiseSelectionChanged()},e.prototype.raiseSelectionChanged=function(){var t=this,e=this.selection.getKeys().map((function(e){return t.createNativeItem(t.model.findItem(e))}));this.events.raise1((function(t){return t.notifySelectionChanged(e)}))},e}(r.BatchUpdatableObject);e.ApiController=u,function(t){t[t["SelectionChanged"]=1]="SelectionChanged"}(i||(i={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PermissionsProvider=void 0;var o=n(14),i=n(3),r=n(16),a=n(6),s=n(355),c=n(356),u=n(357),l=n(358),p=n(359),h=n(360),d=n(361),f=n(362),m=n(363),g=n(364),y=n(365),v=n(366),C=n(367),_=function(){function t(t){this.onRequestOperation=new i.EventDispatcher,this.cache=[],this.permissionsLockCount=0,this.requestDeleteItems={},this.updateUICount=0,this.apiController=t,this.operationSettings=new r.ModelOperationSettings,this.storage=new y.PermissionsProviderStorage}return t.prototype.notifySelectionChanged=function(t){this.clearCache()},t.prototype.notifyModelChanged=function(t){this.clearCache()},t.prototype.notifyPageColorChanged=function(t){},t.prototype.notifyPageSizeChanged=function(t,e){},t.prototype.clearCache=function(t){this.cache=void 0!==t?this.cache.filter((function(e){return e.operation!==t})):[]},t.prototype.canDeleteItems=function(t){var e=this,n=!0;return t.forEach((function(t){var i;t instanceof o.Shape&&(i=new c.DeleteShapeRequestedEntity(e.apiController,t)),t instanceof a.Connector&&(i=new u.DeleteConnectorRequestedEntity(e.apiController,t)),n=n&&e.requestOperation(i)})),n},t.prototype.canAddItems=function(t){var e=this,n=!0;return t.forEach((function(t){t instanceof o.Shape&&(n=n&&e.requestOperation(new s.AddShapeRequestedEntity(e.apiController,t))),t instanceof a.Connector&&(n=n&&e.canChangeConnection(t,t.beginItem,void 0,a.ConnectorPosition.Begin,t.beginConnectionPointIndex),n=n&&e.canChangeConnection(t,t.endItem,void 0,a.ConnectorPosition.End,t.endConnectionPointIndex))})),n},t.prototype.canAddShapeFromToolbox=function(t){return this.requestOperation(new l.AddShapeFromToolboxRequestedEntity(this.apiController,t))},t.prototype.canChangeConnection=function(t,e,n,i,r){return!(!t||!this.requestDeleteItems[t.key])||(!(void 0===e||null===e||e instanceof o.Shape)||this.requestOperation(new p.ChangeConnectionRequestedEntity(this.apiController,t,e,n,i,r)))},t.prototype.canChangeConnectorPoints=function(t,e,n){return!(!t||!this.requestDeleteItems[t.key])||this.requestOperation(new h.ChangeConnectorPointsRequestedEntity(this.apiController,t,e,n))},t.prototype.canChangeShapeText=function(t){return this.requestOperation(new d.BeforeChangeShapeTextRequestedEntity(this.apiController,t))},t.prototype.canChangeConnectorText=function(t,e){return this.requestOperation(new f.BeforeChangeConnectorTextRequestedEntity(this.apiController,t,e))},t.prototype.canApplyShapeTextChange=function(t,e){return this.requestOperation(new m.ChangeShapeTextRequestedEntity(this.apiController,t,e))},t.prototype.canApplyConnectorTextChange=function(t,e,n){return this.requestOperation(new g.ChangeConnectorTextRequestedEntity(this.apiController,t,e,n))},t.prototype.canResizeShapes=function(t){var e=this,n=!0;return t.forEach((function(t){n=n&&e.requestOperation(new v.ResizeShapeRequestedEntity(e.apiController,t.shape,t.oldSize,t.size))})),n},t.prototype.canMoveShapes=function(t){var e=this,n=!0;return t.forEach((function(t){n=n&&e.requestOperation(new C.MoveShapeRequestedEntity(e.apiController,t.shape,t.oldPosition,t.position))})),n},t.prototype.requestOperation=function(t){var e,n=!0;if(!this.permissionsLockCount&&(this.updateUICount>0&&this.cache.forEach((function(n){n.equals(t)&&(e=n)})),e?n=e.allowed:(this.requestOperationCore(t),this.updateUICount>0&&this.cache.push(t),n=t.allowed),0===this.updateUICount&&this.storage.needStorePermissions()))return this.storage.storePermission(t.storageKey,n),this.storage.isStoredPermissionsGranted();return n},t.prototype.requestOperationCore=function(t){t.eventArgs.allowed=this.operationSettings[t.settingsKey],t.eventArgs.updateUI=this.updateUICount>0,t.allowed&&this.onRequestOperation.raise("notifyRequestOperation",t.operation,t.eventArgs)},t.prototype.lockPermissions=function(){this.permissionsLockCount++},t.prototype.unlockPermissions=function(){this.permissionsLockCount--},t.prototype.beginDeleteItems=function(t){var e=this;t.forEach((function(t){return e.requestDeleteItems[t.key]=t}))},t.prototype.endDeleteItems=function(){this.requestDeleteItems={}},t.prototype.beginUpdateUI=function(){this.updateUICount++},t.prototype.endUpdateUI=function(){this.updateUICount--},t.prototype.addInteractingItem=function(t,e){this.storage.addInteractingItem(t,e)},t.prototype.getInteractingItem=function(t,e){return this.storage.getInteractingItem(t,e)},t.prototype.getInteractingItemCount=function(){return this.storage.getInteractingItemCount()},t.prototype.clearInteractingItems=function(){this.storage.clearInteractingItems()},t.prototype.beginStorePermissions=function(){this.storage.beginStorePermissions()},t.prototype.endStorePermissions=function(){this.storage.endStorePermissions()},t.prototype.isStoredPermissionsGranted=function(){return this.permissionsLockCount>0||this.storage.isStoredPermissionsGranted()},t}();e.PermissionsProvider=_},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AddShapeEventArgs=e.AddShapeRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n){var o=t.call(this,e)||this;return o.shape=n,o}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.AddShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeShape(this.shape),this.apiController.convertPoint(this.shape.position))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"addShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.shape===t.shape&&this.shape.position.equals(t.shape.position))},e}(r.RequestedEntity);e.AddShapeRequestedEntity=a;var s=function(t){function e(e,n){var o=t.call(this)||this;return o.shape=e,o.position=n,o}return o(e,t),e}(r.PermissionRequestEventArgs);e.AddShapeEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteShapeEventArgs=e.DeleteShapeRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n){var o=t.call(this,e)||this;return o.shape=n,o}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.DeleteShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeShape(this.shape))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"deleteShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&this.shape===t.shape},e}(r.RequestedEntity);e.DeleteShapeRequestedEntity=a;var s=function(t){function e(e){var n=t.call(this)||this;return n.shape=e,n}return o(e,t),e}(r.PermissionRequestEventArgs);e.DeleteShapeEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteConnectorEventArgs=e.DeleteConnectorRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n){var o=t.call(this,e)||this;return o.connector=n,o}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.DeleteConnector},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeConnector(this.connector))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"deleteConnector"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&this.connector===t.connector},e}(r.RequestedEntity);e.DeleteConnectorRequestedEntity=a;var s=function(t){function e(e){var n=t.call(this)||this;return n.connector=e,n}return o(e,t),e}(r.PermissionRequestEventArgs);e.DeleteConnectorEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AddShapeFromToolboxEventArgs=e.AddShapeFromToolboxRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n){var o=t.call(this,e)||this;return o.shapeType=n,o}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.AddShapeFromToolbox},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.shapeType)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"addShapeFromToolbox"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+this.shapeType},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&this.shapeType===t.shapeType},e}(r.RequestedEntity);e.AddShapeFromToolboxRequestedEntity=a;var s=function(t){function e(e){var n=t.call(this)||this;return n.shapeType=e,n}return o(e,t),e}(r.PermissionRequestEventArgs);e.AddShapeFromToolboxEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectionEventArgs=e.ChangeConnectionRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e)||this;return s.connector=n,s.shape=o,s.oldShape=i,s.position=r,s.connectionPointIndex=a,s}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.ChangeConnection},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeConnector(this.connector),this.apiController.createNativeShape(this.shape),this.apiController.createNativeShape(this.oldShape),this.position,this.connectionPointIndex)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnection"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)+"_"+this.position},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){if(t instanceof e){var n=!this.connector&&!t.connector||this.connector&&t.connector&&this.connector===t.connector,o=!this.shape&&!t.shape||this.shape&&t.shape&&this.shape===t.shape,i=!this.oldShape&&!t.oldShape||this.oldShape&&t.oldShape&&this.oldShape===t.oldShape;return o&&i&&n&&this.position===t.position&&this.connectionPointIndex===t.connectionPointIndex}return!1},e}(r.RequestedEntity);e.ChangeConnectionRequestedEntity=a;var s=function(t){function e(e,n,o,i,r){var a=t.call(this)||this;return a.connector=e,a.shape=n,a.oldShape=o,a.position=i,a.connectionPointIndex=r,a}return o(e,t),e}(r.PermissionRequestEventArgs);e.ChangeConnectionEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorPointsEventArgs=e.ChangeConnectorPointsRequestedEntity=void 0;var i=n(16),r=n(24),a=n(3),s=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.connector=n,r.oldPoints=o,r.points=i,r}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.ChangeConnectorPoints},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){var t=this;return new c(this.apiController.createNativeConnector(this.connector),this.oldPoints.map((function(e){return t.apiController.convertPoint(e)})),this.points.map((function(e){return t.apiController.convertPoint(e)})))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnectorPoints"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.connector===t.connector&&a.GeometryUtils.arePointsEqual(this.oldPoints,t.oldPoints)&&a.GeometryUtils.arePointsEqual(this.points,t.points))},e}(r.RequestedEntity);e.ChangeConnectorPointsRequestedEntity=s;var c=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connector=e,i.oldPoints=n,i.points=o,i}return o(e,t),e}(r.PermissionRequestEventArgs);e.ChangeConnectorPointsEventArgs=c},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.BeforeChangeShapeTextEventArgs=e.BeforeChangeShapeTextRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n){var o=t.call(this,e)||this;return o.shape=n,o}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.BeforeChangeShapeText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeShape(this.shape))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeShapeText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return"before"+this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.shape===t.shape&&this.shape.text===t.shape.text)},e}(r.RequestedEntity);e.BeforeChangeShapeTextRequestedEntity=a;var s=function(t){function e(e){var n=t.call(this)||this;return n.shape=e,n}return o(e,t),e}(r.PermissionRequestEventArgs);e.BeforeChangeShapeTextEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.BeforeChangeConnectorTextEventArgs=e.BeforeChangeConnectorTextRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.connector=n,i.position=o,i}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.BeforeChangeConnectorText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeConnector(this.connector),this.position,this.connector.texts.map((function(t){return t})).sort((function(t,e){return t.position-e.position})).indexOf(this.connector.texts.get(this.position)))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnectorText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return"before"+this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.connector===t.connector&&this.position===t.position&&this.connector.texts.get(this.position)===t.connector.texts.get(t.position))},e}(r.RequestedEntity);e.BeforeChangeConnectorTextRequestedEntity=a;var s=function(t){function e(e,n,o){var i=t.call(this)||this;return i.connector=e,i.position=n,i.index=o,i}return o(e,t),e}(r.PermissionRequestEventArgs);e.BeforeChangeConnectorTextEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeShapeTextEventArgs=e.ChangeShapeTextRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.shape=n,i.text=o,i}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.ChangeShapeText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeShape(this.shape),this.text)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeShapeText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.shape===t.shape&&this.text===t.text)},e}(r.RequestedEntity);e.ChangeShapeTextRequestedEntity=a;var s=function(t){function e(e,n){var o=t.call(this)||this;return o.shape=e,o.text=n,o}return o(e,t),e}(r.PermissionRequestEventArgs);e.ChangeShapeTextEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeConnectorTextEventArgs=e.ChangeConnectorTextRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.connector=n,r.position=o,r.text=i,r}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.ChangeConnectorText},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeConnector(this.connector),this.position,this.connector.texts.map((function(t){return t})).sort((function(t,e){return t.position-e.position})).indexOf(this.connector.texts.get(this.position)),this.text)},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"changeConnectorText"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.connector&&this.connector.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.connector===t.connector&&this.position===t.position&&this.text===t.text)},e}(r.RequestedEntity);e.ChangeConnectorTextRequestedEntity=a;var s=function(t){function e(e,n,o,i){var r=t.call(this)||this;return r.connector=e,r.position=n,r.index=o,r.text=i,r}return o(e,t),e}(r.PermissionRequestEventArgs);e.ChangeConnectorTextEventArgs=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PermissionsProviderStorage=void 0;var o=n(14),i=n(6),r=function(){function t(){this.interactingItems={},this.storedPermissions={}}return t.prototype.addInteractingItem=function(t,e){var n=this.getInteractingItemKey(t,e);void 0===this.interactingItems[n]&&(t instanceof o.Shape||t instanceof i.Connector)&&(this.interactingItems[n]=t.clone())},t.prototype.getInteractingItem=function(t,e){var n=this.getInteractingItemKey(t,e);return this.interactingItems[n]},t.prototype.getInteractingItemCount=function(){return Object.keys(this.interactingItems).length},t.prototype.clearInteractingItems=function(){this.interactingItems={}},t.prototype.getInteractingItemKey=function(t,e){return t.key+(void 0!==e?"_"+e.toString():"")},t.prototype.needStorePermissions=function(){return this.storePermissions},t.prototype.beginStorePermissions=function(){this.storePermissions=!0},t.prototype.endStorePermissions=function(){this.storePermissions=!1,this.storedPermissions={}},t.prototype.isStoredPermissionsGranted=function(){for(var t=Object.keys(this.storedPermissions),e=!0,n=0;n<t.length;n++)e=e&&this.storedPermissions[t[n]];return e},t.prototype.storePermission=function(t,e){this.storedPermissions[t]=e},t}();e.PermissionsProviderStorage=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeShapeEventArgs=e.ResizeShapeRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.shape=n,r.oldSize=o,r.size=i,r}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.ResizeShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeShape(this.shape),this.apiController.convertSize(this.oldSize),this.apiController.convertSize(this.size))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"resizeShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.shape===t.shape&&this.oldSize.equals(t.oldSize)&&this.size.equals(t.size))},e}(r.RequestedEntity);e.ResizeShapeRequestedEntity=a;var s=function(t){function e(e,n,o){var i=t.call(this)||this;return i.shape=e,i.oldSize=n,i.size=o,i}return o(e,t),e}(r.PermissionRequestEventArgs);e.ResizeShapeEventArgs=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.MoveShapeEventArgs=e.MoveShapeRequestedEntity=void 0;var i=n(16),r=n(24),a=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.shape=n,r.oldPosition=o,r.position=i,r}return o(e,t),Object.defineProperty(e.prototype,"operation",{get:function(){return i.DiagramModelOperation.MoveShape},enumerable:!1,configurable:!0}),e.prototype.createEventArgs=function(){return new s(this.apiController.createNativeShape(this.shape),this.apiController.convertPoint(this.oldPosition),this.apiController.convertPoint(this.position))},Object.defineProperty(e.prototype,"settingsKey",{get:function(){return"moveShape"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storageKey",{get:function(){return this.settingsKey+"_"+(this.shape&&this.shape.key)},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&(this.shape===t.shape&&this.oldPosition.equals(t.oldPosition)&&this.position.equals(t.position))},e}(r.RequestedEntity);e.MoveShapeRequestedEntity=a;var s=function(t){function e(e,n,o){var i=t.call(this)||this;return i.shape=e,i.oldPosition=n,i.position=o,i}return o(e,t),e}(r.PermissionRequestEventArgs);e.MoveShapeEventArgs=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorRoutingModel=void 0;var o=n(27),i=n(14),r=n(6),a=n(31),s=n(369),c=function(){function t(){this.connectorRoutingMode=o.ConnectorRoutingMode.AllShapesOnly,this.shapeMargins=r.Connector.minOffset}return t.prototype.initialize=function(t){this.model=t},t.prototype.createStrategy=function(t){if(void 0!==this.model&&this.connectorRoutingMode!==o.ConnectorRoutingMode.None&&t===a.ConnectorLineOption.Orthogonal)return new s.RightAngleConnectorRoutingStrategy(this)},t.prototype.getShapes=function(t,e){return void 0===this.model||void 0===this.connectorRoutingMode||this.connectorRoutingMode===o.ConnectorRoutingMode.None?[]:this.connectorRoutingMode===o.ConnectorRoutingMode.AllShapesOnly?this.model.items.filter((function(t){return t instanceof i.Shape})).map((function(t){return t})):this.getConnectorShapes(t,e)},t.prototype.getExtendedShapesBounds=function(t,e){var n=this;return this.getShapesBounds(t,e).map((function(t){return t.clone().inflate(n.shapeMargins,n.shapeMargins)}))},t.prototype.getIntersectedShapesWithExtendedRectangle=function(t,e,n){var o=this;return this.getShapes(e,n).filter((function(e){return e.rectangle.inflate(o.shapeMargins/2).containsPoint(t)}))},t.prototype.notifyConnectorRoutingModeChanged=function(t){this.connectorRoutingMode=t},t.prototype.getShapesBounds=function(t,e){return this.getShapes(t,e).map((function(t){return t.rectangle}))},t.prototype.getConnectorShapes=function(t,e){var n=[];return t&&n.push(t),e&&t!==e&&n.push(e),n},t}();e.ConnectorRoutingModel=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RightAngleConnectorRoutingStrategy=void 0;var o=n(1),i=n(41),r=n(8),a=n(30),s=n(370),c=n(371),u=n(375),l=n(376),p=n(377),h=n(84),d=function(){function t(t){this.model=t}return t.prototype.createRoutingSegments=function(t){var e=this;return!t||t.length<=1?[]:h.RightAngleConnectorRoutingMathOperations.createSegments(t).filter((function(n){return!e.isCustomSegment(n,t[0],t[t.length-1])}))},t.prototype.getShapes=function(t,e,n,o){var i=this;return this.model.getShapes(n,o).filter((function(r){return!i.shouldIgnoreShape(r,t,e,n,o)}))},t.prototype.isValidRouting=function(t,e,n){var o=this;if(!t||!t.length)return!0;var i=t[0].startPoint,r=t[t.length-1].endPoint;if(this.isSmallPath(i,r))return!0;var a=this.getShapes(i,r,e,n).filter((function(e){return t.some((function(t){return t.isIntersectedByRect(e.rectangle)}))}));return a.length?!h.RightAngleConnectorRoutingMathOperations.areRectanlesCut(t,a.map((function(t){return t.rectangle.inflate(o.model.shapeMargins)})))&&((a.length>1||!h.RightAngleConnectorRoutingMathOperations.containsSegmentsInRectanlePolygonalChain(t,a[0].rectangle))&&this.areValidConnections(t,e,n)):this.areValidConnections(t,e,n)},t.prototype.createRoutedRenderPoints=function(t,e,n,o,i,r){var a,s=[],c=-1,u=-1,l=this.createRenderingSegments(t,e,n,o,i,r),p=l[l.length-1].endPoint,h=this.createGrid(l,n,o);do{this.registerCustomPoints(s,t,u+2,l[c+1].startPointIndex-1),c++,a=l[c],u=a.startPointIndex,this.registerRenderPoints(s,this.createRoutedPoints(a,h,n,o),u)}while(!a.endPoint.equals(p));return this.getValidRenderPoints(s),s},t.prototype.createRenderingSegments=function(t,e,n,i,r,a){var s=this,c=[],u=h.RightAngleConnectorRoutingMathOperations.createUnionSegments(e),l=u.length-1;return u.forEach((function(e,u){var h=u>0?new o.Point(e.startPoint.x,e.startPoint.y):s.createBeginConnectionInfo(n,t[0].clone(),r),d=u<l?new o.Point(e.endPoint.x,e.endPoint.y):s.createEndConnectionInfo(i,t[t.length-1].clone(),a),f=s.createPreviousCustomSegment(t,e.startPoint);c.push(new p.ConnectorRenderSegment(h,d,e.startPoint.pointIndex,f))})),c},t.prototype.createBeginConnectionInfo=function(t,e,n){if(t){var a=t.getConnectionPointSideByIndex(n,e);switch(a){case r.ConnectionPointSide.North:return new i.Segment(e,new o.Point(e.x,e.y-this.model.shapeMargins));case r.ConnectionPointSide.South:return new i.Segment(e,new o.Point(e.x,e.y+this.model.shapeMargins));case r.ConnectionPointSide.West:return new i.Segment(e,new o.Point(e.x-this.model.shapeMargins,e.y));case r.ConnectionPointSide.East:return new i.Segment(e,new o.Point(e.x+this.model.shapeMargins,e.y))}}return e},t.prototype.createEndConnectionInfo=function(t,e,n){if(t){var a=t.getConnectionPointSideByIndex(n,e);switch(a){case r.ConnectionPointSide.North:return new i.Segment(new o.Point(e.x,e.y-this.model.shapeMargins),e);case r.ConnectionPointSide.South:return new i.Segment(new o.Point(e.x,e.y+this.model.shapeMargins),e);case r.ConnectionPointSide.West:return new i.Segment(new o.Point(e.x-this.model.shapeMargins,e.y),e);case r.ConnectionPointSide.East:return new i.Segment(new o.Point(e.x+this.model.shapeMargins,e.y),e)}}return e},t.prototype.createGridPoints=function(t){var e=[];return t.forEach((function(t){var n=t.endInfo;n instanceof i.Segment?(e.push(n.startPoint),e.push(n.center),e.push(n.endPoint)):e.push(n)})),e},t.prototype.clone=function(){return new t(this.model)},t.prototype.onAddPoint=function(t,e,n,o,r){var s=o.map((function(t){return new a.ConnectorRenderPoint(t.x,t.y,t.pointIndex)})),c=this.getRenderPointIndexByPoint(s,n);if(!r){if(c>=0){var u=s[c];return s[c]=new a.ConnectorRenderPoint(u.x,u.y,e),this.updatePointIndexes(t,s,c+1)}return o}if(0===c)return s.splice(1,0,new a.ConnectorRenderPoint(n.x,n.y,e)),this.updatePointIndexes(t,s,2);var l=s.length-1;if(c===l)return s.splice(l,0,new a.ConnectorRenderPoint(n.x,n.y,e)),s[l+1].pointIndex=e+1,s;if(c>0){u=s[c];return s[c]=new a.ConnectorRenderPoint(u.x,u.y,e,u.skipped),this.updatePointIndexes(t,s,c+1)}var p=new i.Segment(s[0],s[1]),h=new a.ConnectorRenderPoint(n.x,n.y);if(p.containsPoint(h))return s.splice(1,0,new a.ConnectorRenderPoint(h.x,h.y,-1)),s.splice(2,0,new a.ConnectorRenderPoint(h.x,h.y,e)),this.updatePointIndexes(t,s,3);var d=new i.Segment(s[l-1],s[l]);return d.containsPoint(h)?(s.splice(l,0,new a.ConnectorRenderPoint(h.x,h.y,e)),s.splice(l+1,0,new a.ConnectorRenderPoint(h.x,h.y,-1)),s[l+2].pointIndex=e+1,s):o},t.prototype.onDeletePoint=function(t,e,n,o){var i=n.map((function(t){return new a.ConnectorRenderPoint(t.x,t.y,t.pointIndex)})),r=this.getRenderPointIndexByPointIndex(i,e);if(!o){if(r>=0){var s=i[r];return i[r]=new a.ConnectorRenderPoint(s.x,s.y,-1,s.skipped),this.updatePointIndexes(t,i,r+1)}return n}if(1===r){var c=i[0],u=i[1];return c.equals(u)?(i.splice(1,1),this.updatePointIndexes(t,i,1)):(i[1]=new a.ConnectorRenderPoint(u.x,u.y,-1,u.skipped),this.updatePointIndexes(t,i,2))}if(2===r){c=i[1];var l=i[2];return c.equals(l)?(i.splice(1,2),this.updatePointIndexes(t,i,1)):(i[2]=new a.ConnectorRenderPoint(l.x,l.y,-1,l.skipped),this.updatePointIndexes(t,i,3))}var p=i.length-1;if(r===p-1){var h=i[p-1],d=i[p];return h.equals(d)?(i.splice(p-1,1),this.updatePointIndexes(t,i,p-1)):(i[p-1]=new a.ConnectorRenderPoint(h.x,h.y,-1,h.skipped),this.updatePointIndexes(t,i,p))}if(r===p-2){var f=i[p-2];d=i[p-1];return f.equals(d)?(i.splice(p-2,2),this.updatePointIndexes(t,i,p-2)):(i[p-2]=new a.ConnectorRenderPoint(f.x,f.y,-1,f.skipped),this.updatePointIndexes(t,i,p-1))}var m=i[r];return i[r]=new a.ConnectorRenderPoint(m.x,m.y,-1,m.skipped),this.updatePointIndexes(t,i,r+1)},t.prototype.onMovePoint=function(t,e,n,o){if(0===e||e===t.length-1)return o;var i=o.map((function(t){return new a.ConnectorRenderPoint(t.x,t.y,t.pointIndex)})),r=this.getRenderPointIndexByPointIndex(i,e);if(r>=0){var s=i[r];i[r]=new a.ConnectorRenderPoint(n.x,n.y,e,s.skipped)}return this.getValidRenderPoints(i)},t.prototype.isCustomSegment=function(t,e,n){var o=t.startPoint;if(o.equals(e))return!1;var i=t.endPoint;return!i.equals(n)&&i.pointIndex-o.pointIndex===1},t.prototype.createGrid=function(t,e,n){return l.DiagramGrid.create(this.createGridPoints(t),this.model.getExtendedShapesBounds(e,n),(function(t,e){return new o.Point(t,e)}))},t.prototype.updatePointIndexes=function(t,e,n){var o=this;return e.map((function(e,i){return new a.ConnectorRenderPoint(e.x,e.y,i>=n&&e.pointIndex>=0?o.getPointIndexByRenderPoint(t,e):e.pointIndex,e.skipped)}))},t.prototype.getPointIndexByRenderPoint=function(t,e){return this.getPointIndexCore(t,(function(t){return t.equals(e)}))},t.prototype.getRenderPointIndexByPointIndex=function(t,e){return this.getPointIndexCore(t,(function(t){return t.pointIndex===e}))},t.prototype.getRenderPointIndexByPoint=function(t,e){return this.getPointIndexCore(t,(function(t){return t.equals(e)}))},t.prototype.getPointIndexCore=function(t,e){if(!t)return-1;for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1},t.prototype.shouldIgnoreShape=function(t,e,n,o,i){return o===i?t===o:t===o?t.rectangle.containsPoint(e):t===i&&t.rectangle.containsPoint(n)},t.prototype.registerRenderPoints=function(t,e,n){var o=this;e.forEach((function(i,r){var a=0===r?n:r===e.length-1?n+1:-1;o.registerPoint(t,i,a)}))},t.prototype.registerCustomPoints=function(t,e,n,o){for(var i=n;i<=o;i++)this.registerPoint(t,e[i],i)},t.prototype.registerPoint=function(t,e,n){t.push(new a.ConnectorRenderPoint(e.x,e.y,n))},t.prototype.createPreviousCustomSegment=function(t,e){var n=e.pointIndex-1;return n>=0?new i.Segment(t[n].clone(),new o.Point(e.x,e.y)):void 0},t.prototype.createRoutedPoints=function(t,e,n,o){var r=new c.AStarContext(new u.IntersectedShapesContext(t.startPathPoint,t.endPathPoint,this.model,n,o),e,t.createProhibitedSegments());s.AStarCalculator.calculate(r);var a=r.path,l=t.startInfo;l instanceof i.Segment&&a.splice(0,0,l.startPoint);var p=t.endInfo;return p instanceof i.Segment&&a.push(p.endPoint),h.RightAngleConnectorRoutingMathOperations.unionPoints(a),a},t.prototype.getValidRenderPoints=function(t){return h.RightAngleConnectorRoutingMathOperations.skipUnnecessaryPoints(t),t},t.prototype.isSmallPath=function(t,e){var n=2*this.model.shapeMargins;return Math.abs(t.x-e.x)<=n&&Math.abs(t.y-e.y)<=n},t.prototype.areValidConnections=function(t,e,n){return this.isValidConnection(t[0],e)&&this.isValidConnection(t[t.length-1],n)},t.prototype.isValidConnection=function(t,e){return!e||t.length>=this.model.shapeMargins},t}();e.RightAngleConnectorRoutingStrategy=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AStarCalculator=void 0;var o=function(){function t(){}return t.calculate=function(t){if(t){var e=this.start(t);while(e)e=e(t)}},t.start=function(e){return e.start(),e.shouldStartContinue?t.startContinue:t.finishWithPath},t.startContinue=function(e){return e.startContinue(),e.shouldFinish?t.finishWithPath:t.endContinue},t.endContinue=function(e){return e.endContinue(),e.shouldStartContinue?t.startContinue:t.finishWithoutPath},t.finishWithPath=function(t){t.finishWithPath()},t.finishWithoutPath=function(t){t.finishWithoutPath()},t}();e.AStarCalculator=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.AStarContext=e.AStarContextBase=void 0;var i=n(372),r=n(373),a=n(374),s=n(114),c=n(41),u=n(84),l=function(){function t(t,e,n,o,i){this.intersectedItemsContext=t,this.grid=e,this.prohibitedSegments=n,this.metrics=o,this.maxStepsCount=i,this.prohibitedPoints={}}return Object.defineProperty(t.prototype,"shouldStartContinue",{get:function(){return this.updatableSet.count>0&&this.stepsCount<this.maxStepsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldFinish",{get:function(){return this.currentNode.position.equals(this.targetPosition)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startPosition",{get:function(){return this.intersectedItemsContext.startPosition},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetPosition",{get:function(){return this.intersectedItemsContext.targetPosition},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.generalSet=new i.SortedQueues((function(t){return t.key})),this.updatableSet=new r.UniqueAStarNodePositions;var t=new a.AStarNode(this.startPosition,this.metrics.distance(this.startPosition,this.targetPosition));this.currentNode=t,this.generalSet.enqueue(t),this.updatableSet.add(t.position,t),this.stepsCount=0,this.openNode=void 0},t.prototype.startContinue=function(){this.currentNode=this.generalSet.dequeueMin()},t.prototype.endContinue=function(){var t=this,e=this.currentNode.position;this.updatableSet.remove(e),this.addProhibitedPoint(e),this.getNeighborPoints(e).forEach((function(n){var o=t.currentNode.parent,i=t.getTurnDirection(o?t.createAngle(o.position,e,n):0),r=t.createMiddlePosition(e,n),s=t.intersectedItemsContext.getIntersectedItemsWithExtendedRectangle(r),c=s.filter((function(t){return t.rectangle.containsPoint(r)})),u=t.currentNode.penalty+t.metrics.penalty(t.metrics.distance(n,e),i,c,s),l=t.updatableSet.getNode(n);if(void 0===l)l=new a.AStarNode(n,t.metrics.distance(n,t.targetPosition)),l.parent=t.currentNode,l.penalty=u,t.generalSet.enqueue(l),t.updatableSet.add(n,l);else if(l.penalty>u){var p=t.generalSet;p.remove(l),l.parent=t.currentNode,l.penalty=u,p.enqueue(l)}t.openNode=l})),this.stepsCount++},t.prototype.finishWithPath=function(){this.path=this.currentNode.getPath()},t.prototype.finishWithoutPath=function(){this.path=[]},t.prototype.getNeighborPoints=function(t){var e=this;return this.grid.getNeighborPoints(t).filter((function(t){return e.isAllowPoint(t)}))},t.prototype.addProhibitedPoint=function(t){this.prohibitedPoints[t.toString()]=t},t.prototype.isAllowPoint=function(t){return void 0===this.prohibitedPoints[t.toString()]&&this.prohibitedSegments.isAllowPoint(t)},t}();e.AStarContextBase=l;var p=function(t){function e(e,n,o){var i=t.call(this,e,n,o,new s.AStarMetrics,1e4)||this;return i.intersectedItemsContext=e,i.grid=n,i.prohibitedSegments=o,i}return o(e,t),e.prototype.getTurnDirection=function(t){return u.RightAngleConnectorRoutingMathOperations.getTurnDirection(t)},e.prototype.createAngle=function(t,e,n){return u.RightAngleConnectorRoutingMathOperations.createAngle(t,e,n)},e.prototype.createMiddlePosition=function(t,e){return new c.Segment(t,e).center},e}(l);e.AStarContext=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SortedQueues=void 0;var o=n(39),i=function(){function t(t){this.getKey=t,this._itemsArrays={},this._sortedKeys=[]}return Object.defineProperty(t.prototype,"sortedKeys",{get:function(){return this._sortedKeys},enumerable:!1,configurable:!0}),t.prototype.getQueue=function(t){return this._itemsArrays[t]},t.prototype.enqueue=function(t){var e=this.getKey(t);void 0===this._itemsArrays[e]?(this._itemsArrays[e]=[t],this.addSortedKey(e)):this._itemsArrays[e].push(t)},t.prototype.remove=function(t){var e=this.getKey(t),n=this._itemsArrays[e];void 0!==n&&(n.length?n[0]===t?(n.shift(),n.length||this.removeCore(e)):this._itemsArrays[e]=n.filter((function(e){return e!==t})):this.removeCore(e))},t.prototype.dequeueMin=function(){if(this._sortedKeys.length){var t=this._sortedKeys[0],e=this._itemsArrays[t],n=e.shift();return e.length||this.removeCore(t),n}},t.prototype.removeCore=function(t){delete this._itemsArrays[t],this.removeSortedKey(t)},t.prototype.removeSortedKey=function(t){var e=o.SearchUtils.binaryIndexOf(this._sortedKeys,(function(e){return e-t}));e>=0&&this.sortedKeys.splice(e,1)},t.prototype.addSortedKey=function(t){var e=o.SearchUtils.binaryIndexOf(this._sortedKeys,(function(e){return e-t}));e<0&&this._sortedKeys.splice(-(e+1),0,t)},t}();e.SortedQueues=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UniqueAStarNodePositions=void 0;var o=function(){function t(t){void 0===t&&(t=function(t){return t.toString()}),this.getKey=t,this.items={}}return Object.defineProperty(t.prototype,"count",{get:function(){return Object.keys(this.items).length},enumerable:!1,configurable:!0}),t.prototype.getNode=function(t){var e=this.items[this.getKey(t)];return void 0!==e?e.node:void 0},t.prototype.add=function(t,e){var n=this.getKey(t);void 0===this.items[n]&&(this.items[n]={position:t,node:e})},t.prototype.remove=function(t){var e=this.getKey(t);void 0!==this.items[e]&&delete this.items[e]},t}();e.UniqueAStarNodePositions=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AStarNode=void 0;var o=function(){function t(t,e){this.position=t,this.distance=e,this.penalty=0}return Object.defineProperty(t.prototype,"key",{get:function(){return this.distance+this.penalty},enumerable:!1,configurable:!0}),t.prototype.getPath=function(){var t=[],e=this;while(void 0!==e)t.splice(0,0,e.position),e=e.parent;return t},t}();e.AStarNode=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.IntersectedShapesContext=e.IntersectedItemsContextBase=void 0;var i=function(){function t(t,e){this.startPosition=t,this.targetPosition=e,this.itemsByPoint={}}return t.prototype.getOrAddShapes=function(t,e){if(t){var n=t.toString(),o=this.itemsByPoint[n];if(void 0!==o)return o.items;if(e){var i=e(t);return this.itemsByPoint[n]={point:t,items:i},i}}},t.prototype.getIntersectedItemsWithExtendedRectangle=function(t){var e=this;return this.getOrAddShapes(t,(function(t){return e.getIntersectedItemsWithExtendedRectangleCore(t)}))},t}();e.IntersectedItemsContextBase=i;var r=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n)||this;return a.startPosition=e,a.targetPosition=n,a.model=o,a.beginConnectorShape=i,a.endConnectorShape=r,a}return o(e,t),e.prototype.getIntersectedItemsWithExtendedRectangleCore=function(t){var e=this;return this.model.getIntersectedShapesWithExtendedRectangle(t,this.beginConnectorShape,this.endConnectorShape).filter((function(t){return!e.shouldIgnore(t)}))},e.prototype.isConnectionPoint=function(t,e){return t.filter((function(t){return t.equals(e)})).length>0},e.prototype.shouldIgnore=function(t){var e=t.getConnectionPoints();if(this.isConnectionPoint(e,this.startPosition)&&this.isConnectionPoint(e,this.targetPosition))return!1;var n=t.rectangle;return n.containsPoint(this.startPosition)&&n.containsPoint(this.targetPosition)},e}(i);e.IntersectedShapesContext=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DiagramGrid=void 0;var o=n(39),i=function(){function t(t,e,n){this.verticalGridLines=t,this.horizontalGridLines=e,this.createPoint=n}return t.create=function(e,n,o){var i=this,r=[],a=[],s={},c={};return n.forEach((function(t){i.addLine(t.x,r,s),i.addLine(t.right,r,s),i.addLine(t.y,a,c),i.addLine(t.bottom,a,c)})),e.forEach((function(t){i.addLine(t.x,r,s),i.addLine(t.y,a,c)})),r.sort((function(t,e){return t-e})),a.sort((function(t,e){return t-e})),new t(r,a,o)},t.addLine=function(t,e,n){n[t]||(e.push(t),n[t]=!0)},t.prototype.getNeighborPoints=function(t){var e=[];if(!this.horizontalGridLines||!this.horizontalGridLines.length||!this.verticalGridLines||!this.verticalGridLines.length)return e;var n=o.SearchUtils.binaryIndexOf(this.verticalGridLines,(function(e){return e-t.x}));n<0?(n=~n,this.isValidArrayIndex(this.verticalGridLines,n)&&e.push(this.createPoint(this.verticalGridLines[n],t.y))):this.isValidArrayIndex(this.verticalGridLines,n+1)&&e.push(this.createPoint(this.verticalGridLines[n+1],t.y)),this.isValidArrayIndex(this.verticalGridLines,n-1)&&e.push(this.createPoint(this.verticalGridLines[n-1],t.y));var i=o.SearchUtils.binaryIndexOf(this.horizontalGridLines,(function(e){return e-t.y}));return i<0?(i=~i,this.isValidArrayIndex(this.horizontalGridLines,i)&&e.push(this.createPoint(t.x,this.horizontalGridLines[i]))):this.isValidArrayIndex(this.horizontalGridLines,i+1)&&e.push(this.createPoint(t.x,this.horizontalGridLines[i+1])),this.isValidArrayIndex(this.horizontalGridLines,i-1)&&e.push(this.createPoint(t.x,this.horizontalGridLines[i-1])),e},t.prototype.isValidArrayIndex=function(t,e){return t&&e>=0&&e<t.length},t}();e.DiagramGrid=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorRenderSegment=void 0;var o=n(41),i=n(378),r=function(){function t(t,e,n,o){this.startInfo=t,this.endInfo=e,this.startPointIndex=n,this.previousCustomSegment=o}return Object.defineProperty(t.prototype,"startPathPoint",{get:function(){return this.startInfo instanceof o.Segment?this.startInfo.endPoint:this.startInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endPathPoint",{get:function(){return this.endInfo instanceof o.Segment?this.endInfo.startPoint:this.endInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startPoint",{get:function(){return this.startInfo instanceof o.Segment?this.startInfo.startPoint:this.startInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endPoint",{get:function(){return this.endInfo instanceof o.Segment?this.endInfo.endPoint:this.endInfo},enumerable:!1,configurable:!0}),t.prototype.createProhibitedSegments=function(){var t=new i.ConnectorProhibitedSegments;return this.startInfo instanceof o.Segment&&t.addSegment(this.startInfo),this.endInfo instanceof o.Segment&&(t.addSegment(this.endInfo),t.addExludedPoint(this.endInfo.startPoint)),this.previousCustomSegment&&t.addSegment(this.previousCustomSegment),t},t}();e.ConnectorRenderSegment=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectorProhibitedSegments=void 0;var o=function(){function t(){this.segments=[],this.exludedPoints={}}return t.prototype.addSegment=function(t){this.segments.push(t)},t.prototype.addExludedPoint=function(t){this.exludedPoints[t.toString()]=t},t.prototype.isAllowPoint=function(t){if(void 0!==this.exludedPoints[t.toString()])return!0;for(var e=0;e<this.segments.length;e++)if(this.segments[e].containsPoint(t))return!1;return!0},t}();e.ConnectorProhibitedSegments=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReloadContentParameters=void 0;var o=function(){function t(){this.isEmpty=!0}return t.prototype.add=function(t,e,n){void 0!==t&&(void 0===this._dataKeys&&(this._dataKeys=[]),Array.isArray(t)?this._dataKeys=this._dataKeys.concat(t):this._dataKeys.push(t)),this._getData=this._getData||e,this._layoutParameters=this._layoutParameters||n,this.isEmpty=!1},t.prototype.clear=function(){this.isEmpty=!0,this._dataKeys=void 0,this._getData=void 0,this._layoutParameters=void 0},Object.defineProperty(t.prototype,"empty",{get:function(){return this.isEmpty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataKeys",{get:function(){return this._dataKeys},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getData",{get:function(){return this._getData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layoutParameters",{get:function(){return this._layoutParameters},enumerable:!1,configurable:!0}),t}();e.ReloadContentParameters=o},function(t,e,n){}])}))},e315:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=r(n("be1c"));function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function p(t){var e=f();return function(){var n,o=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}var g=function(t){u(n,t);var e=p(n);function n(){return a(this,n),e.apply(this,arguments)}return c(n,[{key:"_getKeyExpr",value:function(){return this._diagramWidget._createOptionGetter("nodes.keyExpr")}},{key:"_getItemsExpr",value:function(){return this._diagramWidget._createOptionGetter("nodes.itemsExpr")}},{key:"_getContainerChildrenExpr",value:function(){return this._diagramWidget._createOptionGetter("nodes.containerChildrenExpr")}}]),n}(i.default),y=g;e.default=y,t.exports=e.default},ec06:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=m(n("14a3")),r=n("d4b2"),a=n("706b"),s=n("b49b"),c=m(n("8a64")),u=m(n("ca70")),l=m(n("a9e6")),p=m(n("367c")),h=m(n("9b50")),d=n("4ff6"),f=m(n("8c78"));function m(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function C(t,e,n){return C="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=_(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},C(t,e,n||t)}function _(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=T(t),null===t)break;return t}function P(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}function S(t,e){return S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},S(t,e)}function b(t){var e=I();return function(){var n,o=T(t);if(e){var i=T(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return x(this,n)}}function x(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?w(t):e}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}var O=130,E="dx-diagram-toolbox-popup",M="dx-diagram-toolbox-panel",D="dx-diagram-toolbox-input-container",A="dx-diagram-toolbox-input",k="shape-toolbox-tooltip",L="dx-skip-gesture-event",R=function(t){P(n,t);var e=b(n);function n(){return g(this,n),e.apply(this,arguments)}return v(n,[{key:"_init",value:function(){C(T(n.prototype),"_init",this).call(this),this._toolboxes=[],this._filterText="",this._createOnShapeCategoryRenderedAction(),this._createOnFilterChangedAction()}},{key:"_getPopupClass",value:function(){return E}},{key:"_getPopupHeight",value:function(){return this.isMobileView()?"100%":C(T(n.prototype),"_getPopupHeight",this).call(this)}},{key:"_getPopupMaxHeight",value:function(){return this.isMobileView()?"100%":C(T(n.prototype),"_getPopupMaxHeight",this).call(this)}},{key:"_getPopupMinHeight",value:function(){return O}},{key:"_getPopupPosition",value:function(){var t=this.option("offsetParent"),e={my:"left top",at:"left top",of:t};return this.isMobileView()?e:(0,r.extend)(e,{offset:this.option("offsetX")+" "+this.option("offsetY")})}},{key:"_getPopupAnimation",value:function(){var t=this.option("offsetParent");return this.isMobileView()?{hide:this._getPopupSlideAnimationObject({direction:"left",from:{position:{my:"left top",at:"left top",of:t}},to:{position:{my:"right top",at:"left top",of:t}}}),show:this._getPopupSlideAnimationObject({direction:"right",from:{position:{my:"right top",at:"left top",of:t}},to:{position:{my:"left top",at:"left top",of:t}}})}:C(T(n.prototype),"_getPopupAnimation",this).call(this)}},{key:"_getPopupOptions",value:function(){var t=C(T(n.prototype),"_getPopupOptions",this).call(this);return this.isMobileView()?t:(0,r.extend)(t,{showTitle:!0,toolbarItems:[{widget:"dxButton",location:"center",options:{activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,icon:"diagram-toolbox-drag",stylingMode:"outlined",type:"normal"}}]})}},{key:"_renderPopupContent",value:function(t){var e="100%";if(this.option("showSearch")){var n=(0,i.default)("<div>").addClass(D).appendTo(t);this._updateElementWidth(n),this._renderSearchInput(n),(0,a.hasWindow)()&&(e="calc(100% - "+this._searchInput.$element().height()+"px)")}var o=(0,i.default)("<div>").addClass(M).appendTo(t).height(e);this._updateElementWidth(o),this._renderScrollView(o)}},{key:"_updateElementWidth",value:function(t){void 0!==this.option("toolboxWidth")&&t.css("width",this.option("toolboxWidth"))}},{key:"updateMaxHeight",value:function(){if(!this.isMobileView()){var t=6;if(this._popup){var e=this._getPopupTitle();t+=e.outerHeight()}this._accordion&&(t+=this._accordion.$element().outerHeight()),this._searchInput&&(t+=this._searchInput.$element().outerHeight()),this.option("maxHeight",t)}}},{key:"_renderSearchInput",value:function(t){var e=this,n=(0,i.default)("<div>").addClass(A).appendTo(t);this._searchInput=this._createComponent(n,u.default,{stylingMode:"outlined",placeholder:c.default.format("dxDiagram-uiSearch"),onValueChanged:function(t){e._onInputChanged(t.value)},valueChangeEvent:"keyup",buttons:[{name:"search",location:"after",options:{activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,icon:"search",stylingMode:"outlined",type:"normal",onClick:function(){e._searchInput.focus()}}}]})}},{key:"_renderScrollView",value:function(t){var e=(0,i.default)("<div>").appendTo(t);this._scrollView=this._createComponent(e,p.default);var n=(0,i.default)("<div>").appendTo(this._scrollView.content());this._updateElementWidth(n),this._renderAccordion(n)}},{key:"_getAccordionDataSource",value:function(){for(var t=this,e=[],n=this.option("toolboxGroups"),o=0;o<n.length;o++){var r=n[o].category,a=n[o].title,s={category:r,title:a||r,expanded:n[o].expanded,displayMode:n[o].displayMode,shapes:n[o].shapes,onTemplate:function(e,n,o){var r=(0,i.default)(n);t._onShapeCategoryRenderedAction({category:o.category,displayMode:o.displayMode,dataToggle:k,shapes:o.shapes,$element:r}),t._toolboxes.push(r),""!==t._filterText&&t._onFilterChangedAction({text:t._filterText,filteringToolboxes:t._toolboxes.length-1}),t._createTooltips(r.find('[data-toggle="'+k+'"]'))}};e.push(s)}return e}},{key:"_createTooltips",value:function(t){var e=this,n=(0,d.getDiagram)(),o=n.Browser;if(!o.TouchUI){var r=this.$element();t.each((function(t,n){var o=(0,i.default)(n),a=o.attr("title");if(a){var s=(0,i.default)("<div>").html(a).appendTo(r);e._createComponent(s,h.default,{target:o.get(0),showEvent:"mouseenter",hideEvent:"mouseleave",position:"top",animation:{show:{type:"fade",from:0,to:1,delay:500},hide:{type:"fade",from:1,to:0,delay:100}}})}}))}}},{key:"_renderAccordion",value:function(t){var e=this,n=this._getAccordionDataSource();this._accordion=this._createComponent(t,l.default,{multiple:!0,animationDuration:0,activeStateEnabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,collapsible:!0,displayExpr:"title",dataSource:n,disabled:this.option("disabled"),itemTemplate:function(t,n,o){t.onTemplate(e,o,t)},onSelectionChanged:function(t){e._updateScrollAnimateSubscription(t.component)},onContentReady:function(t){for(var o=0;o<n.length;o++)!1===n[o].expanded?t.component.collapseItem(o):!0===n[o].expanded&&t.component.expandItem(o);e._updateScrollAnimateSubscription(t.component)}})}},{key:"_updateScrollAnimateSubscription",value:function(t){var e=this;t._deferredAnimate=new s.Deferred,t._deferredAnimate.done((function(){e.updateMaxHeight(),e._scrollView.update(),e._updateScrollAnimateSubscription(t)}))}},{key:"_raiseToolboxDragStart",value:function(){this._scrollView.$element().addClass(L)}},{key:"_raiseToolboxDragEnd",value:function(){this._scrollView.$element().removeClass(L)}},{key:"_onInputChanged",value:function(t){var e=this;this._filterText=t,this._onFilterChangedAction({text:this._filterText,filteringToolboxes:this._toolboxes.map((function(t,e){return e}))}),this._toolboxes.forEach((function(t){var n=(0,i.default)(t);e._createTooltips(n.find('[data-toggle="'+k+'"]'))})),this.updateMaxHeight(),this._scrollView.update()}},{key:"_createOnShapeCategoryRenderedAction",value:function(){this._onShapeCategoryRenderedAction=this._createActionByOption("onShapeCategoryRendered")}},{key:"_createOnFilterChangedAction",value:function(){this._onFilterChangedAction=this._createActionByOption("onFilterChanged")}},{key:"_optionChanged",value:function(t){switch(t.name){case"onShapeCategoryRendered":this._createOnShapeCategoryRenderedAction();break;case"onFilterChanged":this._createOnFilterChangedAction();break;case"showSearch":case"toolboxWidth":this._invalidate();break;case"toolboxGroups":this._accordion.option("dataSource",this._getAccordionDataSource());break;default:C(T(n.prototype),"_optionChanged",this).call(this,t)}}}]),n}(f.default),z=R;e.default=z,t.exports=e.default},fe7a:function(t,e,n){"use strict";e.default=void 0;var o=g(n("14a3")),i=g(n("8de2")),r=n("6103"),a=n("d4b2"),s=g(n("c0bf")),c=g(n("8a64")),u=g(n("2dd1")),l=g(n("0fa5")),p=g(n("2dc8")),h=g(n("71aa")),d=g(n("ca70")),f=g(n("f67c")),m=n("5c27");function g(t){return t&&t.__esModule?t:{default:t}}var y="dx-colorview",v="dx-colorview-container",C="dx-colorview-container-row",_="dx-colorview-container-cell",P="dx-colorview-palette",S="dx-colorview-palette-cell",b="dx-colorview-palette-handle",x="dx-colorview-palette-gradient",w="dx-colorview-palette-gradient-white",I="dx-colorview-palette-gradient-black",T="dx-colorview-hue-scale",O="dx-colorview-hue-scale-cell",E="dx-colorview-hue-scale-handle",M="dx-colorview-hue-scale-wrapper",D="dx-colorview-controls-container",A="dx-colorview-label-red",k="dx-colorview-label-green",L="dx-colorview-label-blue",R="dx-colorview-label-hex",z="dx-colorview-alpha-channel-scale",N="dx-colorview-alpha-channel-row",j="dx-colorview-alpha-channel-wrapper",U="dx-colorview-alpha-channel-label",B="dx-colorview-alpha-channel-handle",H="dx-colorview-alpha-channel-cell",V="dx-colorview-alpha-channel-border",F="dx-colorview-color-preview",K="dx-colorview-color-preview-container",W="dx-colorview-color-preview-container-inner",G="dx-colorview-color-preview-color-current",Z="dx-colorview-color-preview-color-new",q=p.default.inherit({_supportedKeys:function(){var t=this.option("rtlEnabled"),e=this,n=function(t){var n=100/e._paletteWidth;return t.shiftKey&&(n*=e.option("keyStep")),n=n>1?n:1,Math.round(n)},o=function(t){var n=e._currentColor.hsv.s+t;n>100?n=100:n<0&&(n=0),e._currentColor.hsv.s=n,c()},i=function(t){var n=100/e._paletteHeight;return t.shiftKey&&(n*=e.option("keyStep")),n=n>1?n:1,Math.round(n)},s=function(t){var n=e._currentColor.hsv.v+t;n>100?n=100:n<0&&(n=0),e._currentColor.hsv.v=n,c()};function c(){e._placePaletteHandle(),e._updateColorFromHsv(e._currentColor.hsv.h,e._currentColor.hsv.s,e._currentColor.hsv.v)}var u=function(t){var n=360/(e._hueScaleWrapperHeight-e._hueScaleHandleHeight);return t.shiftKey&&(n*=e.option("keyStep")),n=n>1?n:1,n},l=function(t){e._currentColor.hsv.h+=t,e._placeHueScaleHandle();var n=(0,r.locate)(e._$hueScaleHandle);e._updateColorHue(n.top+e._hueScaleHandleHeight/2)},p=function(n){var o=1/e._alphaChannelScaleWorkWidth;return n.shiftKey&&(o*=e.option("keyStep")),o=o>.01?o:.01,o=t?-o:o,o},h=function(t){e._currentColor.a+=t,e._placeAlphaChannelHandle();var n=(0,r.locate)(e._$alphaChannelHandle);e._calculateColorTransparencyByScaleWidth(n.left+e._alphaChannelHandleWidth/2)};return(0,a.extend)(this.callBase(),{upArrow:function(t){t.preventDefault(),t.stopPropagation(),t.ctrlKey?this._currentColor.hsv.h<=360&&!this._isTopColorHue&&l(u(t)):this._currentColor.hsv.v<100&&s(i(t))},downArrow:function(t){t.preventDefault(),t.stopPropagation(),t.ctrlKey?this._currentColor.hsv.h>=0&&(this._isTopColorHue&&(this._currentColor.hsv.h=360),l(-u(t))):this._currentColor.hsv.v>0&&s(-i(t))},rightArrow:function(e){e.preventDefault(),e.stopPropagation(),e.ctrlKey?(t?this._currentColor.a<1:this._currentColor.a>0&&this.option("editAlphaChannel"))&&h(-p(e)):this._currentColor.hsv.s<100&&o(n(e))},leftArrow:function(e){e.preventDefault(),e.stopPropagation(),e.ctrlKey?(t?this._currentColor.a>0:this._currentColor.a<1&&this.option("editAlphaChannel"))&&h(p(e)):this._currentColor.hsv.s>0&&o(-n(e))},enter:function(t){this._fireEnterKeyPressed(t)}})},_getDefaultOptions:function(){return(0,a.extend)(this.callBase(),{value:null,matchValue:null,onEnterKeyPressed:void 0,editAlphaChannel:!1,keyStep:1,stylingMode:void 0})},_defaultOptionsRules:function(){return this.callBase().concat([{device:function(){return"desktop"===u.default.real().deviceType&&!u.default.isSimulator()},options:{focusStateEnabled:!0}}])},_init:function(){this.callBase(),this._initColorAndOpacity(),this._initEnterKeyPressedAction()},_initEnterKeyPressedAction:function(){this._onEnterKeyPressedAction=this._createActionByOption("onEnterKeyPressed")},_fireEnterKeyPressed:function(t){this._onEnterKeyPressedAction&&this._onEnterKeyPressedAction({event:t})},_initColorAndOpacity:function(){this._setCurrentColor(this.option("value"))},_setCurrentColor:function(t){t=t||"#000000";var e=new s.default(t);e.colorIsInvalid?this.option("value",this._currentColor.baseColor):this._currentColor&&this._makeRgba(this._currentColor)===this._makeRgba(e)||(this._currentColor=e,this._$currentColor&&this._makeTransparentBackground(this._$currentColor,e))},_setBaseColor:function(t){var e=t||"#000000",n=new s.default(e);if(!n.colorIsInvalid){var o=this._makeRgba(this.option("matchValue")!==this._makeRgba(n));o&&this._$baseColor&&this._makeTransparentBackground(this._$baseColor,n)}},_initMarkup:function(){this.callBase(),this.$element().addClass(y),this._renderColorPickerContainer()},_render:function(){this.callBase(),this._renderPalette(),this._renderHueScale(),this._renderControlsContainer(),this._renderControls(),this._renderAlphaChannelElements()},_makeTransparentBackground:function(t,e){e instanceof s.default||(e=new s.default(e)),t.css("backgroundColor",this._makeRgba(e))},_makeRgba:function(t){return t instanceof s.default||(t=new s.default(t)),"rgba("+[t.r,t.g,t.b,t.a].join(", ")+")"},_renderValue:function(){this.callBase(this.option("editAlphaChannel")?this._makeRgba(this._currentColor):this.option("value"))},_renderColorPickerContainer:function(){var t=this.$element();this._$colorPickerContainer=(0,o.default)("<div>").addClass(v).appendTo(t),this._renderHtmlRows()},_renderHtmlRows:function(t){var e=this._$colorPickerContainer.find("."+C),n=e.length,i=this.option("editAlphaChannel")?2:1,r=n-i;if(r>0&&e.eq(-1).remove(),r<0){r=Math.abs(r);var a,s=[];for(a=0;a<r;a++)s.push((0,o.default)("<div>").addClass(C));if(n)for(a=0;a<s.length;a++)e.eq(0).after(s[a]);else this._$colorPickerContainer.append(s)}},_renderHtmlCellInsideRow:function(t,e,n){return(0,o.default)("<div>").addClass(_).addClass(n).appendTo(e.find("."+C).eq(t))},_renderPalette:function(){var t=this._renderHtmlCellInsideRow(0,this._$colorPickerContainer,S),e=(0,o.default)("<div>").addClass([x,w].join(" ")),n=(0,o.default)("<div>").addClass([x,I].join(" "));this._$palette=(0,o.default)("<div>").addClass(P).css("backgroundColor",this._currentColor.getPureColor().toHex()).appendTo(t),this._paletteHeight=this._$palette.height(),this._paletteWidth=this._$palette.width(),this._renderPaletteHandle(),this._$palette.append([e,n])},_renderPaletteHandle:function(){this._$paletteHandle=(0,o.default)("<div>").addClass(b).appendTo(this._$palette),this._createComponent(this._$paletteHandle,f.default,{contentTemplate:null,boundary:this._$palette,allowMoveByClick:!0,boundOffset:function(){return-this._paletteHandleHeight/2}.bind(this),onDragMove:function(){var t=(0,r.locate)(this._$paletteHandle);this._updateByDrag=!0,this._updateColorFromHsv(this._currentColor.hsv.h,this._calculateColorSaturation(t),this._calculateColorValue(t))}.bind(this)}),this._paletteHandleWidth=this._$paletteHandle.width(),this._paletteHandleHeight=this._$paletteHandle.height(),this._placePaletteHandle()},_placePaletteHandle:function(){(0,r.move)(this._$paletteHandle,{left:Math.round(this._paletteWidth*this._currentColor.hsv.s/100-this._paletteHandleWidth/2),top:Math.round(this._paletteHeight-this._paletteHeight*this._currentColor.hsv.v/100-this._paletteHandleHeight/2)})},_calculateColorValue:function(t){var e=Math.floor(t.top+this._paletteHandleHeight/2);return 100-Math.round(100*e/this._paletteHeight)},_calculateColorSaturation:function(t){var e=Math.floor(t.left+this._paletteHandleWidth/2);return Math.round(100*e/this._paletteWidth)},_updateColorFromHsv:function(t,e,n){var o=this._currentColor.a;this._currentColor=new s.default("hsv("+[t,e,n].join(",")+")"),this._currentColor.a=o,this._updateColorParamsAndColorPreview(),this.applyColor()},_renderHueScale:function(){var t=this._renderHtmlCellInsideRow(0,this._$colorPickerContainer,O);this._$hueScaleWrapper=(0,o.default)("<div>").addClass(M).appendTo(t),this._$hueScale=(0,o.default)("<div>").addClass(T).appendTo(this._$hueScaleWrapper),this._hueScaleHeight=this._$hueScale.height(),this._hueScaleWrapperHeight=this._$hueScaleWrapper.outerHeight(),this._renderHueScaleHandle()},_renderHueScaleHandle:function(){this._$hueScaleHandle=(0,o.default)("<div>").addClass(E).appendTo(this._$hueScaleWrapper),this._createComponent(this._$hueScaleHandle,f.default,{contentTemplate:null,boundary:this._$hueScaleWrapper,allowMoveByClick:!0,dragDirection:"vertical",onDragMove:function(){this._updateByDrag=!0,this._updateColorHue((0,r.locate)(this._$hueScaleHandle).top+this._hueScaleHandleHeight/2)}.bind(this)}),this._hueScaleHandleHeight=this._$hueScaleHandle.height(),this._placeHueScaleHandle()},_placeHueScaleHandle:function(){var t=this._hueScaleWrapperHeight,e=this._hueScaleHandleHeight,n=(t-e)*(360-this._currentColor.hsv.h)/360;t<n+e&&(n=t-e),n<0&&(n=0),(0,r.move)(this._$hueScaleHandle,{top:Math.round(n)})},_updateColorHue:function(t){var e=360-Math.round(360*(t-this._hueScaleHandleHeight/2)/(this._hueScaleWrapperHeight-this._hueScaleHandleHeight)),n=this._currentColor.hsv.s,o=this._currentColor.hsv.v;this._isTopColorHue=!1,e=e<0?0:e,e>=360&&(this._isTopColorHue=!0,e=0),this._updateColorFromHsv(e,n,o),this._$palette.css("backgroundColor",this._currentColor.getPureColor().toHex())},_renderControlsContainer:function(){var t=this._renderHtmlCellInsideRow(0,this._$colorPickerContainer);this._$controlsContainer=(0,o.default)("<div>").addClass(D).appendTo(t)},_renderControls:function(){this._renderColorsPreview(),this._renderRgbInputs(),this._renderHexInput()},_renderColorsPreview:function(){var t=(0,o.default)("<div>").addClass(K).appendTo(this._$controlsContainer),e=(0,o.default)("<div>").addClass(W).appendTo(t);this._$currentColor=(0,o.default)("<div>").addClass([F,Z].join(" ")),this._$baseColor=(0,o.default)("<div>").addClass([F,G].join(" ")),this._makeTransparentBackground(this._$baseColor,this.option("matchValue")),this._makeTransparentBackground(this._$currentColor,this._currentColor),e.append([this._$baseColor,this._$currentColor])},_renderAlphaChannelElements:function(){this.option("editAlphaChannel")&&(this._$colorPickerContainer.find("."+C).eq(1).addClass(N),this._renderAlphaChannelScale(),this._renderAlphaChannelInput())},_renderRgbInputs:function(){this._rgbInputsWithLabels=[this._renderEditorWithLabel({editorType:h.default,value:this._currentColor.r,onValueChanged:this._updateColor.bind(this,!1),labelText:"R",labelAriaText:c.default.format("dxColorView-ariaRed"),labelClass:A}),this._renderEditorWithLabel({editorType:h.default,value:this._currentColor.g,onValueChanged:this._updateColor.bind(this,!1),labelText:"G",labelAriaText:c.default.format("dxColorView-ariaGreen"),labelClass:k}),this._renderEditorWithLabel({editorType:h.default,value:this._currentColor.b,onValueChanged:this._updateColor.bind(this,!1),labelText:"B",labelAriaText:c.default.format("dxColorView-ariaBlue"),labelClass:L})],this._$controlsContainer.append(this._rgbInputsWithLabels),this._rgbInputs=[this._rgbInputsWithLabels[0].find(".dx-numberbox").dxNumberBox("instance"),this._rgbInputsWithLabels[1].find(".dx-numberbox").dxNumberBox("instance"),this._rgbInputsWithLabels[2].find(".dx-numberbox").dxNumberBox("instance")]},_renderEditorWithLabel:function(t){var e=this,n=(0,o.default)("<div>"),r=(0,o.default)("<label>").addClass(t.labelClass).text(t.labelText+":").append(n);i.default.off(r,m.name),i.default.on(r,m.name,(function(t){t.preventDefault()}));var s=t.editorType,c=(0,a.extend)({value:t.value,onValueChanged:t.onValueChanged,onKeyboardHandled:function(t){return e._keyboardHandler(t)}},{stylingMode:this.option("stylingMode")});s===h.default&&(c.min=t.min||0,c.max=t.max||255,c.step=t.step||1);var u=new s(n,c);return u.registerKeyHandler("enter",function(t){this._fireEnterKeyPressed(t)}.bind(this)),this.setAria("label",t.labelAriaText,n),r},hexInputOptions:function(){return{editorType:d.default,value:this._currentColor.toHex().replace("#",""),onValueChanged:this._updateColor.bind(this,!0),labelClass:R,labelText:"#",labelAriaText:c.default.format("dxColorView-ariaHex")}},_renderHexInput:function(){this._hexInput=d.default.getInstance(this._renderEditorWithLabel(this.hexInputOptions()).appendTo(this._$controlsContainer).find(".dx-textbox"))},_renderAlphaChannelScale:function(){var t=this._renderHtmlCellInsideRow(1,this._$colorPickerContainer,H),e=(0,o.default)("<div>").addClass(V).appendTo(t),n=(0,o.default)("<div>").addClass(j).appendTo(e);this._$alphaChannelScale=(0,o.default)("<div>").addClass(z).appendTo(n),this._makeCSSLinearGradient(this._$alphaChannelScale),this._renderAlphaChannelHandle(t)},_makeCSSLinearGradient:function(t){var e=this._currentColor,n=[e.r,e.g,e.b].join(","),o=e.toHex().replace("#",""),i=function(t,e){var n=this.option("rtlEnabled"),o="rgba("+t+", "+(n?"1":"0")+")",i="rgba("+t+", "+(n?"0":"1")+")",r="'#"+(n?"00":"")+e+"'",a="'#"+(n?"":"00")+e+"'";return["background-image: -webkit-linear-gradient(180deg, "+o+", "+i+")","background-image: -moz-linear-gradient(-90deg, "+o+", "+i+")","background-image: -o-linear-gradient(-90deg, "+o+", "+i+")","background-image: linear-gradient(-90deg, "+o+", "+i+")","filter: progid:DXImageTransform.Microsoft.gradient(GradientType=1,startColorstr="+r+", endColorstr="+a+")"].join(";")};t.attr("style",i.call(this,n,o))},_renderAlphaChannelInput:function(){var t=this,e=this._renderHtmlCellInsideRow(1,this._$colorPickerContainer);t._alphaChannelInput=this._renderEditorWithLabel({editorType:h.default,value:this._currentColor.a,max:1,step:.1,onValueChanged:function(e){var n=e.value;n=t._currentColor.isValidAlpha(n)?n:t._currentColor.a,t._updateColorTransparency(n),t._placeAlphaChannelHandle()},labelClass:U,labelText:"Alpha",labelAriaText:c.default.format("dxColorView-ariaAlpha")}).appendTo(e).find(".dx-numberbox").dxNumberBox("instance")},_updateColorTransparency:function(t){this._currentColor.a=t,this.applyColor()},_renderAlphaChannelHandle:function(t){this._$alphaChannelHandle=(0,o.default)("<div>").addClass(B).appendTo(t),this._createComponent(this._$alphaChannelHandle,f.default,{contentTemplate:null,boundary:t,allowMoveByClick:!0,dragDirection:"horizontal",onDragMove:function(){this._updateByDrag=!0;var t=this._$alphaChannelHandle,e=(0,r.locate)(t).left+this._alphaChannelHandleWidth/2;this._calculateColorTransparencyByScaleWidth(e)}.bind(this)}),this._alphaChannelHandleWidth=this._$alphaChannelHandle.width(),this._alphaChannelScaleWorkWidth=t.width()-this._alphaChannelHandleWidth,this._placeAlphaChannelHandle()},_calculateColorTransparencyByScaleWidth:function(t){var e=(t-this._alphaChannelHandleWidth/2)/this._alphaChannelScaleWorkWidth,n=this.option("rtlEnabled");e=n?e:1-e,t>=this._alphaChannelScaleWorkWidth+this._alphaChannelHandleWidth/2?e=n?1:0:e<1&&(e=e.toFixed(2)),e=Math.max(e,0),e=Math.min(e,1),this._alphaChannelInput.option("value",e)},_placeAlphaChannelHandle:function(){var t=this._alphaChannelScaleWorkWidth*(1-this._currentColor.a);t<0&&(t=0),this._alphaChannelScaleWorkWidth<t&&(t=this._alphaChannelScaleWorkWidth),(0,r.move)(this._$alphaChannelHandle,{left:this.option("rtlEnabled")?this._alphaChannelScaleWorkWidth-t:t})},applyColor:function(){var t=this.option("editAlphaChannel")?this._makeRgba(this._currentColor):this._currentColor.toHex();this._makeTransparentBackground(this._$currentColor,this._currentColor),this.option("value",t)},cancelColor:function(){this._initColorAndOpacity(),this._refreshMarkup()},_updateColor:function(t,e){var n,o;t?o=this._validateHex("#"+this._hexInput.option("value")):(n=this._validateRgb(),this._alphaChannelInput?(n.push(this._alphaChannelInput.option("value")),o="rgba("+n.join(", ")+")"):o="rgb("+n.join(", ")+")"),this._suppressEditorsValueUpdating||(this._currentColor=new s.default(o),this.applyColor(),this._refreshMarkup())},_validateHex:function(t){return this._currentColor.isValidHex(t)?t:this._currentColor.toHex()},_validateRgb:function(){var t=this._rgbInputs[0].option("value"),e=this._rgbInputs[1].option("value"),n=this._rgbInputs[2].option("value");return this._currentColor.isValidRGB(t,e,n)||(t=this._currentColor.r,e=this._currentColor.g,n=this._currentColor.b),[t,e,n]},_refreshMarkup:function(){this._placeHueScaleHandle(),this._placePaletteHandle(),this._updateColorParamsAndColorPreview(),this._$palette.css("backgroundColor",this._currentColor.getPureColor().toHex()),this._$alphaChannelHandle&&(this._updateColorTransparency(this._currentColor.a),this._placeAlphaChannelHandle())},_updateColorParamsAndColorPreview:function(){this._suppressEditorsValueUpdating=!0,this._hexInput.option("value",this._currentColor.toHex().replace("#","")),this._rgbInputs[0].option("value",this._currentColor.r),this._rgbInputs[1].option("value",this._currentColor.g),this._rgbInputs[2].option("value",this._currentColor.b),this._suppressEditorsValueUpdating=!1,this.option("editAlphaChannel")&&(this._makeCSSLinearGradient.call(this,this._$alphaChannelScale),this._alphaChannelInput.option("value",this._currentColor.a))},_optionChanged:function(t){var e=t.value;switch(t.name){case"value":this._setCurrentColor(e),this._updateByDrag||this._refreshMarkup(),this._updateByDrag=!1,this.callBase(t);break;case"matchValue":this._setBaseColor(e);break;case"onEnterKeyPressed":this._initEnterKeyPressedAction();break;case"editAlphaChannel":this._$colorPickerContainer&&(this._renderHtmlRows("editAlphaChannel"),this._renderAlphaChannelElements());break;case"keyStep":break;case"stylingMode":this._renderControls();break;default:this.callBase(t)}}});(0,l.default)("dxColorView",q);var $=q;e.default=$,t.exports=e.default},fea6:function(t,e,n){"use strict";function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}e.default=void 0;var i=c(n("14a3")),r=c(n("cc156")),a=c(n("c230")),s=n("4ff6");function c(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function p(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function h(t,e,n){return h="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=d(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},h(t,e,n||t)}function d(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=_(t),null===t)break;return t}function f(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function g(t){var e=C();return function(){var n,o=_(t);if(e){var i=_(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?v(t):e}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var P="dx-diagram-context-toolbox-target",S="dx-diagram-context-toolbox",b="dx-diagram-touch-context-toolbox",x="dx-diagram-context-toolbox-content",w=function(t){f(n,t);var e=g(n);function n(){return u(this,n),e.apply(this,arguments)}return p(n,[{key:"_init",value:function(){h(_(n.prototype),"_init",this).call(this),this._onShownAction=this._createActionByOption("onShown"),this._popoverPositionData=[{my:{x:"center",y:"top"},at:{x:"center",y:"bottom"},offset:{x:0,y:5}},{my:{x:"right",y:"center"},at:{x:"left",y:"center"},offset:{x:-5,y:0}},{my:{x:"center",y:"bottom"},at:{x:"center",y:"top"},offset:{x:0,y:-5}},{my:{x:"left",y:"center"},at:{x:"right",y:"center"},offset:{x:5,y:0}}]}},{key:"_initMarkup",value:function(){h(_(n.prototype),"_initMarkup",this).call(this),this._$popoverTargetElement=(0,i.default)("<div>").addClass(P).appendTo(this.$element());var t=(0,i.default)("<div>").appendTo(this.$element()),e=(0,s.getDiagram)(),o=e.Browser,r=S;o.TouchUI&&(r+=" "+b),this._popoverInstance=this._createComponent(t,a.default,{closeOnOutsideClick:!1,container:this.$element(),elementAttr:{class:r}})}},{key:"_show",value:function(t,e,n,o,r){this._popoverInstance.hide();var a=(0,i.default)("<div>").addClass(x);void 0!==this.option("toolboxWidth")&&a.css("width",this.option("toolboxWidth")),this._$popoverTargetElement.css({left:t+this._popoverPositionData[n].offset.x,top:e+this._popoverPositionData[n].offset.y}).show(),this._popoverInstance.option({position:{my:this._popoverPositionData[n].my,at:this._popoverPositionData[n].at,of:this._$popoverTargetElement},contentTemplate:a,onContentReady:function(){var t=this,e=this.$element().find("."+x);this._onShownAction({category:o,callback:r,$element:e,hide:function(){return t._popoverInstance.hide()}})}.bind(this)}),this._popoverInstance.show()}},{key:"_hide",value:function(){this._$popoverTargetElement.hide(),this._popoverInstance.hide()}}]),n}(r.default),I=w;e.default=I,t.exports=e.default}}]);